<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:19:41 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>bridging_features.h File Reference</h1>
<p>Channel Bridging API.  
<a href="#_details">More...</a></p>

<p><a href="bridging__features_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__bridge__features.html">ast_bridge_features</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure that contains features information.  <a href="structast__bridge__features.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__bridge__features__attended__transfer.html">ast_bridge_features_attended_transfer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure that contains configuration information for the attended transfer built in feature.  <a href="structast__bridge__features__attended__transfer.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__bridge__features__blind__transfer.html">ast_bridge_features_blind_transfer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure that contains configuration information for the blind transfer built in feature.  <a href="structast__bridge__features__blind__transfer.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__bridge__features__hook.html">ast_bridge_features_hook</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure that is the essence of a features hook.  <a href="structast__bridge__features__hook.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a8f882f130b89dd63d656d176884095a1">MAXIMUM_DTMF_FEATURE_STRING</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum length of a DTMF feature string.  <a href="#a8f882f130b89dd63d656d176884095a1"></a><br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a6d066da82427624671f418f4f64c5797">ast_bridge_features_hook_callback</a> )(struct <a class="el" href="structast__bridge.html">ast_bridge</a> *bridge, struct <a class="el" href="structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, void *hook_pvt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Features hook callback type.  <a href="#a6d066da82427624671f418f4f64c5797"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> { <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1296b14dfc88f2a49818dfd08f2b80fb">AST_BRIDGE_BUILTIN_BLINDTRANSFER</a> =  0, 
<a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a914956d3505768cc223eb23ce407c691">AST_BRIDGE_BUILTIN_ATTENDEDTRANSFER</a>, 
<a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a96d5e1a5c56634eb48dd78965e5e2ba4">AST_BRIDGE_BUILTIN_HANGUP</a>, 
<a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717">AST_BRIDGE_BUILTIN_END</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Built in features. </p>
 <a href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444">ast_bridge_feature_flags</a> { <a class="el" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444ae2c21ce82d946116c6488e97faedcd3d">AST_BRIDGE_FLAG_DISSOLVE</a> =  (1 &lt;&lt; 0), 
<a class="el" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b">AST_BRIDGE_FLAG_SMART</a> =  (1 &lt;&lt; 1)
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Flags used for bridge features. </p>
 <a href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#aa60bc7df6be7b53bbb572ab5fcecb5aa">ast_bridge_dtmf_stream</a> (struct <a class="el" href="structast__bridge.html">ast_bridge</a> *bridge, const char *dtmf, struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Play a DTMF stream into a bridge, optionally not to a given channel.  <a href="#aa60bc7df6be7b53bbb572ab5fcecb5aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#acd324df24035097d55e7ecf1f214fab3">ast_bridge_features_cleanup</a> (struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *features)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clean up the contents of a bridge features structure.  <a href="#acd324df24035097d55e7ecf1f214fab3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#adb1bd9496b6c67609e6d909ccd70e5ae">ast_bridge_features_enable</a> (struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *features, enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature, const char *dtmf, void *<a class="el" href="pbx__lua_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable a built in feature on a bridge features structure.  <a href="#adb1bd9496b6c67609e6d909ccd70e5ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a2febee2c3ae0c31d248278818ca5edf7">ast_bridge_features_hook</a> (struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *features, const char *dtmf, <a class="el" href="bridging__features_8h.html#a6d066da82427624671f418f4f64c5797">ast_bridge_features_hook_callback</a> callback, void *hook_pvt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Attach a custom hook to a bridge features structure.  <a href="#a2febee2c3ae0c31d248278818ca5edf7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a> (struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *features)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize bridge features structure.  <a href="#a3128b52009fb3dd764dce90ea377fce1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#ad47b9c636ec2afadb2c98335967a4125">ast_bridge_features_register</a> (enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature, <a class="el" href="bridging__features_8h.html#a6d066da82427624671f418f4f64c5797">ast_bridge_features_hook_callback</a> callback, const char *dtmf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a handler for a built in feature.  <a href="#ad47b9c636ec2afadb2c98335967a4125"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a3a82a984ac979d8c180e80e3ac06c818">ast_bridge_features_set_flag</a> (struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *features, enum <a class="el" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444">ast_bridge_feature_flags</a> flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a flag on a bridge features structure.  <a href="#a3a82a984ac979d8c180e80e3ac06c818"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__features_8h.html#a395272994b2af7bd55f871b02d2d42e4">ast_bridge_features_unregister</a> (enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister a handler for a built in feature.  <a href="#a395272994b2af7bd55f871b02d2d42e4"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Channel Bridging API. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Joshua Colp &lt;<a href="mailto:jcolp@digium.com">jcolp@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="bridging__features_8h_source.html">bridging_features.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a8f882f130b89dd63d656d176884095a1"></a><!-- doxytag: member="bridging_features.h::MAXIMUM_DTMF_FEATURE_STRING" ref="a8f882f130b89dd63d656d176884095a1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXIMUM_DTMF_FEATURE_STRING&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Maximum length of a DTMF feature string. </p>

<p>Definition at line <a class="el" href="bridging__features_8h_source.html#l00069">69</a> of file <a class="el" href="bridging__features_8h_source.html">bridging_features.h</a>.</p>

<p>Referenced by <a class="el" href="bridging_8c_source.html#l00778">bridge_channel_feature()</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a6d066da82427624671f418f4f64c5797"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_hook_callback" ref="a6d066da82427624671f418f4f64c5797" args=")(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel, void *hook_pvt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* <a class="el" href="bridging__features_8h.html#a6d066da82427624671f418f4f64c5797">ast_bridge_features_hook_callback</a>)(struct <a class="el" href="structast__bridge.html">ast_bridge</a> *bridge, struct <a class="el" href="structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, void *hook_pvt)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Features hook callback type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bridge</em>&nbsp;</td><td>The bridge that the channel is part of </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bridge_channel</em>&nbsp;</td><td>Channel executing the feature </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hook_pvt</em>&nbsp;</td><td>Private data passed in when the hook was created</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bridging__features_8h_source.html#l00064">64</a> of file <a class="el" href="bridging__features_8h_source.html">bridging_features.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a59c3a69424e1d3c627ece7aeb5f0bdb3"></a><!-- doxytag: member="bridging_features.h::ast_bridge_builtin_feature" ref="a59c3a69424e1d3c627ece7aeb5f0bdb3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Built in features. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a59c3a69424e1d3c627ece7aeb5f0bdb3a1296b14dfc88f2a49818dfd08f2b80fb"></a><!-- doxytag: member="AST_BRIDGE_BUILTIN_BLINDTRANSFER" ref="a59c3a69424e1d3c627ece7aeb5f0bdb3a1296b14dfc88f2a49818dfd08f2b80fb" args="" -->AST_BRIDGE_BUILTIN_BLINDTRANSFER</em>&nbsp;</td><td>
<p>DTMF Based Blind Transfer </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a59c3a69424e1d3c627ece7aeb5f0bdb3a914956d3505768cc223eb23ce407c691"></a><!-- doxytag: member="AST_BRIDGE_BUILTIN_ATTENDEDTRANSFER" ref="a59c3a69424e1d3c627ece7aeb5f0bdb3a914956d3505768cc223eb23ce407c691" args="" -->AST_BRIDGE_BUILTIN_ATTENDEDTRANSFER</em>&nbsp;</td><td>
<p>DTMF Based Attended Transfer </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a59c3a69424e1d3c627ece7aeb5f0bdb3a96d5e1a5c56634eb48dd78965e5e2ba4"></a><!-- doxytag: member="AST_BRIDGE_BUILTIN_HANGUP" ref="a59c3a69424e1d3c627ece7aeb5f0bdb3a96d5e1a5c56634eb48dd78965e5e2ba4" args="" -->AST_BRIDGE_BUILTIN_HANGUP</em>&nbsp;</td><td>
<p>DTMF Based Hangup Feature </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717"></a><!-- doxytag: member="AST_BRIDGE_BUILTIN_END" ref="a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717" args="" -->AST_BRIDGE_BUILTIN_END</em>&nbsp;</td><td>
<p>End terminator for list of built in features. Must remain last. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="bridging__features_8h_source.html#l00040">40</a> of file <a class="el" href="bridging__features_8h_source.html">bridging_features.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00040"></a>00040                                 {<span class="comment"></span>
<a name="l00041"></a>00041 <span class="comment">   /*! DTMF Based Blind Transfer */</span>
<a name="l00042"></a>00042    <a class="code" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1296b14dfc88f2a49818dfd08f2b80fb">AST_BRIDGE_BUILTIN_BLINDTRANSFER</a> = 0,<span class="comment"></span>
<a name="l00043"></a>00043 <span class="comment">   /*! DTMF Based Attended Transfer */</span>
<a name="l00044"></a>00044    <a class="code" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a914956d3505768cc223eb23ce407c691">AST_BRIDGE_BUILTIN_ATTENDEDTRANSFER</a>,<span class="comment"></span>
<a name="l00045"></a>00045 <span class="comment">   /*! DTMF Based Hangup Feature */</span>
<a name="l00046"></a>00046    <a class="code" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a96d5e1a5c56634eb48dd78965e5e2ba4">AST_BRIDGE_BUILTIN_HANGUP</a>,<span class="comment"></span>
<a name="l00047"></a>00047 <span class="comment">   /*! End terminator for list of built in features. Must remain last. */</span>
<a name="l00048"></a>00048    <a class="code" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717">AST_BRIDGE_BUILTIN_END</a>,
<a name="l00049"></a>00049 };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a65c2644d2eadb31bcec0aaeb41cb3444"></a><!-- doxytag: member="bridging_features.h::ast_bridge_feature_flags" ref="a65c2644d2eadb31bcec0aaeb41cb3444" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444">ast_bridge_feature_flags</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flags used for bridge features. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a65c2644d2eadb31bcec0aaeb41cb3444ae2c21ce82d946116c6488e97faedcd3d"></a><!-- doxytag: member="AST_BRIDGE_FLAG_DISSOLVE" ref="a65c2644d2eadb31bcec0aaeb41cb3444ae2c21ce82d946116c6488e97faedcd3d" args="" -->AST_BRIDGE_FLAG_DISSOLVE</em>&nbsp;</td><td>
<p>Upon hangup the bridge should be discontinued </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b"></a><!-- doxytag: member="AST_BRIDGE_FLAG_SMART" ref="a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b" args="" -->AST_BRIDGE_FLAG_SMART</em>&nbsp;</td><td>
<p>Move between bridging technologies as needed. </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="bridging__features_8h_source.html#l00032">32</a> of file <a class="el" href="bridging__features_8h_source.html">bridging_features.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00032"></a>00032                               {<span class="comment"></span>
<a name="l00033"></a>00033 <span class="comment">   /*! Upon hangup the bridge should be discontinued */</span>
<a name="l00034"></a>00034    <a class="code" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444ae2c21ce82d946116c6488e97faedcd3d">AST_BRIDGE_FLAG_DISSOLVE</a> = (1 &lt;&lt; 0),<span class="comment"></span>
<a name="l00035"></a>00035 <span class="comment">   /*! Move between bridging technologies as needed. */</span>
<a name="l00036"></a>00036    <a class="code" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b">AST_BRIDGE_FLAG_SMART</a> = (1 &lt;&lt; 1),
<a name="l00037"></a>00037 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa60bc7df6be7b53bbb572ab5fcecb5aa"></a><!-- doxytag: member="bridging_features.h::ast_bridge_dtmf_stream" ref="aa60bc7df6be7b53bbb572ab5fcecb5aa" args="(struct ast_bridge *bridge, const char *dtmf, struct ast_channel *chan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_dtmf_stream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge.html">ast_bridge</a> *&nbsp;</td>
          <td class="paramname"> <em>bridge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>dtmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Play a DTMF stream into a bridge, optionally not to a given channel. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bridge</em>&nbsp;</td><td>Bridge to play stream into </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dtmf</em>&nbsp;</td><td>DTMF to play </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to optionally not play to</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__features_8h.html#aa60bc7df6be7b53bbb572ab5fcecb5aa" title="Play a DTMF stream into a bridge, optionally not to a given channel.">ast_bridge_dtmf_stream</a>(<a class="code" href="structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="stringliteral">&quot;0123456789&quot;</span>, NULL);
</pre></div><p>This sends the DTMF digits '0123456789' to all <a class="el" href="structchannels.html" title="the list of channels we have. Note that the lock for this list is used for both the...">channels</a> in the bridge pointed to by the bridge pointer. Optionally a channel may be excluded by passing it's channel pointer using the chan parameter. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01332">1332</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="astobj2_8c_source.html#l00147">ao2_lock()</a>, <a class="el" href="astobj2_8c_source.html#l00169">ao2_unlock()</a>, <a class="el" href="bridging_8c_source.html#l00118">ast_bridge_change_state()</a>, <a class="el" href="bridging_8h_source.html#l00098">AST_BRIDGE_CHANNEL_STATE_DTMF</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="bridging_8h_source.html#l00125">ast_bridge_channel::chan</a>, and <a class="el" href="bridging_8h_source.html#l00141">ast_bridge_channel::dtmf_stream_q</a>.</p>

<p>Referenced by <a class="el" href="bridging_8c_source.html#l00778">bridge_channel_feature()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01333"></a>01333 {
<a name="l01334"></a>01334    <span class="keyword">struct </span><a class="code" href="structast__bridge__channel.html" title="Structure that contains information regarding a channel in a bridge.">ast_bridge_channel</a> *bridge_channel = NULL;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336    <a class="code" href="astobj2_8h.html#a3077056d07f6f9e348a54a743769bad5" title="Lock an object.">ao2_lock</a>(bridge);
<a name="l01337"></a>01337 
<a name="l01338"></a>01338    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;channels, bridge_channel, entry) {
<a name="l01339"></a>01339       <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == chan) {
<a name="l01340"></a>01340          <span class="keywordflow">continue</span>;
<a name="l01341"></a>01341       }
<a name="l01342"></a>01342       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(bridge_channel-&gt;<a class="code" href="structast__bridge__channel.html#ab17441f7a62e1f44132a5c2a5bb69d27">dtmf_stream_q</a>, dtmf, <span class="keyword">sizeof</span>(bridge_channel-&gt;<a class="code" href="structast__bridge__channel.html#ab17441f7a62e1f44132a5c2a5bb69d27">dtmf_stream_q</a>));
<a name="l01343"></a>01343       <a class="code" href="bridging_8h.html#a03cde0e9535440a4f9f24ab921bea771" title="Change the state of a bridged channel.">ast_bridge_change_state</a>(bridge_channel, <a class="code" href="bridging_8h.html#a78f46aa0abbe1f3bf98be03c884203a7a5242791d651ccb03b7426b626dca9dbd">AST_BRIDGE_CHANNEL_STATE_DTMF</a>);
<a name="l01344"></a>01344    }
<a name="l01345"></a>01345 
<a name="l01346"></a>01346    <a class="code" href="astobj2_8h.html#a379cc936a320f2179f7beb422dc15230" title="Unlock an object.">ao2_unlock</a>(bridge);
<a name="l01347"></a>01347 
<a name="l01348"></a>01348    <span class="keywordflow">return</span> 0;
<a name="l01349"></a>01349 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acd324df24035097d55e7ecf1f214fab3"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_cleanup" ref="acd324df24035097d55e7ecf1f214fab3" args="(struct ast_bridge_features *features)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_features_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *&nbsp;</td>
          <td class="paramname"> <em>features</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clean up the contents of a bridge features structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>features</em>&nbsp;</td><td>Bridge features structure</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">struct </span><a class="code" href="structast__bridge__features.html" title="Structure that contains features information.">ast_bridge_features</a> features;
 <a class="code" href="bridging__features_8h.html#a3128b52009fb3dd764dce90ea377fce1" title="Initialize bridge features structure.">ast_bridge_features_init</a>(&amp;features);
 <a class="code" href="bridging__features_8h.html#acd324df24035097d55e7ecf1f214fab3" title="Clean up the contents of a bridge features structure.">ast_bridge_features_cleanup</a>(&amp;features);
</pre></div><p>This cleans up the feature structure 'features'.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This MUST be called after the features structure is done being used or a memory leak may occur. </dd></dl>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01320">1320</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, and <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>.</p>

<p>Referenced by <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, <a class="el" href="bridging_8c_source.html#l00420">destroy_bridge()</a>, and <a class="el" href="bridge__builtin__features_8c_source.html#l00157">feature_attended_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01321"></a>01321 {
<a name="l01322"></a>01322    <span class="keyword">struct </span><a class="code" href="structast__bridge__features__hook.html" title="Structure that is the essence of a features hook.">ast_bridge_features_hook</a> *hook = NULL;
<a name="l01323"></a>01323 
<a name="l01324"></a>01324    <span class="comment">/* This is relatively simple, hooks are kept as a list on the features structure so we just pop them off and free them */</span>
<a name="l01325"></a>01325    <span class="keywordflow">while</span> ((hook = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;features-&gt;hooks, entry))) {
<a name="l01326"></a>01326       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(hook);
<a name="l01327"></a>01327    }
<a name="l01328"></a>01328 
<a name="l01329"></a>01329    <span class="keywordflow">return</span> 0;
<a name="l01330"></a>01330 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adb1bd9496b6c67609e6d909ccd70e5ae"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_enable" ref="adb1bd9496b6c67609e6d909ccd70e5ae" args="(struct ast_bridge_features *features, enum ast_bridge_builtin_feature feature, const char *dtmf, void *config)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_features_enable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *&nbsp;</td>
          <td class="paramname"> <em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a>&nbsp;</td>
          <td class="paramname"> <em>feature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>dtmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>config</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable a built in feature on a bridge features structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>features</em>&nbsp;</td><td>Bridge features structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>feature</em>&nbsp;</td><td>Feature to enable </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dtmf</em>&nbsp;</td><td>Optionally the DTMF stream to trigger the feature, if not specified it will be the default </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>config</em>&nbsp;</td><td>Configuration structure unique to the built in type</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">struct </span><a class="code" href="structast__bridge__features.html" title="Structure that contains features information.">ast_bridge_features</a> features;
 <a class="code" href="bridging__features_8h.html#a3128b52009fb3dd764dce90ea377fce1" title="Initialize bridge features structure.">ast_bridge_features_init</a>(&amp;features);
 <a class="code" href="bridging__features_8h.html#adb1bd9496b6c67609e6d909ccd70e5ae" title="Enable a built in feature on a bridge features structure.">ast_bridge_features_enable</a>(&amp;features, <a class="code" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a914956d3505768cc223eb23ce407c691">AST_BRIDGE_BUILTIN_ATTENDEDTRANSFER</a>, NULL);
</pre></div><p>This enables the attended transfer DTMF option using the default DTMF string. An alternate string may be provided using the dtmf parameter. Internally this is simply setting up a hook to a built in feature callback function. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01282">1282</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="bridging_8c_source.html#l01261">ast_bridge_features_hook()</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, and <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="bridge__builtin__features_8c_source.html#l00157">feature_attended_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01283"></a>01283 {
<a name="l01284"></a>01284    <span class="comment">/* If no alternate DTMF stream was provided use the default one */</span>
<a name="l01285"></a>01285    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(dtmf)) {
<a name="l01286"></a>01286       dtmf = <a class="code" href="bridging_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[feature];
<a name="l01287"></a>01287       <span class="comment">/* If no DTMF is still available (ie: it has been disabled) then error out now */</span>
<a name="l01288"></a>01288       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(dtmf)) {
<a name="l01289"></a>01289          <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Failed to enable built in feature %d on %p, no DTMF string is available for it.\n&quot;</span>, feature, features);
<a name="l01290"></a>01290          <span class="keywordflow">return</span> -1;
<a name="l01291"></a>01291       }
<a name="l01292"></a>01292    }
<a name="l01293"></a>01293 
<a name="l01294"></a>01294    <span class="keywordflow">if</span> (!<a class="code" href="bridging_8c.html#af4095d93586f95dd08ef1ad461bc3b80">builtin_features_handlers</a>[feature]) {
<a name="l01295"></a>01295       <span class="keywordflow">return</span> -1;
<a name="l01296"></a>01296    }
<a name="l01297"></a>01297 
<a name="l01298"></a>01298    <span class="comment">/* The rest is basically pretty easy. We create another hook using the built in feature&apos;s callback and DTMF, easy as pie. */</span>
<a name="l01299"></a>01299    <span class="keywordflow">return</span> <a class="code" href="bridging__features_8h.html#a2febee2c3ae0c31d248278818ca5edf7" title="Attach a custom hook to a bridge features structure.">ast_bridge_features_hook</a>(features, dtmf, <a class="code" href="bridging_8c.html#af4095d93586f95dd08ef1ad461bc3b80">builtin_features_handlers</a>[feature], <a class="code" href="cdr__csv_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>);
<a name="l01300"></a>01300 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2febee2c3ae0c31d248278818ca5edf7"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_hook" ref="a2febee2c3ae0c31d248278818ca5edf7" args="(struct ast_bridge_features *features, const char *dtmf, ast_bridge_features_hook_callback callback, void *hook_pvt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="structast__bridge__features__hook.html">ast_bridge_features_hook</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *&nbsp;</td>
          <td class="paramname"> <em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>dtmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bridging__features_8h.html#a6d066da82427624671f418f4f64c5797">ast_bridge_features_hook_callback</a>&nbsp;</td>
          <td class="paramname"> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>hook_pvt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Attach a custom hook to a bridge features structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>features</em>&nbsp;</td><td>Bridge features structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dtmf</em>&nbsp;</td><td>DTMF string to be activated upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>Function to execute upon activation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hook_pvt</em>&nbsp;</td><td>Unique data</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">struct </span><a class="code" href="structast__bridge__features.html" title="Structure that contains features information.">ast_bridge_features</a> features;
 <a class="code" href="bridging__features_8h.html#a3128b52009fb3dd764dce90ea377fce1" title="Initialize bridge features structure.">ast_bridge_features_init</a>(&amp;features);
 <a class="code" href="bridging__features_8h.html#a2febee2c3ae0c31d248278818ca5edf7" title="Attach a custom hook to a bridge features structure.">ast_bridge_features_hook</a>(&amp;features, <span class="stringliteral">&quot;#&quot;</span>, pound_callback, NULL);
</pre></div><p>This makes the bridging core call pound_callback if a channel that has this feature structure inputs the DTMF string '#'. A pointer to useful data may be provided to the hook_pvt parameter.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>It is important that the callback set the bridge channel <a class="el" href="structstate.html">state</a> back to AST_BRIDGE_CHANNEL_STATE_WAIT or the bridge thread will not service the channel. </dd></dl>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01261">1261</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="bridging__features_8h_source.html#l00078">ast_bridge_features_hook::callback</a>, <a class="el" href="bridging__features_8h_source.html#l00076">ast_bridge_features_hook::dtmf</a>, <a class="el" href="bridging__features_8h_source.html#l00080">ast_bridge_features_hook::hook_pvt</a>, and <a class="el" href="bridging__features_8h_source.html#l00094">ast_bridge_features::usable</a>.</p>

<p>Referenced by <a class="el" href="bridging_8c_source.html#l01282">ast_bridge_features_enable()</a>, <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, and <a class="el" href="bridge__builtin__features_8c_source.html#l00157">feature_attended_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01262"></a>01262 {
<a name="l01263"></a>01263    <span class="keyword">struct </span><a class="code" href="structast__bridge__features__hook.html" title="Structure that is the essence of a features hook.">ast_bridge_features_hook</a> *hook = NULL;
<a name="l01264"></a>01264 
<a name="l01265"></a>01265    <span class="comment">/* Allocate new memory and setup it&apos;s various variables */</span>
<a name="l01266"></a>01266    <span class="keywordflow">if</span> (!(hook = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*hook)))) {
<a name="l01267"></a>01267       <span class="keywordflow">return</span> -1;
<a name="l01268"></a>01268    }
<a name="l01269"></a>01269 
<a name="l01270"></a>01270    <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(hook-&gt;<a class="code" href="structast__bridge__features__hook.html#a33464dba524e69ccf4c908b486d8301e">dtmf</a>, <a class="code" href="structast__bridge__features__hook.html#a33464dba524e69ccf4c908b486d8301e">dtmf</a>, <span class="keyword">sizeof</span>(hook-&gt;<a class="code" href="structast__bridge__features__hook.html#a33464dba524e69ccf4c908b486d8301e">dtmf</a>));
<a name="l01271"></a>01271    hook-&gt;<a class="code" href="structast__bridge__features__hook.html#ad69a4c6a493af02d5203d747834cb329">callback</a> = <a class="code" href="structast__bridge__features__hook.html#ad69a4c6a493af02d5203d747834cb329">callback</a>;
<a name="l01272"></a>01272    hook-&gt;<a class="code" href="structast__bridge__features__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a> = <a class="code" href="structast__bridge__features__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>;
<a name="l01273"></a>01273 
<a name="l01274"></a>01274    <span class="comment">/* Once done we add it onto the list. Now it will be picked up when DTMF is used */</span>
<a name="l01275"></a>01275    <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;features-&gt;hooks, hook, entry);
<a name="l01276"></a>01276 
<a name="l01277"></a>01277    features-&gt;<a class="code" href="structast__bridge__features.html#a080125973deec97104866dd31867e3ce">usable</a> = 1;
<a name="l01278"></a>01278 
<a name="l01279"></a>01279    <span class="keywordflow">return</span> 0;
<a name="l01280"></a>01280 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3128b52009fb3dd764dce90ea377fce1"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_init" ref="a3128b52009fb3dd764dce90ea377fce1" args="(struct ast_bridge_features *features)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_features_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *&nbsp;</td>
          <td class="paramname"> <em>features</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize bridge features structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>features</em>&nbsp;</td><td>Bridge featues structure</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">struct </span><a class="code" href="structast__bridge__features.html" title="Structure that contains features information.">ast_bridge_features</a> features;
 <a class="code" href="bridging__features_8h.html#a3128b52009fb3dd764dce90ea377fce1" title="Initialize bridge features structure.">ast_bridge_features_init</a>(&amp;features);
</pre></div><p>This initializes the feature structure 'features' to have nothing enabled.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This MUST be called before enabling features or flags. Failure to do so may result in a crash. </dd></dl>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01309">1309</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00665">AST_LIST_HEAD_INIT_NOLOCK</a>.</p>

<p>Referenced by <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, and <a class="el" href="bridge__builtin__features_8c_source.html#l00157">feature_attended_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01310"></a>01310 {
<a name="l01311"></a>01311    <span class="comment">/* Zero out the structure */</span>
<a name="l01312"></a>01312    memset(features, 0, <span class="keyword">sizeof</span>(*features));
<a name="l01313"></a>01313 
<a name="l01314"></a>01314    <span class="comment">/* Initialize the hooks list, just in case */</span>
<a name="l01315"></a>01315    <a class="code" href="linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27" title="Initializes a list head structure.">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;features-&gt;hooks);
<a name="l01316"></a>01316 
<a name="l01317"></a>01317    <span class="keywordflow">return</span> 0;
<a name="l01318"></a>01318 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad47b9c636ec2afadb2c98335967a4125"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_register" ref="ad47b9c636ec2afadb2c98335967a4125" args="(enum ast_bridge_builtin_feature feature, ast_bridge_features_hook_callback callback, const char *dtmf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_features_register </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a>&nbsp;</td>
          <td class="paramname"> <em>feature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bridging__features_8h.html#a6d066da82427624671f418f4f64c5797">ast_bridge_features_hook_callback</a>&nbsp;</td>
          <td class="paramname"> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>dtmf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register a handler for a built in feature. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>feature</em>&nbsp;</td><td>The feature that the handler will be responsible for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>The callback function that will handle it </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dtmf</em>&nbsp;</td><td>Default DTMF string used to activate the feature</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__features_8h.html#ad47b9c636ec2afadb2c98335967a4125" title="Register a handler for a built in feature.">ast_bridge_features_register</a>(AST_BRIDGE_BUILTIN_ATTENDED_TRANSFER, bridge_builtin_attended_transfer, <span class="stringliteral">&quot;*1&quot;</span>);
</pre></div><p>This registers the function bridge_builtin_attended_transfer as the function responsible for the built in attended transfer feature. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01235">1235</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="bridge__builtin__features_8c_source.html#l00245">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01236"></a>01236 {
<a name="l01237"></a>01237    <span class="keywordflow">if</span> (<a class="code" href="bridging_8c.html#af4095d93586f95dd08ef1ad461bc3b80">builtin_features_handlers</a>[feature]) {
<a name="l01238"></a>01238       <span class="keywordflow">return</span> -1;
<a name="l01239"></a>01239    }
<a name="l01240"></a>01240 
<a name="l01241"></a>01241    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(dtmf)) {
<a name="l01242"></a>01242       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(<a class="code" href="bridging_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[feature], dtmf, <span class="keyword">sizeof</span>(<a class="code" href="bridging_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[feature]));
<a name="l01243"></a>01243    }
<a name="l01244"></a>01244 
<a name="l01245"></a>01245    <a class="code" href="bridging_8c.html#af4095d93586f95dd08ef1ad461bc3b80">builtin_features_handlers</a>[feature] = callback;
<a name="l01246"></a>01246 
<a name="l01247"></a>01247    <span class="keywordflow">return</span> 0;
<a name="l01248"></a>01248 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a82a984ac979d8c180e80e3ac06c818"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_set_flag" ref="a3a82a984ac979d8c180e80e3ac06c818" args="(struct ast_bridge_features *features, enum ast_bridge_feature_flags flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_features_set_flag </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__features.html">ast_bridge_features</a> *&nbsp;</td>
          <td class="paramname"> <em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444">ast_bridge_feature_flags</a>&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set a flag on a bridge features structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>features</em>&nbsp;</td><td>Bridge features structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flag</em>&nbsp;</td><td>Flag to enable</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">struct </span><a class="code" href="structast__bridge__features.html" title="Structure that contains features information.">ast_bridge_features</a> features;
 <a class="code" href="bridging__features_8h.html#a3128b52009fb3dd764dce90ea377fce1" title="Initialize bridge features structure.">ast_bridge_features_init</a>(&amp;features);
 <a class="code" href="bridging__features_8h.html#a3a82a984ac979d8c180e80e3ac06c818" title="Set a flag on a bridge features structure.">ast_bridge_features_set_flag</a>(&amp;features, <a class="code" href="bridging__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444ae2c21ce82d946116c6488e97faedcd3d">AST_BRIDGE_FLAG_DISSOLVE</a>);
</pre></div><p>This sets the AST_BRIDGE_FLAG_DISSOLVE feature to be enabled on the features structure 'features'. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01302">1302</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00068">ast_set_flag</a>, <a class="el" href="bridging__features_8h_source.html#l00092">ast_bridge_features::feature_flags</a>, and <a class="el" href="bridging__features_8h_source.html#l00094">ast_bridge_features::usable</a>.</p>

<p>Referenced by <a class="el" href="bridge__builtin__features_8c_source.html#l00157">feature_attended_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01303"></a>01303 {
<a name="l01304"></a>01304    <a class="code" href="utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;features-&gt;<a class="code" href="structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, flag);
<a name="l01305"></a>01305    features-&gt;<a class="code" href="structast__bridge__features.html#a080125973deec97104866dd31867e3ce">usable</a> = 1;
<a name="l01306"></a>01306    <span class="keywordflow">return</span> 0;
<a name="l01307"></a>01307 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a395272994b2af7bd55f871b02d2d42e4"></a><!-- doxytag: member="bridging_features.h::ast_bridge_features_unregister" ref="a395272994b2af7bd55f871b02d2d42e4" args="(enum ast_bridge_builtin_feature feature)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_features_unregister </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="bridging__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a>&nbsp;</td>
          <td class="paramname"> <em>feature</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unregister a handler for a built in feature. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>feature</em>&nbsp;</td><td>The feature to unregister</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__features_8h.html#a395272994b2af7bd55f871b02d2d42e4" title="Unregister a handler for a built in feature.">ast_bridge_features_unregister</a>(AST_BRIDGE_BUILTIN_ATTENDED_TRANSFER);
</pre></div><p>This unregisters the function that is handling the built in attended transfer feature. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01250">1250</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01251"></a>01251 {
<a name="l01252"></a>01252    <span class="keywordflow">if</span> (!<a class="code" href="bridging_8c.html#af4095d93586f95dd08ef1ad461bc3b80">builtin_features_handlers</a>[feature]) {
<a name="l01253"></a>01253       <span class="keywordflow">return</span> -1;
<a name="l01254"></a>01254    }
<a name="l01255"></a>01255 
<a name="l01256"></a>01256    <a class="code" href="bridging_8c.html#af4095d93586f95dd08ef1ad461bc3b80">builtin_features_handlers</a>[feature] = NULL;
<a name="l01257"></a>01257 
<a name="l01258"></a>01258    <span class="keywordflow">return</span> 0;
<a name="l01259"></a>01259 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:19:41 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
