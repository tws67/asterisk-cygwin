<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:22:07 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_afe38fc0ccf2e9eefca5d5c6b03503d9.html">main</a>
  </div>
</div>
<div class="contents">
<h1>frame.c File Reference</h1>
<p>Frame and codec manipulation routines.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="__private_8h_source.html">asterisk/_private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="frame_8h_source.html">asterisk/frame.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="term_8h_source.html">asterisk/term.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadstorage_8h_source.html">asterisk/threadstorage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="translate_8h_source.html">asterisk/translate.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="dsp_8h_source.html">asterisk/dsp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="file_8h_source.html">asterisk/file.h</a>&quot;</code><br/>

<p><a href="frame_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__codec__alias__table.html">ast_codec_alias_table</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__frame__cache.html">ast_frame_cache</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__frames.html">ast_frames</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is just so <a class="el" href="structast__frames.html" title="This is just so ast_frames, a list head struct for holding a list of ast_frame structures...">ast_frames</a>, a list head struct for holding a list of <a class="el" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> structures, is defined.  <a href="structast__frames.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__smoother.html">ast_smoother</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a5323507292adb03f4b5b83a23460d9d6">FRAME_CACHE_MAX_SIZE</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum <a class="el" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> cache size.  <a href="#a5323507292adb03f4b5b83a23460d9d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ad437b001eeca9b4ec5e30440de546bec">SMOOTHER_SIZE</a>&nbsp;&nbsp;&nbsp;8000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aff17a6771d3319ab64930cd2b937d6cf">TYPE_MASK</a>&nbsp;&nbsp;&nbsp;0x3</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5f">frame_type</a> { <a class="el" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5faa36545ff3bafe095ec6ecade4820c8ac">TYPE_HIGH</a>, 
<a class="el" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5fa5fc57b85380135170348dd50eefc2758">TYPE_LOW</a>, 
<a class="el" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5fa78be5c6e5e111a4e84d3be94233fca48">TYPE_SILENCE</a>, 
<a class="el" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5fab13f7bec98d45341d5c02adb21372dc7">TYPE_DONTSEND</a>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aa3ca9ba99227d1f76e44d2ceb32cc6f5">__ast_smoother_feed</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>, int swap)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aa621becb506e6b6c3c2a098944a14da8">__frame_free</a> (struct <a class="el" href="structast__frame.html">ast_frame</a> *fr, int cache)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a9011fd5b5b06f7a02938b9cb262bc244">__init_frame_cache</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A per-thread cache of frame headers.  <a href="#a9011fd5b5b06f7a02938b9cb262bc244"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ab492fdbd06591d26ff743d440cc0594f">ast_codec2str</a> (int codec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a name from a format Gets a name from a format.  <a href="#ab492fdbd06591d26ff743d440cc0594f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a123ec7e6e90e279b75bc6447eab5d3b2">ast_codec_choose</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int <a class="el" href="structformats.html">formats</a>, int find_best)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pick a codec.  <a href="#a123ec7e6e90e279b75bc6447eab5d3b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ae147ae1521acd6b95bba6956078b2f34">ast_codec_get_len</a> (int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, int samples)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes for the <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples of the given format.  <a href="#ae147ae1521acd6b95bba6956078b2f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aedec72ae8357bb6c334111f93d283713">ast_codec_get_samples</a> (struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples contained in the frame.  <a href="#aedec72ae8357bb6c334111f93d283713"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a54b0af0dfdc8466239e6babb9303f7b3">ast_codec_pref_append</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append codec to list.  <a href="#a54b0af0dfdc8466239e6babb9303f7b3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a42cc334b6773ff33cb3c24ca5a916842">ast_codec_pref_convert</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, size_t size, int right)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Shift an audio codec preference list up or down 65 bytes so that it becomes an ASCII string.  <a href="#a42cc334b6773ff33cb3c24ca5a916842"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__format__list.html">ast_format_list</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ac9789499b866949ab31bab025b497964">ast_codec_pref_getsize</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get packet size for codec.  <a href="#ac9789499b866949ab31bab025b497964"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a1610acfbe3638e07556dd06562d6c035">ast_codec_pref_index</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int idx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Codec located at a particular place in the preference index.  <a href="#a1610acfbe3638e07556dd06562d6c035"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a5eb17ccec8892ebe96ab661e749f0399">ast_codec_pref_prepend</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, int only_if_existing)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepend codec to list.  <a href="#a5eb17ccec8892ebe96ab661e749f0399"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a8daa8fe39c23fc605881466efafa00f7">ast_codec_pref_remove</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove codec from pref list.  <a href="#a8daa8fe39c23fc605881466efafa00f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a6803881645ae33ff0618b3648d26aeaa">ast_codec_pref_setsize</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, int framems)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set packet size for codec.  <a href="#a6803881645ae33ff0618b3648d26aeaa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a784e4f7371cbfce0b3e9f957f7ce54e3">ast_codec_pref_string</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump audio codec preference list into a string.  <a href="#a784e4f7371cbfce0b3e9f957f7ce54e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a8ce634275e2d4e37422332eb8fbdc5dd">ast_expand_codec_alias</a> (const char *in)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a59b72ee1caa9e8349ca017df01e8ac55">ast_frame_adjust_volume</a> (struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>, int adjustment)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adjusts the <a class="el" href="structvolume.html">volume</a> of the audio samples contained in a frame.  <a href="#a59b72ee1caa9e8349ca017df01e8ac55"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a35641692b96e9e81da06d8d36e677cb8">ast_frame_dump</a> (const char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>, char *<a class="el" href="res__http__post_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a3c004d3820bcf6ba492be693b67e1869">ast_frame_free</a> (struct <a class="el" href="structast__frame.html">ast_frame</a> *frame, int cache)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Requests a frame to be allocated.  <a href="#a3c004d3820bcf6ba492be693b67e1869"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aa3c3bdf906f259cea0aa33d7218b0e1e">ast_frame_header_new</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ab819ef38276be16fede1c39cfcc8306c">ast_frame_slinear_sum</a> (struct <a class="el" href="structast__frame.html">ast_frame</a> *f1, struct <a class="el" href="structast__frame.html">ast_frame</a> *f2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sums two frames of audio samples.  <a href="#ab819ef38276be16fede1c39cfcc8306c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a2a467ce3424859d1b6194c93f2cc05f5">ast_frdup</a> (const struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copies a frame.  <a href="#a2a467ce3424859d1b6194c93f2cc05f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aa7dbd9b12889d9f96fb6c01f94b4909e">ast_frisolate</a> (struct <a class="el" href="structast__frame.html">ast_frame</a> *fr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">'isolates' a frame by duplicating non-malloc'ed components (header, src, data). On return all components are malloc'ed  <a href="#aa7dbd9b12889d9f96fb6c01f94b4909e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__format__list.html">ast_format_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a7a74b26c677d2372f9b90b3a38d03b14">ast_get_format_list</a> (size_t *size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__format__list.html">ast_format_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ae4f8e9142a346cf35e65200969b587ca">ast_get_format_list_index</a> (int idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a2cf30450cd1821bfbc77d2d9e3605363">ast_getformatbyname</a> (const char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets a format from a name.  <a href="#a2cf30450cd1821bfbc77d2d9e3605363"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#afe8f690984f8ba95cd01a431198c10bf">ast_getformatname</a> (int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of a format.  <a href="#afe8f690984f8ba95cd01a431198c10bf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a37cdc7e78686b0bfa4e47e645f782b30">ast_getformatname_multiple</a> (char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, size_t size, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the names of a set of <a class="el" href="structformats.html">formats</a>.  <a href="#a37cdc7e78686b0bfa4e47e645f782b30"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a35aa1fb72e1993a14156a6b912034ef9">ast_parse_allow_disallow</a> (struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *pref, int *mask, const char *list, int allowing)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse an "allow" or "deny" line in a channel or device configuration and update the capabilities mask and pref if provided. Video codecs are not added to codec preference lists, since we can not transcode.  <a href="#a35aa1fb72e1993a14156a6b912034ef9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a6d3b71e0a81af743bae6c33c02b64f1f">ast_smoother_free</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a22e621d6147c80f2dd12ff75c2d8d3cc">ast_smoother_get_flags</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a4cf7f3fd41e2c268159299ea54b36e33">ast_smoother_new</a> (int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#af8d6dcd265eaf403b1b1139770c885d8">ast_smoother_read</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a34c247d5417aed64069bbeac7fc09728">ast_smoother_reconfigure</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s, int bytes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reconfigure an existing smoother to output a different <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes per frame.  <a href="#a34c247d5417aed64069bbeac7fc09728"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#add7324cf0482ce24eaa13abdc00e115d">ast_smoother_reset</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s, int bytes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a3a3294d5c7260c90f2de7b65037055c5">ast_smoother_set_flags</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s, int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a3d6997c8a03e68d88c52f784c16c069f">ast_smoother_test_flag</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s, int flag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ad3313ac3c6813594f1ea408e26505be7">ast_swapcopy_samples</a> (void *dst, const void *src, int samples)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ae0047382e2ea1dac90f6f8c8dcd2bfb8">frame_cache_cleanup</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a5d8cb9e7ec765506672f15e0c2d184f1">g723_len</a> (unsigned char <a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a4eb46a9fec3d504357127c4c1ad41ac9">g723_samples</a> (unsigned char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, int maxlen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a> (unsigned char *data, int n, int bit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ae8a701b0b688879d84514bd36d63ff82">init_framer</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a151c4ff0b1d8addf7ec1f81c553ea084">show_codec_n</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a8e79daabbe43ccf4880e628c7e712b38">show_codecs</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#acb874d67b82b47620eb082453403f820">smoother_frame_feed</a> (struct <a class="el" href="structast__smoother.html">ast_smoother</a> *s, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>, int swap)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a124f17e16301f8e0720d2f4388e0387e">speex_get_wb_sz_at</a> (unsigned char *data, int len, int bit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#adb6c30bc64d4ebc36843172a35105de4">speex_samples</a> (unsigned char *data, int len)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__format__list.html">ast_format_list</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266">AST_FORMAT_LIST</a> []</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Definition of supported media <a class="el" href="structformats.html">formats</a> (codecs).  <a href="#a6da24d09807c4c89bbba05e5566eb266"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a> = { AST_FRAME_NULL, }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_frame_cache , .custom_init = NULL , }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#af1a7a13ff239697e9106ed3763072298">my_clis</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Frame and codec manipulation routines. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Mark Spencer &lt;<a href="mailto:markster@digium.com">markster@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a5323507292adb03f4b5b83a23460d9d6"></a><!-- doxytag: member="frame.c::FRAME_CACHE_MAX_SIZE" ref="a5323507292adb03f4b5b83a23460d9d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAME_CACHE_MAX_SIZE&nbsp;&nbsp;&nbsp;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Maximum <a class="el" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> cache size. </p>
<p>In most cases where the frame header cache will be useful, the size of the cache will stay very small. However, it is not always the case that the same thread that allocates the frame will be the one freeing them, so sometimes a thread will never have any frames in its cache, or the cache will never be pulled from. For the latter case, we limit the maximum size. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00058">58</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad437b001eeca9b4ec5e30440de546bec"></a><!-- doxytag: member="frame.c::SMOOTHER_SIZE" ref="ad437b001eeca9b4ec5e30440de546bec" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMOOTHER_SIZE&nbsp;&nbsp;&nbsp;8000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00070">70</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00201">__ast_smoother_feed()</a>.</p>

</div>
</div>
<a class="anchor" id="aff17a6771d3319ab64930cd2b937d6cf"></a><!-- doxytag: member="frame.c::TYPE_MASK" ref="aff17a6771d3319ab64930cd2b937d6cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TYPE_MASK&nbsp;&nbsp;&nbsp;0x3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00079">79</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a3ca2c0bc7578bf3d337e34b2c08a6c5f"></a><!-- doxytag: member="frame.c::frame_type" ref="a3ca2c0bc7578bf3d337e34b2c08a6c5f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5f">frame_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a3ca2c0bc7578bf3d337e34b2c08a6c5faa36545ff3bafe095ec6ecade4820c8ac"></a><!-- doxytag: member="TYPE_HIGH" ref="a3ca2c0bc7578bf3d337e34b2c08a6c5faa36545ff3bafe095ec6ecade4820c8ac" args="" -->TYPE_HIGH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3ca2c0bc7578bf3d337e34b2c08a6c5fa5fc57b85380135170348dd50eefc2758"></a><!-- doxytag: member="TYPE_LOW" ref="a3ca2c0bc7578bf3d337e34b2c08a6c5fa5fc57b85380135170348dd50eefc2758" args="" -->TYPE_LOW</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3ca2c0bc7578bf3d337e34b2c08a6c5fa78be5c6e5e111a4e84d3be94233fca48"></a><!-- doxytag: member="TYPE_SILENCE" ref="a3ca2c0bc7578bf3d337e34b2c08a6c5fa78be5c6e5e111a4e84d3be94233fca48" args="" -->TYPE_SILENCE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a3ca2c0bc7578bf3d337e34b2c08a6c5fab13f7bec98d45341d5c02adb21372dc7"></a><!-- doxytag: member="TYPE_DONTSEND" ref="a3ca2c0bc7578bf3d337e34b2c08a6c5fab13f7bec98d45341d5c02adb21372dc7" args="" -->TYPE_DONTSEND</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00072">72</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00072"></a>00072                 {
<a name="l00073"></a>00073    <a class="code" href="codec__speex_8c.html#a2fa0578bfbd608daafde3c56a0ad15a6">TYPE_HIGH</a>,     <span class="comment">/* 0x0 */</span>
<a name="l00074"></a>00074    <a class="code" href="codec__speex_8c.html#ab78c10a44f25f2b7196c44c0397839bf">TYPE_LOW</a>,      <span class="comment">/* 0x1 */</span>
<a name="l00075"></a>00075    <a class="code" href="codec__speex_8c.html#af560916d7051f74aa7cf9af7023cafe2">TYPE_SILENCE</a>,  <span class="comment">/* 0x2 */</span>
<a name="l00076"></a>00076    <a class="code" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5fab13f7bec98d45341d5c02adb21372dc7">TYPE_DONTSEND</a>  <span class="comment">/* 0x3 */</span>
<a name="l00077"></a>00077 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa3ca9ba99227d1f76e44d2ceb32cc6f5"></a><!-- doxytag: member="frame.c::__ast_smoother_feed" ref="aa3ca9ba99227d1f76e44d2ceb32cc6f5" args="(struct ast_smoother *s, struct ast_frame *f, int swap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __ast_smoother_feed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>swap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00201">201</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="frame_8h_source.html#l00204">AST_MIN_OFFSET</a>, <a class="el" href="frame_8h_source.html#l00354">AST_SMOOTHER_FLAG_G729</a>, <a class="el" href="frame_8c_source.html#l00551">ast_swapcopy_samples()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8c_source.html#l00084">ast_smoother::flags</a>, <a class="el" href="frame_8c_source.html#l00083">ast_smoother::format</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8c_source.html#l00092">ast_smoother::len</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8c_source.html#l00091">ast_smoother::opt</a>, <a class="el" href="frame_8c_source.html#l00086">ast_smoother::opt_needs_swap</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="frame_8c_source.html#l00085">ast_smoother::samplesperbyte</a>, <a class="el" href="frame_8c_source.html#l00082">ast_smoother::size</a>, <a class="el" href="frame_8c_source.html#l00126">smoother_frame_feed()</a>, <a class="el" href="frame_8c_source.html#l00070">SMOOTHER_SIZE</a>, and <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 {
<a name="l00203"></a>00203    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {
<a name="l00204"></a>00204       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Huh?  Can&apos;t smooth a non-voice frame!\n&quot;</span>);
<a name="l00205"></a>00205       <span class="keywordflow">return</span> -1;
<a name="l00206"></a>00206    }
<a name="l00207"></a>00207    <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="structast__smoother.html#a317afff57d87a89158c2b038d37b2b08">format</a>) {
<a name="l00208"></a>00208       s-&gt;<a class="code" href="structast__smoother.html#a317afff57d87a89158c2b038d37b2b08">format</a> = f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l00209"></a>00209       s-&gt;<a class="code" href="structast__smoother.html#ace5328f4f85cf26835ca68604818271d">samplesperbyte</a> = (float)f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> / (<span class="keywordtype">float</span>)f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00210"></a>00210    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#a317afff57d87a89158c2b038d37b2b08">format</a> != f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>) {
<a name="l00211"></a>00211       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Smoother was working on %d format frames, now trying to feed %d?\n&quot;</span>, s-&gt;<a class="code" href="structast__smoother.html#a317afff57d87a89158c2b038d37b2b08">format</a>, f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>);
<a name="l00212"></a>00212       <span class="keywordflow">return</span> -1;
<a name="l00213"></a>00213    }
<a name="l00214"></a>00214    <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> + f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> &gt; <a class="code" href="frame_8c.html#ad437b001eeca9b4ec5e30440de546bec">SMOOTHER_SIZE</a>) {
<a name="l00215"></a>00215       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Out of smoother space\n&quot;</span>);
<a name="l00216"></a>00216       <span class="keywordflow">return</span> -1;
<a name="l00217"></a>00217    }
<a name="l00218"></a>00218    <span class="keywordflow">if</span> (((f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> == s-&gt;<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a>) ||
<a name="l00219"></a>00219         ((f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> &lt; 10) &amp;&amp; (s-&gt;<a class="code" href="structast__smoother.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="frame_8h.html#a06828788896ac92282112bd8ffe12319">AST_SMOOTHER_FLAG_G729</a>))) &amp;&amp;
<a name="l00220"></a>00220        !s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a> &amp;&amp;
<a name="l00221"></a>00221        !s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> &amp;&amp;
<a name="l00222"></a>00222        (f-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> &gt;= <a class="code" href="frame_8h.html#a0398e1e7020adf345eaaca6357f164b2">AST_MIN_OFFSET</a>)) {
<a name="l00223"></a>00223       <span class="comment">/* Optimize by sending the frame we just got</span>
<a name="l00224"></a>00224 <span class="comment">         on the next read, thus eliminating the douple</span>
<a name="l00225"></a>00225 <span class="comment">         copy */</span>
<a name="l00226"></a>00226       <span class="keywordflow">if</span> (swap)
<a name="l00227"></a>00227          <a class="code" href="frame_8h.html#ad3313ac3c6813594f1ea408e26505be7">ast_swapcopy_samples</a>(f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>);
<a name="l00228"></a>00228       s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a> = f;
<a name="l00229"></a>00229       s-&gt;<a class="code" href="structast__smoother.html#aa0bab80f07b3d04d81bd3c9ae69e8b68">opt_needs_swap</a> = swap ? 1 : 0;
<a name="l00230"></a>00230       <span class="keywordflow">return</span> 0;
<a name="l00231"></a>00231    }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233    <span class="keywordflow">return</span> <a class="code" href="frame_8c.html#acb874d67b82b47620eb082453403f820">smoother_frame_feed</a>(s, f, swap);
<a name="l00234"></a>00234 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa621becb506e6b6c3c2a098944a14da8"></a><!-- doxytag: member="frame.c::__frame_free" ref="aa621becb506e6b6c3c2a098944a14da8" args="(struct ast_frame *fr, int cache)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __frame_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>fr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cache</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00333">333</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="dsp_8c_source.html#l01722">ast_dsp_frame_freed()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="frame_8h_source.html#l00136">AST_FRFLAG_FROM_DSP</a>, <a class="el" href="frame_8h_source.html#l00132">AST_FRFLAG_FROM_TRANSLATOR</a>, <a class="el" href="linkedlists_8h_source.html#l00695">AST_LIST_INSERT_HEAD</a>, <a class="el" href="frame_8h_source.html#l00209">AST_MALLOCD_DATA</a>, <a class="el" href="frame_8h_source.html#l00207">AST_MALLOCD_HDR</a>, <a class="el" href="frame_8h_source.html#l00211">AST_MALLOCD_SRC</a>, <a class="el" href="utils_8h_source.html#l00061">ast_test_flag</a>, <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="translate_8c_source.html#l00909">ast_translate_frame_freed()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8c_source.html#l00047">frame_cache</a>, <a class="el" href="iax2-parser_8c_source.html#l00064">FRAME_CACHE_MAX_SIZE</a>, <a class="el" href="iax2-parser_8c_source.html#l00045">frames</a>, <a class="el" href="frame_8c_source.html#l00065">ast_frame_cache::list</a>, <a class="el" href="frame_8h_source.html#l00151">ast_frame::mallocd</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8c_source.html#l00066">ast_frame_cache::size</a>, and <a class="el" href="frame_8h_source.html#l00157">ast_frame::src</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00373">ast_frame_free()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00334"></a>00334 {
<a name="l00335"></a>00335    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(fr, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058a4a242fff9bd02b02c64a1515a85e15ce">AST_FRFLAG_FROM_TRANSLATOR</a>)) {
<a name="l00336"></a>00336       <a class="code" href="translate_8h.html#a9cbaad6d667527799974c89a8b3e467f" title="Hint that a frame from a translator has been freed.">ast_translate_frame_freed</a>(fr);
<a name="l00337"></a>00337    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(fr, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058a7500f97b39b4d91f3df7daa2435fc8fe">AST_FRFLAG_FROM_DSP</a>)) {
<a name="l00338"></a>00338       <a class="code" href="dsp_8h.html#a9a0a78f4d4ccd93a2eb131e3e67151f4" title="Hint that a frame from a dsp was freed.">ast_dsp_frame_freed</a>(fr);
<a name="l00339"></a>00339    }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341    <span class="keywordflow">if</span> (!fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a>)
<a name="l00342"></a>00342       <span class="keywordflow">return</span>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (cache &amp;&amp; fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> == <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a>) {
<a name="l00346"></a>00346       <span class="comment">/* Cool, only the header is malloc&apos;d, let&apos;s just cache those for now </span>
<a name="l00347"></a>00347 <span class="comment">       * to keep things simple... */</span>
<a name="l00348"></a>00348       <span class="keyword">struct </span><a class="code" href="structast__frame__cache.html">ast_frame_cache</a> *<a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a>;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350       <span class="keywordflow">if</span> ((frames = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;<a class="code" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>, <span class="keyword">sizeof</span>(*frames))) &amp;&amp;
<a name="l00351"></a>00351           (frames-&gt;<a class="code" href="structast__frame__cache.html#a854352f53b148adc24983a58a1866d66">size</a> &lt; <a class="code" href="iax2-parser_8c.html#a5323507292adb03f4b5b83a23460d9d6">FRAME_CACHE_MAX_SIZE</a>)) {
<a name="l00352"></a>00352          <a class="code" href="linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307" title="Inserts a list entry at the head of a list.">AST_LIST_INSERT_HEAD</a>(&amp;frames-&gt;<a class="code" href="structast__frame__cache.html#a9c7b49f68e5d958a09c3628a40a4206f">list</a>, fr, frame_list);
<a name="l00353"></a>00353          frames-&gt;<a class="code" href="structast__frame__cache.html#a854352f53b148adc24983a58a1866d66">size</a>++;
<a name="l00354"></a>00354          <span class="keywordflow">return</span>;
<a name="l00355"></a>00355       }
<a name="l00356"></a>00356    }
<a name="l00357"></a>00357 <span class="preprocessor">#endif</span>
<a name="l00358"></a>00358 <span class="preprocessor"></span>   
<a name="l00359"></a>00359    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; <a class="code" href="frame_8h.html#a700f5f786d7e5a985387e5ce40c47a6a">AST_MALLOCD_DATA</a>) {
<a name="l00360"></a>00360       <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) 
<a name="l00361"></a>00361          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> - fr-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a>);
<a name="l00362"></a>00362    }
<a name="l00363"></a>00363    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; <a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a>) {
<a name="l00364"></a>00364       <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>)
<a name="l00365"></a>00365          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">void</span> *) fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>);
<a name="l00366"></a>00366    }
<a name="l00367"></a>00367    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a>) {
<a name="l00368"></a>00368       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fr);
<a name="l00369"></a>00369    }
<a name="l00370"></a>00370 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9011fd5b5b06f7a02938b9cb262bc244"></a><!-- doxytag: member="frame.c::__init_frame_cache" ref="a9011fd5b5b06f7a02938b9cb262bc244" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __init_frame_cache </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A per-thread cache of frame headers. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00047">47</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00064"></a>00064 {
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab492fdbd06591d26ff743d440cc0594f"></a><!-- doxytag: member="frame.c::ast_codec2str" ref="ab492fdbd06591d26ff743d440cc0594f" args="(int codec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_codec2str </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>codec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a name from a format Gets a name from a format. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>codec</em>&nbsp;</td><td>codec <a class="el" href="structnumber.html" title="Number structure.">number</a> (1,2,4,8,16,etc.) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns a static string identifying the format on success, 0 on error. </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00654">654</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, and <a class="el" href="frame_8h_source.html#l00433">ast_format_list::desc</a>.</p>

<p>Referenced by <a class="el" href="res__musiconhold_8c_source.html#l00859">moh_alloc()</a>, <a class="el" href="frame_8c_source.html#l00722">show_codec_n()</a>, and <a class="el" href="frame_8c_source.html#l00667">show_codecs()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00655"></a>00655 {
<a name="l00656"></a>00656    <span class="keywordtype">int</span> x;
<a name="l00657"></a>00657    <span class="keywordtype">char</span> *ret = <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l00658"></a>00658    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l00659"></a>00659       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].bits == codec) {
<a name="l00660"></a>00660          ret = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="structast__format__list.html#a3aad16fd4bea1b9717f232ea75ad6449">desc</a>;
<a name="l00661"></a>00661          <span class="keywordflow">break</span>;
<a name="l00662"></a>00662       }
<a name="l00663"></a>00663    }
<a name="l00664"></a>00664    <span class="keywordflow">return</span> ret;
<a name="l00665"></a>00665 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a123ec7e6e90e279b75bc6447eab5d3b2"></a><!-- doxytag: member="frame.c::ast_codec_choose" ref="a123ec7e6e90e279b75bc6447eab5d3b2" args="(struct ast_codec_pref *pref, int formats, int find_best)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_choose </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>formats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>find_best</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pick a codec. </p>
<p>Select the best audio format according to preference list from supplied options. If "find_best" is non-zero then if nothing is found, the "Best" format of the format list is selected, otherwise 0 is returned. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01211">1211</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="channel_8c_source.html#l00711">ast_best_codec()</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="frame_8h_source.html#l00273">AST_FORMAT_AUDIO_MASK</a>, <a class="el" href="frame_8h_source.html#l00430">ast_format_list::bits</a>, and <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="chan__h323_8c_source.html#l00999">__oh323_new()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00989">gtalk_new()</a>, <a class="el" href="chan__jingle_8c_source.html#l00800">jingle_new()</a>, <a class="el" href="chan__sip_8c_source.html#l08040">process_sdp()</a>, <a class="el" href="chan__sip_8c_source.html#l06599">sip_new()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01212"></a>01212 {
<a name="l01213"></a>01213    <span class="keywordtype">int</span> x, ret = 0, slot;
<a name="l01214"></a>01214 
<a name="l01215"></a>01215    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01216"></a>01216       slot = pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x];
<a name="l01217"></a>01217 
<a name="l01218"></a>01218       <span class="keywordflow">if</span> (!slot)
<a name="l01219"></a>01219          <span class="keywordflow">break</span>;
<a name="l01220"></a>01220       <span class="keywordflow">if</span> (<a class="code" href="structformats.html">formats</a> &amp; <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[slot-1].bits) {
<a name="l01221"></a>01221          ret = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[slot-1].<a class="code" href="structast__format__list.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a>;
<a name="l01222"></a>01222          <span class="keywordflow">break</span>;
<a name="l01223"></a>01223       }
<a name="l01224"></a>01224    }
<a name="l01225"></a>01225    <span class="keywordflow">if</span> (ret &amp; <a class="code" href="frame_8h.html#a3f680b9c15596de927d507a664fd2803">AST_FORMAT_AUDIO_MASK</a>)
<a name="l01226"></a>01226       <span class="keywordflow">return</span> ret;
<a name="l01227"></a>01227 
<a name="l01228"></a>01228    <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(4, <span class="stringliteral">&quot;Could not find preferred codec - %s\n&quot;</span>, <a class="code" href="app__queue_8c.html#ab389b8ba466d7d05808b044592b05710" title="find the entry with the best metric, or NULL">find_best</a> ? <span class="stringliteral">&quot;Going for the best codec&quot;</span> : <span class="stringliteral">&quot;Returning zero codec&quot;</span>);
<a name="l01229"></a>01229 
<a name="l01230"></a>01230       <span class="keywordflow">return</span> <a class="code" href="app__queue_8c.html#ab389b8ba466d7d05808b044592b05710" title="find the entry with the best metric, or NULL">find_best</a> ? <a class="code" href="channel_8h.html#a4d78194779a26341c3ec7298b450b9ed" title="Pick the best audio codec.">ast_best_codec</a>(<a class="code" href="structformats.html">formats</a>) : 0;
<a name="l01231"></a>01231 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae147ae1521acd6b95bba6956078b2f34"></a><!-- doxytag: member="frame.c::ast_codec_get_len" ref="ae147ae1521acd6b95bba6956078b2f34" args="(int format, int samples)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_get_len </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>samples</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes for the <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples of the given format. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01484">1484</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00251">AST_FORMAT_ADPCM</a>, <a class="el" href="frame_8h_source.html#l00247">AST_FORMAT_ALAW</a>, <a class="el" href="frame_8h_source.html#l00265">AST_FORMAT_G722</a>, <a class="el" href="frame_8h_source.html#l00241">AST_FORMAT_G723_1</a>, <a class="el" href="frame_8h_source.html#l00263">AST_FORMAT_G726</a>, <a class="el" href="frame_8h_source.html#l00249">AST_FORMAT_G726_AAL2</a>, <a class="el" href="frame_8h_source.html#l00257">AST_FORMAT_G729A</a>, <a class="el" href="frame_8h_source.html#l00243">AST_FORMAT_GSM</a>, <a class="el" href="frame_8h_source.html#l00261">AST_FORMAT_ILBC</a>, <a class="el" href="frame_8h_source.html#l00269">AST_FORMAT_SIREN14</a>, <a class="el" href="frame_8h_source.html#l00267">AST_FORMAT_SIREN7</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00271">AST_FORMAT_SLINEAR16</a>, <a class="el" href="frame_8h_source.html#l00245">AST_FORMAT_ULAW</a>, <a class="el" href="frame_8c_source.html#l00573">ast_getformatname()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="func__strings_8c_source.html#l00821">len()</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="res__musiconhold_8c_source.html#l00889">moh_generate()</a>, and <a class="el" href="res__musiconhold_8c_source.html#l00563">monmp3thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01485"></a>01485 {
<a name="l01486"></a>01486    <span class="keywordtype">int</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = 0;
<a name="l01487"></a>01487 
<a name="l01488"></a>01488    <span class="comment">/* XXX Still need speex, and lpc10 XXX */</span> 
<a name="l01489"></a>01489    <span class="keywordflow">switch</span>(<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l01490"></a>01490    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ad90b56ed6ada6e4f13224512668e20fb">AST_FORMAT_G723_1</a>:
<a name="l01491"></a>01491       len = (samples / 240) * 20;
<a name="l01492"></a>01492       <span class="keywordflow">break</span>;
<a name="l01493"></a>01493    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a8330d06ea408802c37e9af61a513c6a1">AST_FORMAT_ILBC</a>:
<a name="l01494"></a>01494       len = (samples / 240) * 50;
<a name="l01495"></a>01495       <span class="keywordflow">break</span>;
<a name="l01496"></a>01496    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a85106ada66147a674b36f0a55297d29d">AST_FORMAT_GSM</a>:
<a name="l01497"></a>01497       len = (samples / 160) * 33;
<a name="l01498"></a>01498       <span class="keywordflow">break</span>;
<a name="l01499"></a>01499    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a8c5f13161448f613baaf42dea11f520a">AST_FORMAT_G729A</a>:
<a name="l01500"></a>01500       len = samples / 8;
<a name="l01501"></a>01501       <span class="keywordflow">break</span>;
<a name="l01502"></a>01502    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>:
<a name="l01503"></a>01503    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a6e078550fcf3f2038f6c343b3d65a936">AST_FORMAT_SLINEAR16</a>:
<a name="l01504"></a>01504       len = samples * 2;
<a name="l01505"></a>01505       <span class="keywordflow">break</span>;
<a name="l01506"></a>01506    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ab602cf455d4a96a3adba2e3ba8cd2b2c">AST_FORMAT_ULAW</a>:
<a name="l01507"></a>01507    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aa58cc980a9c9108522effc64e9aff2d6">AST_FORMAT_ALAW</a>:
<a name="l01508"></a>01508       len = samples;
<a name="l01509"></a>01509       <span class="keywordflow">break</span>;
<a name="l01510"></a>01510    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a4a0e8720928940d26abf28fff2e6586d">AST_FORMAT_G722</a>:
<a name="l01511"></a>01511    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a933964fc376c2642f9471c176fb7ae7d">AST_FORMAT_ADPCM</a>:
<a name="l01512"></a>01512    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a030c77081bc2aff5ae5a384769f46418">AST_FORMAT_G726</a>:
<a name="l01513"></a>01513    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a536fbd427f197a33e679c7721afad420">AST_FORMAT_G726_AAL2</a>:
<a name="l01514"></a>01514       len = samples / 2;
<a name="l01515"></a>01515       <span class="keywordflow">break</span>;
<a name="l01516"></a>01516    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a13092663dddb1492d81571f9f0ae4506">AST_FORMAT_SIREN7</a>:
<a name="l01517"></a>01517       <span class="comment">/* 16,000 samples per second at 32kbps is 4,000 bytes per second */</span>
<a name="l01518"></a>01518       len = samples / (16000 / 4000);
<a name="l01519"></a>01519       <span class="keywordflow">break</span>;
<a name="l01520"></a>01520    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a590224283a5c1527fab938e4d02686cc">AST_FORMAT_SIREN14</a>:
<a name="l01521"></a>01521       <span class="comment">/* 32,000 samples per second at 48kbps is 6,000 bytes per second */</span>
<a name="l01522"></a>01522       len = (int) samples / ((<span class="keywordtype">float</span>) 32000 / 6000);
<a name="l01523"></a>01523       <span class="keywordflow">break</span>;
<a name="l01524"></a>01524    <span class="keywordflow">default</span>:
<a name="l01525"></a>01525       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to calculate sample length for format %s\n&quot;</span>, <a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>));
<a name="l01526"></a>01526    }
<a name="l01527"></a>01527 
<a name="l01528"></a>01528    <span class="keywordflow">return</span> len;
<a name="l01529"></a>01529 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aedec72ae8357bb6c334111f93d283713"></a><!-- doxytag: member="frame.c::ast_codec_get_samples" ref="aedec72ae8357bb6c334111f93d283713" args="(struct ast_frame *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_get_samples </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples contained in the frame. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01431">1431</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00251">AST_FORMAT_ADPCM</a>, <a class="el" href="frame_8h_source.html#l00247">AST_FORMAT_ALAW</a>, <a class="el" href="frame_8h_source.html#l00265">AST_FORMAT_G722</a>, <a class="el" href="frame_8h_source.html#l00241">AST_FORMAT_G723_1</a>, <a class="el" href="frame_8h_source.html#l00263">AST_FORMAT_G726</a>, <a class="el" href="frame_8h_source.html#l00249">AST_FORMAT_G726_AAL2</a>, <a class="el" href="frame_8h_source.html#l00257">AST_FORMAT_G729A</a>, <a class="el" href="frame_8h_source.html#l00243">AST_FORMAT_GSM</a>, <a class="el" href="frame_8h_source.html#l00261">AST_FORMAT_ILBC</a>, <a class="el" href="frame_8h_source.html#l00255">AST_FORMAT_LPC10</a>, <a class="el" href="frame_8h_source.html#l00269">AST_FORMAT_SIREN14</a>, <a class="el" href="frame_8h_source.html#l00267">AST_FORMAT_SIREN7</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00271">AST_FORMAT_SLINEAR16</a>, <a class="el" href="frame_8h_source.html#l00259">AST_FORMAT_SPEEX</a>, <a class="el" href="frame_8h_source.html#l00245">AST_FORMAT_ULAW</a>, <a class="el" href="frame_8c_source.html#l00573">ast_getformatname()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8c_source.html#l01307">g723_samples()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8c_source.html#l01371">speex_samples()</a>, and <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l01562">ast_rtp_read()</a>, <a class="el" href="app__amd_8c_source.html#l00146">isAnsweringMachine()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00889">moh_generate()</a>, <a class="el" href="chan__iax2_8c_source.html#l03970">schedule_delivery()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09260">socket_process_meta()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01432"></a>01432 {
<a name="l01433"></a>01433    <span class="keywordtype">int</span> samples = 0;
<a name="l01434"></a>01434 
<a name="l01435"></a>01435    <span class="keywordflow">switch</span>(f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>) {
<a name="l01436"></a>01436    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a1a05dee116bf73c0f1ca8410bdb48c62">AST_FORMAT_SPEEX</a>:
<a name="l01437"></a>01437       samples = <a class="code" href="frame_8c.html#adb6c30bc64d4ebc36843172a35105de4">speex_samples</a>(f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);
<a name="l01438"></a>01438       <span class="keywordflow">break</span>;
<a name="l01439"></a>01439    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ad90b56ed6ada6e4f13224512668e20fb">AST_FORMAT_G723_1</a>:
<a name="l01440"></a>01440       samples = <a class="code" href="frame_8c.html#a4eb46a9fec3d504357127c4c1ad41ac9">g723_samples</a>(f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);
<a name="l01441"></a>01441       <span class="keywordflow">break</span>;
<a name="l01442"></a>01442    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a8330d06ea408802c37e9af61a513c6a1">AST_FORMAT_ILBC</a>:
<a name="l01443"></a>01443       samples = 240 * (f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> / 50);
<a name="l01444"></a>01444       <span class="keywordflow">break</span>;
<a name="l01445"></a>01445    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a85106ada66147a674b36f0a55297d29d">AST_FORMAT_GSM</a>:
<a name="l01446"></a>01446       samples = 160 * (f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> / 33);
<a name="l01447"></a>01447       <span class="keywordflow">break</span>;
<a name="l01448"></a>01448    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a8c5f13161448f613baaf42dea11f520a">AST_FORMAT_G729A</a>:
<a name="l01449"></a>01449       samples = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> * 8;
<a name="l01450"></a>01450       <span class="keywordflow">break</span>;
<a name="l01451"></a>01451    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>:
<a name="l01452"></a>01452    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a6e078550fcf3f2038f6c343b3d65a936">AST_FORMAT_SLINEAR16</a>:
<a name="l01453"></a>01453       samples = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> / 2;
<a name="l01454"></a>01454       <span class="keywordflow">break</span>;
<a name="l01455"></a>01455    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ac816c6f1fd32b02a6d20af297d96d04f">AST_FORMAT_LPC10</a>:
<a name="l01456"></a>01456       <span class="comment">/* assumes that the RTP packet contains one LPC10 frame */</span>
<a name="l01457"></a>01457       samples = 22 * 8;
<a name="l01458"></a>01458       samples += (((<span class="keywordtype">char</span> *)(f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>))[7] &amp; 0x1) * 8;
<a name="l01459"></a>01459       <span class="keywordflow">break</span>;
<a name="l01460"></a>01460    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ab602cf455d4a96a3adba2e3ba8cd2b2c">AST_FORMAT_ULAW</a>:
<a name="l01461"></a>01461    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aa58cc980a9c9108522effc64e9aff2d6">AST_FORMAT_ALAW</a>:
<a name="l01462"></a>01462       samples = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l01463"></a>01463       <span class="keywordflow">break</span>;
<a name="l01464"></a>01464    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a4a0e8720928940d26abf28fff2e6586d">AST_FORMAT_G722</a>:
<a name="l01465"></a>01465    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a933964fc376c2642f9471c176fb7ae7d">AST_FORMAT_ADPCM</a>:
<a name="l01466"></a>01466    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a030c77081bc2aff5ae5a384769f46418">AST_FORMAT_G726</a>:
<a name="l01467"></a>01467    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a536fbd427f197a33e679c7721afad420">AST_FORMAT_G726_AAL2</a>:
<a name="l01468"></a>01468       samples = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> * 2;
<a name="l01469"></a>01469       <span class="keywordflow">break</span>;
<a name="l01470"></a>01470    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a13092663dddb1492d81571f9f0ae4506">AST_FORMAT_SIREN7</a>:
<a name="l01471"></a>01471       <span class="comment">/* 16,000 samples per second at 32kbps is 4,000 bytes per second */</span>
<a name="l01472"></a>01472       samples = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> * (16000 / 4000);
<a name="l01473"></a>01473       <span class="keywordflow">break</span>;
<a name="l01474"></a>01474    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a590224283a5c1527fab938e4d02686cc">AST_FORMAT_SIREN14</a>:
<a name="l01475"></a>01475       <span class="comment">/* 32,000 samples per second at 48kbps is 6,000 bytes per second */</span>
<a name="l01476"></a>01476       samples = (int) f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> * ((<span class="keywordtype">float</span>) 32000 / 6000);
<a name="l01477"></a>01477       <span class="keywordflow">break</span>;
<a name="l01478"></a>01478    <span class="keywordflow">default</span>:
<a name="l01479"></a>01479       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to calculate samples for format %s\n&quot;</span>, <a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>));
<a name="l01480"></a>01480    }
<a name="l01481"></a>01481    <span class="keywordflow">return</span> samples;
<a name="l01482"></a>01482 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a54b0af0dfdc8466239e6babb9303f7b3"></a><!-- doxytag: member="frame.c::ast_codec_pref_append" ref="a54b0af0dfdc8466239e6babb9303f7b3" args="(struct ast_codec_pref *pref, int format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_pref_append </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append codec to list. </p>
<p>Append a audio codec to a preference list, removing it first if it was already there. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01071">1071</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8c_source.html#l01044">ast_codec_pref_remove()</a>, and <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01233">ast_parse_allow_disallow()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01072"></a>01072 {
<a name="l01073"></a>01073    <span class="keywordtype">int</span> x, newindex = 0;
<a name="l01074"></a>01074 
<a name="l01075"></a>01075    <a class="code" href="frame_8h.html#a8daa8fe39c23fc605881466efafa00f7" title="Remove audio a codec from a preference list.">ast_codec_pref_remove</a>(pref, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);
<a name="l01076"></a>01076 
<a name="l01077"></a>01077    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01078"></a>01078       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].bits == <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l01079"></a>01079          newindex = x + 1;
<a name="l01080"></a>01080          <span class="keywordflow">break</span>;
<a name="l01081"></a>01081       }
<a name="l01082"></a>01082    }
<a name="l01083"></a>01083 
<a name="l01084"></a>01084    <span class="keywordflow">if</span> (newindex) {
<a name="l01085"></a>01085       <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01086"></a>01086          <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x]) {
<a name="l01087"></a>01087             pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x] = newindex;
<a name="l01088"></a>01088             <span class="keywordflow">break</span>;
<a name="l01089"></a>01089          }
<a name="l01090"></a>01090       }
<a name="l01091"></a>01091    }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093    <span class="keywordflow">return</span> x;
<a name="l01094"></a>01094 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a42cc334b6773ff33cb3c24ca5a916842"></a><!-- doxytag: member="frame.c::ast_codec_pref_convert" ref="a42cc334b6773ff33cb3c24ca5a916842" args="(struct ast_codec_pref *pref, char *buf, size_t size, int right)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_codec_pref_convert </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>right</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Shift an audio codec preference list up or down 65 bytes so that it becomes an ASCII string. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00974">974</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l07197">check_access()</a>, <a class="el" href="chan__iax2_8c_source.html#l04337">create_addr()</a>, <a class="el" href="iax2-parser_8c_source.html#l00110">dump_prefs()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00975"></a>00975 {
<a name="l00976"></a>00976    <span class="keywordtype">int</span> x, differential = (int) <span class="charliteral">&apos;A&apos;</span>, mem;
<a name="l00977"></a>00977    <span class="keywordtype">char</span> *from, *to;
<a name="l00978"></a>00978 
<a name="l00979"></a>00979    <span class="keywordflow">if</span> (right) {
<a name="l00980"></a>00980       from = pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>;
<a name="l00981"></a>00981       to = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00982"></a>00982       mem = <a class="code" href="structast__frame__cache.html#a854352f53b148adc24983a58a1866d66">size</a>;
<a name="l00983"></a>00983    } <span class="keywordflow">else</span> {
<a name="l00984"></a>00984       to = pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>;
<a name="l00985"></a>00985       from = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00986"></a>00986       mem = 32;
<a name="l00987"></a>00987    }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989    memset(to, 0, mem);
<a name="l00990"></a>00990    <span class="keywordflow">for</span> (x = 0; x &lt; 32 ; x++) {
<a name="l00991"></a>00991       <span class="keywordflow">if</span> (!from[x])
<a name="l00992"></a>00992          <span class="keywordflow">break</span>;
<a name="l00993"></a>00993       to[x] = right ? (from[x] + differential) : (from[x] - differential);
<a name="l00994"></a>00994    }
<a name="l00995"></a>00995 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac9789499b866949ab31bab025b497964"></a><!-- doxytag: member="frame.c::ast_codec_pref_getsize" ref="ac9789499b866949ab31bab025b497964" args="(struct ast_codec_pref *pref, int format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__format__list.html">ast_format_list</a> ast_codec_pref_getsize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get packet size for codec. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01172">1172</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8h_source.html#l00430">ast_format_list::bits</a>, <a class="el" href="frame_8h_source.html#l00440">ast_format_list::cur_ms</a>, <a class="el" href="frame_8h_source.html#l00438">ast_format_list::def_ms</a>, <a class="el" href="cdr__custom_8c_source.html#l00058">format</a>, <a class="el" href="frame_8h_source.html#l00437">ast_format_list::inc_ms</a>, <a class="el" href="frame_8h_source.html#l00436">ast_format_list::max_ms</a>, and <a class="el" href="frame_8h_source.html#l00435">ast_format_list::min_ms</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l09822">add_codec_to_sdp()</a>, <a class="el" href="rtp_8c_source.html#l04398">ast_rtp_bridge()</a>, <a class="el" href="rtp_8c_source.html#l03728">ast_rtp_codec_setpref()</a>, <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>, <a class="el" href="chan__skinny_8c_source.html#l05511">handle_open_receive_channel_ack_message()</a>, <a class="el" href="chan__skinny_8c_source.html#l02609">skinny_set_rtp_peer()</a>, and <a class="el" href="chan__skinny_8c_source.html#l02139">transmit_connect()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01173"></a>01173 {
<a name="l01174"></a>01174    <span class="keywordtype">int</span> x, idx = -1, framems = 0;
<a name="l01175"></a>01175    <span class="keyword">struct </span><a class="code" href="structast__format__list.html" title="Definition of supported media formats (codecs).">ast_format_list</a> fmt = { 0, };
<a name="l01176"></a>01176 
<a name="l01177"></a>01177    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01178"></a>01178       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="structast__format__list.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a> == <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l01179"></a>01179          fmt = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x];
<a name="l01180"></a>01180          idx = x;
<a name="l01181"></a>01181          <span class="keywordflow">break</span>;
<a name="l01182"></a>01182       }
<a name="l01183"></a>01183    }
<a name="l01184"></a>01184 
<a name="l01185"></a>01185    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01186"></a>01186       <span class="keywordflow">if</span> (pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x] == (idx + 1)) {
<a name="l01187"></a>01187          framems = pref-&gt;<a class="code" href="structast__codec__pref.html#a2b0514c4f4584036696b7b6e83985906">framing</a>[x];
<a name="l01188"></a>01188          <span class="keywordflow">break</span>;
<a name="l01189"></a>01189       }
<a name="l01190"></a>01190    }
<a name="l01191"></a>01191 
<a name="l01192"></a>01192    <span class="comment">/* size validation */</span>
<a name="l01193"></a>01193    <span class="keywordflow">if</span> (!framems)
<a name="l01194"></a>01194       framems = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a6811d95221b6ad6a05fb9e628d903ff5">def_ms</a>;
<a name="l01195"></a>01195 
<a name="l01196"></a>01196    <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a05368e07b33c55c5588a16887e0d1937">inc_ms</a> &amp;&amp; framems % <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a05368e07b33c55c5588a16887e0d1937">inc_ms</a>) <span class="comment">/* avoid division by zero */</span>
<a name="l01197"></a>01197       framems -= framems % <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a05368e07b33c55c5588a16887e0d1937">inc_ms</a>;
<a name="l01198"></a>01198 
<a name="l01199"></a>01199    <span class="keywordflow">if</span> (framems &lt; <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a005fe943b03a357496fec4fd5a5384c7">min_ms</a>)
<a name="l01200"></a>01200       framems = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a005fe943b03a357496fec4fd5a5384c7">min_ms</a>;
<a name="l01201"></a>01201 
<a name="l01202"></a>01202    <span class="keywordflow">if</span> (framems &gt; <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#ae92eef30d25050a86edb84d37a39b984">max_ms</a>)
<a name="l01203"></a>01203       framems = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#ae92eef30d25050a86edb84d37a39b984">max_ms</a>;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205    fmt.<a class="code" href="structast__format__list.html#a8082330d5592ca639ddd6f7be0c0c39b">cur_ms</a> = framems;
<a name="l01206"></a>01206 
<a name="l01207"></a>01207    <span class="keywordflow">return</span> fmt;
<a name="l01208"></a>01208 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1610acfbe3638e07556dd06562d6c035"></a><!-- doxytag: member="frame.c::ast_codec_pref_index" ref="a1610acfbe3638e07556dd06562d6c035" args="(struct ast_codec_pref *pref, int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_pref_index </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Codec located at a particular place in the preference index. </p>
<ul>
<li><a class="el" href="AudioCodecPref.html">Audio Codec Preferences</a> </li>
</ul>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01032">1032</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00430">ast_format_list::bits</a>, and <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l15349">_sip_show_peer()</a>, <a class="el" href="chan__skinny_8c_source.html#l03337">_skinny_show_line()</a>, <a class="el" href="chan__sip_8c_source.html#l10016">add_sdp()</a>, <a class="el" href="frame_8c_source.html#l00997">ast_codec_pref_string()</a>, <a class="el" href="chan__iax2_8c_source.html#l13324">function_iaxpeer()</a>, <a class="el" href="chan__sip_8c_source.html#l17269">function_sippeer()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00379">gtalk_invite()</a>, <a class="el" href="chan__iax2_8c_source.html#l03568">handle_cli_iax2_show_peer()</a>, <a class="el" href="chan__jingle_8c_source.html#l00311">jingle_accept_call()</a>, <a class="el" href="chan__sip_8c_source.html#l15155">print_codec_to_cli()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01033"></a>01033 {
<a name="l01034"></a>01034    <span class="keywordtype">int</span> slot = 0;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036    <span class="keywordflow">if</span> ((idx &gt;= 0) &amp;&amp; (idx &lt; <span class="keyword">sizeof</span>(pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>))) {
<a name="l01037"></a>01037       slot = pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[idx];
<a name="l01038"></a>01038    }
<a name="l01039"></a>01039 
<a name="l01040"></a>01040    <span class="keywordflow">return</span> slot ? <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[slot - 1].<a class="code" href="structast__format__list.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a> : 0;
<a name="l01041"></a>01041 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5eb17ccec8892ebe96ab661e749f0399"></a><!-- doxytag: member="frame.c::ast_codec_pref_prepend" ref="a5eb17ccec8892ebe96ab661e749f0399" args="(struct ast_codec_pref *pref, int format, int only_if_existing)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_codec_pref_prepend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>only_if_existing</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepend codec to list. </p>
<p>Prepend an audio codec to a preference list, removing it first if it was already there. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01097">1097</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8h_source.html#l00039">ast_codec_pref::framing</a>, and <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l04337">create_addr()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01098"></a>01098 {
<a name="l01099"></a>01099    <span class="keywordtype">int</span> x, newindex = 0;
<a name="l01100"></a>01100 
<a name="l01101"></a>01101    <span class="comment">/* First step is to get the codecs &quot;index number&quot; */</span>
<a name="l01102"></a>01102    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01103"></a>01103       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="structast__format__list.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a> == <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l01104"></a>01104          newindex = x + 1;
<a name="l01105"></a>01105          <span class="keywordflow">break</span>;
<a name="l01106"></a>01106       }
<a name="l01107"></a>01107    }
<a name="l01108"></a>01108    <span class="comment">/* Done if its unknown */</span>
<a name="l01109"></a>01109    <span class="keywordflow">if</span> (!newindex)
<a name="l01110"></a>01110       <span class="keywordflow">return</span>;
<a name="l01111"></a>01111 
<a name="l01112"></a>01112    <span class="comment">/* Now find any existing occurrence, or the end */</span>
<a name="l01113"></a>01113    <span class="keywordflow">for</span> (x = 0; x &lt; 32; x++) {
<a name="l01114"></a>01114       <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x] || pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x] == newindex)
<a name="l01115"></a>01115          <span class="keywordflow">break</span>;
<a name="l01116"></a>01116    }
<a name="l01117"></a>01117 
<a name="l01118"></a>01118    <span class="keywordflow">if</span> (only_if_existing &amp;&amp; !pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x])
<a name="l01119"></a>01119       <span class="keywordflow">return</span>;
<a name="l01120"></a>01120 
<a name="l01121"></a>01121    <span class="comment">/* Move down to make space to insert - either all the way to the end,</span>
<a name="l01122"></a>01122 <span class="comment">      or as far as the existing location (which will be overwritten) */</span>
<a name="l01123"></a>01123    <span class="keywordflow">for</span> (; x &gt; 0; x--) {
<a name="l01124"></a>01124       pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x] = pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x - 1];
<a name="l01125"></a>01125       pref-&gt;<a class="code" href="structast__codec__pref.html#a2b0514c4f4584036696b7b6e83985906">framing</a>[x] = pref-&gt;<a class="code" href="structast__codec__pref.html#a2b0514c4f4584036696b7b6e83985906">framing</a>[x - 1];
<a name="l01126"></a>01126    }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128    <span class="comment">/* And insert the new entry */</span>
<a name="l01129"></a>01129    pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[0] = newindex;
<a name="l01130"></a>01130    pref-&gt;<a class="code" href="structast__codec__pref.html#a2b0514c4f4584036696b7b6e83985906">framing</a>[0] = 0; <span class="comment">/* ? */</span>
<a name="l01131"></a>01131 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8daa8fe39c23fc605881466efafa00f7"></a><!-- doxytag: member="frame.c::ast_codec_pref_remove" ref="a8daa8fe39c23fc605881466efafa00f7" args="(struct ast_codec_pref *pref, int format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_codec_pref_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remove codec from pref list. </p>
<p>Remove audio a codec from a preference list. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01044">1044</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8h_source.html#l00039">ast_codec_pref::framing</a>, and <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01071">ast_codec_pref_append()</a>, and <a class="el" href="frame_8c_source.html#l01233">ast_parse_allow_disallow()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01045"></a>01045 {
<a name="l01046"></a>01046    <span class="keyword">struct </span><a class="code" href="structast__codec__pref.html">ast_codec_pref</a> oldorder;
<a name="l01047"></a>01047    <span class="keywordtype">int</span> x, y = 0;
<a name="l01048"></a>01048    <span class="keywordtype">int</span> slot;
<a name="l01049"></a>01049    <span class="keywordtype">int</span> size;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051    <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[0])
<a name="l01052"></a>01052       <span class="keywordflow">return</span>;
<a name="l01053"></a>01053 
<a name="l01054"></a>01054    memcpy(&amp;oldorder, pref, <span class="keyword">sizeof</span>(oldorder));
<a name="l01055"></a>01055    memset(pref, 0, <span class="keyword">sizeof</span>(*pref));
<a name="l01056"></a>01056 
<a name="l01057"></a>01057    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01058"></a>01058       slot = oldorder.order[x];
<a name="l01059"></a>01059       size = oldorder.framing[x];
<a name="l01060"></a>01060       <span class="keywordflow">if</span> (! slot)
<a name="l01061"></a>01061          <span class="keywordflow">break</span>;
<a name="l01062"></a>01062       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[slot-1].bits != <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l01063"></a>01063          pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[y] = slot;
<a name="l01064"></a>01064          pref-&gt;<a class="code" href="structast__codec__pref.html#a2b0514c4f4584036696b7b6e83985906">framing</a>[y++] = size;
<a name="l01065"></a>01065       }
<a name="l01066"></a>01066    }
<a name="l01067"></a>01067    
<a name="l01068"></a>01068 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6803881645ae33ff0618b3648d26aeaa"></a><!-- doxytag: member="frame.c::ast_codec_pref_setsize" ref="a6803881645ae33ff0618b3648d26aeaa" args="(struct ast_codec_pref *pref, int format, int framems)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_pref_setsize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>framems</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set packet size for codec. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01134">1134</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8h_source.html#l00438">ast_format_list::def_ms</a>, <a class="el" href="frame_8h_source.html#l00039">ast_codec_pref::framing</a>, <a class="el" href="frame_8h_source.html#l00437">ast_format_list::inc_ms</a>, <a class="el" href="frame_8h_source.html#l00436">ast_format_list::max_ms</a>, <a class="el" href="frame_8h_source.html#l00435">ast_format_list::min_ms</a>, and <a class="el" href="frame_8h_source.html#l00038">ast_codec_pref::order</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01233">ast_parse_allow_disallow()</a>, and <a class="el" href="chan__sip_8c_source.html#l08730">process_sdp_a_audio()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01135"></a>01135 {
<a name="l01136"></a>01136    <span class="keywordtype">int</span> x, idx = -1;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01139"></a>01139       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].bits == <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l01140"></a>01140          idx = x;
<a name="l01141"></a>01141          <span class="keywordflow">break</span>;
<a name="l01142"></a>01142       }
<a name="l01143"></a>01143    }
<a name="l01144"></a>01144 
<a name="l01145"></a>01145    <span class="keywordflow">if</span> (idx &lt; 0)
<a name="l01146"></a>01146       <span class="keywordflow">return</span> -1;
<a name="l01147"></a>01147 
<a name="l01148"></a>01148    <span class="comment">/* size validation */</span>
<a name="l01149"></a>01149    <span class="keywordflow">if</span> (!framems)
<a name="l01150"></a>01150       framems = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a6811d95221b6ad6a05fb9e628d903ff5">def_ms</a>;
<a name="l01151"></a>01151 
<a name="l01152"></a>01152    <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].inc_ms &amp;&amp; framems % <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].inc_ms) <span class="comment">/* avoid division by zero */</span>
<a name="l01153"></a>01153       framems -= framems % <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a05368e07b33c55c5588a16887e0d1937">inc_ms</a>;
<a name="l01154"></a>01154 
<a name="l01155"></a>01155    <span class="keywordflow">if</span> (framems &lt; <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].min_ms)
<a name="l01156"></a>01156       framems = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#a005fe943b03a357496fec4fd5a5384c7">min_ms</a>;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158    <span class="keywordflow">if</span> (framems &gt; <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].max_ms)
<a name="l01159"></a>01159       framems = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx].<a class="code" href="structast__format__list.html#ae92eef30d25050a86edb84d37a39b984">max_ms</a>;
<a name="l01160"></a>01160 
<a name="l01161"></a>01161    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l01162"></a>01162       <span class="keywordflow">if</span> (pref-&gt;<a class="code" href="structast__codec__pref.html#af2068e452bdf5eeafcda00c8c06b5cc0">order</a>[x] == (idx + 1)) {
<a name="l01163"></a>01163          pref-&gt;<a class="code" href="structast__codec__pref.html#a2b0514c4f4584036696b7b6e83985906">framing</a>[x] = framems;
<a name="l01164"></a>01164          <span class="keywordflow">break</span>;
<a name="l01165"></a>01165       }
<a name="l01166"></a>01166    }
<a name="l01167"></a>01167 
<a name="l01168"></a>01168    <span class="keywordflow">return</span> x;
<a name="l01169"></a>01169 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a784e4f7371cbfce0b3e9f957f7ce54e3"></a><!-- doxytag: member="frame.c::ast_codec_pref_string" ref="a784e4f7371cbfce0b3e9f957f7ce54e3" args="(struct ast_codec_pref *pref, char *buf, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_codec_pref_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dump audio codec preference list into a string. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00997">997</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l01032">ast_codec_pref_index()</a>, and <a class="el" href="frame_8c_source.html#l00573">ast_getformatname()</a>.</p>

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l00110">dump_prefs()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00998"></a>00998 {
<a name="l00999"></a>00999    <span class="keywordtype">int</span> x, codec; 
<a name="l01000"></a>01000    <span class="keywordtype">size_t</span> total_len, slen;
<a name="l01001"></a>01001    <span class="keywordtype">char</span> *formatname;
<a name="l01002"></a>01002    
<a name="l01003"></a>01003    memset(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>,0,size);
<a name="l01004"></a>01004    total_len = size;
<a name="l01005"></a>01005    <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[0] = <span class="charliteral">&apos;(&apos;</span>;
<a name="l01006"></a>01006    total_len--;
<a name="l01007"></a>01007    <span class="keywordflow">for</span>(x = 0; x &lt; 32 ; x++) {
<a name="l01008"></a>01008       <span class="keywordflow">if</span> (total_len &lt;= 0)
<a name="l01009"></a>01009          <span class="keywordflow">break</span>;
<a name="l01010"></a>01010       <span class="keywordflow">if</span> (!(codec = <a class="code" href="frame_8h.html#af9dd4cbc4b715644df1afe4964169c9b" title="Codec located at a particular place in the preference index.">ast_codec_pref_index</a>(pref,x)))
<a name="l01011"></a>01011          <span class="keywordflow">break</span>;
<a name="l01012"></a>01012       <span class="keywordflow">if</span> ((formatname = <a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(codec))) {
<a name="l01013"></a>01013          slen = strlen(formatname);
<a name="l01014"></a>01014          <span class="keywordflow">if</span> (slen &gt; total_len)
<a name="l01015"></a>01015             <span class="keywordflow">break</span>;
<a name="l01016"></a>01016          strncat(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, formatname, total_len - 1); <span class="comment">/* safe */</span>
<a name="l01017"></a>01017          total_len -= slen;
<a name="l01018"></a>01018       }
<a name="l01019"></a>01019       <span class="keywordflow">if</span> (total_len &amp;&amp; x &lt; 31 &amp;&amp; <a class="code" href="frame_8h.html#af9dd4cbc4b715644df1afe4964169c9b" title="Codec located at a particular place in the preference index.">ast_codec_pref_index</a>(pref , x + 1)) {
<a name="l01020"></a>01020          strncat(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="stringliteral">&quot;|&quot;</span>, total_len - 1); <span class="comment">/* safe */</span>
<a name="l01021"></a>01021          total_len--;
<a name="l01022"></a>01022       }
<a name="l01023"></a>01023    }
<a name="l01024"></a>01024    <span class="keywordflow">if</span> (total_len) {
<a name="l01025"></a>01025       strncat(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="stringliteral">&quot;)&quot;</span>, total_len - 1); <span class="comment">/* safe */</span>
<a name="l01026"></a>01026       total_len--;
<a name="l01027"></a>01027    }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029    <span class="keywordflow">return</span> size - total_len;
<a name="l01030"></a>01030 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8ce634275e2d4e37422332eb8fbdc5dd"></a><!-- doxytag: member="frame.c::ast_expand_codec_alias" ref="a8ce634275e2d4e37422332eb8fbdc5dd" args="(const char *in)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* ast_expand_codec_alias </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>in</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00625">625</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00636">ast_getformatbyname()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00626"></a>00626 {
<a name="l00627"></a>00627    <span class="keywordtype">int</span> x;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="structast__codec__alias__table.html">ast_codec_alias_table</a>); x++) {
<a name="l00630"></a>00630       <span class="keywordflow">if</span> (!strcmp(in,<a class="code" href="structast__codec__alias__table.html">ast_codec_alias_table</a>[x].alias))
<a name="l00631"></a>00631          <span class="keywordflow">return</span> <a class="code" href="structast__codec__alias__table.html">ast_codec_alias_table</a>[x].realname;
<a name="l00632"></a>00632    }
<a name="l00633"></a>00633    <span class="keywordflow">return</span> in;
<a name="l00634"></a>00634 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a59b72ee1caa9e8349ca017df01e8ac55"></a><!-- doxytag: member="frame.c::ast_frame_adjust_volume" ref="a59b72ee1caa9e8349ca017df01e8ac55" args="(struct ast_frame *f, int adjustment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_frame_adjust_volume </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>adjustment</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adjusts the <a class="el" href="structvolume.html">volume</a> of the audio samples contained in a frame. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>The frame containing the samples (must be AST_FRAME_VOICE and AST_FORMAT_SLINEAR) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>adjustment</em>&nbsp;</td><td>The <a class="el" href="structnumber.html" title="Number structure.">number</a> of dB to adjust up or down. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 for success, non-zero for an error </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01531">1531</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="utils_8h_source.html#l00310">ast_slinear_saturated_divide()</a>, <a class="el" href="utils_8h_source.html#l00297">ast_slinear_saturated_multiply()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, and <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00169">audiohook_read_frame_single()</a>, <a class="el" href="audiohook_8c_source.html#l00855">audiohook_volume_callback()</a>, <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>, and <a class="el" href="func__volume_8c_source.html#l00082">volume_callback()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01532"></a>01532 {
<a name="l01533"></a>01533    <span class="keywordtype">int</span> count;
<a name="l01534"></a>01534    <span class="keywordtype">short</span> *fdata = f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;
<a name="l01535"></a>01535    <span class="keywordtype">short</span> adjust_value = abs(adjustment);
<a name="l01536"></a>01536 
<a name="l01537"></a>01537    <span class="keywordflow">if</span> ((f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) || (f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> != <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>))
<a name="l01538"></a>01538       <span class="keywordflow">return</span> -1;
<a name="l01539"></a>01539 
<a name="l01540"></a>01540    <span class="keywordflow">if</span> (!adjustment)
<a name="l01541"></a>01541       <span class="keywordflow">return</span> 0;
<a name="l01542"></a>01542 
<a name="l01543"></a>01543    <span class="keywordflow">for</span> (count = 0; count &lt; f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>; count++) {
<a name="l01544"></a>01544       <span class="keywordflow">if</span> (adjustment &gt; 0) {
<a name="l01545"></a>01545          <a class="code" href="utils_8h.html#a5b2919c84591a13feb6b750b54c57520">ast_slinear_saturated_multiply</a>(&amp;fdata[count], &amp;adjust_value);
<a name="l01546"></a>01546       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (adjustment &lt; 0) {
<a name="l01547"></a>01547          <a class="code" href="utils_8h.html#af5e55a87e9741a1bbea1e2ec2f99a1e1">ast_slinear_saturated_divide</a>(&amp;fdata[count], &amp;adjust_value);
<a name="l01548"></a>01548       }
<a name="l01549"></a>01549    }
<a name="l01550"></a>01550 
<a name="l01551"></a>01551    <span class="keywordflow">return</span> 0;
<a name="l01552"></a>01552 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a35641692b96e9e81da06d8d36e677cb8"></a><!-- doxytag: member="frame.c::ast_frame_dump" ref="a35641692b96e9e81da06d8d36e677cb8" args="(const char *name, struct ast_frame *f, char *prefix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_frame_dump </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>prefix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dump a frame for debugging purposes </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00756">756</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00301">AST_CONTROL_ANSWER</a>, <a class="el" href="frame_8h_source.html#l00302">AST_CONTROL_BUSY</a>, <a class="el" href="frame_8h_source.html#l00305">AST_CONTROL_CONGESTION</a>, <a class="el" href="frame_8h_source.html#l00306">AST_CONTROL_FLASH</a>, <a class="el" href="frame_8h_source.html#l00298">AST_CONTROL_HANGUP</a>, <a class="el" href="frame_8h_source.html#l00313">AST_CONTROL_HOLD</a>, <a class="el" href="frame_8h_source.html#l00304">AST_CONTROL_OFFHOOK</a>, <a class="el" href="frame_8h_source.html#l00308">AST_CONTROL_OPTION</a>, <a class="el" href="frame_8h_source.html#l00309">AST_CONTROL_RADIO_KEY</a>, <a class="el" href="frame_8h_source.html#l00310">AST_CONTROL_RADIO_UNKEY</a>, <a class="el" href="frame_8h_source.html#l00299">AST_CONTROL_RING</a>, <a class="el" href="frame_8h_source.html#l00300">AST_CONTROL_RINGING</a>, <a class="el" href="frame_8h_source.html#l00318">AST_CONTROL_T38_PARAMETERS</a>, <a class="el" href="frame_8h_source.html#l00303">AST_CONTROL_TAKEOFFHOOK</a>, <a class="el" href="frame_8h_source.html#l00314">AST_CONTROL_UNHOLD</a>, <a class="el" href="frame_8h_source.html#l00307">AST_CONTROL_WINK</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h_source.html#l00122">AST_FRAME_DTMF_BEGIN</a>, <a class="el" href="frame_8h_source.html#l00099">AST_FRAME_DTMF_END</a>, <a class="el" href="frame_8h_source.html#l00115">AST_FRAME_HTML</a>, <a class="el" href="frame_8h_source.html#l00109">AST_FRAME_IAX</a>, <a class="el" href="frame_8h_source.html#l00113">AST_FRAME_IMAGE</a>, <a class="el" href="frame_8h_source.html#l00120">AST_FRAME_MODEM</a>, <a class="el" href="frame_8h_source.html#l00107">AST_FRAME_NULL</a>, <a class="el" href="frame_8h_source.html#l00111">AST_FRAME_TEXT</a>, <a class="el" href="frame_8h_source.html#l00103">AST_FRAME_VIDEO</a>, <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="frame_8c_source.html#l00573">ast_getformatname()</a>, <a class="el" href="frame_8h_source.html#l00225">AST_HTML_BEGIN</a>, <a class="el" href="frame_8h_source.html#l00223">AST_HTML_DATA</a>, <a class="el" href="frame_8h_source.html#l00227">AST_HTML_END</a>, <a class="el" href="frame_8h_source.html#l00229">AST_HTML_LDCOMPLETE</a>, <a class="el" href="frame_8h_source.html#l00237">AST_HTML_LINKREJECT</a>, <a class="el" href="frame_8h_source.html#l00233">AST_HTML_LINKURL</a>, <a class="el" href="frame_8h_source.html#l00231">AST_HTML_NOSUPPORT</a>, <a class="el" href="frame_8h_source.html#l00235">AST_HTML_UNLINK</a>, <a class="el" href="frame_8h_source.html#l00221">AST_HTML_URL</a>, <a class="el" href="frame_8h_source.html#l00215">AST_MODEM_T38</a>, <a class="el" href="frame_8h_source.html#l00217">AST_MODEM_V150</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="frame_8h_source.html#l00324">AST_T38_NEGOTIATED</a>, <a class="el" href="frame_8h_source.html#l00326">AST_T38_REFUSED</a>, <a class="el" href="frame_8h_source.html#l00322">AST_T38_REQUEST_NEGOTIATE</a>, <a class="el" href="frame_8h_source.html#l00323">AST_T38_REQUEST_TERMINATE</a>, <a class="el" href="frame_8h_source.html#l00325">AST_T38_TERMINATED</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="term_8h_source.html#l00047">COLOR_BLACK</a>, <a class="el" href="term_8h_source.html#l00060">COLOR_BRCYAN</a>, <a class="el" href="term_8h_source.html#l00052">COLOR_BRGREEN</a>, <a class="el" href="term_8h_source.html#l00058">COLOR_BRMAGENTA</a>, <a class="el" href="term_8h_source.html#l00050">COLOR_BRRED</a>, <a class="el" href="term_8h_source.html#l00054">COLOR_YELLOW</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00344">ast_control_t38_parameters::request_response</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, and <a class="el" href="term_8c_source.html#l00168">term_color()</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l02636">__ast_read()</a>, and <a class="el" href="channel_8c_source.html#l03411">ast_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00757"></a>00757 {
<a name="l00758"></a>00758    <span class="keyword">const</span> <span class="keywordtype">char</span> noname[] = <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l00759"></a>00759    <span class="keywordtype">char</span> ftype[40] = <span class="stringliteral">&quot;Unknown Frametype&quot;</span>;
<a name="l00760"></a>00760    <span class="keywordtype">char</span> cft[80];
<a name="l00761"></a>00761    <span class="keywordtype">char</span> subclass[40] = <span class="stringliteral">&quot;Unknown Subclass&quot;</span>;
<a name="l00762"></a>00762    <span class="keywordtype">char</span> csub[80];
<a name="l00763"></a>00763    <span class="keywordtype">char</span> moreinfo[40] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00764"></a>00764    <span class="keywordtype">char</span> cn[60];
<a name="l00765"></a>00765    <span class="keywordtype">char</span> cp[40];
<a name="l00766"></a>00766    <span class="keywordtype">char</span> cmn[40];
<a name="l00767"></a>00767    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structmessage.html">message</a> = <span class="stringliteral">&quot;Unknown&quot;</span>;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769    <span class="keywordflow">if</span> (!<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l00770"></a>00770       <a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a> = noname;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772 
<a name="l00773"></a>00773    <span class="keywordflow">if</span> (!f) {
<a name="l00774"></a>00774       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot;%s [ %s (NULL) ] [%s]\n&quot;</span>, 
<a name="l00775"></a>00775          <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cp, <a class="code" href="http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a>, <a class="code" href="term_8h.html#aee88b2ffd7fd2128fe38896cffb1a71a">COLOR_BRMAGENTA</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cp)),
<a name="l00776"></a>00776          <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cft, <span class="stringliteral">&quot;HANGUP&quot;</span>, <a class="code" href="term_8h.html#a1851f8a3f25e5caf6183dc44af070d0d">COLOR_BRRED</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cft)), 
<a name="l00777"></a>00777          <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cn, <a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="code" href="term_8h.html#a4534b577b74a58b0f4b7be027af664e0">COLOR_YELLOW</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cn)));
<a name="l00778"></a>00778       <span class="keywordflow">return</span>;
<a name="l00779"></a>00779    }
<a name="l00780"></a>00780    <span class="comment">/* XXX We should probably print one each of voice and video when the format changes XXX */</span>
<a name="l00781"></a>00781    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>)
<a name="l00782"></a>00782       <span class="keywordflow">return</span>;
<a name="l00783"></a>00783    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30">AST_FRAME_VIDEO</a>)
<a name="l00784"></a>00784       <span class="keywordflow">return</span>;
<a name="l00785"></a>00785    <span class="keywordflow">switch</span>(f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>) {
<a name="l00786"></a>00786    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a9b350360a64b55c7590f1ec03db480be">AST_FRAME_DTMF_BEGIN</a>:
<a name="l00787"></a>00787       strcpy(ftype, <span class="stringliteral">&quot;DTMF Begin&quot;</span>);
<a name="l00788"></a>00788       subclass[0] = f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l00789"></a>00789       subclass[1] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00790"></a>00790       <span class="keywordflow">break</span>;
<a name="l00791"></a>00791    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b">AST_FRAME_DTMF_END</a>:
<a name="l00792"></a>00792       strcpy(ftype, <span class="stringliteral">&quot;DTMF End&quot;</span>);
<a name="l00793"></a>00793       subclass[0] = f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l00794"></a>00794       subclass[1] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00795"></a>00795       <span class="keywordflow">break</span>;
<a name="l00796"></a>00796    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>:
<a name="l00797"></a>00797       strcpy(ftype, <span class="stringliteral">&quot;Control&quot;</span>);
<a name="l00798"></a>00798       <span class="keywordflow">switch</span>(f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>) {
<a name="l00799"></a>00799       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>:
<a name="l00800"></a>00800          strcpy(subclass, <span class="stringliteral">&quot;Hangup&quot;</span>);
<a name="l00801"></a>00801          <span class="keywordflow">break</span>;
<a name="l00802"></a>00802       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a00675bfb8c64b2be86297fe4cba51fa2">AST_CONTROL_RING</a>:
<a name="l00803"></a>00803          strcpy(subclass, <span class="stringliteral">&quot;Ring&quot;</span>);
<a name="l00804"></a>00804          <span class="keywordflow">break</span>;
<a name="l00805"></a>00805       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:
<a name="l00806"></a>00806          strcpy(subclass, <span class="stringliteral">&quot;Ringing&quot;</span>);
<a name="l00807"></a>00807          <span class="keywordflow">break</span>;
<a name="l00808"></a>00808       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>:
<a name="l00809"></a>00809          strcpy(subclass, <span class="stringliteral">&quot;Answer&quot;</span>);
<a name="l00810"></a>00810          <span class="keywordflow">break</span>;
<a name="l00811"></a>00811       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:
<a name="l00812"></a>00812          strcpy(subclass, <span class="stringliteral">&quot;Busy&quot;</span>);
<a name="l00813"></a>00813          <span class="keywordflow">break</span>;
<a name="l00814"></a>00814       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a5a24176e8066b727463907da4903bb8e">AST_CONTROL_TAKEOFFHOOK</a>:
<a name="l00815"></a>00815          strcpy(subclass, <span class="stringliteral">&quot;Take Off Hook&quot;</span>);
<a name="l00816"></a>00816          <span class="keywordflow">break</span>;
<a name="l00817"></a>00817       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755">AST_CONTROL_OFFHOOK</a>:
<a name="l00818"></a>00818          strcpy(subclass, <span class="stringliteral">&quot;Line Off Hook&quot;</span>);
<a name="l00819"></a>00819          <span class="keywordflow">break</span>;
<a name="l00820"></a>00820       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:
<a name="l00821"></a>00821          strcpy(subclass, <span class="stringliteral">&quot;Congestion&quot;</span>);
<a name="l00822"></a>00822          <span class="keywordflow">break</span>;
<a name="l00823"></a>00823       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a>:
<a name="l00824"></a>00824          strcpy(subclass, <span class="stringliteral">&quot;Flash&quot;</span>);
<a name="l00825"></a>00825          <span class="keywordflow">break</span>;
<a name="l00826"></a>00826       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a195b2c39c09113953814aa800dd06e7f">AST_CONTROL_WINK</a>:
<a name="l00827"></a>00827          strcpy(subclass, <span class="stringliteral">&quot;Wink&quot;</span>);
<a name="l00828"></a>00828          <span class="keywordflow">break</span>;
<a name="l00829"></a>00829       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ac4106406e269667ff84ee49e0a634f94">AST_CONTROL_OPTION</a>:
<a name="l00830"></a>00830          strcpy(subclass, <span class="stringliteral">&quot;Option&quot;</span>);
<a name="l00831"></a>00831          <span class="keywordflow">break</span>;
<a name="l00832"></a>00832       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aacb7ddf1a95fa544fdecada68213f3c7">AST_CONTROL_RADIO_KEY</a>:
<a name="l00833"></a>00833          strcpy(subclass, <span class="stringliteral">&quot;Key Radio&quot;</span>);
<a name="l00834"></a>00834          <span class="keywordflow">break</span>;
<a name="l00835"></a>00835       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a34ac3ccebc219c59daa7eb0275fcd54d">AST_CONTROL_RADIO_UNKEY</a>:
<a name="l00836"></a>00836          strcpy(subclass, <span class="stringliteral">&quot;Unkey Radio&quot;</span>);
<a name="l00837"></a>00837          <span class="keywordflow">break</span>;
<a name="l00838"></a>00838       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a>:
<a name="l00839"></a>00839          strcpy(subclass, <span class="stringliteral">&quot;Hold&quot;</span>);
<a name="l00840"></a>00840          <span class="keywordflow">break</span>;
<a name="l00841"></a>00841       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a>:
<a name="l00842"></a>00842          strcpy(subclass, <span class="stringliteral">&quot;Unhold&quot;</span>);
<a name="l00843"></a>00843          <span class="keywordflow">break</span>;
<a name="l00844"></a>00844       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a7334c9d27a6d70fe7c85b60b864788fc">AST_CONTROL_T38_PARAMETERS</a>:
<a name="l00845"></a>00845          <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__control__t38__parameters.html">ast_control_t38_parameters</a>)) {
<a name="l00846"></a>00846             message = <span class="stringliteral">&quot;Invalid&quot;</span>;
<a name="l00847"></a>00847          } <span class="keywordflow">else</span> {
<a name="l00848"></a>00848             <span class="keyword">struct </span><a class="code" href="structast__control__t38__parameters.html">ast_control_t38_parameters</a> *parameters = f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;
<a name="l00849"></a>00849             <span class="keyword">enum</span> <a class="code" href="frame_8h.html#a168d496bdac09ece3ce49cf473bbdb4b">ast_control_t38</a> <a class="code" href="structstate.html">state</a> = parameters-&gt;<a class="code" href="structast__control__t38__parameters.html#adb36822366e10ce64ca8337c512732a6">request_response</a>;
<a name="l00850"></a>00850             <span class="keywordflow">if</span> (state == <a class="code" href="frame_8h.html#a168d496bdac09ece3ce49cf473bbdb4bafdb1ca68d683c64301c4cf07463a9975">AST_T38_REQUEST_NEGOTIATE</a>)
<a name="l00851"></a>00851                message = <span class="stringliteral">&quot;Negotiation Requested&quot;</span>;
<a name="l00852"></a>00852             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="frame_8h.html#a168d496bdac09ece3ce49cf473bbdb4bab75e46d3212a2a886143d874c78a1e3c">AST_T38_REQUEST_TERMINATE</a>)
<a name="l00853"></a>00853                message = <span class="stringliteral">&quot;Negotiation Request Terminated&quot;</span>;
<a name="l00854"></a>00854             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="frame_8h.html#a168d496bdac09ece3ce49cf473bbdb4bad501e0d5fe272eaba466507a686a2df5">AST_T38_NEGOTIATED</a>)
<a name="l00855"></a>00855                message = <span class="stringliteral">&quot;Negotiated&quot;</span>;
<a name="l00856"></a>00856             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="frame_8h.html#a168d496bdac09ece3ce49cf473bbdb4ba9df578b4287c86673d7f40f9abcdc86f">AST_T38_TERMINATED</a>)
<a name="l00857"></a>00857                message = <span class="stringliteral">&quot;Terminated&quot;</span>;
<a name="l00858"></a>00858             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="frame_8h.html#a168d496bdac09ece3ce49cf473bbdb4baa02b30f25621f20396d06f5ac8aa7a2e">AST_T38_REFUSED</a>)
<a name="l00859"></a>00859                message = <span class="stringliteral">&quot;Refused&quot;</span>;
<a name="l00860"></a>00860          }
<a name="l00861"></a>00861          snprintf(subclass, <span class="keyword">sizeof</span>(subclass), <span class="stringliteral">&quot;T38_Parameters/%s&quot;</span>, message);
<a name="l00862"></a>00862          <span class="keywordflow">break</span>;
<a name="l00863"></a>00863       <span class="keywordflow">case</span> -1:
<a name="l00864"></a>00864          strcpy(subclass, <span class="stringliteral">&quot;Stop generators&quot;</span>);
<a name="l00865"></a>00865          <span class="keywordflow">break</span>;
<a name="l00866"></a>00866       <span class="keywordflow">default</span>:
<a name="l00867"></a>00867          snprintf(subclass, <span class="keyword">sizeof</span>(subclass), <span class="stringliteral">&quot;Unknown control &apos;%d&apos;&quot;</span>, f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>);
<a name="l00868"></a>00868       }
<a name="l00869"></a>00869       <span class="keywordflow">break</span>;
<a name="l00870"></a>00870    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a29ff71f9d5c7927906ebd437fe372056">AST_FRAME_NULL</a>:
<a name="l00871"></a>00871       strcpy(ftype, <span class="stringliteral">&quot;Null Frame&quot;</span>);
<a name="l00872"></a>00872       strcpy(subclass, <span class="stringliteral">&quot;N/A&quot;</span>);
<a name="l00873"></a>00873       <span class="keywordflow">break</span>;
<a name="l00874"></a>00874    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a7f7e5bdc9f8a8ef45c4d078f96b52624">AST_FRAME_IAX</a>:
<a name="l00875"></a>00875       <span class="comment">/* Should never happen */</span>
<a name="l00876"></a>00876       strcpy(ftype, <span class="stringliteral">&quot;IAX Specific&quot;</span>);
<a name="l00877"></a>00877       snprintf(subclass, <span class="keyword">sizeof</span>(subclass), <span class="stringliteral">&quot;IAX Frametype %d&quot;</span>, f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>);
<a name="l00878"></a>00878       <span class="keywordflow">break</span>;
<a name="l00879"></a>00879    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0af7728b18670d3cd075f63d67f8867078">AST_FRAME_TEXT</a>:
<a name="l00880"></a>00880       strcpy(ftype, <span class="stringliteral">&quot;Text&quot;</span>);
<a name="l00881"></a>00881       strcpy(subclass, <span class="stringliteral">&quot;N/A&quot;</span>);
<a name="l00882"></a>00882       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(moreinfo, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, <span class="keyword">sizeof</span>(moreinfo));
<a name="l00883"></a>00883       <span class="keywordflow">break</span>;
<a name="l00884"></a>00884    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a6c9398ee8989239124295d096a87bf32">AST_FRAME_IMAGE</a>:
<a name="l00885"></a>00885       strcpy(ftype, <span class="stringliteral">&quot;Image&quot;</span>);
<a name="l00886"></a>00886       snprintf(subclass, <span class="keyword">sizeof</span>(subclass), <span class="stringliteral">&quot;Image format %s\n&quot;</span>, <a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>));
<a name="l00887"></a>00887       <span class="keywordflow">break</span>;
<a name="l00888"></a>00888    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a3d91bab33583f560197e21532a02a895">AST_FRAME_HTML</a>:
<a name="l00889"></a>00889       strcpy(ftype, <span class="stringliteral">&quot;HTML&quot;</span>);
<a name="l00890"></a>00890       <span class="keywordflow">switch</span>(f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>) {
<a name="l00891"></a>00891       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a6eada13200d55b88ef01b68c5d62a43a">AST_HTML_URL</a>:
<a name="l00892"></a>00892          strcpy(subclass, <span class="stringliteral">&quot;URL&quot;</span>);
<a name="l00893"></a>00893          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(moreinfo, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, <span class="keyword">sizeof</span>(moreinfo));
<a name="l00894"></a>00894          <span class="keywordflow">break</span>;
<a name="l00895"></a>00895       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aba474b9a2a4dcde86ee12f74e878ab6d">AST_HTML_DATA</a>:
<a name="l00896"></a>00896          strcpy(subclass, <span class="stringliteral">&quot;Data&quot;</span>);
<a name="l00897"></a>00897          <span class="keywordflow">break</span>;
<a name="l00898"></a>00898       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ade1d4ef84064d1c58f0377514292db3c">AST_HTML_BEGIN</a>:
<a name="l00899"></a>00899          strcpy(subclass, <span class="stringliteral">&quot;Begin&quot;</span>);
<a name="l00900"></a>00900          <span class="keywordflow">break</span>;
<a name="l00901"></a>00901       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aa6c9a7c6b3b55b0b2b3792655b24cfaf">AST_HTML_END</a>:
<a name="l00902"></a>00902          strcpy(subclass, <span class="stringliteral">&quot;End&quot;</span>);
<a name="l00903"></a>00903          <span class="keywordflow">break</span>;
<a name="l00904"></a>00904       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a91982c4a8393bd03929906ae254e759e">AST_HTML_LDCOMPLETE</a>:
<a name="l00905"></a>00905          strcpy(subclass, <span class="stringliteral">&quot;Load Complete&quot;</span>);
<a name="l00906"></a>00906          <span class="keywordflow">break</span>;
<a name="l00907"></a>00907       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a75abb5123a5468bdce1c651a6df008c3">AST_HTML_NOSUPPORT</a>:
<a name="l00908"></a>00908          strcpy(subclass, <span class="stringliteral">&quot;No Support&quot;</span>);
<a name="l00909"></a>00909          <span class="keywordflow">break</span>;
<a name="l00910"></a>00910       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a5e242c10a410dcee83755947346d9671">AST_HTML_LINKURL</a>:
<a name="l00911"></a>00911          strcpy(subclass, <span class="stringliteral">&quot;Link URL&quot;</span>);
<a name="l00912"></a>00912          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(moreinfo, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, <span class="keyword">sizeof</span>(moreinfo));
<a name="l00913"></a>00913          <span class="keywordflow">break</span>;
<a name="l00914"></a>00914       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a1c9f284a258e8c26216fe1ac4fbecba4">AST_HTML_UNLINK</a>:
<a name="l00915"></a>00915          strcpy(subclass, <span class="stringliteral">&quot;Unlink&quot;</span>);
<a name="l00916"></a>00916          <span class="keywordflow">break</span>;
<a name="l00917"></a>00917       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ad5863e5c322715392e99acc5bef0a518">AST_HTML_LINKREJECT</a>:
<a name="l00918"></a>00918          strcpy(subclass, <span class="stringliteral">&quot;Link Reject&quot;</span>);
<a name="l00919"></a>00919          <span class="keywordflow">break</span>;
<a name="l00920"></a>00920       <span class="keywordflow">default</span>:
<a name="l00921"></a>00921          snprintf(subclass, <span class="keyword">sizeof</span>(subclass), <span class="stringliteral">&quot;Unknown HTML frame &apos;%d&apos;\n&quot;</span>, f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>);
<a name="l00922"></a>00922          <span class="keywordflow">break</span>;
<a name="l00923"></a>00923       }
<a name="l00924"></a>00924       <span class="keywordflow">break</span>;
<a name="l00925"></a>00925    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ad99b86353343f422bda01163898b2eea">AST_FRAME_MODEM</a>:
<a name="l00926"></a>00926       strcpy(ftype, <span class="stringliteral">&quot;Modem&quot;</span>);
<a name="l00927"></a>00927       <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>) {
<a name="l00928"></a>00928       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a3a510e4e2673c6870ed5fe0f1eb53732">AST_MODEM_T38</a>:
<a name="l00929"></a>00929          strcpy(subclass, <span class="stringliteral">&quot;T.38&quot;</span>);
<a name="l00930"></a>00930          <span class="keywordflow">break</span>;
<a name="l00931"></a>00931       <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ad7ac909bf2adaabfe37805db2cf53f14">AST_MODEM_V150</a>:
<a name="l00932"></a>00932          strcpy(subclass, <span class="stringliteral">&quot;V.150&quot;</span>);
<a name="l00933"></a>00933          <span class="keywordflow">break</span>;
<a name="l00934"></a>00934       <span class="keywordflow">default</span>:
<a name="l00935"></a>00935          snprintf(subclass, <span class="keyword">sizeof</span>(subclass), <span class="stringliteral">&quot;Unknown MODEM frame &apos;%d&apos;\n&quot;</span>, f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>);
<a name="l00936"></a>00936          <span class="keywordflow">break</span>;
<a name="l00937"></a>00937       }
<a name="l00938"></a>00938       <span class="keywordflow">break</span>;
<a name="l00939"></a>00939    <span class="keywordflow">default</span>:
<a name="l00940"></a>00940       snprintf(ftype, <span class="keyword">sizeof</span>(ftype), <span class="stringliteral">&quot;Unknown Frametype &apos;%d&apos;&quot;</span>, f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>);
<a name="l00941"></a>00941    }
<a name="l00942"></a>00942    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(moreinfo))
<a name="l00943"></a>00943       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot;%s [ TYPE: %s (%d) SUBCLASS: %s (%d) &apos;%s&apos; ] [%s]\n&quot;</span>,  
<a name="l00944"></a>00944              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cp, <a class="code" href="http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a>, <a class="code" href="term_8h.html#aee88b2ffd7fd2128fe38896cffb1a71a">COLOR_BRMAGENTA</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cp)),
<a name="l00945"></a>00945              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cft, ftype, <a class="code" href="term_8h.html#a1851f8a3f25e5caf6183dc44af070d0d">COLOR_BRRED</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cft)),
<a name="l00946"></a>00946              f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>, 
<a name="l00947"></a>00947              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(csub, subclass, <a class="code" href="term_8h.html#a23aeefae76b2cacc1a6162de88c3fff0">COLOR_BRCYAN</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(csub)),
<a name="l00948"></a>00948              f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>, 
<a name="l00949"></a>00949              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cmn, moreinfo, <a class="code" href="term_8h.html#a0149574f00c0892ce71ca7964e69672b">COLOR_BRGREEN</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cmn)),
<a name="l00950"></a>00950              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cn, <a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="code" href="term_8h.html#a4534b577b74a58b0f4b7be027af664e0">COLOR_YELLOW</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cn)));
<a name="l00951"></a>00951    <span class="keywordflow">else</span>
<a name="l00952"></a>00952       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot;%s [ TYPE: %s (%d) SUBCLASS: %s (%d) ] [%s]\n&quot;</span>,  
<a name="l00953"></a>00953              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cp, <a class="code" href="http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a>, <a class="code" href="term_8h.html#aee88b2ffd7fd2128fe38896cffb1a71a">COLOR_BRMAGENTA</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cp)),
<a name="l00954"></a>00954              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cft, ftype, <a class="code" href="term_8h.html#a1851f8a3f25e5caf6183dc44af070d0d">COLOR_BRRED</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cft)),
<a name="l00955"></a>00955              f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>, 
<a name="l00956"></a>00956              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(csub, subclass, <a class="code" href="term_8h.html#a23aeefae76b2cacc1a6162de88c3fff0">COLOR_BRCYAN</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(csub)),
<a name="l00957"></a>00957              f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>, 
<a name="l00958"></a>00958              <a class="code" href="term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(cn, <a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="code" href="term_8h.html#a4534b577b74a58b0f4b7be027af664e0">COLOR_YELLOW</a>, <a class="code" href="term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>, <span class="keyword">sizeof</span>(cn)));
<a name="l00959"></a>00959 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c004d3820bcf6ba492be693b67e1869"></a><!-- doxytag: member="frame.c::ast_frame_free" ref="a3c004d3820bcf6ba492be693b67e1869" args="(struct ast_frame *frame, int cache)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_frame_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>fr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cache</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Requests a frame to be allocated. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>Request a frame be allocated. source is an optional source of the frame, len is the requested length, or "0" if the caller will supply the buffer</td></tr>
  </table>
  </dd>
</dl>
<p>Frees a frame or list of frames </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fr</em>&nbsp;</td><td>Frame to free, or head of list to free </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cache</em>&nbsp;</td><td>Whether to consider this frame for frame caching </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00373">373</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00333">__frame_free()</a>, and <a class="el" href="linkedlists_8h_source.html#l00438">AST_LIST_NEXT</a>.</p>

<p>Referenced by <a class="el" href="app__mixmonitor_8c_source.html#l00280">mixmonitor_thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00374"></a>00374 {
<a name="l00375"></a>00375    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *next;
<a name="l00376"></a>00376 
<a name="l00377"></a>00377    <span class="keywordflow">for</span> (next = <a class="code" href="linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6" title="Returns the next entry in the list after the given entry.">AST_LIST_NEXT</a>(frame, frame_list);
<a name="l00378"></a>00378         frame;
<a name="l00379"></a>00379         frame = next, next = frame ? <a class="code" href="linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6" title="Returns the next entry in the list after the given entry.">AST_LIST_NEXT</a>(frame, frame_list) : NULL) {
<a name="l00380"></a>00380       <a class="code" href="frame_8c.html#aa621becb506e6b6c3c2a098944a14da8">__frame_free</a>(frame, cache);
<a name="l00381"></a>00381    }
<a name="l00382"></a>00382 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa3c3bdf906f259cea0aa33d7218b0e1e"></a><!-- doxytag: member="frame.c::ast_frame_header_new" ref="aa3c3bdf906f259cea0aa33d7218b0e1e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_frame_header_new </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00291">291</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="astmm_8h_source.html#l00075">ast_calloc_cache</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="frame_8h_source.html#l00207">AST_MALLOCD_HDR</a>, <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="format__g726_8c_source.html#l00177">f</a>, <a class="el" href="frame_8c_source.html#l00047">frame_cache</a>, <a class="el" href="iax2-parser_8c_source.html#l00045">frames</a>, <a class="el" href="frame_8c_source.html#l00065">ast_frame_cache::list</a>, <a class="el" href="frame_8h_source.html#l00151">ast_frame::mallocd</a>, <a class="el" href="frame_8h_source.html#l00153">ast_frame::mallocd_hdr_len</a>, and <a class="el" href="frame_8c_source.html#l00066">ast_frame_cache::size</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00389">ast_frisolate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00292"></a>00292 {
<a name="l00293"></a>00293    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>;
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00296"></a>00296 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structast__frame__cache.html">ast_frame_cache</a> *<a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a>;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298    <span class="keywordflow">if</span> ((frames = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;<a class="code" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>, <span class="keyword">sizeof</span>(*frames)))) {
<a name="l00299"></a>00299       <span class="keywordflow">if</span> ((f = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;frames-&gt;<a class="code" href="structast__frame__cache.html#a9c7b49f68e5d958a09c3628a40a4206f">list</a>, frame_list))) {
<a name="l00300"></a>00300          <span class="keywordtype">size_t</span> mallocd_len = f-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a>;
<a name="l00301"></a>00301          memset(f, 0, <span class="keyword">sizeof</span>(*f));
<a name="l00302"></a>00302          f-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a> = mallocd_len;
<a name="l00303"></a>00303          f-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a>;
<a name="l00304"></a>00304          frames-&gt;<a class="code" href="structast__frame__cache.html#a854352f53b148adc24983a58a1866d66">size</a>--;
<a name="l00305"></a>00305          <span class="keywordflow">return</span> f;
<a name="l00306"></a>00306       }
<a name="l00307"></a>00307    }
<a name="l00308"></a>00308    <span class="keywordflow">if</span> (!(f = <a class="code" href="astmm_8h.html#a690471dda49603174e7dd93a29fea87a">ast_calloc_cache</a>(1, <span class="keyword">sizeof</span>(*f))))
<a name="l00309"></a>00309       <span class="keywordflow">return</span> NULL;
<a name="l00310"></a>00310 <span class="preprocessor">#else</span>
<a name="l00311"></a>00311 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (!(f = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*f))))
<a name="l00312"></a>00312       <span class="keywordflow">return</span> NULL;
<a name="l00313"></a>00313 <span class="preprocessor">#endif</span>
<a name="l00314"></a>00314 <span class="preprocessor"></span>
<a name="l00315"></a>00315    f-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a> = <span class="keyword">sizeof</span>(*f);
<a name="l00316"></a>00316    
<a name="l00317"></a>00317    <span class="keywordflow">return</span> f;
<a name="l00318"></a>00318 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab819ef38276be16fede1c39cfcc8306c"></a><!-- doxytag: member="frame.c::ast_frame_slinear_sum" ref="ab819ef38276be16fede1c39cfcc8306c" args="(struct ast_frame *f1, struct ast_frame *f2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_frame_slinear_sum </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sums two frames of audio samples. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f1</em>&nbsp;</td><td>The first frame (which will contain the result) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f2</em>&nbsp;</td><td>The second frame </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 for success, non-zero for an error</dd></dl>
<p>The frames must be AST_FRAME_VOICE and must contain AST_FORMAT_SLINEAR samples, and must contain the same <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01554">1554</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="utils_8h_source.html#l00271">ast_slinear_saturated_add()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, and <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01555"></a>01555 {
<a name="l01556"></a>01556    <span class="keywordtype">int</span> count;
<a name="l01557"></a>01557    <span class="keywordtype">short</span> *data1, *data2;
<a name="l01558"></a>01558 
<a name="l01559"></a>01559    <span class="keywordflow">if</span> ((f1-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) || (f1-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> != <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>))
<a name="l01560"></a>01560       <span class="keywordflow">return</span> -1;
<a name="l01561"></a>01561 
<a name="l01562"></a>01562    <span class="keywordflow">if</span> ((f2-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) || (f2-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> != <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>))
<a name="l01563"></a>01563       <span class="keywordflow">return</span> -1;
<a name="l01564"></a>01564 
<a name="l01565"></a>01565    <span class="keywordflow">if</span> (f1-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> != f2-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>)
<a name="l01566"></a>01566       <span class="keywordflow">return</span> -1;
<a name="l01567"></a>01567 
<a name="l01568"></a>01568    <span class="keywordflow">for</span> (count = 0, data1 = f1-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, data2 = f2-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;
<a name="l01569"></a>01569         count &lt; f1-&gt;samples;
<a name="l01570"></a>01570         count++, data1++, data2++)
<a name="l01571"></a>01571       <a class="code" href="utils_8h.html#a8761597fec2f8a17d105a82c20d0b728">ast_slinear_saturated_add</a>(data1, data2);
<a name="l01572"></a>01572 
<a name="l01573"></a>01573    <span class="keywordflow">return</span> 0;
<a name="l01574"></a>01574 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2a467ce3424859d1b6194c93f2cc05f5"></a><!-- doxytag: member="frame.c::ast_frdup" ref="a2a467ce3424859d1b6194c93f2cc05f5" args="(const struct ast_frame *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_frdup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>fr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copies a frame. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fr</em>&nbsp;</td><td>frame to copy Duplicates a frame -- should only rarely be used, typically frisolate is good enough </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns a frame on success, NULL on error </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00474">474</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00075">ast_calloc_cache</a>, <a class="el" href="utils_8h_source.html#l00082">ast_copy_flags</a>, <a class="el" href="frame_8h_source.html#l00128">AST_FRFLAG_HAS_TIMING_INFO</a>, <a class="el" href="frame_8h_source.html#l00203">AST_FRIENDLY_OFFSET</a>, <a class="el" href="linkedlists_8h_source.html#l00553">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00599">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="frame_8h_source.html#l00207">AST_MALLOCD_HDR</a>, <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8h_source.html#l00161">ast_frame::delivery</a>, <a class="el" href="frame_8c_source.html#l00047">frame_cache</a>, <a class="el" href="iax2-parser_8c_source.html#l00045">frames</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8h_source.html#l00169">ast_frame::len</a>, <a class="el" href="func__strings_8c_source.html#l00821">len()</a>, <a class="el" href="frame_8c_source.html#l00065">ast_frame_cache::list</a>, <a class="el" href="frame_8h_source.html#l00151">ast_frame::mallocd</a>, <a class="el" href="frame_8h_source.html#l00153">ast_frame::mallocd_hdr_len</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="frame_8h_source.html#l00171">ast_frame::seqno</a>, <a class="el" href="frame_8c_source.html#l00066">ast_frame_cache::size</a>, <a class="el" href="frame_8h_source.html#l00157">ast_frame::src</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, <a class="el" href="frame_8h_source.html#l00167">ast_frame::ts</a>, and <a class="el" href="frame_8h_source.html#l00159">ast_frame::uint32</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l00991">__ast_queue_frame()</a>, <a class="el" href="frame_8c_source.html#l00389">ast_frisolate()</a>, <a class="el" href="abstract__jb_8c_source.html#l00303">ast_jb_put()</a>, <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>, <a class="el" href="slinfactory_8c_source.html#l00073">ast_slinfactory_feed()</a>, <a class="el" href="audiohook_8c_source.html#l00197">audiohook_read_frame_both()</a>, <a class="el" href="audiohook_8c_source.html#l00169">audiohook_read_frame_single()</a>, <a class="el" href="autoservice_8c_source.html#l00073">autoservice_run()</a>, <a class="el" href="app__meetme_8c_source.html#l04359">recordthread()</a>, <a class="el" href="app__rpt_8c_source.html#l10730">rpt()</a>, and <a class="el" href="app__rpt_8c_source.html#l13122">rpt_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00475"></a>00475 {
<a name="l00476"></a>00476    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *out = NULL;
<a name="l00477"></a>00477    <span class="keywordtype">int</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, srclen = 0;
<a name="l00478"></a>00478    <span class="keywordtype">void</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> = NULL;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structast__frame__cache.html">ast_frame_cache</a> *<a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a>;
<a name="l00482"></a>00482 <span class="preprocessor">#endif</span>
<a name="l00483"></a>00483 <span class="preprocessor"></span>
<a name="l00484"></a>00484    <span class="comment">/* Start with standard stuff */</span>
<a name="l00485"></a>00485    len = <span class="keyword">sizeof</span>(*out) + <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a> + f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00486"></a>00486    <span class="comment">/* If we have a source, add space for it */</span>
<a name="l00487"></a>00487    <span class="comment">/*</span>
<a name="l00488"></a>00488 <span class="comment">    * XXX Watch out here - if we receive a src which is not terminated</span>
<a name="l00489"></a>00489 <span class="comment">    * properly, we can be easily attacked. Should limit the size we deal with.</span>
<a name="l00490"></a>00490 <span class="comment">    */</span>
<a name="l00491"></a>00491    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>)
<a name="l00492"></a>00492       srclen = strlen(f-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>);
<a name="l00493"></a>00493    <span class="keywordflow">if</span> (srclen &gt; 0)
<a name="l00494"></a>00494       len += srclen + 1;
<a name="l00495"></a>00495    
<a name="l00496"></a>00496 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((frames = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;<a class="code" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>, <span class="keyword">sizeof</span>(*frames)))) {
<a name="l00498"></a>00498       <a class="code" href="linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d" title="Loops safely over (traverses) the entries in a list.">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;frames-&gt;<a class="code" href="structast__frame__cache.html#a9c7b49f68e5d958a09c3628a40a4206f">list</a>, out, frame_list) {
<a name="l00499"></a>00499          <span class="keywordflow">if</span> (out-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a> &gt;= len) {
<a name="l00500"></a>00500             <span class="keywordtype">size_t</span> mallocd_len = out-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a>;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502             <a class="code" href="linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c" title="Removes the current entry from a list during a traversal.">AST_LIST_REMOVE_CURRENT</a>(frame_list);
<a name="l00503"></a>00503             memset(out, 0, <span class="keyword">sizeof</span>(*out));
<a name="l00504"></a>00504             out-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a> = mallocd_len;
<a name="l00505"></a>00505             buf = out;
<a name="l00506"></a>00506             frames-&gt;<a class="code" href="structast__frame__cache.html#a854352f53b148adc24983a58a1866d66">size</a>--;
<a name="l00507"></a>00507             <span class="keywordflow">break</span>;
<a name="l00508"></a>00508          }
<a name="l00509"></a>00509       }
<a name="l00510"></a>00510       <a class="code" href="linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9" title="Closes a safe loop traversal block.">AST_LIST_TRAVERSE_SAFE_END</a>;
<a name="l00511"></a>00511    }
<a name="l00512"></a>00512 <span class="preprocessor">#endif</span>
<a name="l00513"></a>00513 <span class="preprocessor"></span>
<a name="l00514"></a>00514    <span class="keywordflow">if</span> (!buf) {
<a name="l00515"></a>00515       <span class="keywordflow">if</span> (!(buf = <a class="code" href="astmm_8h.html#a690471dda49603174e7dd93a29fea87a">ast_calloc_cache</a>(1, len)))
<a name="l00516"></a>00516          <span class="keywordflow">return</span> NULL;
<a name="l00517"></a>00517       out = buf;
<a name="l00518"></a>00518       out-&gt;<a class="code" href="structast__frame.html#a8cbff4a8245f6b7d82c011261cf1fb4d">mallocd_hdr_len</a> = len;
<a name="l00519"></a>00519    }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521    out-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>;
<a name="l00522"></a>00522    out-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l00523"></a>00523    out-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00524"></a>00524    out-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;
<a name="l00525"></a>00525    out-&gt;<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a> = f-&gt;<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>;
<a name="l00526"></a>00526    <span class="comment">/* Set us as having malloc&apos;d header only, so it will eventually</span>
<a name="l00527"></a>00527 <span class="comment">      get freed. */</span>
<a name="l00528"></a>00528    out-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a>;
<a name="l00529"></a>00529    out-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00530"></a>00530    <span class="keywordflow">if</span> (out-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>) {
<a name="l00531"></a>00531       out-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = buf + <span class="keyword">sizeof</span>(*out) + <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00532"></a>00532       memcpy(out-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, out-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);  
<a name="l00533"></a>00533    } <span class="keywordflow">else</span> {
<a name="l00534"></a>00534       out-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a> = f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a>;
<a name="l00535"></a>00535    }
<a name="l00536"></a>00536    <span class="keywordflow">if</span> (srclen &gt; 0) {
<a name="l00537"></a>00537       <span class="comment">/* This may seem a little strange, but it&apos;s to avoid a gcc (4.2.4) compiler warning */</span>
<a name="l00538"></a>00538       <span class="keywordtype">char</span> *src;
<a name="l00539"></a>00539       out-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = buf + <span class="keyword">sizeof</span>(*out) + <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a> + f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00540"></a>00540       src = (<span class="keywordtype">char</span> *) out-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>;
<a name="l00541"></a>00541       <span class="comment">/* Must have space since we allocated for it */</span>
<a name="l00542"></a>00542       strcpy(src, f-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>);
<a name="l00543"></a>00543    }
<a name="l00544"></a>00544    <a class="code" href="utils_8h.html#ab9da1c7265610eff83ed6146f104dc6f">ast_copy_flags</a>(out, f, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058ae8f674e19f6450e2b746c8a52c11649a">AST_FRFLAG_HAS_TIMING_INFO</a>);
<a name="l00545"></a>00545    out-&gt;<a class="code" href="structast__frame.html#a1eb46dcb363821328c0d2a758549216b">ts</a> = f-&gt;<a class="code" href="structast__frame.html#a1eb46dcb363821328c0d2a758549216b">ts</a>;
<a name="l00546"></a>00546    out-&gt;<a class="code" href="structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a> = f-&gt;<a class="code" href="structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a>;
<a name="l00547"></a>00547    out-&gt;<a class="code" href="structast__frame.html#ab793262012344621455faf9266acbac2">seqno</a> = f-&gt;<a class="code" href="structast__frame.html#ab793262012344621455faf9266acbac2">seqno</a>;
<a name="l00548"></a>00548    <span class="keywordflow">return</span> out;
<a name="l00549"></a>00549 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa7dbd9b12889d9f96fb6c01f94b4909e"></a><!-- doxytag: member="frame.c::ast_frisolate" ref="aa7dbd9b12889d9f96fb6c01f94b4909e" args="(struct ast_frame *fr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_frisolate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>fr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>'isolates' a frame by duplicating non-malloc'ed components (header, src, data). On return all components are malloc'ed </p>
<p>Makes a frame independent of any static storage. </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00389">389</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00075">ast_clear_flag</a>, <a class="el" href="utils_8h_source.html#l00082">ast_copy_flags</a>, <a class="el" href="frame_8c_source.html#l00291">ast_frame_header_new()</a>, <a class="el" href="frame_8c_source.html#l00474">ast_frdup()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="frame_8h_source.html#l00136">AST_FRFLAG_FROM_DSP</a>, <a class="el" href="frame_8h_source.html#l00132">AST_FRFLAG_FROM_TRANSLATOR</a>, <a class="el" href="frame_8h_source.html#l00128">AST_FRFLAG_HAS_TIMING_INFO</a>, <a class="el" href="frame_8h_source.html#l00203">AST_FRIENDLY_OFFSET</a>, <a class="el" href="astmm_8h_source.html#l00081">ast_malloc</a>, <a class="el" href="frame_8h_source.html#l00209">AST_MALLOCD_DATA</a>, <a class="el" href="frame_8h_source.html#l00207">AST_MALLOCD_HDR</a>, <a class="el" href="frame_8h_source.html#l00211">AST_MALLOCD_SRC</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="utils_8h_source.html#l00061">ast_test_flag</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8h_source.html#l00169">ast_frame::len</a>, <a class="el" href="frame_8h_source.html#l00151">ast_frame::mallocd</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="frame_8h_source.html#l00171">ast_frame::seqno</a>, <a class="el" href="frame_8h_source.html#l00157">ast_frame::src</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, <a class="el" href="frame_8h_source.html#l00167">ast_frame::ts</a>, and <a class="el" href="frame_8h_source.html#l00159">ast_frame::uint32</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l01850">__ast_answer()</a>, <a class="el" href="slinfactory_8c_source.html#l00073">ast_slinfactory_feed()</a>, <a class="el" href="channel_8c_source.html#l03411">ast_write()</a>, <a class="el" href="autoservice_8c_source.html#l00073">autoservice_run()</a>, <a class="el" href="format__jpeg_8c_source.html#l00036">jpeg_read_image()</a>, and <a class="el" href="file_8c_source.html#l00695">read_frame()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00390"></a>00390 {
<a name="l00391"></a>00391    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *out;
<a name="l00392"></a>00392    <span class="keywordtype">void</span> *newdata;
<a name="l00393"></a>00393 
<a name="l00394"></a>00394    <span class="comment">/* if none of the existing frame is malloc&apos;d, let ast_frdup() do it</span>
<a name="l00395"></a>00395 <span class="comment">      since it is more efficient</span>
<a name="l00396"></a>00396 <span class="comment">   */</span>
<a name="l00397"></a>00397    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> == 0) {
<a name="l00398"></a>00398       <span class="keywordflow">return</span> <a class="code" href="frame_8h.html#a4b23720d208128250a765490b1a4f145" title="Copies a frame.">ast_frdup</a>(fr);
<a name="l00399"></a>00399    }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401    <span class="comment">/* if everything is already malloc&apos;d, we are done */</span>
<a name="l00402"></a>00402    <span class="keywordflow">if</span> ((fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; (<a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a> | <a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a> | <a class="code" href="frame_8h.html#a700f5f786d7e5a985387e5ce40c47a6a">AST_MALLOCD_DATA</a>)) ==
<a name="l00403"></a>00403        (<a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a> | <a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a> | <a class="code" href="frame_8h.html#a700f5f786d7e5a985387e5ce40c47a6a">AST_MALLOCD_DATA</a>)) {
<a name="l00404"></a>00404       <span class="keywordflow">return</span> fr;
<a name="l00405"></a>00405    }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407    <span class="keywordflow">if</span> (!(fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a>)) {
<a name="l00408"></a>00408       <span class="comment">/* Allocate a new header if needed */</span>
<a name="l00409"></a>00409       <span class="keywordflow">if</span> (!(out = <a class="code" href="frame_8c.html#aa3c3bdf906f259cea0aa33d7218b0e1e">ast_frame_header_new</a>())) {
<a name="l00410"></a>00410          <span class="keywordflow">return</span> NULL;
<a name="l00411"></a>00411       }
<a name="l00412"></a>00412       out-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = fr-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>;
<a name="l00413"></a>00413       out-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = fr-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l00414"></a>00414       out-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = fr-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00415"></a>00415       out-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = fr-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;
<a name="l00416"></a>00416       out-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = fr-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a>;
<a name="l00417"></a>00417       <span class="comment">/* Copy the timing data */</span>
<a name="l00418"></a>00418       <a class="code" href="utils_8h.html#ab9da1c7265610eff83ed6146f104dc6f">ast_copy_flags</a>(out, fr, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058ae8f674e19f6450e2b746c8a52c11649a">AST_FRFLAG_HAS_TIMING_INFO</a>);
<a name="l00419"></a>00419       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(fr, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058ae8f674e19f6450e2b746c8a52c11649a">AST_FRFLAG_HAS_TIMING_INFO</a>)) {
<a name="l00420"></a>00420          out-&gt;<a class="code" href="structast__frame.html#a1eb46dcb363821328c0d2a758549216b">ts</a> = fr-&gt;<a class="code" href="structast__frame.html#a1eb46dcb363821328c0d2a758549216b">ts</a>;
<a name="l00421"></a>00421          out-&gt;<a class="code" href="structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a> = fr-&gt;<a class="code" href="structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a>;
<a name="l00422"></a>00422          out-&gt;<a class="code" href="structast__frame.html#ab793262012344621455faf9266acbac2">seqno</a> = fr-&gt;<a class="code" href="structast__frame.html#ab793262012344621455faf9266acbac2">seqno</a>;
<a name="l00423"></a>00423       }
<a name="l00424"></a>00424    } <span class="keywordflow">else</span> {
<a name="l00425"></a>00425       <a class="code" href="utils_8h.html#a7b260320610a09017a9416398acd0a70">ast_clear_flag</a>(fr, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058a4a242fff9bd02b02c64a1515a85e15ce">AST_FRFLAG_FROM_TRANSLATOR</a>);
<a name="l00426"></a>00426       <a class="code" href="utils_8h.html#a7b260320610a09017a9416398acd0a70">ast_clear_flag</a>(fr, <a class="code" href="frame_8h.html#a0ae1e3bf78c960c83e2d437efd802058a7500f97b39b4d91f3df7daa2435fc8fe">AST_FRFLAG_FROM_DSP</a>);
<a name="l00427"></a>00427       out = fr;
<a name="l00428"></a>00428    }
<a name="l00429"></a>00429    
<a name="l00430"></a>00430    <span class="keywordflow">if</span> (!(fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; <a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a>) &amp;&amp; fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>) {
<a name="l00431"></a>00431       <span class="keywordflow">if</span> (!(out-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>))) {
<a name="l00432"></a>00432          <span class="keywordflow">if</span> (out != fr) {
<a name="l00433"></a>00433             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(out);
<a name="l00434"></a>00434          }
<a name="l00435"></a>00435          <span class="keywordflow">return</span> NULL;
<a name="l00436"></a>00436       }
<a name="l00437"></a>00437    } <span class="keywordflow">else</span> {
<a name="l00438"></a>00438       out-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>;
<a name="l00439"></a>00439       fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = NULL;
<a name="l00440"></a>00440       fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp;= ~<a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a>;
<a name="l00441"></a>00441    }
<a name="l00442"></a>00442    
<a name="l00443"></a>00443    <span class="keywordflow">if</span> (!(fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp; <a class="code" href="frame_8h.html#a700f5f786d7e5a985387e5ce40c47a6a">AST_MALLOCD_DATA</a>))  {
<a name="l00444"></a>00444       <span class="keywordflow">if</span> (!fr-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>) {
<a name="l00445"></a>00445          out-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a> = fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a>;
<a name="l00446"></a>00446          out-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a> | <a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a>;
<a name="l00447"></a>00447          <span class="keywordflow">return</span> out;
<a name="l00448"></a>00448       }
<a name="l00449"></a>00449       <span class="keywordflow">if</span> (!(newdata = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(fr-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> + <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>))) {
<a name="l00450"></a>00450          <span class="keywordflow">if</span> (out-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> != fr-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>) {
<a name="l00451"></a>00451             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">void</span> *) out-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>);
<a name="l00452"></a>00452          }
<a name="l00453"></a>00453          <span class="keywordflow">if</span> (out != fr) {
<a name="l00454"></a>00454             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(out);
<a name="l00455"></a>00455          }
<a name="l00456"></a>00456          <span class="keywordflow">return</span> NULL;
<a name="l00457"></a>00457       }
<a name="l00458"></a>00458       newdata += <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00459"></a>00459       out-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00460"></a>00460       out-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = fr-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00461"></a>00461       memcpy(newdata, fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, fr-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);
<a name="l00462"></a>00462       out-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = newdata;
<a name="l00463"></a>00463    } <span class="keywordflow">else</span> {
<a name="l00464"></a>00464       out-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a> = fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>;
<a name="l00465"></a>00465       memset(&amp;fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 0, <span class="keyword">sizeof</span>(fr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>));
<a name="l00466"></a>00466       fr-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> &amp;= ~<a class="code" href="frame_8h.html#a700f5f786d7e5a985387e5ce40c47a6a">AST_MALLOCD_DATA</a>;
<a name="l00467"></a>00467    }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469    out-&gt;<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = <a class="code" href="frame_8h.html#a22c49dfda592a2adb1fbaeaaa6ed3b7f">AST_MALLOCD_HDR</a> | <a class="code" href="frame_8h.html#aa1644c06703f3d2e61318b559a090685">AST_MALLOCD_SRC</a> | <a class="code" href="frame_8h.html#a700f5f786d7e5a985387e5ce40c47a6a">AST_MALLOCD_DATA</a>;
<a name="l00470"></a>00470    
<a name="l00471"></a>00471    <span class="keywordflow">return</span> out;
<a name="l00472"></a>00472 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7a74b26c677d2372f9b90b3a38d03b14"></a><!-- doxytag: member="frame.c::ast_get_format_list" ref="a7a74b26c677d2372f9b90b3a38d03b14" args="(size_t *size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__format__list.html">ast_format_list</a>* ast_get_format_list </td>
          <td>(</td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>size</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00567">567</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00568"></a>00568 {
<a name="l00569"></a>00569    *size = <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>);
<a name="l00570"></a>00570    <span class="keywordflow">return</span> <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>;
<a name="l00571"></a>00571 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4f8e9142a346cf35e65200969b587ca"></a><!-- doxytag: member="frame.c::ast_get_format_list_index" ref="ae4f8e9142a346cf35e65200969b587ca" args="(int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__format__list.html">ast_format_list</a>* ast_get_format_list_index </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00562">562</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00563"></a>00563 {
<a name="l00564"></a>00564    <span class="keywordflow">return</span> &amp;<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[idx];
<a name="l00565"></a>00565 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2cf30450cd1821bfbc77d2d9e3605363"></a><!-- doxytag: member="frame.c::ast_getformatbyname" ref="a2cf30450cd1821bfbc77d2d9e3605363" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_getformatbyname </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets a format from a name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>string of format </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the form of the format in binary on success, 0 on error. </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00636">636</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8c_source.html#l00625">ast_expand_codec_alias()</a>, <a class="el" href="frame_8h_source.html#l00430">ast_format_list::bits</a>, and <a class="el" href="cdr__custom_8c_source.html#l00058">format</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01233">ast_parse_allow_disallow()</a>, <a class="el" href="iax2-provision_8c_source.html#l00277">iax_template_parse()</a>, <a class="el" href="res__musiconhold_8c_source.html#l01549">load_moh_classes()</a>, <a class="el" href="res__musiconhold_8c_source.html#l01223">local_ast_moh_start()</a>, <a class="el" href="chan__mgcp_8c_source.html#l04076">reload_config()</a>, and <a class="el" href="chan__sip_8c_source.html#l06163">try_suggested_sip_codec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00637"></a>00637 {
<a name="l00638"></a>00638    <span class="keywordtype">int</span> x, all, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> = 0;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640    all = strcasecmp(<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="stringliteral">&quot;all&quot;</span>) ? 0 : 1;
<a name="l00641"></a>00641    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l00642"></a>00642       <span class="keywordflow">if</span> (all || 
<a name="l00643"></a>00643            !strcasecmp(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>,name) ||
<a name="l00644"></a>00644            !strcasecmp(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].name, <a class="code" href="frame_8c.html#a8ce634275e2d4e37422332eb8fbdc5dd">ast_expand_codec_alias</a>(name))) {
<a name="l00645"></a>00645          format |= <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="structast__format__list.html#ad1e28a1a66a25529b0b61b9ca4e66d44">bits</a>;
<a name="l00646"></a>00646          <span class="keywordflow">if</span> (!all)
<a name="l00647"></a>00647             <span class="keywordflow">break</span>;
<a name="l00648"></a>00648       }
<a name="l00649"></a>00649    }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651    <span class="keywordflow">return</span> format;
<a name="l00652"></a>00652 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afe8f690984f8ba95cd01a431198c10bf"></a><!-- doxytag: member="frame.c::ast_getformatname" ref="afe8f690984f8ba95cd01a431198c10bf" args="(int format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_getformatname </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of a format. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>id of format </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A static string containing the name of the format or "unknown" if unknown. </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00573">573</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8h_source.html#l00430">ast_format_list::bits</a>, and <a class="el" href="frame_8h_source.html#l00431">ast_format_list::name</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l00668">__ast_play_and_record()</a>, <a class="el" href="channel_8c_source.html#l02636">__ast_read()</a>, <a class="el" href="translate_8c_source.html#l00621">__ast_register_translator()</a>, <a class="el" href="chan__sip_8c_source.html#l15349">_sip_show_peer()</a>, <a class="el" href="chan__skinny_8c_source.html#l03337">_skinny_show_line()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00274">add_codec_to_answer()</a>, <a class="el" href="chan__sip_8c_source.html#l09822">add_codec_to_sdp()</a>, <a class="el" href="chan__sip_8c_source.html#l09902">add_tcodec_to_sdp()</a>, <a class="el" href="chan__sip_8c_source.html#l09879">add_vcodec_to_sdp()</a>, <a class="el" href="chan__agent_8c_source.html#l00770">agent_call()</a>, <a class="el" href="frame_8c_source.html#l01484">ast_codec_get_len()</a>, <a class="el" href="frame_8c_source.html#l01431">ast_codec_get_samples()</a>, <a class="el" href="frame_8c_source.html#l00997">ast_codec_pref_string()</a>, <a class="el" href="dsp_8c_source.html#l01306">ast_dsp_process()</a>, <a class="el" href="frame_8c_source.html#l00756">ast_frame_dump()</a>, <a class="el" href="file_8c_source.html#l00662">ast_openvstream()</a>, <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>, <a class="el" href="slinfactory_8c_source.html#l00073">ast_slinfactory_feed()</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, <a class="el" href="translate_8c_source.html#l00263">ast_translator_build_path()</a>, <a class="el" href="translate_8c_source.html#l00719">ast_unregister_translator()</a>, <a class="el" href="file_8c_source.html#l00144">ast_writestream()</a>, <a class="el" href="app__talkdetect_8c_source.html#l00076">background_detect_exec()</a>, <a class="el" href="bridging_8c_source.html#l00860">bridge_channel_join()</a>, <a class="el" href="bridging_8c_source.html#l00538">bridge_make_compatible()</a>, <a class="el" href="chan__dahdi_8c_source.html#l06717">dahdi_read()</a>, <a class="el" href="app__waitforsilence_8c_source.html#l00125">do_waiting()</a>, <a class="el" href="res__agi_8c_source.html#l03287">eagi_exec()</a>, <a class="el" href="func__channel_8c_source.html#l00230">func_channel_read()</a>, <a class="el" href="chan__iax2_8c_source.html#l13324">function_iaxpeer()</a>, <a class="el" href="chan__sip_8c_source.html#l17269">function_sippeer()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01683">gtalk_show_channels()</a>, <a class="el" href="file_8c_source.html#l01430">handle_cli_core_show_file_formats()</a>, <a class="el" href="translate_8c_source.html#l00518">handle_cli_core_show_translation()</a>, <a class="el" href="chan__iax2_8c_source.html#l06825">handle_cli_iax2_show_channels()</a>, <a class="el" href="chan__iax2_8c_source.html#l03568">handle_cli_iax2_show_peer()</a>, <a class="el" href="res__musiconhold_8c_source.html#l01717">handle_cli_moh_show_classes()</a>, <a class="el" href="image_8c_source.html#l00169">handle_core_show_image_formats()</a>, <a class="el" href="chan__iax2_8c_source.html#l11561">iax2_request()</a>, <a class="el" href="iax2-provision_8c_source.html#l00431">iax_show_provisioning()</a>, <a class="el" href="chan__jingle_8c_source.html#l01513">jingle_show_channels()</a>, <a class="el" href="chan__agent_8c_source.html#l01981">login_exec()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00830">moh_release()</a>, <a class="el" href="chan__h323_8c_source.html#l00748">oh323_rtp_read()</a>, <a class="el" href="chan__phone_8c_source.html#l00388">phone_setup()</a>, <a class="el" href="chan__sip_8c_source.html#l15155">print_codec_to_cli()</a>, <a class="el" href="translate_8c_source.html#l00446">rebuild_matrix()</a>, <a class="el" href="codec__dahdi_8c_source.html#l00479">register_translator()</a>, <a class="el" href="channel_8c_source.html#l03673">set_format()</a>, <a class="el" href="chan__h323_8c_source.html#l02473">set_local_capabilities()</a>, <a class="el" href="chan__h323_8c_source.html#l02438">set_peer_capabilities()</a>, <a class="el" href="frame_8c_source.html#l00667">show_codecs()</a>, <a class="el" href="chan__sip_8c_source.html#l23066">sip_request_call()</a>, <a class="el" href="chan__sip_8c_source.html#l06955">sip_rtp_read()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, <a class="el" href="chan__unistim_8c_source.html#l02028">start_rtp()</a>, <a class="el" href="chan__unistim_8c_source.html#l04619">unistim_request()</a>, <a class="el" href="chan__unistim_8c_source.html#l03905">unistim_rtp_read()</a>, and <a class="el" href="chan__unistim_8c_source.html#l03965">unistim_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00574"></a>00574 {
<a name="l00575"></a>00575    <span class="keywordtype">int</span> x;
<a name="l00576"></a>00576    <span class="keywordtype">char</span> *ret = <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l00577"></a>00577    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l00578"></a>00578       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].bits == <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l00579"></a>00579          ret = <a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="structast__format__list.html#a5ac083a645d964373f022d03df4849c8">name</a>;
<a name="l00580"></a>00580          <span class="keywordflow">break</span>;
<a name="l00581"></a>00581       }
<a name="l00582"></a>00582    }
<a name="l00583"></a>00583    <span class="keywordflow">return</span> ret;
<a name="l00584"></a>00584 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37cdc7e78686b0bfa4e47e645f782b30"></a><!-- doxytag: member="frame.c::ast_getformatname_multiple" ref="a37cdc7e78686b0bfa4e47e645f782b30" args="(char *buf, size_t size, int format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_getformatname_multiple </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the names of a set of <a class="el" href="structformats.html">formats</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>a buffer for the output string </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>size of buf (bytes) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>the format (combined IDs of codecs) Prints a list of readable codec names corresponding to "format". ex: for format=AST_FORMAT_GSM|AST_FORMAT_SPEEX|AST_FORMAT_ILBC it will return "0x602 (GSM|SPEEX|ILBC)" </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The return value is buf. </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00586">586</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="frame_8h_source.html#l00430">ast_format_list::bits</a>, <a class="el" href="func__strings_8c_source.html#l00821">len()</a>, and <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l02636">__ast_read()</a>, <a class="el" href="chan__sip_8c_source.html#l15349">_sip_show_peer()</a>, <a class="el" href="chan__skinny_8c_source.html#l03063">_skinny_show_device()</a>, <a class="el" href="chan__skinny_8c_source.html#l03337">_skinny_show_line()</a>, <a class="el" href="chan__sip_8c_source.html#l10016">add_sdp()</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, <a class="el" href="bridging_8c_source.html#l00538">bridge_make_compatible()</a>, <a class="el" href="chan__iax2_8c_source.html#l13324">function_iaxpeer()</a>, <a class="el" href="chan__sip_8c_source.html#l17269">function_sippeer()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00603">gtalk_is_answered()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01154">gtalk_newcall()</a>, <a class="el" href="chan__iax2_8c_source.html#l03568">handle_cli_iax2_show_peer()</a>, <a class="el" href="cli_8c_source.html#l01268">handle_showchan()</a>, <a class="el" href="chan__iax2_8c_source.html#l05170">iax2_bridge()</a>, <a class="el" href="chan__sip_8c_source.html#l08040">process_sdp()</a>, <a class="el" href="app__dumpchan_8c_source.html#l00065">serialize_showchan()</a>, <a class="el" href="channel_8c_source.html#l03673">set_format()</a>, <a class="el" href="chan__sip_8c_source.html#l16189">show_channels_cb()</a>, <a class="el" href="chan__sip_8c_source.html#l06599">sip_new()</a>, <a class="el" href="chan__sip_8c_source.html#l23066">sip_request_call()</a>, <a class="el" href="chan__sip_8c_source.html#l16415">sip_show_channel()</a>, <a class="el" href="chan__sip_8c_source.html#l15919">sip_show_settings()</a>, and <a class="el" href="chan__sip_8c_source.html#l06207">sip_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00587"></a>00587 {
<a name="l00588"></a>00588    <span class="keywordtype">int</span> x;
<a name="l00589"></a>00589    <span class="keywordtype">unsigned</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;
<a name="l00590"></a>00590    <span class="keywordtype">char</span> *start, *end = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00591"></a>00591 
<a name="l00592"></a>00592    <span class="keywordflow">if</span> (!size)
<a name="l00593"></a>00593       <span class="keywordflow">return</span> <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00594"></a>00594    snprintf(end, size, <span class="stringliteral">&quot;0x%x (&quot;</span>, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);
<a name="l00595"></a>00595    len = strlen(end);
<a name="l00596"></a>00596    end += len;
<a name="l00597"></a>00597    size -= len;
<a name="l00598"></a>00598    start = end;
<a name="l00599"></a>00599    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>); x++) {
<a name="l00600"></a>00600       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].bits &amp; <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>) {
<a name="l00601"></a>00601          snprintf(end, size,<span class="stringliteral">&quot;%s|&quot;</span>,<a class="code" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266" title="Definition of supported media formats (codecs).">AST_FORMAT_LIST</a>[x].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00602"></a>00602          len = strlen(end);
<a name="l00603"></a>00603          end += len;
<a name="l00604"></a>00604          size -= len;
<a name="l00605"></a>00605       }
<a name="l00606"></a>00606    }
<a name="l00607"></a>00607    <span class="keywordflow">if</span> (start == end)
<a name="l00608"></a>00608       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(start, <span class="stringliteral">&quot;nothing)&quot;</span>, size);
<a name="l00609"></a>00609    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size &gt; 1)
<a name="l00610"></a>00610       *(end -1) = <span class="charliteral">&apos;)&apos;</span>;
<a name="l00611"></a>00611    <span class="keywordflow">return</span> <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00612"></a>00612 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a35aa1fb72e1993a14156a6b912034ef9"></a><!-- doxytag: member="frame.c::ast_parse_allow_disallow" ref="a35aa1fb72e1993a14156a6b912034ef9" args="(struct ast_codec_pref *pref, int *mask, const char *list, int allowing)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_parse_allow_disallow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__codec__pref.html">ast_codec_pref</a> *&nbsp;</td>
          <td class="paramname"> <em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>allowing</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parse an "allow" or "deny" line in a channel or device configuration and update the capabilities mask and pref if provided. Video codecs are not added to codec preference lists, since we can not transcode. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns <a class="el" href="structnumber.html" title="Number structure.">number</a> of errors encountered during parsing </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l01233">1233</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l01071">ast_codec_pref_append()</a>, <a class="el" href="frame_8c_source.html#l01044">ast_codec_pref_remove()</a>, <a class="el" href="frame_8c_source.html#l01134">ast_codec_pref_setsize()</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="frame_8h_source.html#l00273">AST_FORMAT_AUDIO_MASK</a>, <a class="el" href="frame_8c_source.html#l00636">ast_getformatbyname()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="cdr__custom_8c_source.html#l00058">format</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__mgcp_8c_source.html#l01737">parse()</a>, and <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l02392">action_originate()</a>, <a class="el" href="pbx__spool_8c_source.html#l00110">apply_outgoing()</a>, <a class="el" href="chan__iax2_8c_source.html#l11880">build_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l12156">build_user()</a>, <a class="el" href="chan__skinny_8c_source.html#l06537">config_parse_variables()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01840">gtalk_create_member()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01901">gtalk_load_config()</a>, <a class="el" href="chan__jingle_8c_source.html#l01666">jingle_create_member()</a>, <a class="el" href="chan__jingle_8c_source.html#l01724">jingle_load_config()</a>, <a class="el" href="chan__sip_8c_source.html#l24245">reload_config()</a>, <a class="el" href="chan__iax2_8c_source.html#l12493">set_config()</a>, <a class="el" href="chan__skinny_8c_source.html#l01881">skinny_unregister()</a>, and <a class="el" href="chan__h323_8c_source.html#l01251">update_common_options()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01234"></a>01234 {
<a name="l01235"></a>01235    <span class="keywordtype">int</span> errors = 0;
<a name="l01236"></a>01236    <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a> = NULL, *<span class="keyword">this</span> = NULL, *psize = NULL;
<a name="l01237"></a>01237    <span class="keywordtype">int</span> <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> = 0, framems = 0;
<a name="l01238"></a>01238 
<a name="l01239"></a>01239    parse = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(list);
<a name="l01240"></a>01240    <span class="keywordflow">while</span> ((<span class="keyword">this</span> = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;parse, <span class="stringliteral">&quot;,&quot;</span>))) {
<a name="l01241"></a>01241       framems = 0;
<a name="l01242"></a>01242       <span class="keywordflow">if</span> ((psize = strrchr(<span class="keyword">this</span>, <span class="charliteral">&apos;:&apos;</span>))) {
<a name="l01243"></a>01243          *psize++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01244"></a>01244          <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Packetization for codec: %s is %s\n&quot;</span>, <span class="keyword">this</span>, psize);
<a name="l01245"></a>01245          framems = atoi(psize);
<a name="l01246"></a>01246          <span class="keywordflow">if</span> (framems &lt; 0) {
<a name="l01247"></a>01247             framems = 0;
<a name="l01248"></a>01248             errors++;
<a name="l01249"></a>01249             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bad packetization value for codec %s\n&quot;</span>, <span class="keyword">this</span>);
<a name="l01250"></a>01250          }
<a name="l01251"></a>01251       }
<a name="l01252"></a>01252       <span class="keywordflow">if</span> (!(format = <a class="code" href="frame_8h.html#a2cf30450cd1821bfbc77d2d9e3605363" title="Gets a format from a name.">ast_getformatbyname</a>(<span class="keyword">this</span>))) {
<a name="l01253"></a>01253          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot %s unknown format &apos;%s&apos;\n&quot;</span>, allowing ? <span class="stringliteral">&quot;allow&quot;</span> : <span class="stringliteral">&quot;disallow&quot;</span>, <span class="keyword">this</span>);
<a name="l01254"></a>01254          errors++;
<a name="l01255"></a>01255          <span class="keywordflow">continue</span>;
<a name="l01256"></a>01256       }
<a name="l01257"></a>01257 
<a name="l01258"></a>01258       <span class="keywordflow">if</span> (mask) {
<a name="l01259"></a>01259          <span class="keywordflow">if</span> (allowing)
<a name="l01260"></a>01260             *mask |= format;
<a name="l01261"></a>01261          <span class="keywordflow">else</span>
<a name="l01262"></a>01262             *mask &amp;= ~format;
<a name="l01263"></a>01263       }
<a name="l01264"></a>01264 
<a name="l01265"></a>01265       <span class="comment">/* Set up a preference list for audio. Do not include video in preferences </span>
<a name="l01266"></a>01266 <span class="comment">         since we can not transcode video and have to use whatever is offered</span>
<a name="l01267"></a>01267 <span class="comment">       */</span>
<a name="l01268"></a>01268       <span class="keywordflow">if</span> (pref &amp;&amp; (format &amp; <a class="code" href="frame_8h.html#a3f680b9c15596de927d507a664fd2803">AST_FORMAT_AUDIO_MASK</a>)) {
<a name="l01269"></a>01269          <span class="keywordflow">if</span> (strcasecmp(<span class="keyword">this</span>, <span class="stringliteral">&quot;all&quot;</span>)) {
<a name="l01270"></a>01270             <span class="keywordflow">if</span> (allowing) {
<a name="l01271"></a>01271                <a class="code" href="frame_8h.html#a54b0af0dfdc8466239e6babb9303f7b3" title="Append a audio codec to a preference list, removing it first if it was already there...">ast_codec_pref_append</a>(pref, format);
<a name="l01272"></a>01272                <a class="code" href="frame_8h.html#a6803881645ae33ff0618b3648d26aeaa" title="Set packet size for codec.">ast_codec_pref_setsize</a>(pref, format, framems);
<a name="l01273"></a>01273             }
<a name="l01274"></a>01274             <span class="keywordflow">else</span>
<a name="l01275"></a>01275                <a class="code" href="frame_8h.html#a8daa8fe39c23fc605881466efafa00f7" title="Remove audio a codec from a preference list.">ast_codec_pref_remove</a>(pref, format);
<a name="l01276"></a>01276          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!allowing) {
<a name="l01277"></a>01277             memset(pref, 0, <span class="keyword">sizeof</span>(*pref));
<a name="l01278"></a>01278          }
<a name="l01279"></a>01279       }
<a name="l01280"></a>01280    }
<a name="l01281"></a>01281    <span class="keywordflow">return</span> errors;
<a name="l01282"></a>01282 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6d3b71e0a81af743bae6c33c02b64f1f"></a><!-- doxytag: member="frame.c::ast_smoother_free" ref="a6d3b71e0a81af743bae6c33c02b64f1f" args="(struct ast_smoother *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_smoother_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00286">286</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l03058">ast_rtp_destroy()</a>, and <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00287"></a>00287 {
<a name="l00288"></a>00288    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(s);
<a name="l00289"></a>00289 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a22e621d6147c80f2dd12ff75c2d8d3cc"></a><!-- doxytag: member="frame.c::ast_smoother_get_flags" ref="a22e621d6147c80f2dd12ff75c2d8d3cc" args="(struct ast_smoother *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_smoother_get_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00186">186</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00084">ast_smoother::flags</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00187"></a>00187 {
<a name="l00188"></a>00188    <span class="keywordflow">return</span> s-&gt;<a class="code" href="structast__smoother.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;
<a name="l00189"></a>00189 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4cf7f3fd41e2c268159299ea54b36e33"></a><!-- doxytag: member="frame.c::ast_smoother_new" ref="a4cf7f3fd41e2c268159299ea54b36e33" args="(int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__smoother.html">ast_smoother</a>* ast_smoother_new </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00176">176</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00081">ast_malloc</a>, <a class="el" href="frame_8c_source.html#l00148">ast_smoother_reset()</a>, and <a class="el" href="aesopt_8h_source.html#l00399">s</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l03728">ast_rtp_codec_setpref()</a>, and <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00177"></a>00177 {
<a name="l00178"></a>00178    <span class="keyword">struct </span><a class="code" href="structast__smoother.html">ast_smoother</a> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l00179"></a>00179    <span class="keywordflow">if</span> (<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a> &lt; 1)
<a name="l00180"></a>00180       <span class="keywordflow">return</span> NULL;
<a name="l00181"></a>00181    <span class="keywordflow">if</span> ((s = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(*s))))
<a name="l00182"></a>00182       <a class="code" href="frame_8h.html#add7324cf0482ce24eaa13abdc00e115d">ast_smoother_reset</a>(s, <a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);
<a name="l00183"></a>00183    <span class="keywordflow">return</span> s;
<a name="l00184"></a>00184 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af8d6dcd265eaf403b1b1139770c885d8"></a><!-- doxytag: member="frame.c::ast_smoother_read" ref="af8d6dcd265eaf403b1b1139770c885d8" args="(struct ast_smoother *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_smoother_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00236">236</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00680">ast_format_rate()</a>, <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h_source.html#l00203">AST_FRIENDLY_OFFSET</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="time_8h_source.html#l00176">ast_samp2tv()</a>, <a class="el" href="frame_8h_source.html#l00354">AST_SMOOTHER_FLAG_G729</a>, <a class="el" href="utils_8c_source.html#l01365">ast_tvadd()</a>, <a class="el" href="time_8h_source.html#l00099">ast_tvzero()</a>, <a class="el" href="frame_8c_source.html#l00089">ast_smoother::data</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8c_source.html#l00088">ast_smoother::delivery</a>, <a class="el" href="frame_8h_source.html#l00161">ast_frame::delivery</a>, <a class="el" href="frame_8c_source.html#l00087">ast_smoother::f</a>, <a class="el" href="frame_8c_source.html#l00084">ast_smoother::flags</a>, <a class="el" href="frame_8c_source.html#l00083">ast_smoother::format</a>, <a class="el" href="frame_8c_source.html#l00090">ast_smoother::framedata</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8c_source.html#l00092">ast_smoother::len</a>, <a class="el" href="func__strings_8c_source.html#l00821">len()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8c_source.html#l00091">ast_smoother::opt</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="frame_8c_source.html#l00085">ast_smoother::samplesperbyte</a>, <a class="el" href="frame_8c_source.html#l00082">ast_smoother::size</a>, and <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00237"></a>00237 {
<a name="l00238"></a>00238    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *opt;
<a name="l00239"></a>00239    <span class="keywordtype">int</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;
<a name="l00240"></a>00240 
<a name="l00241"></a>00241    <span class="comment">/* IF we have an optimization frame, send it */</span>
<a name="l00242"></a>00242    <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a>) {
<a name="l00243"></a>00243       <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a>-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> &lt; <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>)
<a name="l00244"></a>00244          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Returning a frame of inappropriate offset (%d).\n&quot;</span>,
<a name="l00245"></a>00245                      s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a>-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a>);
<a name="l00246"></a>00246       opt = s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a>;
<a name="l00247"></a>00247       s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a> = NULL;
<a name="l00248"></a>00248       <span class="keywordflow">return</span> opt;
<a name="l00249"></a>00249    }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251    <span class="comment">/* Make sure we have enough data */</span>
<a name="l00252"></a>00252    <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> &lt; s-&gt;<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a>) {
<a name="l00253"></a>00253       <span class="comment">/* Or, if this is a G.729 frame with VAD on it, send it immediately anyway */</span>
<a name="l00254"></a>00254       <span class="keywordflow">if</span> (!((s-&gt;<a class="code" href="structast__smoother.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="frame_8h.html#a06828788896ac92282112bd8ffe12319">AST_SMOOTHER_FLAG_G729</a>) &amp;&amp; (s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> % 10)))
<a name="l00255"></a>00255          <span class="keywordflow">return</span> NULL;
<a name="l00256"></a>00256    }
<a name="l00257"></a>00257    len = s-&gt;<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;
<a name="l00258"></a>00258    <span class="keywordflow">if</span> (len &gt; s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a>)
<a name="l00259"></a>00259       len = s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a>;
<a name="l00260"></a>00260    <span class="comment">/* Make frame */</span>
<a name="l00261"></a>00261    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>;
<a name="l00262"></a>00262    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = s-&gt;<a class="code" href="structast__smoother.html#a317afff57d87a89158c2b038d37b2b08">format</a>;
<a name="l00263"></a>00263    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = s-&gt;<a class="code" href="structast__smoother.html#a9b5791c26a8c001bdd98e61634b7de5a">framedata</a> + <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00264"></a>00264    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00265"></a>00265    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = len;
<a name="l00266"></a>00266    <span class="comment">/* Samples will be improper given VAD, but with VAD the concept really doesn&apos;t even exist */</span>
<a name="l00267"></a>00267    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = len * s-&gt;<a class="code" href="structast__smoother.html#ace5328f4f85cf26835ca68604818271d">samplesperbyte</a>;   <span class="comment">/* XXX rounding */</span>
<a name="l00268"></a>00268    s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a> = s-&gt;<a class="code" href="structast__smoother.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>;
<a name="l00269"></a>00269    <span class="comment">/* Fill Data */</span>
<a name="l00270"></a>00270    memcpy(s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, s-&gt;<a class="code" href="structast__smoother.html#ae5c0218650008c505b08356333bbe5b3">data</a>, len);
<a name="l00271"></a>00271    s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> -= len;
<a name="l00272"></a>00272    <span class="comment">/* Move remaining data to the front if applicable */</span>
<a name="l00273"></a>00273    <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a>) {
<a name="l00274"></a>00274       <span class="comment">/* In principle this should all be fine because if we are sending</span>
<a name="l00275"></a>00275 <span class="comment">         G.729 VAD, the next timestamp will take over anyawy */</span>
<a name="l00276"></a>00276       memmove(s-&gt;<a class="code" href="structast__smoother.html#ae5c0218650008c505b08356333bbe5b3">data</a>, s-&gt;<a class="code" href="structast__smoother.html#ae5c0218650008c505b08356333bbe5b3">data</a> + len, s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a>);
<a name="l00277"></a>00277       <span class="keywordflow">if</span> (!<a class="code" href="time_8h.html#a1b7c6177ea781fc11512de25805fc144" title="Returns true if the argument is 0,0.">ast_tvzero</a>(s-&gt;<a class="code" href="structast__smoother.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>)) {
<a name="l00278"></a>00278          <span class="comment">/* If we have delivery time, increment it, otherwise, leave it at 0 */</span>
<a name="l00279"></a>00279          s-&gt;<a class="code" href="structast__smoother.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a> = <a class="code" href="time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073" title="Returns the sum of two timevals a + b.">ast_tvadd</a>(s-&gt;<a class="code" href="structast__smoother.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>, <a class="code" href="time_8h.html#a147d132412d7188c1dcebf25b8d31c0c" title="Returns a timeval corresponding to the duration of n samples at rate r. Useful to...">ast_samp2tv</a>(s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>.<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>, <a class="code" href="frame_8h.html#a29a7b93f4295966d4d441e91bff2b01e" title="Get the sample rate for a given format.">ast_format_rate</a>(s-&gt;<a class="code" href="structast__smoother.html#a317afff57d87a89158c2b038d37b2b08">format</a>)));
<a name="l00280"></a>00280       }
<a name="l00281"></a>00281    }
<a name="l00282"></a>00282    <span class="comment">/* Return frame */</span>
<a name="l00283"></a>00283    <span class="keywordflow">return</span> &amp;s-&gt;<a class="code" href="structast__smoother.html#a735f764b1095611ace084e7c6c06857d">f</a>;
<a name="l00284"></a>00284 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a34c247d5417aed64069bbeac7fc09728"></a><!-- doxytag: member="frame.c::ast_smoother_reconfigure" ref="a34c247d5417aed64069bbeac7fc09728" args="(struct ast_smoother *s, int bytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_smoother_reconfigure </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reconfigure an existing smoother to output a different <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes per frame. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>the smoother to reconfigure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bytes</em>&nbsp;</td><td>the desired <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes per output frame </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00154">154</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00091">ast_smoother::opt</a>, <a class="el" href="frame_8c_source.html#l00086">ast_smoother::opt_needs_swap</a>, <a class="el" href="frame_8c_source.html#l00082">ast_smoother::size</a>, and <a class="el" href="frame_8c_source.html#l00126">smoother_frame_feed()</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l03728">ast_rtp_codec_setpref()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00155"></a>00155 {
<a name="l00156"></a>00156    <span class="comment">/* if there is no change, then nothing to do */</span>
<a name="l00157"></a>00157    <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a> == bytes) {
<a name="l00158"></a>00158       <span class="keywordflow">return</span>;
<a name="l00159"></a>00159    }
<a name="l00160"></a>00160    <span class="comment">/* set the new desired output size */</span>
<a name="l00161"></a>00161    s-&gt;<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = bytes;
<a name="l00162"></a>00162    <span class="comment">/* if there is no &apos;optimized&apos; frame in the smoother,</span>
<a name="l00163"></a>00163 <span class="comment">    *   then there is nothing left to do</span>
<a name="l00164"></a>00164 <span class="comment">    */</span>
<a name="l00165"></a>00165    <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a>) {
<a name="l00166"></a>00166       <span class="keywordflow">return</span>;
<a name="l00167"></a>00167    }
<a name="l00168"></a>00168    <span class="comment">/* there is an &apos;optimized&apos; frame here at the old size,</span>
<a name="l00169"></a>00169 <span class="comment">    * but it must now be put into the buffer so the data</span>
<a name="l00170"></a>00170 <span class="comment">    * can be extracted at the new size</span>
<a name="l00171"></a>00171 <span class="comment">    */</span>
<a name="l00172"></a>00172    <a class="code" href="frame_8c.html#acb874d67b82b47620eb082453403f820">smoother_frame_feed</a>(s, s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a>, s-&gt;<a class="code" href="structast__smoother.html#aa0bab80f07b3d04d81bd3c9ae69e8b68">opt_needs_swap</a>);
<a name="l00173"></a>00173    s-&gt;<a class="code" href="structast__smoother.html#a2707e7d39a01f2e9a557076acd901889">opt</a> = NULL;
<a name="l00174"></a>00174 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="add7324cf0482ce24eaa13abdc00e115d"></a><!-- doxytag: member="frame.c::ast_smoother_reset" ref="add7324cf0482ce24eaa13abdc00e115d" args="(struct ast_smoother *s, int bytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_smoother_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00148">148</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00082">ast_smoother::size</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00176">ast_smoother_new()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00149"></a>00149 {
<a name="l00150"></a>00150    memset(s, 0, <span class="keyword">sizeof</span>(*s));
<a name="l00151"></a>00151    s-&gt;<a class="code" href="structast__smoother.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = bytes;
<a name="l00152"></a>00152 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a3294d5c7260c90f2de7b65037055c5"></a><!-- doxytag: member="frame.c::ast_smoother_set_flags" ref="a3a3294d5c7260c90f2de7b65037055c5" args="(struct ast_smoother *s, int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_smoother_set_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00191">191</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00084">ast_smoother::flags</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l03728">ast_rtp_codec_setpref()</a>, and <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00192"></a>00192 {
<a name="l00193"></a>00193    s-&gt;<a class="code" href="structast__smoother.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> = <a class="code" href="structast__frame.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>;
<a name="l00194"></a>00194 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3d6997c8a03e68d88c52f784c16c069f"></a><!-- doxytag: member="frame.c::ast_smoother_test_flag" ref="a3d6997c8a03e68d88c52f784c16c069f" args="(struct ast_smoother *s, int flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_smoother_test_flag </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00196">196</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00084">ast_smoother::flags</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l03790">ast_rtp_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00197"></a>00197 {
<a name="l00198"></a>00198    <span class="keywordflow">return</span> (s-&gt;<a class="code" href="structast__smoother.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; flag);
<a name="l00199"></a>00199 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad3313ac3c6813594f1ea408e26505be7"></a><!-- doxytag: member="frame.c::ast_swapcopy_samples" ref="ad3313ac3c6813594f1ea408e26505be7" args="(void *dst, const void *src, int samples)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_swapcopy_samples </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>samples</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00551">551</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00201">__ast_smoother_feed()</a>, <a class="el" href="iax2-parser_8c_source.html#l01079">iax_frame_wrap()</a>, <a class="el" href="chan__phone_8c_source.html#l00605">phone_write_buf()</a>, and <a class="el" href="frame_8c_source.html#l00126">smoother_frame_feed()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00552"></a>00552 {
<a name="l00553"></a>00553    <span class="keywordtype">int</span> i;
<a name="l00554"></a>00554    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *dst_s = dst;
<a name="l00555"></a>00555    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *src_s = <a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>; i++)
<a name="l00558"></a>00558       dst_s[i] = (src_s[i]&lt;&lt;8) | (src_s[i]&gt;&gt;8);
<a name="l00559"></a>00559 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae0047382e2ea1dac90f6f8c8dcd2bfb8"></a><!-- doxytag: member="frame.c::frame_cache_cleanup" ref="ae0047382e2ea1dac90f6f8c8dcd2bfb8" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void frame_cache_cleanup </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00321">321</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="format__g726_8c_source.html#l00177">f</a>, <a class="el" href="iax2-parser_8c_source.html#l00045">frames</a>, and <a class="el" href="frame_8c_source.html#l00065">ast_frame_cache::list</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00322"></a>00322 {
<a name="l00323"></a>00323    <span class="keyword">struct </span><a class="code" href="structast__frame__cache.html">ast_frame_cache</a> *<a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a> = data;
<a name="l00324"></a>00324    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326    <span class="keywordflow">while</span> ((f = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;frames-&gt;<a class="code" href="structast__frame__cache.html#a9c7b49f68e5d958a09c3628a40a4206f">list</a>, frame_list)))
<a name="l00327"></a>00327       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(f);
<a name="l00328"></a>00328    
<a name="l00329"></a>00329    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(frames);
<a name="l00330"></a>00330 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5d8cb9e7ec765506672f15e0c2d184f1"></a><!-- doxytag: member="frame.c::g723_len" ref="a5d8cb9e7ec765506672f15e0c2d184f1" args="(unsigned char buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int g723_len </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>buf</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l01284">1284</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="evt_8c_source.html#l00071">type</a>, <a class="el" href="frame_8c_source.html#l00076">TYPE_DONTSEND</a>, <a class="el" href="codec__speex_8c_source.html#l00076">TYPE_HIGH</a>, <a class="el" href="codec__speex_8c_source.html#l00077">TYPE_LOW</a>, <a class="el" href="codec__speex_8c_source.html#l00078">TYPE_MASK</a>, and <a class="el" href="codec__speex_8c_source.html#l00075">TYPE_SILENCE</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01307">g723_samples()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01285"></a>01285 {
<a name="l01286"></a>01286    <span class="keyword">enum</span> <a class="code" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5f">frame_type</a> <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> &amp; <a class="code" href="codec__speex_8c.html#aff17a6771d3319ab64930cd2b937d6cf">TYPE_MASK</a>;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288    <span class="keywordflow">switch</span>(type) {
<a name="l01289"></a>01289    <span class="keywordflow">case</span> <a class="code" href="frame_8c.html#a3ca2c0bc7578bf3d337e34b2c08a6c5fab13f7bec98d45341d5c02adb21372dc7">TYPE_DONTSEND</a>:
<a name="l01290"></a>01290       <span class="keywordflow">return</span> 0;
<a name="l01291"></a>01291       <span class="keywordflow">break</span>;
<a name="l01292"></a>01292    <span class="keywordflow">case</span> <a class="code" href="codec__speex_8c.html#af560916d7051f74aa7cf9af7023cafe2">TYPE_SILENCE</a>:
<a name="l01293"></a>01293       <span class="keywordflow">return</span> 4;
<a name="l01294"></a>01294       <span class="keywordflow">break</span>;
<a name="l01295"></a>01295    <span class="keywordflow">case</span> <a class="code" href="codec__speex_8c.html#a2fa0578bfbd608daafde3c56a0ad15a6">TYPE_HIGH</a>:
<a name="l01296"></a>01296       <span class="keywordflow">return</span> 24;
<a name="l01297"></a>01297       <span class="keywordflow">break</span>;
<a name="l01298"></a>01298    <span class="keywordflow">case</span> <a class="code" href="codec__speex_8c.html#ab78c10a44f25f2b7196c44c0397839bf">TYPE_LOW</a>:
<a name="l01299"></a>01299       <span class="keywordflow">return</span> 20;
<a name="l01300"></a>01300       <span class="keywordflow">break</span>;
<a name="l01301"></a>01301    <span class="keywordflow">default</span>:
<a name="l01302"></a>01302       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Badly encoded frame (%d)\n&quot;</span>, type);
<a name="l01303"></a>01303    }
<a name="l01304"></a>01304    <span class="keywordflow">return</span> -1;
<a name="l01305"></a>01305 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4eb46a9fec3d504357127c4c1ad41ac9"></a><!-- doxytag: member="frame.c::g723_samples" ref="a4eb46a9fec3d504357127c4c1ad41ac9" args="(unsigned char *buf, int maxlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int g723_samples </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l01307">1307</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l01284">g723_len()</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01431">ast_codec_get_samples()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01308"></a>01308 {
<a name="l01309"></a>01309    <span class="keywordtype">int</span> pos = 0;
<a name="l01310"></a>01310    <span class="keywordtype">int</span> <a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = 0;
<a name="l01311"></a>01311    <span class="keywordtype">int</span> res;
<a name="l01312"></a>01312    <span class="keywordflow">while</span>(pos &lt; maxlen) {
<a name="l01313"></a>01313       res = <a class="code" href="frame_8c.html#a5d8cb9e7ec765506672f15e0c2d184f1">g723_len</a>(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[pos]);
<a name="l01314"></a>01314       <span class="keywordflow">if</span> (res &lt;= 0)
<a name="l01315"></a>01315          <span class="keywordflow">break</span>;
<a name="l01316"></a>01316       samples += 240;
<a name="l01317"></a>01317       pos += res;
<a name="l01318"></a>01318    }
<a name="l01319"></a>01319    <span class="keywordflow">return</span> samples;
<a name="l01320"></a>01320 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a631ab309b415fe0138d69ec7dbe323"></a><!-- doxytag: member="frame.c::get_n_bits_at" ref="a3a631ab309b415fe0138d69ec7dbe323" args="(unsigned char *data, int n, int bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned char get_n_bits_at </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l01322">1322</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01341">speex_get_wb_sz_at()</a>, and <a class="el" href="frame_8c_source.html#l01371">speex_samples()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01323"></a>01323 {
<a name="l01324"></a>01324    <span class="keywordtype">int</span> byte = bit / 8;       <span class="comment">/* byte containing first bit */</span>
<a name="l01325"></a>01325    <span class="keywordtype">int</span> rem = 8 - (bit % 8);  <span class="comment">/* remaining bits in first byte */</span>
<a name="l01326"></a>01326    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ret = 0;
<a name="l01327"></a>01327    
<a name="l01328"></a>01328    <span class="keywordflow">if</span> (n &lt;= 0 || n &gt; 8)
<a name="l01329"></a>01329       <span class="keywordflow">return</span> 0;
<a name="l01330"></a>01330 
<a name="l01331"></a>01331    <span class="keywordflow">if</span> (rem &lt; n) {
<a name="l01332"></a>01332       ret = (<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>[byte] &lt;&lt; (n - rem));
<a name="l01333"></a>01333       ret |= (<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>[byte + 1] &gt;&gt; (8 - n + rem));
<a name="l01334"></a>01334    } <span class="keywordflow">else</span> {
<a name="l01335"></a>01335       ret = (<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>[byte] &gt;&gt; (rem - n));
<a name="l01336"></a>01336    }
<a name="l01337"></a>01337 
<a name="l01338"></a>01338    <span class="keywordflow">return</span> (ret &amp; (0xff &gt;&gt; (8 - n)));
<a name="l01339"></a>01339 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae8a701b0b688879d84514bd36d63ff82"></a><!-- doxytag: member="frame.c::init_framer" ref="ae8a701b0b688879d84514bd36d63ff82" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_framer </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Provided by <a class="el" href="frame_8c.html" title="Frame and codec manipulation routines.">frame.c</a> </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00968">968</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, and <a class="el" href="cli_8c_source.html#l01927">ast_cli_register_multiple()</a>.</p>

<p>Referenced by <a class="el" href="asterisk_8c_source.html#l03095">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00969"></a>00969 {
<a name="l00970"></a>00970    <a class="code" href="cli_8h.html#aadeef34f3106bb78aeb3414032ad7fb7" title="Register multiple commands.">ast_cli_register_multiple</a>(<a class="code" href="frame_8c.html#af1a7a13ff239697e9106ed3763072298">my_clis</a>, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="frame_8c.html#af1a7a13ff239697e9106ed3763072298">my_clis</a>));
<a name="l00971"></a>00971    <span class="keywordflow">return</span> 0;   
<a name="l00972"></a>00972 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a151c4ff0b1d8addf7ec1f81c553ea084"></a><!-- doxytag: member="frame.c::show_codec_n" ref="a151c4ff0b1d8addf7ec1f81c553ea084" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* show_codec_n </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00722">722</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8c_source.html#l00654">ast_codec2str()</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00723"></a>00723 {
<a name="l00724"></a>00724    <span class="keywordtype">int</span> codec, i, found=0;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726    <span class="keywordflow">switch</span> (cmd) {
<a name="l00727"></a>00727    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00728"></a>00728       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;core show codec&quot;</span>;
<a name="l00729"></a>00729       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = 
<a name="l00730"></a>00730          <span class="stringliteral">&quot;Usage: core show codec &lt;number&gt;\n&quot;</span>
<a name="l00731"></a>00731          <span class="stringliteral">&quot;       Displays codec mapping\n&quot;</span>;
<a name="l00732"></a>00732       <span class="keywordflow">return</span> NULL;
<a name="l00733"></a>00733    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00734"></a>00734       <span class="keywordflow">return</span> NULL;
<a name="l00735"></a>00735    }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != 4)
<a name="l00738"></a>00738       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00739"></a>00739 
<a name="l00740"></a>00740    <span class="keywordflow">if</span> (sscanf(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3], <span class="stringliteral">&quot;%30d&quot;</span>, &amp;codec) != 1)
<a name="l00741"></a>00741       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00742"></a>00742 
<a name="l00743"></a>00743    <span class="keywordflow">for</span> (i = 0; i &lt; 32; i++)
<a name="l00744"></a>00744       <span class="keywordflow">if</span> (codec &amp; (1 &lt;&lt; i)) {
<a name="l00745"></a>00745          found = 1;
<a name="l00746"></a>00746          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;%11u (1 &lt;&lt; %2d)  %s\n&quot;</span>,1 &lt;&lt; i,i,<a class="code" href="frame_8h.html#ab492fdbd06591d26ff743d440cc0594f" title="Get a name from a format Gets a name from a format.">ast_codec2str</a>(1&lt;&lt;i));
<a name="l00747"></a>00747       }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749    <span class="keywordflow">if</span> (!found)
<a name="l00750"></a>00750       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Codec %d not found\n&quot;</span>, codec);
<a name="l00751"></a>00751 
<a name="l00752"></a>00752    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00753"></a>00753 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e79daabbe43ccf4880e628c7e712b38"></a><!-- doxytag: member="frame.c::show_codecs" ref="a8e79daabbe43ccf4880e628c7e712b38" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* show_codecs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00667">667</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8c_source.html#l00654">ast_codec2str()</a>, <a class="el" href="frame_8c_source.html#l00573">ast_getformatname()</a>, <a class="el" href="options_8h_source.html#l00115">ast_opt_dont_warn</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00668"></a>00668 {
<a name="l00669"></a>00669    <span class="keywordtype">int</span> i, found=0;
<a name="l00670"></a>00670    <span class="keywordtype">char</span> hex[25];
<a name="l00671"></a>00671 
<a name="l00672"></a>00672    <span class="keywordflow">switch</span> (cmd) {
<a name="l00673"></a>00673    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00674"></a>00674       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;core show codecs [audio|video|image]&quot;</span>;
<a name="l00675"></a>00675       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = 
<a name="l00676"></a>00676          <span class="stringliteral">&quot;Usage: core show codecs [audio|video|image]\n&quot;</span>
<a name="l00677"></a>00677          <span class="stringliteral">&quot;       Displays codec mapping\n&quot;</span>;
<a name="l00678"></a>00678       <span class="keywordflow">return</span> NULL;
<a name="l00679"></a>00679    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00680"></a>00680       <span class="keywordflow">return</span> NULL;
<a name="l00681"></a>00681    }
<a name="l00682"></a>00682    
<a name="l00683"></a>00683    <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &lt; 3) || (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &gt; 4))
<a name="l00684"></a>00684       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00685"></a>00685 
<a name="l00686"></a>00686    <span class="keywordflow">if</span> (!<a class="code" href="options_8h.html#a5240f07b6ff8003ff47b856d44ef7226">ast_opt_dont_warn</a>)
<a name="l00687"></a>00687       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Disclaimer: this command is for informational purposes only.\n&quot;</span>
<a name="l00688"></a>00688             <span class="stringliteral">&quot;\tIt does not indicate anything about your configuration.\n&quot;</span>);
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;%11s %9s %10s   TYPE   %8s   %s\n&quot;</span>,<span class="stringliteral">&quot;INT&quot;</span>,<span class="stringliteral">&quot;BINARY&quot;</span>,<span class="stringliteral">&quot;HEX&quot;</span>,<span class="stringliteral">&quot;NAME&quot;</span>,<span class="stringliteral">&quot;DESC&quot;</span>);
<a name="l00691"></a>00691    <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;--------------------------------------------------------------------------------\n&quot;</span>);
<a name="l00692"></a>00692    <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) || (!strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3],<span class="stringliteral">&quot;audio&quot;</span>))) {
<a name="l00693"></a>00693       found = 1;
<a name="l00694"></a>00694       <span class="keywordflow">for</span> (i=0;i&lt;13;i++) {
<a name="l00695"></a>00695          snprintf(hex,25,<span class="stringliteral">&quot;(0x%x)&quot;</span>,1&lt;&lt;i);
<a name="l00696"></a>00696          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;%11u (1 &lt;&lt; %2d) %10s  audio   %8s   (%s)\n&quot;</span>,1 &lt;&lt; i,i,hex,<a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(1&lt;&lt;i),<a class="code" href="frame_8h.html#ab492fdbd06591d26ff743d440cc0594f" title="Get a name from a format Gets a name from a format.">ast_codec2str</a>(1&lt;&lt;i));
<a name="l00697"></a>00697       }
<a name="l00698"></a>00698    }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700    <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) || (!strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3],<span class="stringliteral">&quot;image&quot;</span>))) {
<a name="l00701"></a>00701       found = 1;
<a name="l00702"></a>00702       <span class="keywordflow">for</span> (i=16;i&lt;18;i++) {
<a name="l00703"></a>00703          snprintf(hex,25,<span class="stringliteral">&quot;(0x%x)&quot;</span>,1&lt;&lt;i);
<a name="l00704"></a>00704          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;%11u (1 &lt;&lt; %2d) %10s  image   %8s   (%s)\n&quot;</span>,1 &lt;&lt; i,i,hex,<a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(1&lt;&lt;i),<a class="code" href="frame_8h.html#ab492fdbd06591d26ff743d440cc0594f" title="Get a name from a format Gets a name from a format.">ast_codec2str</a>(1&lt;&lt;i));
<a name="l00705"></a>00705       }
<a name="l00706"></a>00706    }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708    <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3) || (!strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3],<span class="stringliteral">&quot;video&quot;</span>))) {
<a name="l00709"></a>00709       found = 1;
<a name="l00710"></a>00710       <span class="keywordflow">for</span> (i=18;i&lt;22;i++) {
<a name="l00711"></a>00711          snprintf(hex,25,<span class="stringliteral">&quot;(0x%x)&quot;</span>,1&lt;&lt;i);
<a name="l00712"></a>00712          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;%11u (1 &lt;&lt; %2d) %10s  video   %8s   (%s)\n&quot;</span>,1 &lt;&lt; i,i,hex,<a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(1&lt;&lt;i),<a class="code" href="frame_8h.html#ab492fdbd06591d26ff743d440cc0594f" title="Get a name from a format Gets a name from a format.">ast_codec2str</a>(1&lt;&lt;i));
<a name="l00713"></a>00713       }
<a name="l00714"></a>00714    }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716    <span class="keywordflow">if</span> (!found)
<a name="l00717"></a>00717       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00718"></a>00718    <span class="keywordflow">else</span>
<a name="l00719"></a>00719       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00720"></a>00720 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb874d67b82b47620eb082453403f820"></a><!-- doxytag: member="frame.c::smoother_frame_feed" ref="acb874d67b82b47620eb082453403f820" args="(struct ast_smoother *s, struct ast_frame *f, int swap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int smoother_frame_feed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__smoother.html">ast_smoother</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>swap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00126">126</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="frame_8h_source.html#l00354">AST_SMOOTHER_FLAG_G729</a>, <a class="el" href="frame_8c_source.html#l00551">ast_swapcopy_samples()</a>, <a class="el" href="time_8h_source.html#l00099">ast_tvzero()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8c_source.html#l00089">ast_smoother::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8c_source.html#l00088">ast_smoother::delivery</a>, <a class="el" href="frame_8h_source.html#l00161">ast_frame::delivery</a>, <a class="el" href="frame_8c_source.html#l00084">ast_smoother::flags</a>, <a class="el" href="frame_8c_source.html#l00092">ast_smoother::len</a>, <a class="el" href="logger_8h_source.html#l00141">LOG_NOTICE</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, and <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00201">__ast_smoother_feed()</a>, and <a class="el" href="frame_8c_source.html#l00154">ast_smoother_reconfigure()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00127"></a>00127 {
<a name="l00128"></a>00128    <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; <a class="code" href="frame_8h.html#a06828788896ac92282112bd8ffe12319">AST_SMOOTHER_FLAG_G729</a>) {
<a name="l00129"></a>00129       <span class="keywordflow">if</span> (s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> % 10) {
<a name="l00130"></a>00130          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Dropping extra frame of G.729 since we already have a VAD frame at the end\n&quot;</span>);
<a name="l00131"></a>00131          <span class="keywordflow">return</span> 0;
<a name="l00132"></a>00132       }
<a name="l00133"></a>00133    }
<a name="l00134"></a>00134    <span class="keywordflow">if</span> (swap) {
<a name="l00135"></a>00135       <a class="code" href="frame_8h.html#ad3313ac3c6813594f1ea408e26505be7">ast_swapcopy_samples</a>(s-&gt;<a class="code" href="structast__smoother.html#ae5c0218650008c505b08356333bbe5b3">data</a> + s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>);
<a name="l00136"></a>00136    } <span class="keywordflow">else</span> {
<a name="l00137"></a>00137       memcpy(s-&gt;<a class="code" href="structast__smoother.html#ae5c0218650008c505b08356333bbe5b3">data</a> + s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);
<a name="l00138"></a>00138    }
<a name="l00139"></a>00139    <span class="comment">/* If either side is empty, reset the delivery time */</span>
<a name="l00140"></a>00140    <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> || <a class="code" href="time_8h.html#a1b7c6177ea781fc11512de25805fc144" title="Returns true if the argument is 0,0.">ast_tvzero</a>(f-&gt;<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>) || <a class="code" href="time_8h.html#a1b7c6177ea781fc11512de25805fc144" title="Returns true if the argument is 0,0.">ast_tvzero</a>(s-&gt;<a class="code" href="structast__smoother.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>)) { <span class="comment">/* XXX really ? */</span>
<a name="l00141"></a>00141       s-&gt;<a class="code" href="structast__smoother.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a> = f-&gt;<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>;
<a name="l00142"></a>00142    }
<a name="l00143"></a>00143    s-&gt;<a class="code" href="structast__smoother.html#afed088663f8704004425cdae2120b9b3">len</a> += f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145    <span class="keywordflow">return</span> 0;
<a name="l00146"></a>00146 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a124f17e16301f8e0720d2f4388e0387e"></a><!-- doxytag: member="frame.c::speex_get_wb_sz_at" ref="a124f17e16301f8e0720d2f4388e0387e" args="(unsigned char *data, int len, int bit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int speex_get_wb_sz_at </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>bit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l01341">1341</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="frame_8c_source.html#l01322">get_n_bits_at()</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01371">speex_samples()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01342"></a>01342 {
<a name="l01343"></a>01343    <span class="keyword">static</span> <span class="keywordtype">int</span> SpeexWBSubModeSz[] = {
<a name="l01344"></a>01344       0, 36, 112, 192,
<a name="l01345"></a>01345       352, 0, 0, 0 };
<a name="l01346"></a>01346    <span class="keywordtype">int</span> off = bit;
<a name="l01347"></a>01347    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349    <span class="comment">/* skip up to two wideband frames */</span>
<a name="l01350"></a>01350    <span class="keywordflow">if</span> (((<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> * 8 - off) &gt;= 5) &amp;&amp; 
<a name="l01351"></a>01351       <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 1, off)) {
<a name="l01352"></a>01352       c = <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 3, off + 1);
<a name="l01353"></a>01353       off += SpeexWBSubModeSz[c];
<a name="l01354"></a>01354 
<a name="l01355"></a>01355       <span class="keywordflow">if</span> (((<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> * 8 - off) &gt;= 5) &amp;&amp; 
<a name="l01356"></a>01356          <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 1, off)) {
<a name="l01357"></a>01357          c = <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 3, off + 1);
<a name="l01358"></a>01358          off += SpeexWBSubModeSz[c];
<a name="l01359"></a>01359 
<a name="l01360"></a>01360          <span class="keywordflow">if</span> (((<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> * 8 - off) &gt;= 5) &amp;&amp; 
<a name="l01361"></a>01361             <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 1, off)) {
<a name="l01362"></a>01362             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Encountered corrupt speex frame; too many wideband frames in a row.\n&quot;</span>);
<a name="l01363"></a>01363             <span class="keywordflow">return</span> -1;
<a name="l01364"></a>01364          }
<a name="l01365"></a>01365       }
<a name="l01366"></a>01366 
<a name="l01367"></a>01367    }
<a name="l01368"></a>01368    <span class="keywordflow">return</span> off - bit;
<a name="l01369"></a>01369 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adb6c30bc64d4ebc36843172a35105de4"></a><!-- doxytag: member="frame.c::speex_samples" ref="adb6c30bc64d4ebc36843172a35105de4" args="(unsigned char *data, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int speex_samples </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l01371">1371</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="frame_8c_source.html#l01322">get_n_bits_at()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="frame_8c_source.html#l01341">speex_get_wb_sz_at()</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l01431">ast_codec_get_samples()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01372"></a>01372 {
<a name="l01373"></a>01373    <span class="keyword">static</span> <span class="keywordtype">int</span> SpeexSubModeSz[] = {
<a name="l01374"></a>01374       5, 43, 119, 160,
<a name="l01375"></a>01375       220, 300, 364, 492, 
<a name="l01376"></a>01376       79, 0, 0, 0,
<a name="l01377"></a>01377       0, 0, 0, 0 };
<a name="l01378"></a>01378    <span class="keyword">static</span> <span class="keywordtype">int</span> SpeexInBandSz[] = { 
<a name="l01379"></a>01379       1, 1, 4, 4,
<a name="l01380"></a>01380       4, 4, 4, 4,
<a name="l01381"></a>01381       8, 8, 16, 16,
<a name="l01382"></a>01382       32, 32, 64, 64 };
<a name="l01383"></a>01383    <span class="keywordtype">int</span> bit = 0;
<a name="l01384"></a>01384    <span class="keywordtype">int</span> cnt = 0;
<a name="l01385"></a>01385    <span class="keywordtype">int</span> off;
<a name="l01386"></a>01386    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388    <span class="keywordflow">while</span> ((<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> * 8 - bit) &gt;= 5) {
<a name="l01389"></a>01389       <span class="comment">/* skip wideband frames */</span>
<a name="l01390"></a>01390       off = <a class="code" href="frame_8c.html#a124f17e16301f8e0720d2f4388e0387e">speex_get_wb_sz_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, bit);
<a name="l01391"></a>01391       <span class="keywordflow">if</span> (off &lt; 0)  {
<a name="l01392"></a>01392          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Had error while reading wideband frames for speex samples\n&quot;</span>);
<a name="l01393"></a>01393          <span class="keywordflow">break</span>;
<a name="l01394"></a>01394       }
<a name="l01395"></a>01395       bit += off;
<a name="l01396"></a>01396 
<a name="l01397"></a>01397       <span class="keywordflow">if</span> ((<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> * 8 - bit) &lt; 5) {
<a name="l01398"></a>01398          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Not enough bits remaining after wide band for speex samples.\n&quot;</span>);
<a name="l01399"></a>01399          <span class="keywordflow">break</span>;
<a name="l01400"></a>01400       }
<a name="l01401"></a>01401 
<a name="l01402"></a>01402       <span class="comment">/* get control bits */</span>
<a name="l01403"></a>01403       c = <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 5, bit);
<a name="l01404"></a>01404       bit += 5;
<a name="l01405"></a>01405 
<a name="l01406"></a>01406       <span class="keywordflow">if</span> (c == 15) { 
<a name="l01407"></a>01407          <span class="comment">/* terminator */</span>
<a name="l01408"></a>01408          <span class="keywordflow">break</span>; 
<a name="l01409"></a>01409       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c == 14) {
<a name="l01410"></a>01410          <span class="comment">/* in-band signal; next 4 bits contain signal id */</span>
<a name="l01411"></a>01411          c = <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 4, bit);
<a name="l01412"></a>01412          bit += 4;
<a name="l01413"></a>01413          bit += SpeexInBandSz[c];
<a name="l01414"></a>01414       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c == 13) {
<a name="l01415"></a>01415          <span class="comment">/* user in-band; next 5 bits contain msg len */</span>
<a name="l01416"></a>01416          c = <a class="code" href="frame_8c.html#a3a631ab309b415fe0138d69ec7dbe323">get_n_bits_at</a>(<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>, 5, bit);
<a name="l01417"></a>01417          bit += 5;
<a name="l01418"></a>01418          bit += c * 8;
<a name="l01419"></a>01419       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt; 8) {
<a name="l01420"></a>01420          <span class="comment">/* unknown */</span>
<a name="l01421"></a>01421          <span class="keywordflow">break</span>;
<a name="l01422"></a>01422       } <span class="keywordflow">else</span> {
<a name="l01423"></a>01423          <span class="comment">/* skip number bits for submode (less the 5 control bits) */</span>
<a name="l01424"></a>01424          bit += SpeexSubModeSz[c] - 5;
<a name="l01425"></a>01425          cnt += 160; <span class="comment">/* new frame */</span>
<a name="l01426"></a>01426       }
<a name="l01427"></a>01427    }
<a name="l01428"></a>01428    <span class="keywordflow">return</span> cnt;
<a name="l01429"></a>01429 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a6da24d09807c4c89bbba05e5566eb266"></a><!-- doxytag: member="frame.c::AST_FORMAT_LIST" ref="a6da24d09807c4c89bbba05e5566eb266" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__format__list.html">ast_format_list</a> <a class="el" href="frame_8c.html#a6da24d09807c4c89bbba05e5566eb266">AST_FORMAT_LIST</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition of supported media <a class="el" href="structformats.html">formats</a> (codecs). </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00096">96</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a class="anchor" id="af203379aca2fd704fe8d86a9445596b6"></a><!-- doxytag: member="frame.c::ast_null_frame" ref="af203379aca2fd704fe8d86a9445596b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__frame.html">ast_frame</a> <a class="el" href="frame_8c.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a> = { AST_FRAME_NULL, }</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Queueing a null frame is fairly common, so we declare a global null frame object for this purpose instead of having to declare one on the stack </p>

<p>Definition at line <a class="el" href="frame_8c_source.html#l00124">124</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l02636">__ast_read()</a>, <a class="el" href="chan__h323_8c_source.html#l00951">__oh323_rtp_create()</a>, <a class="el" href="chan__h323_8c_source.html#l00332">__oh323_update_info()</a>, <a class="el" href="chan__agent_8c_source.html#l01086">agent_new()</a>, <a class="el" href="chan__agent_8c_source.html#l00519">agent_read()</a>, <a class="el" href="channel_8c_source.html#l04217">ast_channel_masquerade()</a>, <a class="el" href="channel_8c_source.html#l00521">ast_channel_setwhentohangup_tv()</a>, <a class="el" href="channel_8c_source.html#l04393">ast_do_masquerade()</a>, <a class="el" href="rtp_8c_source.html#l01168">ast_rtcp_read()</a>, <a class="el" href="rtp_8c_source.html#l01562">ast_rtp_read()</a>, <a class="el" href="channel_8c_source.html#l01653">ast_softhangup_nolock()</a>, <a class="el" href="udptl_8c_source.html#l00672">ast_udptl_read()</a>, <a class="el" href="chan__bridge_8c_source.html#l00085">bridge_read()</a>, <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>, <a class="el" href="chan__console_8c_source.html#l00548">console_read()</a>, <a class="el" href="chan__dahdi_8c_source.html#l06717">dahdi_read()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01385">gtalk_rtp_read()</a>, <a class="el" href="chan__sip_8c_source.html#l19641">handle_request_invite()</a>, <a class="el" href="chan__sip_8c_source.html#l17572">handle_response_invite()</a>, <a class="el" href="chan__iax2_8c_source.html#l05082">iax2_read()</a>, <a class="el" href="chan__jingle_8c_source.html#l01167">jingle_rtp_read()</a>, <a class="el" href="chan__local_8c_source.html#l00357">local_read()</a>, <a class="el" href="chan__mgcp_8c_source.html#l01202">mgcp_rtp_read()</a>, <a class="el" href="chan__h323_8c_source.html#l00803">oh323_read()</a>, <a class="el" href="chan__h323_8c_source.html#l00748">oh323_rtp_read()</a>, <a class="el" href="rtp_8c_source.html#l01013">process_rfc2833()</a>, <a class="el" href="chan__sip_8c_source.html#l08040">process_sdp()</a>, <a class="el" href="rtp_8c_source.html#l00871">send_dtmf()</a>, <a class="el" href="chan__sip_8c_source.html#l07045">sip_read()</a>, <a class="el" href="chan__sip_8c_source.html#l06955">sip_rtp_read()</a>, <a class="el" href="chan__skinny_8c_source.html#l03907">skinny_rtp_read()</a>, <a class="el" href="chan__unistim_8c_source.html#l03905">unistim_rtp_read()</a>, and <a class="el" href="chan__dahdi_8c_source.html#l01520">wakeup_sub()</a>.</p>

</div>
</div>
<a class="anchor" id="a0aa5ff72fc86609f2fe7385e7747b52e"></a><!-- doxytag: member="frame.c::frame_cache" ref="a0aa5ff72fc86609f2fe7385e7747b52e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a> <a class="el" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_frame_cache , .custom_init = NULL , }<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="frame_8c_source.html#l00047">47</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00333">__frame_free()</a>, <a class="el" href="frame_8c_source.html#l00291">ast_frame_header_new()</a>, <a class="el" href="frame_8c_source.html#l00474">ast_frdup()</a>, <a class="el" href="iax2-parser_8c_source.html#l01168">iax_frame_free()</a>, and <a class="el" href="iax2-parser_8c_source.html#l01110">iax_frame_new()</a>.</p>

</div>
</div>
<a class="anchor" id="af1a7a13ff239697e9106ed3763072298"></a><!-- doxytag: member="frame.c::my_clis" ref="af1a7a13ff239697e9106ed3763072298" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="frame_8c.html#af1a7a13ff239697e9106ed3763072298">my_clis</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
   <a class="code" href="cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="frame_8c.html#a8e79daabbe43ccf4880e628c7e712b38">show_codecs</a>, <span class="stringliteral">&quot;Displays a list of codecs&quot;</span>),
   <a class="code" href="cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="frame_8c.html#a151c4ff0b1d8addf7ec1f81c553ea084">show_codec_n</a>, <span class="stringliteral">&quot;Shows a specific codec&quot;</span>),
}
</pre></div>
<p>Definition at line <a class="el" href="frame_8c_source.html#l00963">963</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:22:08 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
