<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:23:33 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_afe38fc0ccf2e9eefca5d5c6b03503d9.html">main</a>
  </div>
</div>
<div class="contents">
<h1>utils.c File Reference</h1>
<p>Utility functions.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="network_8h_source.html">asterisk/network.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="io_8h_source.html">asterisk/io.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="md5_8h_source.html">asterisk/md5.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sha1_8h_source.html">asterisk/sha1.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="strings_8h_source.html">asterisk/strings.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="time_8h_source.html">asterisk/time.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stringfields_8h_source.html">asterisk/stringfields.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadstorage_8h_source.html">asterisk/threadstorage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="config_8h_source.html">asterisk/config.h</a>&quot;</code><br/>

<p><a href="utils_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthr__arg.html">thr_arg</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a805616595a796949ade4a78edc628f99">AST_API_MODULE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aa1591a4f3a86360108de5b9ba34980ca">ERANGE</a>&nbsp;&nbsp;&nbsp;34</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>&nbsp;&nbsp;&nbsp;1000000</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a7466d46d24c1418dbc0c814a03e1a5dc">__ast_string_field_alloc_space</a> (struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *mgr, struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **pool_head, size_t needed)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a4e24c6a8b5b6ae53764e6a0e9c313506">__ast_string_field_init</a> (struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *mgr, struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **pool_head, int needed, const char *file, int lineno, const char *func)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a1d75cac4d629dcf89e6fd872206bef58">__ast_string_field_ptr_build</a> (struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *mgr, struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **pool_head, <a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> *ptr, const char *<a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a75c416951b9c4a28f609c9a64d4d905a">__ast_string_field_ptr_build_va</a> (struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *mgr, struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **pool_head, <a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> *ptr, const char *<a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, va_list ap1, va_list ap2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ac438a66ce99b119c7fb4ee7f787d7232">__ast_string_field_ptr_grow</a> (struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *mgr, size_t needed, const <a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> *ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a0114e8cab34567d42d506ad18c7ff28e">__init_inet_ntoa_buf</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ad74eb920d81cc82cbbfe3079b8140530">add_string_pool</a> (struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *mgr, struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **pool_head, size_t size, const char *file, int lineno, const char *func)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">add a new block to the pool. We can only allocate from the topmost pool, so the fields in *mgr reflect the size of that only.  <a href="#ad74eb920d81cc82cbbfe3079b8140530"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aafd2c396c15ac749e33198a5d4fd592f">ast_atomic_fetchadd_int_slow</a> (volatile int *p, int v)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a1e7e06bd20719ecfd58b67f230780ffa">ast_base64decode</a> (unsigned char *dst, const char *src, int max)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">decode BASE64 encoded text  <a href="#a1e7e06bd20719ecfd58b67f230780ffa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a555dad1bd5b23acf01cf08f1affab879">ast_base64encode</a> (char *dst, const unsigned char *src, int srclen, int max)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encode data in base64.  <a href="#a555dad1bd5b23acf01cf08f1affab879"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#abc46a030bcce6696e31ac29a79558b53">ast_base64encode_full</a> (char *dst, const unsigned char *src, int srclen, int max, int linebreaks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">encode text to BASE64 coding  <a href="#abc46a030bcce6696e31ac29a79558b53"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a603020160399d4876ec09fd299ebcaf9">ast_build_string</a> (char **buffer, size_t *space, const char *fmt,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Build a string in a buffer, designed to be called repeatedly.  <a href="#a603020160399d4876ec09fd299ebcaf9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a7cc2336f3642ec07be6058e7fa746e71">ast_build_string_va</a> (char **buffer, size_t *space, const char *fmt, va_list ap)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Build a string in a buffer, designed to be called repeatedly.  <a href="#a7cc2336f3642ec07be6058e7fa746e71"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ae97a3220bac9e353fe2049c0fa8d73a7">ast_careful_fwrite</a> (FILE *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>, int fd, const char *src, size_t len, int timeoutms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write data to a file stream with a timeout.  <a href="#ae97a3220bac9e353fe2049c0fa8d73a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a38faf2987c375335b2773964aabf69b3">ast_carefulwrite</a> (int fd, char *s, int len, int timeoutms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try to write string, but wait no more than ms milliseconds before timing out.  <a href="#a38faf2987c375335b2773964aabf69b3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a89056bba460d0aa179d3a3ddc0af472a">ast_enable_packet_fragmentation</a> (int sock)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable PMTU discovery on a socket.  <a href="#a89056bba460d0aa179d3a3ddc0af472a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ab974fc2bc77e80f85dda82b5cf14bf58">ast_false</a> (const char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make sure something is false. Determine if a string containing a boolean value is "false". This function checks to see whether a string passed to it is an indication of an "false" value. It checks to see if the string is "no", "false", "n", "f", "off" or "0".  <a href="#ab974fc2bc77e80f85dda82b5cf14bf58"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a3b5457e5f5679935093d94b0f788769e">ast_get_time_t</a> (const char *src, time_t *dst, time_t _default, int *consumed)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get <a class="el" href="structvalues.html">values</a> from config variables.  <a href="#a3b5457e5f5679935093d94b0f788769e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a70853b91fea6436a8234ee488d4bae54">ast_get_timeval</a> (const char *src, struct timeval *dst, struct timeval _default, int *consumed)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get <a class="el" href="structvalues.html">values</a> from config variables.  <a href="#a70853b91fea6436a8234ee488d4bae54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct hostent *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ad3b63ee1041593219ef0765b28d70442">ast_gethostbyname</a> (const char *host, struct <a class="el" href="structast__hostent.html">ast_hostent</a> *<a class="el" href="chan__skinny_8c.html#aa0f575fa3882aa394cc287edba645a35">hp</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Re-entrant (thread safe) version of gethostbyname that replaces the standard gethostbyname (which is not thread safe).  <a href="#ad3b63ee1041593219ef0765b28d70442"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a5a735cb59e8a8ddd78078d396db7e106">ast_inet_ntoa</a> (struct in_addr ia)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_inet_ntoa: Recursive thread safe replacement of inet_ntoa  <a href="#a5a735cb59e8a8ddd78078d396db7e106"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a0c9c27a9e6b4a6d1e2b868525ae3d0c1">ast_join</a> (char *s, size_t len, char *const w[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ac19bc2df18345ab0f12d972f2987b896">ast_md5_hash</a> (char *output, char *input)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce 32 char MD5 hash of value.  <a href="#ac19bc2df18345ab0f12d972f2987b896"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a7c38859ed90e96df2b0a0fdf843769d0">ast_mkdir</a> (const char *path, int mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Recursively create directory path.  <a href="#a7c38859ed90e96df2b0a0fdf843769d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a3543b8258edfa9140d45147013bc6919">ast_process_quotes_and_slashes</a> (char *start, char find, char replace_with)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Process a string to find and replace characters.  <a href="#a3543b8258edfa9140d45147013bc6919"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#af13d115905cb377f2e1b2e46fec92257">ast_pthread_create_detached_stack</a> (pthread_t *<a class="el" href="res__timing__pthread_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, pthread_attr_t *attr, void *(*start_routine)(void *), void *data, size_t stacksize, const char *file, const char *caller, int line, const char *start_fn)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#af740ee3fba7768010783e3faaf5aeb12">ast_pthread_create_stack</a> (pthread_t *<a class="el" href="res__timing__pthread_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, pthread_attr_t *attr, void *(*start_routine)(void *), void *data, size_t stacksize, const char *file, const char *caller, int line, const char *start_fn)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a89565d41a0b343afc57a1c0d9eb85160">ast_sha1_hash</a> (char *output, char *input)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce 40 char SHA1 hash of value.  <a href="#a89565d41a0b343afc57a1c0d9eb85160"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aeb597bdc9a1209c2e7dd8af04de43485">ast_strip_quoted</a> (char *s, const char *beg_quotes, const char *end_quotes)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Strip leading/trailing whitespace and quotes from a string.  <a href="#aeb597bdc9a1209c2e7dd8af04de43485"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ac0d2fe097c3b32d8f9db56f35812e694">ast_true</a> (const char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make sure something is true. Determine if a string containing a boolean value is "true". This function checks to see whether a string passed to it is an indication of an "true" value. It checks to see if the string is "yes", "true", "y", "t", "on" or "1".  <a href="#ac0d2fe097c3b32d8f9db56f35812e694"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a> (struct timeval a, struct timeval b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the sum of two timevals a + b.  <a href="#a97e1bb8fbd7a103212789e87e7ed6073"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aa13b651c18bc6004cab21ac041d44dd8">ast_tvsub</a> (struct timeval a, struct timeval b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the difference of two timevals a - b.  <a href="#aa13b651c18bc6004cab21ac041d44dd8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a3115ebeab1be5667662faf6d6a54894f">ast_unescape_c</a> (char *src)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert some C escape sequences.  <a href="#a3115ebeab1be5667662faf6d6a54894f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a20ca5b03887fb1ecf589590182f4a9aa">ast_unescape_semicolon</a> (char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Strip backslash for "escaped" semicolons, the string to be stripped (will be modified).  <a href="#a20ca5b03887fb1ecf589590182f4a9aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#adafa7619a91aca23fc519bcc31ae8dff">ast_uri_decode</a> (char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_uri_decode: Decode SIP URI, URN, URL (overwrite the string)  <a href="#adafa7619a91aca23fc519bcc31ae8dff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a4736440328d6809ea8d9f57c0606f253">ast_uri_encode</a> (const char *string, char *outbuf, int buflen, int doreserved)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_uri_encode: Turn text string to URI-encoded XX version  <a href="#a4736440328d6809ea8d9f57c0606f253"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a7f67fc7c9501569b338913c796d86c45">ast_utils_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a60404ef44696316455e79c3a002cc71e">ast_wait_for_input</a> (int fd, int ms)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ac58e0f6d4af3a1a7444467e51a300a08">ast_wait_for_output</a> (int fd, int timeoutms)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a7bc2df9f50343c9e3bf8b6200c709996">base64_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a763d9f2734d56e19a6de3b461a396a1a">dummy_start</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a3f966fe2f565bf47d8a37c59475d7958">gethostbyname_r</a> (const char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct hostent *ret, char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, size_t buflen, struct hostent **result, int *h_errnop)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reentrant replacement for gethostbyname for BSD-based systems.  <a href="#a3f966fe2f565bf47d8a37c59475d7958"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ae011d19bb4f1d706eecb7e2b0c7ad581">tvfix</a> (struct timeval a)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#abd7963f51b12591f39f99c08277ec41d">__ast_string_field_empty</a> [] = &quot;&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ade4348139e9d2506805737d46317403d">__mutex</a> = ((<a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>) PTHREAD_MUTEX_INITIALIZER )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a> [256]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a> [64]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a29aac26dfc884358b9b98aa7c89fee44">dev_urandom_fd</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ab1a3720160370ec1c8acc7da43ee0095">fetchadd_m</a> = ((<a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>) PTHREAD_MUTEX_INITIALIZER )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ac465762c00b512ce7c2af42eb20cf7f8">inet_ntoa_buf</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_inet_ntoa_buf , .custom_init = NULL , }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aff56af259d6f99172edddacdad8e9372">randomlock</a> = ((<a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>) PTHREAD_MUTEX_INITIALIZER )</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">glibc puts a lock inside random(3), so that the results are thread-safe. BSD libc (and others) do not.  <a href="#aff56af259d6f99172edddacdad8e9372"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Utility functions. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>These are important for portability and security, so please use them in favour of other routines. Please consult the CODING GUIDELINES for more information. </dd></dl>

<p>Definition in file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a805616595a796949ade4a78edc628f99"></a><!-- doxytag: member="utils.c::AST_API_MODULE" ref="a805616595a796949ade4a78edc628f99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_API_MODULE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00062">62</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa1591a4f3a86360108de5b9ba34980ca"></a><!-- doxytag: member="utils.c::ERANGE" ref="aa1591a4f3a86360108de5b9ba34980ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ERANGE&nbsp;&nbsp;&nbsp;34</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>duh? ERANGE value copied from web... </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00072">72</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00082">gethostbyname_r()</a>, and <a class="el" href="app__queue_8c_source.html#l04667">reload_queue_members()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a146c1b2155b03eb2ffa3f4ba755034"></a><!-- doxytag: member="utils.c::ONE_MILLION" ref="a6a146c1b2155b03eb2ffa3f4ba755034" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ONE_MILLION&nbsp;&nbsp;&nbsp;1000000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01345">1345</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01365">ast_tvadd()</a>, <a class="el" href="utils_8c_source.html#l01379">ast_tvsub()</a>, and <a class="el" href="utils_8c_source.html#l01350">tvfix()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7466d46d24c1418dbc0c814a03e1a5dc"></a><!-- doxytag: member="utils.c::__ast_string_field_alloc_space" ref="a7466d46d24c1418dbc0c814a03e1a5dc" args="(struct ast_string_field_mgr *mgr, struct ast_string_field_pool **pool_head, size_t needed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> __ast_string_field_alloc_space </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>mgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **&nbsp;</td>
          <td class="paramname"> <em>pool_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>needed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01568">1568</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01480">add_string_pool()</a>, <a class="el" href="stringfields_8h_source.html#l00140">ast_string_field_mgr::last_alloc</a>, <a class="el" href="stringfields_8h_source.html#l00142">ast_string_field_mgr::owner_file</a>, <a class="el" href="stringfields_8h_source.html#l00143">ast_string_field_mgr::owner_func</a>, <a class="el" href="stringfields_8h_source.html#l00144">ast_string_field_mgr::owner_line</a>, <a class="el" href="stringfields_8h_source.html#l00138">ast_string_field_mgr::size</a>, and <a class="el" href="stringfields_8h_source.html#l00139">ast_string_field_mgr::used</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01570"></a>01570 {
<a name="l01571"></a>01571    <span class="keywordtype">char</span> *result = NULL;
<a name="l01572"></a>01572    <span class="keywordtype">size_t</span> space = mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a854352f53b148adc24983a58a1866d66">size</a> - mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;
<a name="l01573"></a>01573 
<a name="l01574"></a>01574    <span class="keywordflow">if</span> (__builtin_expect(needed &gt; space, 0)) {
<a name="l01575"></a>01575       <span class="keywordtype">size_t</span> new_size = mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a854352f53b148adc24983a58a1866d66">size</a> * 2;
<a name="l01576"></a>01576 
<a name="l01577"></a>01577       <span class="keywordflow">while</span> (new_size &lt; needed)
<a name="l01578"></a>01578          new_size *= 2;
<a name="l01579"></a>01579 
<a name="l01580"></a>01580 <span class="preprocessor">#if defined(__AST_DEBUG_MALLOC)</span>
<a name="l01581"></a>01581 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#ad74eb920d81cc82cbbfe3079b8140530" title="add a new block to the pool. We can only allocate from the topmost pool, so the fields...">add_string_pool</a>(mgr, pool_head, new_size, mgr-&gt;<a class="code" href="structast__string__field__mgr.html#acc76495190eef060bf6cfd862823b4d4">owner_file</a>, mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a09087f8ccb4895ce186313e9154f895f">owner_line</a>, mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a7c862795849b24a961d548682343670f">owner_func</a>))
<a name="l01582"></a>01582          <span class="keywordflow">return</span> NULL;
<a name="l01583"></a>01583 <span class="preprocessor">#else</span>
<a name="l01584"></a>01584 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#ad74eb920d81cc82cbbfe3079b8140530" title="add a new block to the pool. We can only allocate from the topmost pool, so the fields...">add_string_pool</a>(mgr, pool_head, new_size, __FILE__, __LINE__, __FUNCTION__))
<a name="l01585"></a>01585          <span class="keywordflow">return</span> NULL;
<a name="l01586"></a>01586 <span class="preprocessor">#endif</span>
<a name="l01587"></a>01587 <span class="preprocessor"></span>   }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589    result = (*pool_head)-&gt;base + mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;
<a name="l01590"></a>01590    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> += needed;
<a name="l01591"></a>01591    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a3c2227ec1356c037606f8639bdefda71">last_alloc</a> = result;
<a name="l01592"></a>01592    <span class="keywordflow">return</span> result;
<a name="l01593"></a>01593 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4e24c6a8b5b6ae53764e6a0e9c313506"></a><!-- doxytag: member="utils.c::__ast_string_field_init" ref="a4e24c6a8b5b6ae53764e6a0e9c313506" args="(struct ast_string_field_mgr *mgr, struct ast_string_field_pool **pool_head, int needed, const char *file, int lineno, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __ast_string_field_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>mgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **&nbsp;</td>
          <td class="paramname"> <em>pool_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>needed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01514">1514</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01480">add_string_pool()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="stringfields_8h_source.html#l00140">ast_string_field_mgr::last_alloc</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="stringfields_8h_source.html#l00142">ast_string_field_mgr::owner_file</a>, <a class="el" href="stringfields_8h_source.html#l00143">ast_string_field_mgr::owner_func</a>, <a class="el" href="stringfields_8h_source.html#l00144">ast_string_field_mgr::owner_line</a>, <a class="el" href="stringfields_8h_source.html#l00127">ast_string_field_pool::prev</a>, and <a class="el" href="stringfields_8h_source.html#l00139">ast_string_field_mgr::used</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01516"></a>01516 {
<a name="l01517"></a>01517    <span class="keyword">const</span> <span class="keywordtype">char</span> **p = (<span class="keyword">const</span> <span class="keywordtype">char</span> **) pool_head + 1;
<a name="l01518"></a>01518    <span class="keyword">struct </span><a class="code" href="structast__string__field__pool.html">ast_string_field_pool</a> *cur = NULL;
<a name="l01519"></a>01519    <span class="keyword">struct </span><a class="code" href="structast__string__field__pool.html">ast_string_field_pool</a> *preserve = NULL;
<a name="l01520"></a>01520 
<a name="l01521"></a>01521    <span class="comment">/* clear fields - this is always necessary */</span>
<a name="l01522"></a>01522    <span class="keywordflow">while</span> ((<span class="keyword">struct</span> <a class="code" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *) p != mgr)
<a name="l01523"></a>01523       *p++ = <a class="code" href="stringfields_8h.html#abd7963f51b12591f39f99c08277ec41d">__ast_string_field_empty</a>;
<a name="l01524"></a>01524    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a3c2227ec1356c037606f8639bdefda71">last_alloc</a> = NULL;
<a name="l01525"></a>01525 <span class="preprocessor">#if defined(__AST_DEBUG_MALLOC)</span>
<a name="l01526"></a>01526 <span class="preprocessor"></span>   mgr-&gt;<a class="code" href="structast__string__field__mgr.html#acc76495190eef060bf6cfd862823b4d4">owner_file</a> = file;
<a name="l01527"></a>01527    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a7c862795849b24a961d548682343670f">owner_func</a> = func;
<a name="l01528"></a>01528    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a09087f8ccb4895ce186313e9154f895f">owner_line</a> = lineno;
<a name="l01529"></a>01529 <span class="preprocessor">#endif</span>
<a name="l01530"></a>01530 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (needed &gt; 0) {    <span class="comment">/* allocate the initial pool */</span>
<a name="l01531"></a>01531       *pool_head = NULL;
<a name="l01532"></a>01532       <span class="keywordflow">return</span> <a class="code" href="utils_8c.html#ad74eb920d81cc82cbbfe3079b8140530" title="add a new block to the pool. We can only allocate from the topmost pool, so the fields...">add_string_pool</a>(mgr, pool_head, needed, file, lineno, func);
<a name="l01533"></a>01533    }
<a name="l01534"></a>01534    <span class="keywordflow">if</span> (needed &lt; 0) {    <span class="comment">/* reset all pools */</span>
<a name="l01535"></a>01535       <span class="keywordflow">if</span> (*pool_head == NULL) {
<a name="l01536"></a>01536          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;trying to reset empty pool\n&quot;</span>);
<a name="l01537"></a>01537          <span class="keywordflow">return</span> -1;
<a name="l01538"></a>01538       }
<a name="l01539"></a>01539       cur = *pool_head;
<a name="l01540"></a>01540    } <span class="keywordflow">else</span> {       <span class="comment">/* preserve the last pool */</span>
<a name="l01541"></a>01541       <span class="keywordflow">if</span> (*pool_head == NULL) {
<a name="l01542"></a>01542          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;trying to reset empty pool\n&quot;</span>);
<a name="l01543"></a>01543          <span class="keywordflow">return</span> -1;
<a name="l01544"></a>01544       }
<a name="l01545"></a>01545       mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> = 0;
<a name="l01546"></a>01546       preserve = *pool_head;
<a name="l01547"></a>01547       cur = preserve-&gt;<a class="code" href="structast__string__field__pool.html#a5782414ec616579b78d42c79ed254962">prev</a>;
<a name="l01548"></a>01548    }
<a name="l01549"></a>01549 
<a name="l01550"></a>01550    <span class="keywordflow">if</span> (preserve) {
<a name="l01551"></a>01551       preserve-&gt;<a class="code" href="structast__string__field__pool.html#a5782414ec616579b78d42c79ed254962">prev</a> = NULL;
<a name="l01552"></a>01552    }
<a name="l01553"></a>01553 
<a name="l01554"></a>01554    <span class="keywordflow">while</span> (cur) {
<a name="l01555"></a>01555       <span class="keyword">struct </span><a class="code" href="structast__string__field__pool.html">ast_string_field_pool</a> *<a class="code" href="structast__string__field__pool.html#a5782414ec616579b78d42c79ed254962">prev</a> = cur-&gt;<a class="code" href="structast__string__field__pool.html#a5782414ec616579b78d42c79ed254962">prev</a>;
<a name="l01556"></a>01556 
<a name="l01557"></a>01557       <span class="keywordflow">if</span> (cur != preserve) {
<a name="l01558"></a>01558          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cur);
<a name="l01559"></a>01559       }
<a name="l01560"></a>01560       cur = prev;
<a name="l01561"></a>01561    }
<a name="l01562"></a>01562 
<a name="l01563"></a>01563    *pool_head = preserve;
<a name="l01564"></a>01564 
<a name="l01565"></a>01565    <span class="keywordflow">return</span> 0;
<a name="l01566"></a>01566 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1d75cac4d629dcf89e6fd872206bef58"></a><!-- doxytag: member="utils.c::__ast_string_field_ptr_build" ref="a1d75cac4d629dcf89e6fd872206bef58" args="(struct ast_string_field_mgr *mgr, struct ast_string_field_pool **pool_head, ast_string_field *ptr, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __ast_string_field_ptr_build </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>mgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **&nbsp;</td>
          <td class="paramname"> <em>pool_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> *&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01674">1674</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01618">__ast_string_field_ptr_build_va()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01677"></a>01677 {
<a name="l01678"></a>01678    va_list ap1, ap2;
<a name="l01679"></a>01679 
<a name="l01680"></a>01680    va_start(ap1, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);
<a name="l01681"></a>01681    va_start(ap2, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);     <span class="comment">/* va_copy does not exist on FreeBSD */</span>
<a name="l01682"></a>01682 
<a name="l01683"></a>01683    <a class="code" href="stringfields_8h.html#ad98e24bec15ed4b5605f336406cbe370">__ast_string_field_ptr_build_va</a>(mgr, pool_head, ptr, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>, ap1, ap2);
<a name="l01684"></a>01684 
<a name="l01685"></a>01685    va_end(ap1);
<a name="l01686"></a>01686    va_end(ap2);
<a name="l01687"></a>01687 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a75c416951b9c4a28f609c9a64d4d905a"></a><!-- doxytag: member="utils.c::__ast_string_field_ptr_build_va" ref="a75c416951b9c4a28f609c9a64d4d905a" args="(struct ast_string_field_mgr *mgr, struct ast_string_field_pool **pool_head, ast_string_field *ptr, const char *format, va_list ap1, va_list ap2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __ast_string_field_ptr_build_va </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>mgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **&nbsp;</td>
          <td class="paramname"> <em>pool_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> *&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&nbsp;</td>
          <td class="paramname"> <em>ap1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&nbsp;</td>
          <td class="paramname"> <em>ap2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01618">1618</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01480">add_string_pool()</a>, <a class="el" href="chan__dahdi_8c_source.html#l10640">available()</a>, <a class="el" href="stringfields_8h_source.html#l00140">ast_string_field_mgr::last_alloc</a>, <a class="el" href="stringfields_8h_source.html#l00142">ast_string_field_mgr::owner_file</a>, <a class="el" href="stringfields_8h_source.html#l00143">ast_string_field_mgr::owner_func</a>, <a class="el" href="stringfields_8h_source.html#l00144">ast_string_field_mgr::owner_line</a>, <a class="el" href="stringfields_8h_source.html#l00138">ast_string_field_mgr::size</a>, and <a class="el" href="stringfields_8h_source.html#l00139">ast_string_field_mgr::used</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01674">__ast_string_field_ptr_build()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01621"></a>01621 {
<a name="l01622"></a>01622    <span class="keywordtype">size_t</span> needed;
<a name="l01623"></a>01623    <span class="keywordtype">size_t</span> <a class="code" href="chan__dahdi_8c.html#a305c0e17a1db304e7e5d0a4c39e5d9a4">available</a>;
<a name="l01624"></a>01624    <span class="keywordtype">size_t</span> space = mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a854352f53b148adc24983a58a1866d66">size</a> - mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;
<a name="l01625"></a>01625    <span class="keywordtype">char</span> *target;
<a name="l01626"></a>01626 
<a name="l01627"></a>01627    <span class="comment">/* if the field already has space allocated, try to reuse it;</span>
<a name="l01628"></a>01628 <span class="comment">      otherwise, use the empty space at the end of the current</span>
<a name="l01629"></a>01629 <span class="comment">      pool</span>
<a name="l01630"></a>01630 <span class="comment">   */</span>
<a name="l01631"></a>01631    <span class="keywordflow">if</span> ((*ptr)[0] != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l01632"></a>01632       target = (<span class="keywordtype">char</span> *) *ptr;
<a name="l01633"></a>01633       available = strlen(target) + 1;
<a name="l01634"></a>01634    } <span class="keywordflow">else</span> {
<a name="l01635"></a>01635       target = (*pool_head)-&gt;base + mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;
<a name="l01636"></a>01636       available = space;
<a name="l01637"></a>01637    }
<a name="l01638"></a>01638 
<a name="l01639"></a>01639    needed = vsnprintf(target, available, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>, ap1) + 1;
<a name="l01640"></a>01640 
<a name="l01641"></a>01641    va_end(ap1);
<a name="l01642"></a>01642 
<a name="l01643"></a>01643    <span class="keywordflow">if</span> (needed &gt; available) {
<a name="l01644"></a>01644       <span class="comment">/* if the space needed can be satisfied by using the current</span>
<a name="l01645"></a>01645 <span class="comment">         pool (which could only occur if we tried to use the field&apos;s</span>
<a name="l01646"></a>01646 <span class="comment">         allocated space and failed), then use that space; otherwise</span>
<a name="l01647"></a>01647 <span class="comment">         allocate a new pool</span>
<a name="l01648"></a>01648 <span class="comment">      */</span>
<a name="l01649"></a>01649       <span class="keywordflow">if</span> (needed &gt; space) {
<a name="l01650"></a>01650          <span class="keywordtype">size_t</span> new_size = mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a854352f53b148adc24983a58a1866d66">size</a> * 2;
<a name="l01651"></a>01651 
<a name="l01652"></a>01652          <span class="keywordflow">while</span> (new_size &lt; needed)
<a name="l01653"></a>01653             new_size *= 2;
<a name="l01654"></a>01654          
<a name="l01655"></a>01655 <span class="preprocessor">#if defined(__AST_DEBUG_MALLOC)</span>
<a name="l01656"></a>01656 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#ad74eb920d81cc82cbbfe3079b8140530" title="add a new block to the pool. We can only allocate from the topmost pool, so the fields...">add_string_pool</a>(mgr, pool_head, new_size, mgr-&gt;<a class="code" href="structast__string__field__mgr.html#acc76495190eef060bf6cfd862823b4d4">owner_file</a>, mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a09087f8ccb4895ce186313e9154f895f">owner_line</a>, mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a7c862795849b24a961d548682343670f">owner_func</a>))
<a name="l01657"></a>01657             <span class="keywordflow">return</span>;
<a name="l01658"></a>01658 <span class="preprocessor">#else</span>
<a name="l01659"></a>01659 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#ad74eb920d81cc82cbbfe3079b8140530" title="add a new block to the pool. We can only allocate from the topmost pool, so the fields...">add_string_pool</a>(mgr, pool_head, new_size, NULL, 0, NULL))
<a name="l01660"></a>01660             <span class="keywordflow">return</span>;
<a name="l01661"></a>01661 <span class="preprocessor">#endif</span>
<a name="l01662"></a>01662 <span class="preprocessor"></span>      }
<a name="l01663"></a>01663 
<a name="l01664"></a>01664       target = (*pool_head)-&gt;base + mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;
<a name="l01665"></a>01665       vsprintf(target, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>, ap2);
<a name="l01666"></a>01666    }
<a name="l01667"></a>01667 
<a name="l01668"></a>01668    <span class="keywordflow">if</span> (*ptr != target) {
<a name="l01669"></a>01669       mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a3c2227ec1356c037606f8639bdefda71">last_alloc</a> = *ptr = target;
<a name="l01670"></a>01670       mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> += needed;
<a name="l01671"></a>01671    }
<a name="l01672"></a>01672 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac438a66ce99b119c7fb4ee7f787d7232"></a><!-- doxytag: member="utils.c::__ast_string_field_ptr_grow" ref="ac438a66ce99b119c7fb4ee7f787d7232" args="(struct ast_string_field_mgr *mgr, size_t needed, const ast_string_field *ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __ast_string_field_ptr_grow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>mgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>needed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stringfields_8h.html#abb39dc592226a570e6a73f1b9b09b021">ast_string_field</a> *&nbsp;</td>
          <td class="paramname"> <em>ptr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01595">1595</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="stringfields_8h_source.html#l00140">ast_string_field_mgr::last_alloc</a>, <a class="el" href="stringfields_8h_source.html#l00138">ast_string_field_mgr::size</a>, and <a class="el" href="stringfields_8h_source.html#l00139">ast_string_field_mgr::used</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01597"></a>01597 {
<a name="l01598"></a>01598    <span class="keywordtype">int</span> grow = needed - (strlen(*ptr) + 1);
<a name="l01599"></a>01599    <span class="keywordtype">size_t</span> space = mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a854352f53b148adc24983a58a1866d66">size</a> - mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a>;
<a name="l01600"></a>01600 
<a name="l01601"></a>01601    <span class="keywordflow">if</span> (grow &lt;= 0) {
<a name="l01602"></a>01602       <span class="keywordflow">return</span> 0;
<a name="l01603"></a>01603    }
<a name="l01604"></a>01604 
<a name="l01605"></a>01605    <span class="keywordflow">if</span> (*ptr != mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a3c2227ec1356c037606f8639bdefda71">last_alloc</a>) {
<a name="l01606"></a>01606       <span class="keywordflow">return</span> 1;
<a name="l01607"></a>01607    }
<a name="l01608"></a>01608 
<a name="l01609"></a>01609    <span class="keywordflow">if</span> (space &lt; grow) {
<a name="l01610"></a>01610       <span class="keywordflow">return</span> 1;
<a name="l01611"></a>01611    }
<a name="l01612"></a>01612 
<a name="l01613"></a>01613    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> += grow;
<a name="l01614"></a>01614 
<a name="l01615"></a>01615    <span class="keywordflow">return</span> 0;
<a name="l01616"></a>01616 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0114e8cab34567d42d506ad18c7ff28e"></a><!-- doxytag: member="utils.c::__init_inet_ntoa_buf" ref="a0114e8cab34567d42d506ad18c7ff28e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __init_inet_ntoa_buf </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00068">68</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00085"></a>00085 {
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad74eb920d81cc82cbbfe3079b8140530"></a><!-- doxytag: member="utils.c::add_string_pool" ref="ad74eb920d81cc82cbbfe3079b8140530" args="(struct ast_string_field_mgr *mgr, struct ast_string_field_pool **pool_head, size_t size, const char *file, int lineno, const char *func)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int add_string_pool </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__mgr.html">ast_string_field_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>mgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__string__field__pool.html">ast_string_field_pool</a> **&nbsp;</td>
          <td class="paramname"> <em>pool_head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>add a new block to the pool. We can only allocate from the topmost pool, so the fields in *mgr reflect the size of that only. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01480">1480</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="astmm_8c_source.html#l00199">__ast_calloc()</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="stringfields_8h_source.html#l00140">ast_string_field_mgr::last_alloc</a>, <a class="el" href="stringfields_8h_source.html#l00127">ast_string_field_pool::prev</a>, <a class="el" href="stringfields_8h_source.html#l00138">ast_string_field_mgr::size</a>, and <a class="el" href="stringfields_8h_source.html#l00139">ast_string_field_mgr::used</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01568">__ast_string_field_alloc_space()</a>, <a class="el" href="utils_8c_source.html#l01514">__ast_string_field_init()</a>, and <a class="el" href="utils_8c_source.html#l01618">__ast_string_field_ptr_build_va()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01482"></a>01482 {
<a name="l01483"></a>01483    <span class="keyword">struct </span><a class="code" href="structast__string__field__pool.html">ast_string_field_pool</a> *pool;
<a name="l01484"></a>01484 
<a name="l01485"></a>01485 <span class="preprocessor">#if defined(__AST_DEBUG_MALLOC)</span>
<a name="l01486"></a>01486 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (!(pool = <a class="code" href="astmm_8h.html#ad800d5c993a0c605f6e061bdef1b524c">__ast_calloc</a>(1, <span class="keyword">sizeof</span>(*pool) + size, file, lineno, func))) {
<a name="l01487"></a>01487       <span class="keywordflow">return</span> -1;
<a name="l01488"></a>01488    }
<a name="l01489"></a>01489 <span class="preprocessor">#else</span>
<a name="l01490"></a>01490 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (!(pool = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*pool) + size))) {
<a name="l01491"></a>01491       <span class="keywordflow">return</span> -1;
<a name="l01492"></a>01492    }
<a name="l01493"></a>01493 <span class="preprocessor">#endif</span>
<a name="l01494"></a>01494 <span class="preprocessor"></span>
<a name="l01495"></a>01495    pool-&gt;<a class="code" href="structast__string__field__pool.html#a5782414ec616579b78d42c79ed254962">prev</a> = *pool_head;
<a name="l01496"></a>01496    *pool_head = pool;
<a name="l01497"></a>01497    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a854352f53b148adc24983a58a1866d66">size</a> = size;
<a name="l01498"></a>01498    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#ae8cc011bf3ee2d3c19743095ffc0f7a5">used</a> = 0;
<a name="l01499"></a>01499    mgr-&gt;<a class="code" href="structast__string__field__mgr.html#a3c2227ec1356c037606f8639bdefda71">last_alloc</a> = NULL;
<a name="l01500"></a>01500 
<a name="l01501"></a>01501    <span class="keywordflow">return</span> 0;
<a name="l01502"></a>01502 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aafd2c396c15ac749e33198a5d4fd592f"></a><!-- doxytag: member="utils.c::ast_atomic_fetchadd_int_slow" ref="aafd2c396c15ac749e33198a5d4fd592f" args="(volatile int *p, int v)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_atomic_fetchadd_int_slow </td>
          <td>(</td>
          <td class="paramtype">volatile int *&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>v</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01692">1692</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, and <a class="el" href="utils_8c_source.html#l01690">fetchadd_m</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01693"></a>01693 {
<a name="l01694"></a>01694    <span class="keywordtype">int</span> ret;
<a name="l01695"></a>01695    <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;<a class="code" href="utils_8c.html#ab1a3720160370ec1c8acc7da43ee0095">fetchadd_m</a>);
<a name="l01696"></a>01696    ret = *p;
<a name="l01697"></a>01697    *p += v;
<a name="l01698"></a>01698    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;<a class="code" href="utils_8c.html#ab1a3720160370ec1c8acc7da43ee0095">fetchadd_m</a>);
<a name="l01699"></a>01699    <span class="keywordflow">return</span> ret;
<a name="l01700"></a>01700 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1e7e06bd20719ecfd58b67f230780ffa"></a><!-- doxytag: member="utils.c::ast_base64decode" ref="a1e7e06bd20719ecfd58b67f230780ffa" args="(unsigned char *dst, const char *src, int max)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_base64decode </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>decode BASE64 encoded text </p>
<p>Decode data from base64. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00264">264</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="res__crypto_8c_source.html#l00421">__ast_check_signature()</a>, <a class="el" href="func__aes_8c_source.html#l00073">aes_helper()</a>, <a class="el" href="func__base64_8c_source.html#l00075">base64_decode()</a>, and <a class="el" href="app__osplookup_8c_source.html#l00506">osp_validate_token()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00265"></a>00265 {
<a name="l00266"></a>00266    <span class="keywordtype">int</span> cnt = 0;
<a name="l00267"></a>00267    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> byte = 0;
<a name="l00268"></a>00268    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bits = 0;
<a name="l00269"></a>00269    <span class="keywordtype">int</span> incnt = 0;
<a name="l00270"></a>00270    <span class="keywordflow">while</span>(*src &amp;&amp; *src != <span class="charliteral">&apos;=&apos;</span> &amp;&amp; (cnt &lt; max)) {
<a name="l00271"></a>00271       <span class="comment">/* Shift in 6 bits of input */</span>
<a name="l00272"></a>00272       byte &lt;&lt;= 6;
<a name="l00273"></a>00273       byte |= (<a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[(int)(*src)]) &amp; 0x3f;
<a name="l00274"></a>00274       bits += 6;
<a name="l00275"></a>00275       src++;
<a name="l00276"></a>00276       incnt++;
<a name="l00277"></a>00277       <span class="comment">/* If we have at least 8 bits left over, take that character </span>
<a name="l00278"></a>00278 <span class="comment">         off the top */</span>
<a name="l00279"></a>00279       <span class="keywordflow">if</span> (bits &gt;= 8)  {
<a name="l00280"></a>00280          bits -= 8;
<a name="l00281"></a>00281          *dst = (byte &gt;&gt; bits) &amp; 0xff;
<a name="l00282"></a>00282          dst++;
<a name="l00283"></a>00283          cnt++;
<a name="l00284"></a>00284       }
<a name="l00285"></a>00285    }
<a name="l00286"></a>00286    <span class="comment">/* Dont worry about left over bits, they&apos;re extra anyway */</span>
<a name="l00287"></a>00287    <span class="keywordflow">return</span> cnt;
<a name="l00288"></a>00288 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a555dad1bd5b23acf01cf08f1affab879"></a><!-- doxytag: member="utils.c::ast_base64encode" ref="a555dad1bd5b23acf01cf08f1affab879" args="(char *dst, const unsigned char *src, int srclen, int max)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_base64encode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>srclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encode data in base64. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dst</em>&nbsp;</td><td>the destination buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>src</em>&nbsp;</td><td>the source data to be encoded </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>srclen</em>&nbsp;</td><td>the <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes present in the source buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>max</em>&nbsp;</td><td>the maximum <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes to write into the destination buffer, *including* the terminating NULL character. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00342">342</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00291">ast_base64encode_full()</a>.</p>

<p>Referenced by <a class="el" href="res__crypto_8c_source.html#l00376">__ast_sign()</a>, <a class="el" href="func__aes_8c_source.html#l00073">aes_helper()</a>, <a class="el" href="res__jabber_8c_source.html#l00895">aji_start_sasl()</a>, <a class="el" href="func__base64_8c_source.html#l00062">base64_encode()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02082">build_secret()</a>, and <a class="el" href="app__osplookup_8c_source.html#l00591">osp_check_destination()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00343"></a>00343 {
<a name="l00344"></a>00344    <span class="keywordflow">return</span> <a class="code" href="utils_8h.html#abc46a030bcce6696e31ac29a79558b53" title="encode text to BASE64 coding">ast_base64encode_full</a>(dst, src, srclen, max, 0);
<a name="l00345"></a>00345 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abc46a030bcce6696e31ac29a79558b53"></a><!-- doxytag: member="utils.c::ast_base64encode_full" ref="abc46a030bcce6696e31ac29a79558b53" args="(char *dst, const unsigned char *src, int srclen, int max, int linebreaks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_base64encode_full </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>srclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>linebreaks</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>encode text to BASE64 coding </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00291">291</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00342">ast_base64encode()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00292"></a>00292 {
<a name="l00293"></a>00293    <span class="keywordtype">int</span> cnt = 0;
<a name="l00294"></a>00294    <span class="keywordtype">int</span> col = 0;
<a name="l00295"></a>00295    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> byte = 0;
<a name="l00296"></a>00296    <span class="keywordtype">int</span> bits = 0;
<a name="l00297"></a>00297    <span class="keywordtype">int</span> cntin = 0;
<a name="l00298"></a>00298    <span class="comment">/* Reserve space for null byte at end of string */</span>
<a name="l00299"></a>00299    max--;
<a name="l00300"></a>00300    <span class="keywordflow">while</span> ((cntin &lt; srclen) &amp;&amp; (cnt &lt; max)) {
<a name="l00301"></a>00301       byte &lt;&lt;= 8;
<a name="l00302"></a>00302       byte |= *(src++);
<a name="l00303"></a>00303       bits += 8;
<a name="l00304"></a>00304       cntin++;
<a name="l00305"></a>00305       <span class="keywordflow">if</span> ((bits == 24) &amp;&amp; (cnt + 4 &lt;= max)) {
<a name="l00306"></a>00306          *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[(byte &gt;&gt; 18) &amp; 0x3f];
<a name="l00307"></a>00307          *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[(byte &gt;&gt; 12) &amp; 0x3f];
<a name="l00308"></a>00308          *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[(byte &gt;&gt; 6) &amp; 0x3f];
<a name="l00309"></a>00309          *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[byte &amp; 0x3f];
<a name="l00310"></a>00310          cnt += 4;
<a name="l00311"></a>00311          col += 4;
<a name="l00312"></a>00312          bits = 0;
<a name="l00313"></a>00313          byte = 0;
<a name="l00314"></a>00314       }
<a name="l00315"></a>00315       <span class="keywordflow">if</span> (linebreaks &amp;&amp; (cnt &lt; max) &amp;&amp; (col == 64)) {
<a name="l00316"></a>00316          *dst++ = <span class="charliteral">&apos;\n&apos;</span>;
<a name="l00317"></a>00317          cnt++;
<a name="l00318"></a>00318          col = 0;
<a name="l00319"></a>00319       }
<a name="l00320"></a>00320    }
<a name="l00321"></a>00321    <span class="keywordflow">if</span> (bits &amp;&amp; (cnt + 4 &lt;= max)) {
<a name="l00322"></a>00322       <span class="comment">/* Add one last character for the remaining bits, </span>
<a name="l00323"></a>00323 <span class="comment">         padding the rest with 0 */</span>
<a name="l00324"></a>00324       byte &lt;&lt;= 24 - bits;
<a name="l00325"></a>00325       *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[(byte &gt;&gt; 18) &amp; 0x3f];
<a name="l00326"></a>00326       *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[(byte &gt;&gt; 12) &amp; 0x3f];
<a name="l00327"></a>00327       <span class="keywordflow">if</span> (bits == 16)
<a name="l00328"></a>00328          *dst++ = <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[(byte &gt;&gt; 6) &amp; 0x3f];
<a name="l00329"></a>00329       <span class="keywordflow">else</span>
<a name="l00330"></a>00330          *dst++ = <span class="charliteral">&apos;=&apos;</span>;
<a name="l00331"></a>00331       *dst++ = <span class="charliteral">&apos;=&apos;</span>;
<a name="l00332"></a>00332       cnt += 4;
<a name="l00333"></a>00333    }
<a name="l00334"></a>00334    <span class="keywordflow">if</span> (linebreaks &amp;&amp; (cnt &lt; max)) {
<a name="l00335"></a>00335       *dst++ = <span class="charliteral">&apos;\n&apos;</span>;
<a name="l00336"></a>00336       cnt++;
<a name="l00337"></a>00337    }
<a name="l00338"></a>00338    *dst = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00339"></a>00339    <span class="keywordflow">return</span> cnt;
<a name="l00340"></a>00340 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a603020160399d4876ec09fd299ebcaf9"></a><!-- doxytag: member="utils.c::ast_build_string" ref="a603020160399d4876ec09fd299ebcaf9" args="(char **buffer, size_t *space, const char *fmt,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_build_string </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build a string in a buffer, designed to be called repeatedly. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This method is not recommended. New code should use ast_str_*() instead.</dd></dl>
<p>This is a wrapper for snprintf, that properly handles the buffer pointer and buffer space available.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>current position in buffer to place string into (will be updated on return) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>space</em>&nbsp;</td><td>remaining space in buffer (will be updated on return) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fmt</em>&nbsp;</td><td>printf-style format string </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01299">1299</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01280">ast_build_string_va()</a>.</p>

<p>Referenced by <a class="el" href="res__config__odbc_8c_source.html#l00797">config_odbc()</a>, <a class="el" href="res__agi_8c_source.html#l02137">handle_speechrecognize()</a>, <a class="el" href="pbx__lua_8c_source.html#l00596">lua_func_read()</a>, <a class="el" href="pbx__lua_8c_source.html#l00165">lua_pbx_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01131">pp_each_extension_exec()</a>, and <a class="el" href="res__phoneprov_8c_source.html#l01088">pp_each_user_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01300"></a>01300 {
<a name="l01301"></a>01301    va_list ap;
<a name="l01302"></a>01302    <span class="keywordtype">int</span> result;
<a name="l01303"></a>01303 
<a name="l01304"></a>01304    va_start(ap, fmt);
<a name="l01305"></a>01305    result = <a class="code" href="strings_8h.html#a7cc2336f3642ec07be6058e7fa746e71" title="Build a string in a buffer, designed to be called repeatedly.">ast_build_string_va</a>(buffer, space, fmt, ap);
<a name="l01306"></a>01306    va_end(ap);
<a name="l01307"></a>01307 
<a name="l01308"></a>01308    <span class="keywordflow">return</span> result;
<a name="l01309"></a>01309 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7cc2336f3642ec07be6058e7fa746e71"></a><!-- doxytag: member="utils.c::ast_build_string_va" ref="a7cc2336f3642ec07be6058e7fa746e71" args="(char **buffer, size_t *space, const char *fmt, va_list ap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_build_string_va </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&nbsp;</td>
          <td class="paramname"> <em>ap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build a string in a buffer, designed to be called repeatedly. </p>
<p>This is a wrapper for snprintf, that properly handles the buffer pointer and buffer space available.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, non-zero on failure. </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buffer</em>&nbsp;</td><td>current position in buffer to place string into (will be updated on return) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>space</em>&nbsp;</td><td>remaining space in buffer (will be updated on return) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fmt</em>&nbsp;</td><td>printf-style format string </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ap</em>&nbsp;</td><td>varargs list of arguments for format </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01280">1280</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01299">ast_build_string()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01281"></a>01281 {
<a name="l01282"></a>01282    <span class="keywordtype">int</span> result;
<a name="l01283"></a>01283 
<a name="l01284"></a>01284    <span class="keywordflow">if</span> (!buffer || !*buffer || !space || !*space)
<a name="l01285"></a>01285       <span class="keywordflow">return</span> -1;
<a name="l01286"></a>01286 
<a name="l01287"></a>01287    result = vsnprintf(*buffer, *space, fmt, ap);
<a name="l01288"></a>01288 
<a name="l01289"></a>01289    <span class="keywordflow">if</span> (result &lt; 0)
<a name="l01290"></a>01290       <span class="keywordflow">return</span> -1;
<a name="l01291"></a>01291    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result &gt; *space)
<a name="l01292"></a>01292       result = *space;
<a name="l01293"></a>01293 
<a name="l01294"></a>01294    *buffer += result;
<a name="l01295"></a>01295    *space -= result;
<a name="l01296"></a>01296    <span class="keywordflow">return</span> 0;
<a name="l01297"></a>01297 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae97a3220bac9e353fe2049c0fa8d73a7"></a><!-- doxytag: member="utils.c::ast_careful_fwrite" ref="ae97a3220bac9e353fe2049c0fa8d73a7" args="(FILE *f, int fd, const char *src, size_t len, int timeoutms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_careful_fwrite </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeoutms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write data to a file stream with a timeout. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>the file stream to write to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>the file description to poll on to know when the file stream can be written to without blocking. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>the buffer to write from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>the <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeoutms</em>&nbsp;</td><td>The maximum amount of time to block in this function trying to write, specified in milliseconds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function assumes that the associated file stream has been set up as non-blocking.</dd></dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01154">1154</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="time_8h_source.html#l00089">ast_tvdiff_ms()</a>, <a class="el" href="time_8h_source.html#l00141">ast_tvnow()</a>, <a class="el" href="utils_8c_source.html#l01060">ast_wait_for_output()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="ast__expr2f_8c_source.html#l00563">fwrite</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l00944">send_string()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01155"></a>01155 {
<a name="l01156"></a>01156    <span class="keyword">struct </span>timeval start = <a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>();
<a name="l01157"></a>01157    <span class="keywordtype">int</span> n = 0;
<a name="l01158"></a>01158    <span class="keywordtype">int</span> elapsed = 0;
<a name="l01159"></a>01159 
<a name="l01160"></a>01160    <span class="keywordflow">while</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>) {
<a name="l01161"></a>01161       <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#ac58e0f6d4af3a1a7444467e51a300a08">ast_wait_for_output</a>(fd, timeoutms - elapsed)) {
<a name="l01162"></a>01162          <span class="comment">/* poll returned a fatal error, so bail out immediately. */</span>
<a name="l01163"></a>01163          <span class="keywordflow">return</span> -1;
<a name="l01164"></a>01164       }
<a name="l01165"></a>01165 
<a name="l01166"></a>01166       <span class="comment">/* Clear any errors from a previous write */</span>
<a name="l01167"></a>01167       clearerr(<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>);
<a name="l01168"></a>01168 
<a name="l01169"></a>01169       n = <a class="code" href="ast__expr2f_8c.html#a8541b986268a39ba1b07d9e912d31732">fwrite</a>(src, 1, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, <a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>);
<a name="l01170"></a>01170 
<a name="l01171"></a>01171       <span class="keywordflow">if</span> (ferror(<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>) &amp;&amp; errno != EINTR &amp;&amp; errno != EAGAIN) {
<a name="l01172"></a>01172          <span class="comment">/* fatal error from fwrite() */</span>
<a name="l01173"></a>01173          <span class="keywordflow">if</span> (!feof(<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)) {
<a name="l01174"></a>01174             <span class="comment">/* Don&apos;t spam the logs if it was just that the connection is closed. */</span>
<a name="l01175"></a>01175             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;fwrite() returned error: %s\n&quot;</span>, strerror(errno));
<a name="l01176"></a>01176          }
<a name="l01177"></a>01177          n = -1;
<a name="l01178"></a>01178          <span class="keywordflow">break</span>;
<a name="l01179"></a>01179       }
<a name="l01180"></a>01180 
<a name="l01181"></a>01181       <span class="comment">/* Update for data already written to the socket */</span>
<a name="l01182"></a>01182       <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> -= n;
<a name="l01183"></a>01183       src += n;
<a name="l01184"></a>01184 
<a name="l01185"></a>01185       elapsed = <a class="code" href="time_8h.html#a74e35cffcd45ad6cd7c8587921e8a4c2" title="Computes the difference (in milliseconds) between two struct timeval instances.">ast_tvdiff_ms</a>(<a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>(), start);
<a name="l01186"></a>01186       <span class="keywordflow">if</span> (elapsed &gt;= timeoutms) {
<a name="l01187"></a>01187          <span class="comment">/* We&apos;ve taken too long to write </span>
<a name="l01188"></a>01188 <span class="comment">          * This is only an error condition if we haven&apos;t finished writing. */</span>
<a name="l01189"></a>01189          n = <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> ? -1 : 0;
<a name="l01190"></a>01190          <span class="keywordflow">break</span>;
<a name="l01191"></a>01191       }
<a name="l01192"></a>01192    }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194    <span class="keywordflow">while</span> (fflush(<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)) {
<a name="l01195"></a>01195       <span class="keywordflow">if</span> (errno == EAGAIN || errno == EINTR) {
<a name="l01196"></a>01196          <span class="keywordflow">continue</span>;
<a name="l01197"></a>01197       }
<a name="l01198"></a>01198       <span class="keywordflow">if</span> (!feof(<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)) {
<a name="l01199"></a>01199          <span class="comment">/* Don&apos;t spam the logs if it was just that the connection is closed. */</span>
<a name="l01200"></a>01200          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;fflush() returned error: %s\n&quot;</span>, strerror(errno));
<a name="l01201"></a>01201       }
<a name="l01202"></a>01202       n = -1;
<a name="l01203"></a>01203       <span class="keywordflow">break</span>;
<a name="l01204"></a>01204    }
<a name="l01205"></a>01205 
<a name="l01206"></a>01206    <span class="keywordflow">return</span> n &lt; 0 ? -1 : 0;
<a name="l01207"></a>01207 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a38faf2987c375335b2773964aabf69b3"></a><!-- doxytag: member="utils.c::ast_carefulwrite" ref="a38faf2987c375335b2773964aabf69b3" args="(int fd, char *s, int len, int timeoutms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_carefulwrite </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeoutms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Try to write string, but wait no more than ms milliseconds before timing out. </p>
<p>Try to write string, but wait no more than ms milliseconds before timing out.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The code assumes that the file descriptor has NONBLOCK set, so there is only one system call made to do a write, unless we actually have a need to wait. This way, we get better performance. If the descriptor is blocking, all assumptions on the guaranteed detail do not apply anymore. </dd></dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01113">1113</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="time_8h_source.html#l00089">ast_tvdiff_ms()</a>, <a class="el" href="time_8h_source.html#l00141">ast_tvnow()</a>, <a class="el" href="utils_8c_source.html#l01060">ast_wait_for_output()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l00375">ast_agi_send()</a>, and <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01114"></a>01114 {
<a name="l01115"></a>01115    <span class="keyword">struct </span>timeval start = <a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>();
<a name="l01116"></a>01116    <span class="keywordtype">int</span> res = 0;
<a name="l01117"></a>01117    <span class="keywordtype">int</span> elapsed = 0;
<a name="l01118"></a>01118 
<a name="l01119"></a>01119    <span class="keywordflow">while</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>) {
<a name="l01120"></a>01120       <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#ac58e0f6d4af3a1a7444467e51a300a08">ast_wait_for_output</a>(fd, timeoutms - elapsed)) {
<a name="l01121"></a>01121          <span class="keywordflow">return</span> -1;
<a name="l01122"></a>01122       }
<a name="l01123"></a>01123 
<a name="l01124"></a>01124       res = write(fd, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l01125"></a>01125 
<a name="l01126"></a>01126       <span class="keywordflow">if</span> (res &lt; 0 &amp;&amp; errno != EAGAIN &amp;&amp; errno != EINTR) {
<a name="l01127"></a>01127          <span class="comment">/* fatal error from write() */</span>
<a name="l01128"></a>01128          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;write() returned error: %s\n&quot;</span>, strerror(errno));
<a name="l01129"></a>01129          <span class="keywordflow">return</span> -1;
<a name="l01130"></a>01130       }
<a name="l01131"></a>01131 
<a name="l01132"></a>01132       <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l01133"></a>01133          <span class="comment">/* It was an acceptable error */</span>
<a name="l01134"></a>01134          res = 0;
<a name="l01135"></a>01135       }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137       <span class="comment">/* Update how much data we have left to write */</span>
<a name="l01138"></a>01138       <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> -= res;
<a name="l01139"></a>01139       <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> += res;
<a name="l01140"></a>01140       res = 0;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142       elapsed = <a class="code" href="time_8h.html#a74e35cffcd45ad6cd7c8587921e8a4c2" title="Computes the difference (in milliseconds) between two struct timeval instances.">ast_tvdiff_ms</a>(<a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>(), start);
<a name="l01143"></a>01143       <span class="keywordflow">if</span> (elapsed &gt;= timeoutms) {
<a name="l01144"></a>01144          <span class="comment">/* We&apos;ve taken too long to write </span>
<a name="l01145"></a>01145 <span class="comment">          * This is only an error condition if we haven&apos;t finished writing. */</span>
<a name="l01146"></a>01146          res = <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> ? -1 : 0;
<a name="l01147"></a>01147          <span class="keywordflow">break</span>;
<a name="l01148"></a>01148       }
<a name="l01149"></a>01149    }
<a name="l01150"></a>01150 
<a name="l01151"></a>01151    <span class="keywordflow">return</span> res;
<a name="l01152"></a>01152 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a89056bba460d0aa179d3a3ddc0af472a"></a><!-- doxytag: member="utils.c::ast_enable_packet_fragmentation" ref="a89056bba460d0aa179d3a3ddc0af472a" args="(int sock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_enable_packet_fragmentation </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sock</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disable PMTU discovery on a socket. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>The socket to manipulate </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nothing</dd></dl>
<p>On Linux, UDP sockets default to sending packets with the Dont Fragment (DF) bit set. This is supposedly done to allow the application to do PMTU discovery, but Asterisk does not do this.</p>
<p>Because of this, UDP packets sent by Asterisk that are larger than the MTU of any hop in the path will be lost. This function can be called on a socket to ensure that the DF bit will not be set. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01755">1755</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="netsock_8c_source.html#l00104">ast_netsock_bindaddr()</a>, and <a class="el" href="chan__sip_8c_source.html#l24245">reload_config()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01756"></a>01756 {
<a name="l01757"></a>01757 <span class="preprocessor">#if defined(HAVE_IP_MTU_DISCOVER)</span>
<a name="l01758"></a>01758 <span class="preprocessor"></span>   <span class="keywordtype">int</span> <a class="code" href="structval.html">val</a> = IP_PMTUDISC_DONT;
<a name="l01759"></a>01759    
<a name="l01760"></a>01760    <span class="keywordflow">if</span> (setsockopt(sock, IPPROTO_IP, IP_MTU_DISCOVER, &amp;val, <span class="keyword">sizeof</span>(val)))
<a name="l01761"></a>01761       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to disable PMTU discovery. Large UDP packets may fail to be delivered when sent from this socket.\n&quot;</span>);
<a name="l01762"></a>01762 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_IP_MTU_DISCOVER */</span>
<a name="l01763"></a>01763 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab974fc2bc77e80f85dda82b5cf14bf58"></a><!-- doxytag: member="utils.c::ast_false" ref="ab974fc2bc77e80f85dda82b5cf14bf58" args="(const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_false </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>val</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make sure something is false. Determine if a string containing a boolean value is "false". This function checks to see whether a string passed to it is an indication of an "false" value. It checks to see if the string is "no", "false", "n", "f", "off" or "0". </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if <a class="el" href="structval.html">val</a> is a NULL pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>if "true". </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01328">1328</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="rtp_8c_source.html#l04739">__ast_rtp_reload()</a>, <a class="el" href="udptl_8c_source.html#l01342">__ast_udptl_reload()</a>, <a class="el" href="res__odbc_8c_source.html#l01502">acf_transaction_write()</a>, <a class="el" href="res__jabber_8c_source.html#l02660">aji_create_client()</a>, <a class="el" href="res__jabber_8c_source.html#l02907">aji_load_config()</a>, <a class="el" href="chan__iax2_8c_source.html#l11880">build_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l12156">build_user()</a>, <a class="el" href="chan__dahdi_8c_source.html#l15112">dahdi_set_dnd()</a>, <a class="el" href="app__followme_8c_source.html#l00917">find_realtime()</a>, <a class="el" href="func__channel_8c_source.html#l00280">func_channel_write()</a>, <a class="el" href="chan__sip_8c_source.html#l23300">handle_common_options()</a>, <a class="el" href="func__odbc_8c_source.html#l00745">init_acf_query()</a>, <a class="el" href="app__voicemail_8c_source.html#l10603">load_config()</a>, <a class="el" href="res__odbc_8c_source.html#l00730">load_odbc_config()</a>, <a class="el" href="app__queue_8c_source.html#l01342">parse_empty_options()</a>, <a class="el" href="chan__sip_8c_source.html#l24245">reload_config()</a>, <a class="el" href="res__agi_8c_source.html#l02853">run_agi()</a>, <a class="el" href="chan__iax2_8c_source.html#l12493">set_config()</a>, <a class="el" href="chan__sip_8c_source.html#l23229">set_insecure_flags()</a>, <a class="el" href="app__meetme_8c_source.html#l06042">sla_build_trunk()</a>, and <a class="el" href="manager_8c_source.html#l00449">strings_to_mask()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01329"></a>01329 {
<a name="l01330"></a>01330    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>))
<a name="l01331"></a>01331       <span class="keywordflow">return</span> 0;
<a name="l01332"></a>01332 
<a name="l01333"></a>01333    <span class="comment">/* Determine if this is a false value */</span>
<a name="l01334"></a>01334    <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;no&quot;</span>) ||
<a name="l01335"></a>01335        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;false&quot;</span>) ||
<a name="l01336"></a>01336        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;n&quot;</span>) ||
<a name="l01337"></a>01337        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;f&quot;</span>) ||
<a name="l01338"></a>01338        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;0&quot;</span>) ||
<a name="l01339"></a>01339        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;off&quot;</span>))
<a name="l01340"></a>01340       <span class="keywordflow">return</span> -1;
<a name="l01341"></a>01341 
<a name="l01342"></a>01342    <span class="keywordflow">return</span> 0;
<a name="l01343"></a>01343 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3b5457e5f5679935093d94b0f788769e"></a><!-- doxytag: member="utils.c::ast_get_time_t" ref="a3b5457e5f5679935093d94b0f788769e" args="(const char *src, time_t *dst, time_t _default, int *consumed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_get_time_t </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&nbsp;</td>
          <td class="paramname"> <em>_default</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>consumed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>get <a class="el" href="structvalues.html">values</a> from config variables. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01732">1732</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l23690">build_peer()</a>, <a class="el" href="pbx__dundi_8c_source.html#l01147">cache_lookup_internal()</a>, <a class="el" href="res__agi_8c_source.html#l01383">handle_saydatetime()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02110">load_password()</a>, <a class="el" href="app__voicemail_8c_source.html#l06865">play_message_datetime()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02192">process_clearcache()</a>, <a class="el" href="chan__iax2_8c_source.html#l04115">realtime_peer()</a>, and <a class="el" href="app__sayunixtime_8c_source.html#l00092">sayunixtime_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01733"></a>01733 {
<a name="l01734"></a>01734    <span class="keywordtype">long</span> t;
<a name="l01735"></a>01735    <span class="keywordtype">int</span> scanned;
<a name="l01736"></a>01736 
<a name="l01737"></a>01737    <span class="keywordflow">if</span> (dst == NULL)
<a name="l01738"></a>01738       <span class="keywordflow">return</span> -1;
<a name="l01739"></a>01739 
<a name="l01740"></a>01740    *dst = _default;
<a name="l01741"></a>01741 
<a name="l01742"></a>01742    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(src))
<a name="l01743"></a>01743       <span class="keywordflow">return</span> -1;
<a name="l01744"></a>01744 
<a name="l01745"></a>01745    <span class="comment">/* only integer at the moment, but one day we could accept more formats */</span>
<a name="l01746"></a>01746    <span class="keywordflow">if</span> (sscanf(src, <span class="stringliteral">&quot;%30ld%n&quot;</span>, &amp;t, &amp;scanned) == 1) {
<a name="l01747"></a>01747       *dst = t;
<a name="l01748"></a>01748       <span class="keywordflow">if</span> (consumed)
<a name="l01749"></a>01749          *consumed = scanned;
<a name="l01750"></a>01750       <span class="keywordflow">return</span> 0;
<a name="l01751"></a>01751    } <span class="keywordflow">else</span>
<a name="l01752"></a>01752       <span class="keywordflow">return</span> -1;
<a name="l01753"></a>01753 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a70853b91fea6436a8234ee488d4bae54"></a><!-- doxytag: member="utils.c::ast_get_timeval" ref="a70853b91fea6436a8234ee488d4bae54" args="(const char *src, struct timeval *dst, struct timeval _default, int *consumed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_get_timeval </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>_default</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>consumed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>get <a class="el" href="structvalues.html">values</a> from config variables. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01705">1705</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="func__strings_8c_source.html#l00838">acf_strftime()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01706"></a>01706 {
<a name="l01707"></a>01707    <span class="keywordtype">long</span> <span class="keywordtype">double</span> dtv = 0.0;
<a name="l01708"></a>01708    <span class="keywordtype">int</span> scanned;
<a name="l01709"></a>01709 
<a name="l01710"></a>01710    <span class="keywordflow">if</span> (dst == NULL)
<a name="l01711"></a>01711       <span class="keywordflow">return</span> -1;
<a name="l01712"></a>01712 
<a name="l01713"></a>01713    *dst = _default;
<a name="l01714"></a>01714 
<a name="l01715"></a>01715    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(src))
<a name="l01716"></a>01716       <span class="keywordflow">return</span> -1;
<a name="l01717"></a>01717 
<a name="l01718"></a>01718    <span class="comment">/* only integer at the moment, but one day we could accept more formats */</span>
<a name="l01719"></a>01719    <span class="keywordflow">if</span> (sscanf(src, <span class="stringliteral">&quot;%30Lf%n&quot;</span>, &amp;dtv, &amp;scanned) &gt; 0) {
<a name="l01720"></a>01720       dst-&gt;tv_sec = dtv;
<a name="l01721"></a>01721       dst-&gt;tv_usec = (dtv - dst-&gt;tv_sec) * 1000000.0;
<a name="l01722"></a>01722       <span class="keywordflow">if</span> (consumed)
<a name="l01723"></a>01723          *consumed = scanned;
<a name="l01724"></a>01724       <span class="keywordflow">return</span> 0;
<a name="l01725"></a>01725    } <span class="keywordflow">else</span>
<a name="l01726"></a>01726       <span class="keywordflow">return</span> -1;
<a name="l01727"></a>01727 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad3b63ee1041593219ef0765b28d70442"></a><!-- doxytag: member="utils.c::ast_gethostbyname" ref="ad3b63ee1041593219ef0765b28d70442" args="(const char *host, struct ast_hostent *hp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct hostent* ast_gethostbyname </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__hostent.html">ast_hostent</a> *&nbsp;</td>
          <td class="paramname"> <em>hp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Re-entrant (thread safe) version of gethostbyname that replaces the standard gethostbyname (which is not thread safe). </p>
<p>Thread-safe gethostbyname function to use in Asterisk. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00182">182</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00210">ast_hostent::buf</a>, <a class="el" href="utils_8c_source.html#l00082">gethostbyname_r()</a>, <a class="el" href="utils_8h_source.html#l00209">ast_hostent::hp</a>, and <a class="el" href="aesopt_8h_source.html#l00399">s</a>.</p>

<p>Referenced by <a class="el" href="http_8c_source.html#l00848">__ast_http_load()</a>, <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>, <a class="el" href="chan__sip_8c_source.html#l12157">__set_address_from_contact()</a>, <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="acl_8c_source.html#l00511">ast_find_ourip()</a>, <a class="el" href="acl_8c_source.html#l00375">ast_get_ip_or_srv()</a>, <a class="el" href="config_8c_source.html#l02286">ast_parse_arg()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04371">build_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l13770">check_via()</a>, <a class="el" href="chan__skinny_8c_source.html#l07053">config_load()</a>, <a class="el" href="chan__skinny_8c_source.html#l06537">config_parse_variables()</a>, <a class="el" href="chan__h323_8c_source.html#l01650">create_addr()</a>, <a class="el" href="app__festival_8c_source.html#l00268">festival_exec()</a>, <a class="el" href="chan__sip_8c_source.html#l07983">get_ip_and_port_from_sdp()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01901">gtalk_load_config()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01256">gtalk_update_stun()</a>, <a class="el" href="udptl_8c_source.html#l01275">handle_cli_udptl_set_debug()</a>, <a class="el" href="iax2-provision_8c_source.html#l00277">iax_template_parse()</a>, <a class="el" href="chan__jingle_8c_source.html#l01724">jingle_load_config()</a>, <a class="el" href="chan__jingle_8c_source.html#l01063">jingle_update_stun()</a>, <a class="el" href="res__agi_8c_source.html#l00779">launch_netscript()</a>, <a class="el" href="chan__sip_8c_source.html#l12222">parse_register_contact()</a>, <a class="el" href="chan__mgcp_8c_source.html#l01838">process_sdp()</a>, <a class="el" href="chan__sip_8c_source.html#l08691">process_sdp_c()</a>, <a class="el" href="chan__iax2_8c_source.html#l04115">realtime_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l04235">realtime_user()</a>, <a class="el" href="chan__h323_8c_source.html#l02832">reload_config()</a>, <a class="el" href="app__rpt_8c_source.html#l13122">rpt_exec()</a>, <a class="el" href="rtp_8c_source.html#l04581">rtcp_do_debug_ip()</a>, <a class="el" href="rtp_8c_source.html#l04551">rtp_do_debug_ip()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04635">set_config()</a>, <a class="el" href="chan__sip_8c_source.html#l09200">set_destination()</a>, and <a class="el" href="chan__sip_8c_source.html#l16798">sip_do_debug_ip()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00183"></a>00183 {
<a name="l00184"></a>00184    <span class="keywordtype">int</span> res;
<a name="l00185"></a>00185    <span class="keywordtype">int</span> herrno;
<a name="l00186"></a>00186    <span class="keywordtype">int</span> dots = 0;
<a name="l00187"></a>00187    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l00188"></a>00188    <span class="keyword">struct </span>hostent *result = NULL;
<a name="l00189"></a>00189    <span class="comment">/* Although it is perfectly legitimate to lookup a pure integer, for</span>
<a name="l00190"></a>00190 <span class="comment">      the sake of the sanity of people who like to name their peers as</span>
<a name="l00191"></a>00191 <span class="comment">      integers, we break with tradition and refuse to look up a</span>
<a name="l00192"></a>00192 <span class="comment">      pure integer */</span>
<a name="l00193"></a>00193    s = host;
<a name="l00194"></a>00194    res = 0;
<a name="l00195"></a>00195    <span class="keywordflow">while</span> (s &amp;&amp; *s) {
<a name="l00196"></a>00196       <span class="keywordflow">if</span> (*s == <span class="charliteral">&apos;.&apos;</span>)
<a name="l00197"></a>00197          dots++;
<a name="l00198"></a>00198       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!isdigit(*s))
<a name="l00199"></a>00199          <span class="keywordflow">break</span>;
<a name="l00200"></a>00200       s++;
<a name="l00201"></a>00201    }
<a name="l00202"></a>00202    <span class="keywordflow">if</span> (!s || !*s) {
<a name="l00203"></a>00203       <span class="comment">/* Forge a reply for IP&apos;s to avoid octal IP&apos;s being interpreted as octal */</span>
<a name="l00204"></a>00204       <span class="keywordflow">if</span> (dots != 3)
<a name="l00205"></a>00205          <span class="keywordflow">return</span> NULL;
<a name="l00206"></a>00206       memset(hp, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__hostent.html">ast_hostent</a>));
<a name="l00207"></a>00207       hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addrtype = AF_INET;
<a name="l00208"></a>00208       hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr_list = (<span class="keywordtype">void</span> *) hp-&gt;<a class="code" href="structast__hostent.html#ac75fce8692fd1d41a8985f6aacc4a175">buf</a>;
<a name="l00209"></a>00209       hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr = hp-&gt;<a class="code" href="structast__hostent.html#ac75fce8692fd1d41a8985f6aacc4a175">buf</a> + <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *);
<a name="l00210"></a>00210       <span class="keywordflow">if</span> (inet_pton(AF_INET, host, hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr) &gt; 0)
<a name="l00211"></a>00211          <span class="keywordflow">return</span> &amp;hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>;
<a name="l00212"></a>00212       <span class="keywordflow">return</span> NULL;
<a name="l00213"></a>00213       
<a name="l00214"></a>00214    }
<a name="l00215"></a>00215 <span class="preprocessor">#ifdef HAVE_GETHOSTBYNAME_R_5</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span>   result = <a class="code" href="utils_8c.html#a3f966fe2f565bf47d8a37c59475d7958" title="Reentrant replacement for gethostbyname for BSD-based systems.">gethostbyname_r</a>(host, &amp;hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>, hp-&gt;<a class="code" href="structast__hostent.html#ac75fce8692fd1d41a8985f6aacc4a175">buf</a>, <span class="keyword">sizeof</span>(hp-&gt;<a class="code" href="structast__hostent.html#ac75fce8692fd1d41a8985f6aacc4a175">buf</a>), &amp;herrno);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218    <span class="keywordflow">if</span> (!result || !hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr_list || !hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr_list[0])
<a name="l00219"></a>00219       <span class="keywordflow">return</span> NULL;
<a name="l00220"></a>00220 <span class="preprocessor">#else</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span>   res = <a class="code" href="utils_8c.html#a3f966fe2f565bf47d8a37c59475d7958" title="Reentrant replacement for gethostbyname for BSD-based systems.">gethostbyname_r</a>(host, &amp;hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>, hp-&gt;<a class="code" href="structast__hostent.html#ac75fce8692fd1d41a8985f6aacc4a175">buf</a>, <span class="keyword">sizeof</span>(hp-&gt;<a class="code" href="structast__hostent.html#ac75fce8692fd1d41a8985f6aacc4a175">buf</a>), &amp;result, &amp;herrno);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223    <span class="keywordflow">if</span> (res || !result || !hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr_list || !hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>.h_addr_list[0])
<a name="l00224"></a>00224       <span class="keywordflow">return</span> NULL;
<a name="l00225"></a>00225 <span class="preprocessor">#endif</span>
<a name="l00226"></a>00226 <span class="preprocessor"></span>   <span class="keywordflow">return</span> &amp;hp-&gt;<a class="code" href="structast__hostent.html#aeb5e492fbe7eecc5c41d020517da4228">hp</a>;
<a name="l00227"></a>00227 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5a735cb59e8a8ddd78078d396db7e106"></a><!-- doxytag: member="utils.c::ast_inet_ntoa" ref="a5a735cb59e8a8ddd78078d396db7e106" args="(struct in_addr ia)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_inet_ntoa </td>
          <td>(</td>
          <td class="paramtype">struct in_addr&nbsp;</td>
          <td class="paramname"> <em>ia</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ast_inet_ntoa: Recursive thread safe replacement of inet_ntoa </p>
<p>thread-safe replacement for <a class="el" href="network_8h.html#aeaaa5e8fec9d5425e74dd3724e1d41ee">inet_ntoa()</a>. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00431">431</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, and <a class="el" href="utils_8c_source.html#l00068">inet_ntoa_buf</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l03307">__attempt_transmit()</a>, <a class="el" href="chan__iax2_8c_source.html#l02580">__find_callno()</a>, <a class="el" href="chan__iax2_8c_source.html#l06324">__iax2_show_peers()</a>, <a class="el" href="chan__sip_8c_source.html#l03552">__sip_xmit()</a>, <a class="el" href="chan__sip_8c_source.html#l15349">_sip_show_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l14666">_sip_show_peers()</a>, <a class="el" href="chan__skinny_8c_source.html#l03063">_skinny_show_device()</a>, <a class="el" href="chan__skinny_8c_source.html#l02945">_skinny_show_devices()</a>, <a class="el" href="chan__iax2_8c_source.html#l13396">acf_channel_read()</a>, <a class="el" href="manager_8c_source.html#l01740">action_login()</a>, <a class="el" href="chan__mgcp_8c_source.html#l02047">add_sdp()</a>, <a class="el" href="acl_8c_source.html#l00272">ast_append_ha()</a>, <a class="el" href="acl_8c_source.html#l00352">ast_apply_ha()</a>, <a class="el" href="netsock_8c_source.html#l00104">ast_netsock_bindaddr()</a>, <a class="el" href="config_8c_source.html#l02286">ast_parse_arg()</a>, <a class="el" href="rtp_8c_source.html#l01168">ast_rtcp_read()</a>, <a class="el" href="rtp_8c_source.html#l03444">ast_rtcp_write_rr()</a>, <a class="el" href="rtp_8c_source.html#l03311">ast_rtcp_write_sr()</a>, <a class="el" href="rtp_8c_source.html#l03609">ast_rtp_raw_write()</a>, <a class="el" href="rtp_8c_source.html#l01562">ast_rtp_read()</a>, <a class="el" href="rtp_8c_source.html#l03574">ast_rtp_sendcng()</a>, <a class="el" href="rtp_8c_source.html#l03141">ast_rtp_senddigit_begin()</a>, <a class="el" href="rtp_8c_source.html#l03206">ast_rtp_senddigit_continuation()</a>, <a class="el" href="rtp_8c_source.html#l03243">ast_rtp_senddigit_end()</a>, <a class="el" href="chan__sip_8c_source.html#l03607">ast_sip_ouraddrfor()</a>, <a class="el" href="tcptls_8c_source.html#l00376">ast_tcptls_client_create()</a>, <a class="el" href="tcptls_8c_source.html#l00339">ast_tcptls_client_start()</a>, <a class="el" href="tcptls_8c_source.html#l00432">ast_tcptls_server_start()</a>, <a class="el" href="udptl_8c_source.html#l01150">ast_udptl_bridge()</a>, <a class="el" href="udptl_8c_source.html#l00672">ast_udptl_read()</a>, <a class="el" href="udptl_8c_source.html#l01060">ast_udptl_write()</a>, <a class="el" href="chan__iax2_8c_source.html#l07754">authenticate()</a>, <a class="el" href="rtp_8c_source.html#l03915">bridge_native_loop()</a>, <a class="el" href="rtp_8c_source.html#l01508">bridge_p2p_rtp_write()</a>, <a class="el" href="chan__sip_8c_source.html#l07101">build_callid_pvt()</a>, <a class="el" href="chan__sip_8c_source.html#l07112">build_callid_registry()</a>, <a class="el" href="chan__sip_8c_source.html#l10559">build_contact()</a>, <a class="el" href="chan__sip_8c_source.html#l23690">build_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l17113">build_reply_digest()</a>, <a class="el" href="chan__sip_8c_source.html#l10578">build_rpid()</a>, <a class="el" href="chan__sip_8c_source.html#l03588">build_via()</a>, <a class="el" href="chan__iax2_8c_source.html#l02031">calltoken_required()</a>, <a class="el" href="chan__iax2_8c_source.html#l07197">check_access()</a>, <a class="el" href="chan__sip_8c_source.html#l13923">check_peer_ok()</a>, <a class="el" href="chan__sip_8c_source.html#l13770">check_via()</a>, <a class="el" href="chan__skinny_8c_source.html#l07053">config_load()</a>, <a class="el" href="chan__sip_8c_source.html#l09099">copy_via_headers()</a>, <a class="el" href="chan__sip_8c_source.html#l05102">create_addr_from_peer()</a>, <a class="el" href="chan__unistim_8c_source.html#l00863">create_client()</a>, <a class="el" href="dnsmgr_8c_source.html#l00156">dnsmgr_refresh()</a>, <a class="el" href="iax2-parser_8c_source.html#l00080">dump_addr()</a>, <a class="el" href="iax2-parser_8c_source.html#l00169">dump_ipaddr()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03039">dundi_rexmit()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02563">dundi_show_peer()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02636">dundi_show_peers()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02731">dundi_show_trans()</a>, <a class="el" href="dundi-parser_8c_source.html#l00429">dundi_showframe()</a>, <a class="el" href="pbx__dundi_8c_source.html#l02931">dundi_xmit()</a>, <a class="el" href="chan__h323_8c_source.html#l01895">external_rtp_create()</a>, <a class="el" href="chan__mgcp_8c_source.html#l02422">find_command()</a>, <a class="el" href="chan__h323_8c_source.html#l01632">find_peer()</a>, <a class="el" href="chan__mgcp_8c_source.html#l01625">find_subchannel_and_lock()</a>, <a class="el" href="chan__iax2_8c_source.html#l05749">find_tpeer()</a>, <a class="el" href="chan__iax2_8c_source.html#l13324">function_iaxpeer()</a>, <a class="el" href="chan__sip_8c_source.html#l17364">function_sipchaninfo_read()</a>, <a class="el" href="chan__sip_8c_source.html#l17269">function_sippeer()</a>, <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>, <a class="el" href="manager_8c_source.html#l03067">get_input()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00773">gtalk_create_candidates()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01256">gtalk_update_stun()</a>, <a class="el" href="chan__iax2_8c_source.html#l04634">handle_call_token()</a>, <a class="el" href="chan__iax2_8c_source.html#l06998">handle_cli_iax2_set_debug()</a>, <a class="el" href="chan__iax2_8c_source.html#l02374">handle_cli_iax2_show_callno_limits()</a>, <a class="el" href="chan__iax2_8c_source.html#l06825">handle_cli_iax2_show_channels()</a>, <a class="el" href="chan__iax2_8c_source.html#l03568">handle_cli_iax2_show_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l06735">handle_cli_iax2_show_registry()</a>, <a class="el" href="udptl_8c_source.html#l01275">handle_cli_udptl_set_debug()</a>, <a class="el" href="pbx__dundi_8c_source.html#l01553">handle_command_response()</a>, <a class="el" href="chan__iax2_8c_source.html#l03117">handle_error()</a>, <a class="el" href="chan__sip_8c_source.html#l21556">handle_incoming()</a>, <a class="el" href="chan__mgcp_8c_source.html#l01037">handle_mgcp_show_endpoints()</a>, <a class="el" href="chan__skinny_8c_source.html#l05511">handle_open_receive_channel_ack_message()</a>, <a class="el" href="chan__mgcp_8c_source.html#l03020">handle_request()</a>, <a class="el" href="chan__sip_8c_source.html#l21024">handle_request_bye()</a>, <a class="el" href="chan__sip_8c_source.html#l21921">handle_request_do()</a>, <a class="el" href="chan__sip_8c_source.html#l21500">handle_request_register()</a>, <a class="el" href="chan__sip_8c_source.html#l21175">handle_request_subscribe()</a>, <a class="el" href="chan__sip_8c_source.html#l18268">handle_response()</a>, <a class="el" href="chan__sip_8c_source.html#l17893">handle_response_notify()</a>, <a class="el" href="chan__sip_8c_source.html#l17997">handle_response_refer()</a>, <a class="el" href="http_8c_source.html#l00956">handle_show_http()</a>, <a class="el" href="manager_8c_source.html#l00723">handle_showmanconn()</a>, <a class="el" href="chan__skinny_8c_source.html#l03513">handle_skinny_show_settings()</a>, <a class="el" href="http_8c_source.html#l00243">httpstatus_callback()</a>, <a class="el" href="chan__iax2_8c_source.html#l08091">iax2_ack_registry()</a>, <a class="el" href="chan__iax2_8c_source.html#l11373">iax2_prov_app()</a>, <a class="el" href="chan__iax2_8c_source.html#l05784">iax2_trunk_queue()</a>, <a class="el" href="iax2-provision_8c_source.html#l00418">iax_server()</a>, <a class="el" href="iax2-parser_8c_source.html#l00543">iax_showframe()</a>, <a class="el" href="chan__sip_8c_source.html#l10657">initreqprep()</a>, <a class="el" href="chan__jingle_8c_source.html#l00583">jingle_create_candidates()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04823">load_module()</a>, <a class="el" href="chan__iax2_8c_source.html#l06668">manager_iax2_show_peer_list()</a>, <a class="el" href="chan__iax2_8c_source.html#l06776">manager_iax2_show_registry()</a>, <a class="el" href="chan__mgcp_8c_source.html#l03294">mgcpsock_read()</a>, <a class="el" href="chan__h323_8c_source.html#l01597">oh323_addrcmp_str()</a>, <a class="el" href="chan__h323_8c_source.html#l00579">oh323_call()</a>, <a class="el" href="chan__h323_8c_source.html#l03189">oh323_set_rtp_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l12222">parse_register_contact()</a>, <a class="el" href="chan__unistim_8c_source.html#l03464">parsing()</a>, <a class="el" href="chan__iax2_8c_source.html#l02169">peercnt_add()</a>, <a class="el" href="chan__iax2_8c_source.html#l02141">peercnt_modify()</a>, <a class="el" href="chan__iax2_8c_source.html#l02221">peercnt_remove()</a>, <a class="el" href="res__phoneprov_8c_source.html#l00401">phoneprov_callback()</a>, <a class="el" href="chan__unistim_8c_source.html#l03345">process_request()</a>, <a class="el" href="rtp_8c_source.html#l01120">process_rfc3389()</a>, <a class="el" href="chan__mgcp_8c_source.html#l01838">process_sdp()</a>, <a class="el" href="manager_8c_source.html#l03246">purge_sessions()</a>, <a class="el" href="chan__iax2_8c_source.html#l07422">raw_hangup()</a>, <a class="el" href="chan__h323_8c_source.html#l01554">realtime_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l04306">realtime_update_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l04235">realtime_user()</a>, <a class="el" href="chan__iax2_8c_source.html#l08297">reg_source_db()</a>, <a class="el" href="chan__iax2_8c_source.html#l07596">register_verify()</a>, <a class="el" href="chan__iax2_8c_source.html#l08553">registry_rerequest()</a>, <a class="el" href="chan__mgcp_8c_source.html#l04076">reload_config()</a>, <a class="el" href="chan__mgcp_8c_source.html#l00528">resend_response()</a>, <a class="el" href="chan__sip_8c_source.html#l03727">retrans_pkt()</a>, <a class="el" href="app__rpt_8c_source.html#l13122">rpt_exec()</a>, <a class="el" href="rtp_8c_source.html#l04581">rtcp_do_debug_ip()</a>, <a class="el" href="rtp_8c_source.html#l04551">rtp_do_debug_ip()</a>, <a class="el" href="chan__iax2_8c_source.html#l02530">sched_delay_remove()</a>, <a class="el" href="acl_8c_source.html#l00056">score_address()</a>, <a class="el" href="rtp_8c_source.html#l00871">send_dtmf()</a>, <a class="el" href="chan__iax2_8c_source.html#l03164">send_packet()</a>, <a class="el" href="chan__unistim_8c_source.html#l00737">send_raw_client()</a>, <a class="el" href="chan__mgcp_8c_source.html#l00758">send_request()</a>, <a class="el" href="chan__mgcp_8c_source.html#l00541">send_response()</a>, <a class="el" href="chan__iax2_8c_source.html#l08736">send_trunk()</a>, <a class="el" href="manager_8c_source.html#l03169">session_do()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04635">set_config()</a>, <a class="el" href="chan__sip_8c_source.html#l09200">set_destination()</a>, <a class="el" href="chan__iax2_8c_source.html#l02090">set_peercnt_limit()</a>, <a class="el" href="chan__h323_8c_source.html#l02100">setup_incoming_call()</a>, <a class="el" href="chan__sip_8c_source.html#l16189">show_channels_cb()</a>, <a class="el" href="chan__sip_8c_source.html#l15831">show_chanstats_cb()</a>, <a class="el" href="chan__unistim_8c_source.html#l03073">show_main_page()</a>, <a class="el" href="chan__sip_8c_source.html#l16798">sip_do_debug_ip()</a>, <a class="el" href="chan__sip_8c_source.html#l16827">sip_do_debug_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l22876">sip_poke_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l25305">sip_set_rtp_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l25198">sip_set_udptl_peer()</a>, <a class="el" href="chan__sip_8c_source.html#l16415">sip_show_channel()</a>, <a class="el" href="chan__sip_8c_source.html#l15919">sip_show_settings()</a>, <a class="el" href="chan__sip_8c_source.html#l14450">sip_show_tcp()</a>, <a class="el" href="chan__skinny_8c_source.html#l06348">skinny_session()</a>, <a class="el" href="chan__skinny_8c_source.html#l02609">skinny_set_rtp_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, <a class="el" href="chan__iax2_8c_source.html#l09260">socket_process_meta()</a>, <a class="el" href="chan__unistim_8c_source.html#l02028">start_rtp()</a>, <a class="el" href="chan__iax2_8c_source.html#l08787">timing_read()</a>, <a class="el" href="chan__sip_8c_source.html#l11268">transmit_notify_with_mwi()</a>, <a class="el" href="chan__unistim_8c_source.html#l04673">unistim_info()</a>, <a class="el" href="chan__unistim_8c_source.html#l03848">unistimsock_read()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00432"></a>00432 {
<a name="l00433"></a>00433    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00434"></a>00434 
<a name="l00435"></a>00435    <span class="keywordflow">if</span> (!(buf = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;<a class="code" href="utils_8c.html#ac465762c00b512ce7c2af42eb20cf7f8">inet_ntoa_buf</a>, INET_ADDRSTRLEN)))
<a name="l00436"></a>00436       <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438    <span class="keywordflow">return</span> inet_ntop(AF_INET, &amp;ia, buf, INET_ADDRSTRLEN);
<a name="l00439"></a>00439 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0c9c27a9e6b4a6d1e2b868525ae3d0c1"></a><!-- doxytag: member="utils.c::ast_join" ref="a0c9c27a9e6b4a6d1e2b868525ae3d0c1" args="(char *s, size_t len, char *const w[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_join </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *const &nbsp;</td>
          <td class="paramname"> <em>w</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01451">1451</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="cli_8c_source.html#l02170">__ast_cli_generator()</a>, <a class="el" href="res__agi_8c_source.html#l02556">ast_agi_register()</a>, <a class="el" href="res__agi_8c_source.html#l02593">ast_agi_unregister()</a>, <a class="el" href="cli_8c_source.html#l02258">ast_cli_command_full()</a>, <a class="el" href="chan__console_8c_source.html#l01076">cli_console_sendtext()</a>, <a class="el" href="chan__oss_8c_source.html#l00984">console_sendtext()</a>, <a class="el" href="cli_8c_source.html#l01816">find_best()</a>, <a class="el" href="res__agi_8c_source.html#l02996">handle_cli_agi_show()</a>, <a class="el" href="cli_8c_source.html#l01004">handle_cli_check_permissions()</a>, <a class="el" href="cli_8c_source.html#l01980">handle_help()</a>, <a class="el" href="cli_8c_source.html#l01951">help1()</a>, <a class="el" href="res__agi_8c_source.html#l02530">help_workhorse()</a>, <a class="el" href="cli_8c_source.html#l01519">set_full_cmd()</a>, and <a class="el" href="res__agi_8c_source.html#l03130">write_htmldump()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01452"></a>01452 {
<a name="l01453"></a>01453    <span class="keywordtype">int</span> x, ofs = 0;
<a name="l01454"></a>01454    <span class="keyword">const</span> <span class="keywordtype">char</span> *src;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456    <span class="comment">/* Join words into a string */</span>
<a name="l01457"></a>01457    <span class="keywordflow">if</span> (!<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>)
<a name="l01458"></a>01458       <span class="keywordflow">return</span>;
<a name="l01459"></a>01459    <span class="keywordflow">for</span> (x = 0; ofs &lt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> &amp;&amp; w[x]; x++) {
<a name="l01460"></a>01460       <span class="keywordflow">if</span> (x &gt; 0)
<a name="l01461"></a>01461          <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[ofs++] = <span class="charliteral">&apos; &apos;</span>;
<a name="l01462"></a>01462       <span class="keywordflow">for</span> (src = w[x]; *src &amp;&amp; ofs &lt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; src++)
<a name="l01463"></a>01463          <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[ofs++] = *src;
<a name="l01464"></a>01464    }
<a name="l01465"></a>01465    <span class="keywordflow">if</span> (ofs == <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)
<a name="l01466"></a>01466       ofs--;
<a name="l01467"></a>01467    <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[ofs] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01468"></a>01468 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac19bc2df18345ab0f12d972f2987b896"></a><!-- doxytag: member="utils.c::ast_md5_hash" ref="ac19bc2df18345ab0f12d972f2987b896" args="(char *output, char *input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_md5_hash </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>input</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Produce 32 char MD5 hash of value. </p>
<p>Produces MD5 hash based on input string. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00230">230</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="md5_8c_source.html#l00122">MD5Final()</a>, <a class="el" href="md5_8c_source.html#l00059">MD5Init()</a>, and <a class="el" href="md5_8c_source.html#l00074">MD5Update()</a>.</p>

<p>Referenced by <a class="el" href="app__authenticate_8c_source.html#l00108">auth_exec()</a>, <a class="el" href="chan__sip_8c_source.html#l17113">build_reply_digest()</a>, <a class="el" href="chan__sip_8c_source.html#l12573">check_auth()</a>, and <a class="el" href="func__md5_8c_source.html#l00050">md5()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00231"></a>00231 {
<a name="l00232"></a>00232    <span class="keyword">struct </span><a class="code" href="structMD5Context.html">MD5Context</a> <a class="code" href="func__md5_8c.html#a058fc1589da2b9b0d8e404ba0482c3af">md5</a>;
<a name="l00233"></a>00233    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest[16];
<a name="l00234"></a>00234    <span class="keywordtype">char</span> *ptr;
<a name="l00235"></a>00235    <span class="keywordtype">int</span> x;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237    <a class="code" href="md5_8h.html#a6bdca55813077d1c652a1f63608dac30">MD5Init</a>(&amp;<a class="code" href="func__md5_8c.html#a058fc1589da2b9b0d8e404ba0482c3af">md5</a>);
<a name="l00238"></a>00238    <a class="code" href="md5_8h.html#a2a146d25ee54b589dd79d776522ef742">MD5Update</a>(&amp;<a class="code" href="func__md5_8c.html#a058fc1589da2b9b0d8e404ba0482c3af">md5</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="ast__expr2f_8c.html#a5a634cf4429798b1c921a81de8250051">input</a>, strlen(input));
<a name="l00239"></a>00239    <a class="code" href="md5_8h.html#a7132b90c03637ae151c1a8befd7989f2">MD5Final</a>(digest, &amp;<a class="code" href="func__md5_8c.html#a058fc1589da2b9b0d8e404ba0482c3af">md5</a>);
<a name="l00240"></a>00240    ptr = output;
<a name="l00241"></a>00241    <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++)
<a name="l00242"></a>00242       ptr += sprintf(ptr, <span class="stringliteral">&quot;%2.2x&quot;</span>, digest[x]);
<a name="l00243"></a>00243 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c38859ed90e96df2b0a0fdf843769d0"></a><!-- doxytag: member="utils.c::ast_mkdir" ref="a7c38859ed90e96df2b0a0fdf843769d0" args="(const char *path, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_mkdir </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Recursively create directory path. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>path</em>&nbsp;</td><td>The directory path to create </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The permissions with which to try to create the directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or an error code otherwise</dd></dl>
<p>Creates a directory path, creating parent directories as needed. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01765">1765</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, and <a class="el" href="func__strings_8c_source.html#l00821">len()</a>.</p>

<p>Referenced by <a class="el" href="res__monitor_8c_source.html#l00415">ast_monitor_change_fname()</a>, <a class="el" href="res__monitor_8c_source.html#l00148">ast_monitor_start()</a>, <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>, <a class="el" href="app__minivm_8c_source.html#l01294">create_dirpath()</a>, <a class="el" href="app__dictate_8c_source.html#l00084">dictate_exec()</a>, <a class="el" href="logger_8c_source.html#l01004">init_logger()</a>, <a class="el" href="pbx__spool_8c_source.html#l00513">load_module()</a>, <a class="el" href="app__mixmonitor_8c_source.html#l00469">mixmonitor_exec()</a>, <a class="el" href="app__record_8c_source.html#l00132">record_exec()</a>, <a class="el" href="logger_8c_source.html#l00586">reload_logger()</a>, <a class="el" href="pbx__spool_8c_source.html#l00276">remove_from_queue()</a>, <a class="el" href="app__dial_8c_source.html#l01385">setup_privacy_args()</a>, <a class="el" href="app__sms_8c_source.html#l01428">sms_nextoutgoing()</a>, <a class="el" href="app__sms_8c_source.html#l00984">sms_writefile()</a>, <a class="el" href="app__test_8c_source.html#l00146">testclient_exec()</a>, <a class="el" href="app__test_8c_source.html#l00320">testserver_exec()</a>, and <a class="el" href="chan__unistim_8c_source.html#l01693">write_history()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01766"></a>01766 {
<a name="l01767"></a>01767    <span class="keywordtype">char</span> *ptr;
<a name="l01768"></a>01768    <span class="keywordtype">int</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(path), count = 0, x, piececount = 0;
<a name="l01769"></a>01769    <span class="keywordtype">char</span> *tmp = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(path);
<a name="l01770"></a>01770    <span class="keywordtype">char</span> **pieces;
<a name="l01771"></a>01771    <span class="keywordtype">char</span> *fullpath = alloca(len + 1);
<a name="l01772"></a>01772    <span class="keywordtype">int</span> res = 0;
<a name="l01773"></a>01773 
<a name="l01774"></a>01774    <span class="keywordflow">for</span> (ptr = tmp; *ptr; ptr++) {
<a name="l01775"></a>01775       <span class="keywordflow">if</span> (*ptr == <span class="charliteral">&apos;/&apos;</span>)
<a name="l01776"></a>01776          count++;
<a name="l01777"></a>01777    }
<a name="l01778"></a>01778 
<a name="l01779"></a>01779    <span class="comment">/* Count the components to the directory path */</span>
<a name="l01780"></a>01780    pieces = alloca(count * <span class="keyword">sizeof</span>(*pieces));
<a name="l01781"></a>01781    <span class="keywordflow">for</span> (ptr = tmp; *ptr; ptr++) {
<a name="l01782"></a>01782       <span class="keywordflow">if</span> (*ptr == <span class="charliteral">&apos;/&apos;</span>) {
<a name="l01783"></a>01783          *ptr = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01784"></a>01784          pieces[piececount++] = ptr + 1;
<a name="l01785"></a>01785       }
<a name="l01786"></a>01786    }
<a name="l01787"></a>01787 
<a name="l01788"></a>01788    *fullpath = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01789"></a>01789    <span class="keywordflow">for</span> (x = 0; x &lt; piececount; x++) {
<a name="l01790"></a>01790       <span class="comment">/* This looks funky, but the buffer is always ideally-sized, so it&apos;s fine. */</span>
<a name="l01791"></a>01791       strcat(fullpath, <span class="stringliteral">&quot;/&quot;</span>);
<a name="l01792"></a>01792       strcat(fullpath, pieces[x]);
<a name="l01793"></a>01793       res = mkdir(fullpath, mode);
<a name="l01794"></a>01794       <span class="keywordflow">if</span> (res &amp;&amp; errno != EEXIST)
<a name="l01795"></a>01795          <span class="keywordflow">return</span> <a class="code" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>;
<a name="l01796"></a>01796    }
<a name="l01797"></a>01797    <span class="keywordflow">return</span> 0;
<a name="l01798"></a>01798 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3543b8258edfa9140d45147013bc6919"></a><!-- doxytag: member="utils.c::ast_process_quotes_and_slashes" ref="a3543b8258edfa9140d45147013bc6919" args="(char *start, char find, char replace_with)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_process_quotes_and_slashes </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>find</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>replace_with</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Process a string to find and replace characters. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>start</em>&nbsp;</td><td>The string to analyze </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>find</em>&nbsp;</td><td>The character to find </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>replace_with</em>&nbsp;</td><td>The character that will replace the one we are looking for </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01425">1425</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01426"></a>01426 {
<a name="l01427"></a>01427    <span class="keywordtype">char</span> *dataPut = start;
<a name="l01428"></a>01428    <span class="keywordtype">int</span> inEscape = 0;
<a name="l01429"></a>01429    <span class="keywordtype">int</span> inQuotes = 0;
<a name="l01430"></a>01430 
<a name="l01431"></a>01431    <span class="keywordflow">for</span> (; *start; start++) {
<a name="l01432"></a>01432       <span class="keywordflow">if</span> (inEscape) {
<a name="l01433"></a>01433          *dataPut++ = *start;       <span class="comment">/* Always goes verbatim */</span>
<a name="l01434"></a>01434          inEscape = 0;
<a name="l01435"></a>01435       } <span class="keywordflow">else</span> {
<a name="l01436"></a>01436          <span class="keywordflow">if</span> (*start == <span class="charliteral">&apos;\\&apos;</span>) {
<a name="l01437"></a>01437             inEscape = 1;      <span class="comment">/* Do not copy \ into the data */</span>
<a name="l01438"></a>01438          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*start == <span class="charliteral">&apos;\&apos;&apos;</span>) {
<a name="l01439"></a>01439             inQuotes = 1 - inQuotes;   <span class="comment">/* Do not copy &apos; into the data */</span>
<a name="l01440"></a>01440          } <span class="keywordflow">else</span> {
<a name="l01441"></a>01441             <span class="comment">/* Replace , with |, unless in quotes */</span>
<a name="l01442"></a>01442             *dataPut++ = inQuotes ? *start : ((*start == find) ? replace_with : *start);
<a name="l01443"></a>01443          }
<a name="l01444"></a>01444       }
<a name="l01445"></a>01445    }
<a name="l01446"></a>01446    <span class="keywordflow">if</span> (start != dataPut)
<a name="l01447"></a>01447       *dataPut = 0;
<a name="l01448"></a>01448    <span class="keywordflow">return</span> dataPut;
<a name="l01449"></a>01449 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af13d115905cb377f2e1b2e46fec92257"></a><!-- doxytag: member="utils.c::ast_pthread_create_detached_stack" ref="af13d115905cb377f2e1b2e46fec92257" args="(pthread_t *thread, pthread_attr_t *attr, void *(*start_routine)(void *), void *data, size_t stacksize, const char *file, const char *caller, int line, const char *start_fn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_pthread_create_detached_stack </td>
          <td>(</td>
          <td class="paramtype">pthread_t *&nbsp;</td>
          <td class="paramname"> <em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pthread_attr_t *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void *)&nbsp;</td>
          <td class="paramname"> <em>start_routine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>stacksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>caller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>start_fn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01026">1026</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8c_source.html#l00977">ast_pthread_create_stack()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">thr_arg::start_routine</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01029"></a>01029 {
<a name="l01030"></a>01030    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> attr_destroy = 0;
<a name="l01031"></a>01031    <span class="keywordtype">int</span> res;
<a name="l01032"></a>01032 
<a name="l01033"></a>01033    <span class="keywordflow">if</span> (!attr) {
<a name="l01034"></a>01034       attr = alloca(<span class="keyword">sizeof</span>(*attr));
<a name="l01035"></a>01035       pthread_attr_init(attr);
<a name="l01036"></a>01036       attr_destroy = 1;
<a name="l01037"></a>01037    }
<a name="l01038"></a>01038 
<a name="l01039"></a>01039    <span class="keywordflow">if</span> ((errno = pthread_attr_setdetachstate(attr, PTHREAD_CREATE_DETACHED)))
<a name="l01040"></a>01040       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;pthread_attr_setdetachstate: %s\n&quot;</span>, strerror(errno));
<a name="l01041"></a>01041 
<a name="l01042"></a>01042    res = <a class="code" href="utils_8h.html#af740ee3fba7768010783e3faaf5aeb12">ast_pthread_create_stack</a>(<a class="code" href="app__meetme_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, attr, start_routine, data, 
<a name="l01043"></a>01043                                   stacksize, file, caller, line, start_fn);
<a name="l01044"></a>01044 
<a name="l01045"></a>01045    <span class="keywordflow">if</span> (attr_destroy)
<a name="l01046"></a>01046       pthread_attr_destroy(attr);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    <span class="keywordflow">return</span> res;
<a name="l01049"></a>01049 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af740ee3fba7768010783e3faaf5aeb12"></a><!-- doxytag: member="utils.c::ast_pthread_create_stack" ref="af740ee3fba7768010783e3faaf5aeb12" args="(pthread_t *thread, pthread_attr_t *attr, void *(*start_routine)(void *), void *data, size_t stacksize, const char *file, const char *caller, int line, const char *start_fn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_pthread_create_stack </td>
          <td>(</td>
          <td class="paramtype">pthread_t *&nbsp;</td>
          <td class="paramname"> <em>thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pthread_attr_t *&nbsp;</td>
          <td class="paramname"> <em>attr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void *)&nbsp;</td>
          <td class="paramname"> <em>start_routine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>stacksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>caller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>start_fn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00977">977</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00108">asprintf</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="astmm_8h_source.html#l00081">ast_malloc</a>, <a class="el" href="utils_8h_source.html#l00357">AST_STACKSIZE</a>, <a class="el" href="utils_8c_source.html#l00922">thr_arg::data</a>, <a class="el" href="utils_8c_source.html#l00933">dummy_start()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="utils_8c_source.html#l00923">thr_arg::name</a>, <a class="el" href="lock_8h_source.html#l01910">pthread_create</a>, and <a class="el" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">thr_arg::start_routine</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01026">ast_pthread_create_detached_stack()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00980"></a>00980 {
<a name="l00981"></a>00981 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00982"></a>00982 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structthr__arg.html">thr_arg</a> *a;
<a name="l00983"></a>00983 <span class="preprocessor">#endif</span>
<a name="l00984"></a>00984 <span class="preprocessor"></span>
<a name="l00985"></a>00985    <span class="keywordflow">if</span> (!attr) {
<a name="l00986"></a>00986       attr = alloca(<span class="keyword">sizeof</span>(*attr));
<a name="l00987"></a>00987       pthread_attr_init(attr);
<a name="l00988"></a>00988    }
<a name="l00989"></a>00989 
<a name="l00990"></a>00990 <span class="preprocessor">#ifdef __linux__</span>
<a name="l00991"></a>00991 <span class="preprocessor"></span>   <span class="comment">/* On Linux, pthread_attr_init() defaults to PTHREAD_EXPLICIT_SCHED,</span>
<a name="l00992"></a>00992 <span class="comment">      which is kind of useless. Change this here to</span>
<a name="l00993"></a>00993 <span class="comment">      PTHREAD_INHERIT_SCHED; that way the -p option to set realtime</span>
<a name="l00994"></a>00994 <span class="comment">      priority will propagate down to new threads by default.</span>
<a name="l00995"></a>00995 <span class="comment">      This does mean that callers cannot set a different priority using</span>
<a name="l00996"></a>00996 <span class="comment">      PTHREAD_EXPLICIT_SCHED in the attr argument; instead they must set</span>
<a name="l00997"></a>00997 <span class="comment">      the priority afterwards with pthread_setschedparam(). */</span>
<a name="l00998"></a>00998    <span class="keywordflow">if</span> ((errno = pthread_attr_setinheritsched(attr, PTHREAD_INHERIT_SCHED)))
<a name="l00999"></a>00999       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;pthread_attr_setinheritsched: %s\n&quot;</span>, strerror(errno));
<a name="l01000"></a>01000 <span class="preprocessor">#endif</span>
<a name="l01001"></a>01001 <span class="preprocessor"></span>
<a name="l01002"></a>01002    <span class="keywordflow">if</span> (!stacksize)
<a name="l01003"></a>01003       stacksize = <a class="code" href="utils_8h.html#a47e9ccd65c7bb239af68c006ceae18b4">AST_STACKSIZE</a>;
<a name="l01004"></a>01004 
<a name="l01005"></a>01005    <span class="keywordflow">if</span> ((errno = pthread_attr_setstacksize(attr, stacksize ? stacksize : <a class="code" href="utils_8h.html#a47e9ccd65c7bb239af68c006ceae18b4">AST_STACKSIZE</a>)))
<a name="l01006"></a>01006       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;pthread_attr_setstacksize: %s\n&quot;</span>, strerror(errno));
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l01009"></a>01009 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((a = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(*a)))) {
<a name="l01010"></a>01010       a-&gt;<a class="code" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">start_routine</a> = <a class="code" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">start_routine</a>;
<a name="l01011"></a>01011       a-&gt;<a class="code" href="structthr__arg.html#a735984d41155bc1032e09bece8f8d66d">data</a> = <a class="code" href="structthr__arg.html#a735984d41155bc1032e09bece8f8d66d">data</a>;
<a name="l01012"></a>01012       <a class="code" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">start_routine</a> = <a class="code" href="utils_8c.html#a763d9f2734d56e19a6de3b461a396a1a">dummy_start</a>;
<a name="l01013"></a>01013       <span class="keywordflow">if</span> (<a class="code" href="astmm_8h.html#a5d1f84199c77c83b8b51928dd359e228">asprintf</a>(&amp;a-&gt;<a class="code" href="structthr__arg.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="stringliteral">&quot;%-20s started at [%5d] %s %s()&quot;</span>,
<a name="l01014"></a>01014               start_fn, line, file, caller) &lt; 0) {
<a name="l01015"></a>01015          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;asprintf() failed: %s\n&quot;</span>, strerror(errno));
<a name="l01016"></a>01016          a-&gt;<a class="code" href="structthr__arg.html#a5ac083a645d964373f022d03df4849c8">name</a> = NULL;
<a name="l01017"></a>01017       }
<a name="l01018"></a>01018       <a class="code" href="structthr__arg.html#a735984d41155bc1032e09bece8f8d66d">data</a> = a;
<a name="l01019"></a>01019    }
<a name="l01020"></a>01020 <span class="preprocessor">#endif </span><span class="comment">/* !LOW_MEMORY */</span>
<a name="l01021"></a>01021 
<a name="l01022"></a>01022    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#a3c7d37cba2d420a45309a93b799d9db9">pthread_create</a>(<a class="code" href="app__meetme_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, attr, <a class="code" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">start_routine</a>, <a class="code" href="structthr__arg.html#a735984d41155bc1032e09bece8f8d66d">data</a>); <span class="comment">/* We&apos;re in ast_pthread_create, so it&apos;s okay */</span>
<a name="l01023"></a>01023 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7b4f10b070e95ba413e258a3e4b03c20"></a><!-- doxytag: member="utils.c::ast_random" ref="a7b4f10b070e95ba413e258a3e4b03c20" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int ast_random </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01401">1401</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, and <a class="el" href="utils_8c_source.html#l01398">randomlock</a>.</p>

<p>Referenced by <a class="el" href="func__rand_8c_source.html#l00055">acf_rand_exec()</a>, <a class="el" href="manager_8c_source.html#l01755">action_challenge()</a>, <a class="el" href="chan__sip_8c_source.html#l10016">add_sdp()</a>, <a class="el" href="chan__agent_8c_source.html#l01086">agent_new()</a>, <a class="el" href="res__agi_8c_source.html#l02777">agi_handle_command()</a>, <a class="el" href="app_8c_source.html#l01213">ast_lock_path_lockfile()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00256">ast_moh_files_next()</a>, <a class="el" href="rtp_8c_source.html#l02519">ast_rtp_new_init()</a>, <a class="el" href="rtp_8c_source.html#l02646">ast_rtp_new_source()</a>, <a class="el" href="rtp_8c_source.html#l02533">ast_rtp_new_with_bindaddr()</a>, <a class="el" href="udptl_8c_source.html#l00919">ast_udptl_new_with_bindaddr()</a>, <a class="el" href="chan__iax2_8c_source.html#l07462">authenticate_request()</a>, <a class="el" href="chan__mgcp_8c_source.html#l03552">build_gateway()</a>, <a class="el" href="pbx__dundi_8c_source.html#l00521">build_iv()</a>, <a class="el" href="chan__iax2_8c_source.html#l05857">build_rand_pad()</a>, <a class="el" href="chan__sip_8c_source.html#l17113">build_reply_digest()</a>, <a class="el" href="app__queue_8c_source.html#l03319">calc_metric()</a>, <a class="el" href="chan__iax2_8c_source.html#l05709">calc_rxstamp()</a>, <a class="el" href="chan__iax2_8c_source.html#l02483">callno_hash()</a>, <a class="el" href="chan__dahdi_8c_source.html#l07417">dahdi_new()</a>, <a class="el" href="chan__sip_8c_source.html#l07088">generate_random_string()</a>, <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>, <a class="el" href="pbx__dundi_8c_source.html#l00468">get_trans_id()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00909">gtalk_alloc()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00773">gtalk_create_candidates()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00989">gtalk_new()</a>, <a class="el" href="chan__sip_8c_source.html#l17572">handle_response_invite()</a>, <a class="el" href="chan__iax2_8c_source.html#l05088">iax2_key_rotate()</a>, <a class="el" href="chan__iax2_8c_source.html#l05121">iax2_start_transfer()</a>, <a class="el" href="chan__jingle_8c_source.html#l00741">jingle_alloc()</a>, <a class="el" href="chan__jingle_8c_source.html#l00583">jingle_create_candidates()</a>, <a class="el" href="chan__jingle_8c_source.html#l00800">jingle_new()</a>, <a class="el" href="chan__iax2_8c_source.html#l13805">load_module()</a>, <a class="el" href="chan__local_8c_source.html#l00734">local_new()</a>, <a class="el" href="app__voicemail_8c_source.html#l04163">make_email_file()</a>, <a class="el" href="chan__sip_8c_source.html#l07122">make_our_tag()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00347">moh_files_alloc()</a>, <a class="el" href="format__ogg__vorbis_8c_source.html#l00192">ogg_vorbis_rewrite()</a>, <a class="el" href="app__osplookup_8c_source.html#l00766">osp_create_uuid()</a>, <a class="el" href="app__page_8c_source.html#l00121">page_exec()</a>, <a class="el" href="features_8c_source.html#l00566">park_space_reserve()</a>, <a class="el" href="srv_8c_source.html#l00148">process_weights()</a>, <a class="el" href="chan__sip_8c_source.html#l12075">reg_source_db()</a>, <a class="el" href="chan__iax2_8c_source.html#l08505">registry_authrequest()</a>, <a class="el" href="chan__sip_8c_source.html#l09423">reqprep()</a>, <a class="el" href="app__queue_8c_source.html#l02731">say_periodic_announcement()</a>, <a class="el" href="app__minivm_8c_source.html#l01027">sendmail()</a>, <a class="el" href="chan__sip_8c_source.html#l12557">set_nonce_randdata()</a>, <a class="el" href="chan__sip_8c_source.html#l07151">sip_alloc()</a>, <a class="el" href="chan__iax2_8c_source.html#l09182">socket_read()</a>, <a class="el" href="chan__mgcp_8c_source.html#l02610">start_rtp()</a>, <a class="el" href="rtp_8c_source.html#l00487">stun_req_id()</a>, <a class="el" href="chan__sip_8c_source.html#l10819">transmit_invite()</a>, <a class="el" href="chan__sip_8c_source.html#l11545">transmit_register()</a>, <a class="el" href="chan__sip_8c_source.html#l09600">transmit_response_using_temp()</a>, <a class="el" href="app__queue_8c_source.html#l03569">try_calling()</a>, and <a class="el" href="chan__iax2_8c_source.html#l02853">try_firmware()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01402"></a>01402 {
<a name="l01403"></a>01403    <span class="keywordtype">long</span> <span class="keywordtype">int</span> res;
<a name="l01404"></a>01404 <span class="preprocessor">#ifdef HAVE_DEV_URANDOM</span>
<a name="l01405"></a>01405 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#a29aac26dfc884358b9b98aa7c89fee44">dev_urandom_fd</a> &gt;= 0) {
<a name="l01406"></a>01406       <span class="keywordtype">int</span> read_res = read(<a class="code" href="utils_8c.html#a29aac26dfc884358b9b98aa7c89fee44">dev_urandom_fd</a>, &amp;res, <span class="keyword">sizeof</span>(res));
<a name="l01407"></a>01407       <span class="keywordflow">if</span> (read_res &gt; 0) {
<a name="l01408"></a>01408          <span class="keywordtype">long</span> <span class="keywordtype">int</span> rm = RAND_MAX;
<a name="l01409"></a>01409          res = res &lt; 0 ? ~res : res;
<a name="l01410"></a>01410          rm++;
<a name="l01411"></a>01411          <span class="keywordflow">return</span> res % rm;
<a name="l01412"></a>01412       }
<a name="l01413"></a>01413    }
<a name="l01414"></a>01414 <span class="preprocessor">#endif</span>
<a name="l01415"></a>01415 <span class="preprocessor"></span><span class="preprocessor">#ifdef linux</span>
<a name="l01416"></a>01416 <span class="preprocessor"></span>   res = random();
<a name="l01417"></a>01417 <span class="preprocessor">#else</span>
<a name="l01418"></a>01418 <span class="preprocessor"></span>   <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;<a class="code" href="utils_8c.html#aff56af259d6f99172edddacdad8e9372" title="glibc puts a lock inside random(3), so that the results are thread-safe. BSD libc...">randomlock</a>);
<a name="l01419"></a>01419    res = random();
<a name="l01420"></a>01420    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;<a class="code" href="utils_8c.html#aff56af259d6f99172edddacdad8e9372" title="glibc puts a lock inside random(3), so that the results are thread-safe. BSD libc...">randomlock</a>);
<a name="l01421"></a>01421 <span class="preprocessor">#endif</span>
<a name="l01422"></a>01422 <span class="preprocessor"></span>   <span class="keywordflow">return</span> res;
<a name="l01423"></a>01423 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a89565d41a0b343afc57a1c0d9eb85160"></a><!-- doxytag: member="utils.c::ast_sha1_hash" ref="a89565d41a0b343afc57a1c0d9eb85160" args="(char *output, char *input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sha1_hash </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>input</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Produce 40 char SHA1 hash of value. </p>
<p>Produces SHA1 hash based on input string. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00246">246</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="sha1_8c_source.html#l00154">SHA1Input()</a>, <a class="el" href="sha1_8c_source.html#l00081">SHA1Reset()</a>, and <a class="el" href="sha1_8c_source.html#l00113">SHA1Result()</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00944">aji_act_hook()</a>, <a class="el" href="chan__iax2_8c_source.html#l04634">handle_call_token()</a>, <a class="el" href="res__jabber_8c_source.html#l00404">jabber_make_auth()</a>, and <a class="el" href="func__sha1_8c_source.html#l00053">sha1()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00247"></a>00247 {
<a name="l00248"></a>00248    <span class="keyword">struct </span><a class="code" href="structSHA1Context.html" title="This structure will hold context information for the SHA-1 hashing operation.">SHA1Context</a> sha;
<a name="l00249"></a>00249    <span class="keywordtype">char</span> *ptr;
<a name="l00250"></a>00250    <span class="keywordtype">int</span> x;
<a name="l00251"></a>00251    uint8_t Message_Digest[20];
<a name="l00252"></a>00252 
<a name="l00253"></a>00253    <a class="code" href="sha1_8h.html#ab4d7125efac9b487ca663d692e78af36" title="SHA1Reset.">SHA1Reset</a>(&amp;sha);
<a name="l00254"></a>00254    
<a name="l00255"></a>00255    <a class="code" href="sha1_8h.html#abcec0fbbb48793f9e9ccfea9b9792aad" title="SHA1Input.">SHA1Input</a>(&amp;sha, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) <a class="code" href="ast__expr2f_8c.html#a5a634cf4429798b1c921a81de8250051">input</a>, strlen(input));
<a name="l00256"></a>00256 
<a name="l00257"></a>00257    <a class="code" href="sha1_8h.html#a12d619787f5a12702e890b2c3907510e" title="SHA1Result.">SHA1Result</a>(&amp;sha, Message_Digest);
<a name="l00258"></a>00258    ptr = output;
<a name="l00259"></a>00259    <span class="keywordflow">for</span> (x = 0; x &lt; 20; x++)
<a name="l00260"></a>00260       ptr += sprintf(ptr, <span class="stringliteral">&quot;%2.2x&quot;</span>, Message_Digest[x]);
<a name="l00261"></a>00261 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aeb597bdc9a1209c2e7dd8af04de43485"></a><!-- doxytag: member="utils.c::ast_strip_quoted" ref="aeb597bdc9a1209c2e7dd8af04de43485" args="(char *s, const char *beg_quotes, const char *end_quotes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_strip_quoted </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>beg_quotes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>end_quotes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Strip leading/trailing whitespace and quotes from a string. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>The string to be stripped (will be modified). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>beg_quotes</em>&nbsp;</td><td>The list of possible beginning quote characters. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>end_quotes</em>&nbsp;</td><td>The list of matching ending quote characters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The stripped string.</dd></dl>
<p>This functions strips all leading and trailing whitespace characters from the input string, and returns a pointer to the resulting string. The string is modified in place.</p>
<p>It can also remove beginning and ending quote (or quote-like) characters, in matching pairs. If the first character of the string matches any character in beg_quotes, and the last character of the string is the matching character in end_quotes, then they are removed from the string.</p>
<p>Examples: </p>
<div class="fragment"><pre class="fragment">  <a class="code" href="strings_8h.html#aeb597bdc9a1209c2e7dd8af04de43485" title="Strip leading/trailing whitespace and quotes from a string.">ast_strip_quoted</a>(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="stringliteral">&quot;\&quot;&quot;</span>, <span class="stringliteral">&quot;\&quot;&quot;</span>);
  <a class="code" href="strings_8h.html#aeb597bdc9a1209c2e7dd8af04de43485" title="Strip leading/trailing whitespace and quotes from a string.">ast_strip_quoted</a>(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="stringliteral">&quot;&apos;&quot;</span>, <span class="stringliteral">&quot;&apos;&quot;</span>);
  <a class="code" href="strings_8h.html#aeb597bdc9a1209c2e7dd8af04de43485" title="Strip leading/trailing whitespace and quotes from a string.">ast_strip_quoted</a>(<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="stringliteral">&quot;[{(&quot;</span>, <span class="stringliteral">&quot;]})&quot;</span>);
</pre></div> 
<p>Definition at line <a class="el" href="utils_8c_source.html#l01209">1209</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00150">ast_strip()</a>.</p>

<p>Referenced by <a class="el" href="asterisk_8c_source.html#l00296">ast_register_file_version()</a>, <a class="el" href="chan__sip_8c_source.html#l13195">get_rdnis()</a>, <a class="el" href="func__logic_8c_source.html#l00130">iftime()</a>, <a class="el" href="cdr__sqlite3__custom_8c_source.html#l00119">load_values_config()</a>, <a class="el" href="http_8c_source.html#l00622">parse_cookies()</a>, <a class="el" href="chan__iax2_8c_source.html#l04737">parse_dial_string()</a>, and <a class="el" href="chan__sip_8c_source.html#l07472">sip_register()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01210"></a>01210 {
<a name="l01211"></a>01211    <span class="keywordtype">char</span> *e;
<a name="l01212"></a>01212    <span class="keywordtype">char</span> *q;
<a name="l01213"></a>01213 
<a name="l01214"></a>01214    <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> = <a class="code" href="strings_8h.html#aeb1c54e6e100c63176d8e22b0d5ca865" title="Strip leading/trailing whitespace from a string.">ast_strip</a>(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>);
<a name="l01215"></a>01215    <span class="keywordflow">if</span> ((q = strchr(beg_quotes, *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>)) &amp;&amp; *q != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l01216"></a>01216       e = <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> + strlen(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>) - 1;
<a name="l01217"></a>01217       <span class="keywordflow">if</span> (*e == *(end_quotes + (q - beg_quotes))) {
<a name="l01218"></a>01218          <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>++;
<a name="l01219"></a>01219          *e = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01220"></a>01220       }
<a name="l01221"></a>01221    }
<a name="l01222"></a>01222 
<a name="l01223"></a>01223    <span class="keywordflow">return</span> <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l01224"></a>01224 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac0d2fe097c3b32d8f9db56f35812e694"></a><!-- doxytag: member="utils.c::ast_true" ref="ac0d2fe097c3b32d8f9db56f35812e694" args="(const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_true </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>val</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make sure something is true. Determine if a string containing a boolean value is "true". This function checks to see whether a string passed to it is an indication of an "true" value. It checks to see if the string is "yes", "true", "y", "t", "on" or "1". </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if <a class="el" href="structval.html">val</a> is a NULL pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>if "true". </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01311">1311</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="http_8c_source.html#l00848">__ast_http_load()</a>, <a class="el" href="rtp_8c_source.html#l04739">__ast_rtp_reload()</a>, <a class="el" href="udptl_8c_source.html#l01342">__ast_udptl_reload()</a>, <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>, <a class="el" href="misdn__config_8c_source.html#l00870">_parse()</a>, <a class="el" href="func__curl_8c_source.html#l00163">acf_curlopt_write()</a>, <a class="el" href="res__odbc_8c_source.html#l01502">acf_transaction_write()</a>, <a class="el" href="chan__agent_8c_source.html#l01768">action_agent_logoff()</a>, <a class="el" href="features_8c_source.html#l04156">action_bridge()</a>, <a class="el" href="manager_8c_source.html#l02392">action_originate()</a>, <a class="el" href="manager_8c_source.html#l01481">action_updateconfig()</a>, <a class="el" href="res__jabber_8c_source.html#l02660">aji_create_client()</a>, <a class="el" href="res__jabber_8c_source.html#l02907">aji_load_config()</a>, <a class="el" href="app__minivm_8c_source.html#l02515">apply_general_options()</a>, <a class="el" href="app__voicemail_8c_source.html#l00949">apply_option()</a>, <a class="el" href="pbx__spool_8c_source.html#l00110">apply_outgoing()</a>, <a class="el" href="abstract__jb_8c_source.html#l00571">ast_jb_read_conf()</a>, <a class="el" href="app__directory_8c_source.html#l00505">AST_LIST_HEAD_NOLOCK()</a>, <a class="el" href="asterisk_8c_source.html#l02784">ast_readconfig()</a>, <a class="el" href="chan__unistim_8c_source.html#l04998">build_device()</a>, <a class="el" href="chan__mgcp_8c_source.html#l03552">build_gateway()</a>, <a class="el" href="chan__h323_8c_source.html#l01478">build_peer()</a>, <a class="el" href="chan__iax2_8c_source.html#l12156">build_user()</a>, <a class="el" href="chan__skinny_8c_source.html#l06537">config_parse_variables()</a>, <a class="el" href="app__rpt_8c_source.html#l05678">connect_link()</a>, <a class="el" href="chan__dahdi_8c_source.html#l15112">dahdi_set_dnd()</a>, <a class="el" href="cdr_8c_source.html#l01396">do_reload()</a>, <a class="el" href="app__dial_8c_source.html#l01143">do_timelimit()</a>, <a class="el" href="app__festival_8c_source.html#l00268">festival_exec()</a>, <a class="el" href="func__channel_8c_source.html#l00280">func_channel_write()</a>, <a class="el" href="func__audiohookinherit_8c_source.html#l00207">func_inheritance_write()</a>, <a class="el" href="chan__iax2_8c_source.html#l01419">get_encrypt_methods()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01901">gtalk_load_config()</a>, <a class="el" href="chan__sip_8c_source.html#l23300">handle_common_options()</a>, <a class="el" href="logger_8c_source.html#l00732">handle_logger_set_level()</a>, <a class="el" href="chan__sip_8c_source.html#l23255">handle_t38_options()</a>, <a class="el" href="logger_8c_source.html#l00320">init_logger_chain()</a>, <a class="el" href="chan__jingle_8c_source.html#l01724">jingle_load_config()</a>, <a class="el" href="app__alarmreceiver_8c_source.html#l00639">load_config()</a>, <a class="el" href="app__meetme_8c_source.html#l04446">load_config_meetme()</a>, <a class="el" href="cdr__radius_8c_source.html#l00230">load_module()</a>, <a class="el" href="loader_8c_source.html#l00941">load_modules()</a>, <a class="el" href="res__musiconhold_8c_source.html#l01549">load_moh_classes()</a>, <a class="el" href="res__odbc_8c_source.html#l00730">load_odbc_config()</a>, <a class="el" href="app__rpt_8c_source.html#l02224">load_rpt_vars()</a>, <a class="el" href="res__musiconhold_8c_source.html#l01223">local_ast_moh_start()</a>, <a class="el" href="chan__agent_8c_source.html#l01981">login_exec()</a>, <a class="el" href="app__queue_8c_source.html#l06466">manager_add_queue_member()</a>, <a class="el" href="app__queue_8c_source.html#l06551">manager_pause_queue_member()</a>, <a class="el" href="app__minivm_8c_source.html#l00635">message_template_build()</a>, <a class="el" href="chan__misdn_8c_source.html#l02539">misdn_answer()</a>, <a class="el" href="cdr__odbc_8c_source.html#l00152">odbc_load_module()</a>, <a class="el" href="app__osplookup_8c_source.html#l01772">osp_load()</a>, <a class="el" href="codec__adpcm_8c_source.html#l00311">parse_config()</a>, <a class="el" href="app__queue_8c_source.html#l01342">parse_empty_options()</a>, <a class="el" href="pbx__config_8c_source.html#l01367">pbx_load_config()</a>, <a class="el" href="pbx__config_8c_source.html#l01608">pbx_load_users()</a>, <a class="el" href="chan__dahdi_8c_source.html#l16096">process_dahdi()</a>, <a class="el" href="chan__dahdi_8c_source.html#l16040">process_echocancel()</a>, <a class="el" href="app__queue_8c_source.html#l05698">queue_set_global_params()</a>, <a class="el" href="app__queue_8c_source.html#l01385">queue_set_param()</a>, <a class="el" href="chan__agent_8c_source.html#l01180">read_agent_config()</a>, <a class="el" href="app__directory_8c_source.html#l00382">realtime_directory()</a>, <a class="el" href="chan__h323_8c_source.html#l02832">reload_config()</a>, <a class="el" href="asterisk_8c_source.html#l03067">run_startup_commands()</a>, <a class="el" href="app__directory_8c_source.html#l00582">search_directory()</a>, <a class="el" href="chan__console_8c_source.html#l01129">set_active()</a>, <a class="el" href="chan__iax2_8c_source.html#l12493">set_config()</a>, <a class="el" href="app__meetme_8c_source.html#l06285">sla_load_config()</a>, <a class="el" href="res__smdi_8c_source.html#l00861">smdi_load()</a>, <a class="el" href="func__speex_8c_source.html#l00194">speex_write()</a>, <a class="el" href="res__monitor_8c_source.html#l00605">start_monitor_action()</a>, <a class="el" href="manager_8c_source.html#l00449">strings_to_mask()</a>, <a class="el" href="chan__h323_8c_source.html#l01251">update_common_options()</a>, <a class="el" href="xmldoc_8c_source.html#l00898">xmldoc_get_syntax_cmd()</a>, and <a class="el" href="xmldoc_8c_source.html#l00620">xmldoc_get_syntax_fun()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01312"></a>01312 {
<a name="l01313"></a>01313    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>))
<a name="l01314"></a>01314       <span class="keywordflow">return</span> 0;
<a name="l01315"></a>01315 
<a name="l01316"></a>01316    <span class="comment">/* Determine if this is a true value */</span>
<a name="l01317"></a>01317    <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;yes&quot;</span>) ||
<a name="l01318"></a>01318        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;true&quot;</span>) ||
<a name="l01319"></a>01319        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;y&quot;</span>) ||
<a name="l01320"></a>01320        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;t&quot;</span>) ||
<a name="l01321"></a>01321        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;1&quot;</span>) ||
<a name="l01322"></a>01322        !strcasecmp(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;on&quot;</span>))
<a name="l01323"></a>01323       <span class="keywordflow">return</span> -1;
<a name="l01324"></a>01324 
<a name="l01325"></a>01325    <span class="keywordflow">return</span> 0;
<a name="l01326"></a>01326 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a97e1bb8fbd7a103212789e87e7ed6073"></a><!-- doxytag: member="utils.c::ast_tvadd" ref="a97e1bb8fbd7a103212789e87e7ed6073" args="(struct timeval a, struct timeval b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timeval ast_tvadd </td>
          <td>(</td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the sum of two timevals a + b. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01365">1365</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01345">ONE_MILLION</a>, and <a class="el" href="utils_8c_source.html#l01350">tvfix()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l03879">__get_from_jb()</a>, <a class="el" href="chan__agent_8c_source.html#l00893">agent_hangup()</a>, <a class="el" href="chan__agent_8c_source.html#l00519">agent_read()</a>, <a class="el" href="audiohook_8c_source.html#l00725">ast_audiohook_trigger_wait()</a>, <a class="el" href="channel_8c_source.html#l05055">ast_channel_bridge()</a>, <a class="el" href="channel_8c_source.html#l00535">ast_channel_cmpwhentohangup_tv()</a>, <a class="el" href="channel_8c_source.html#l00521">ast_channel_setwhentohangup_tv()</a>, <a class="el" href="channel_8c_source.html#l04776">ast_generic_bridge()</a>, <a class="el" href="rtp_8c_source.html#l03574">ast_rtp_sendcng()</a>, <a class="el" href="rtp_8c_source.html#l03141">ast_rtp_senddigit_begin()</a>, <a class="el" href="rtp_8c_source.html#l03243">ast_rtp_senddigit_end()</a>, <a class="el" href="sched_8c_source.html#l00581">ast_sched_runq()</a>, <a class="el" href="frame_8c_source.html#l00236">ast_smoother_read()</a>, <a class="el" href="translate_8c_source.html#l00308">ast_translate()</a>, <a class="el" href="rtp_8c_source.html#l01453">calc_rxstamp()</a>, <a class="el" href="chan__iax2_8c_source.html#l05576">calc_timestamp()</a>, <a class="el" href="taskprocessor_8c_source.html#l00189">cli_tps_ping()</a>, <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>, <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>, <a class="el" href="cdr_8c_source.html#l01288">do_cdr()</a>, <a class="el" href="res__timing__pthread_8c_source.html#l00449">do_timing()</a>, <a class="el" href="chan__iax2_8c_source.html#l11136">iax2_process_thread()</a>, <a class="el" href="abstract__jb_8c_source.html#l00385">jb_get_and_deliver()</a>, <a class="el" href="app__voicemail_8c_source.html#l10271">mb_poll_thread()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00563">monmp3thread()</a>, <a class="el" href="app__mp3_8c_source.html#l00120">mp3_exec()</a>, <a class="el" href="res__smdi_8c_source.html#l00804">mwi_monitor_handler()</a>, <a class="el" href="app__nbscat_8c_source.html#l00108">NBScat_exec()</a>, <a class="el" href="sched_8c_source.html#l00083">sched_run()</a>, <a class="el" href="sched_8c_source.html#l00373">sched_settime()</a>, <a class="el" href="chan__iax2_8c_source.html#l03970">schedule_delivery()</a>, <a class="el" href="app__meetme_8c_source.html#l05327">sla_process_timers()</a>, <a class="el" href="res__smdi_8c_source.html#l00443">smdi_message_wait()</a>, and <a class="el" href="func__timeout_8c_source.html#l00119">timeout_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01366"></a>01366 {
<a name="l01367"></a>01367    <span class="comment">/* consistency checks to guarantee usec in 0..999999 */</span>
<a name="l01368"></a>01368    a = <a class="code" href="utils_8c.html#ae011d19bb4f1d706eecb7e2b0c7ad581">tvfix</a>(a);
<a name="l01369"></a>01369    b = <a class="code" href="utils_8c.html#ae011d19bb4f1d706eecb7e2b0c7ad581">tvfix</a>(b);
<a name="l01370"></a>01370    a.tv_sec += b.tv_sec;
<a name="l01371"></a>01371    a.tv_usec += b.tv_usec;
<a name="l01372"></a>01372    <span class="keywordflow">if</span> (a.tv_usec &gt;= <a class="code" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>) {
<a name="l01373"></a>01373       a.tv_sec++;
<a name="l01374"></a>01374       a.tv_usec -= <a class="code" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>;
<a name="l01375"></a>01375    }
<a name="l01376"></a>01376    <span class="keywordflow">return</span> a;
<a name="l01377"></a>01377 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa13b651c18bc6004cab21ac041d44dd8"></a><!-- doxytag: member="utils.c::ast_tvsub" ref="aa13b651c18bc6004cab21ac041d44dd8" args="(struct timeval a, struct timeval b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timeval ast_tvsub </td>
          <td>(</td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the difference of two timevals a - b. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01379">1379</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01345">ONE_MILLION</a>, and <a class="el" href="utils_8c_source.html#l01350">tvfix()</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l05055">ast_channel_bridge()</a>, <a class="el" href="lock_8h_source.html#l01801">ast_rwlock_timedrdlock()</a>, <a class="el" href="lock_8h_source.html#l01832">ast_rwlock_timedwrlock()</a>, <a class="el" href="sched_8c_source.html#l00546">ast_sched_dump()</a>, <a class="el" href="translate_8c_source.html#l00308">ast_translate()</a>, <a class="el" href="channel_8c_source.html#l02041">ast_waitfor_nandfds()</a>, <a class="el" href="chan__iax2_8c_source.html#l05709">calc_rxstamp()</a>, <a class="el" href="chan__iax2_8c_source.html#l05576">calc_timestamp()</a>, <a class="el" href="taskprocessor_8c_source.html#l00189">cli_tps_ping()</a>, <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>, <a class="el" href="cli_8c_source.html#l00735">handle_showcalls()</a>, and <a class="el" href="cli_8c_source.html#l00665">handle_showuptime()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01380"></a>01380 {
<a name="l01381"></a>01381    <span class="comment">/* consistency checks to guarantee usec in 0..999999 */</span>
<a name="l01382"></a>01382    a = <a class="code" href="utils_8c.html#ae011d19bb4f1d706eecb7e2b0c7ad581">tvfix</a>(a);
<a name="l01383"></a>01383    b = <a class="code" href="utils_8c.html#ae011d19bb4f1d706eecb7e2b0c7ad581">tvfix</a>(b);
<a name="l01384"></a>01384    a.tv_sec -= b.tv_sec;
<a name="l01385"></a>01385    a.tv_usec -= b.tv_usec;
<a name="l01386"></a>01386    <span class="keywordflow">if</span> (a.tv_usec &lt; 0) {
<a name="l01387"></a>01387       a.tv_sec-- ;
<a name="l01388"></a>01388       a.tv_usec += <a class="code" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>;
<a name="l01389"></a>01389    }
<a name="l01390"></a>01390    <span class="keywordflow">return</span> a;
<a name="l01391"></a>01391 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3115ebeab1be5667662faf6d6a54894f"></a><!-- doxytag: member="utils.c::ast_unescape_c" ref="a3115ebeab1be5667662faf6d6a54894f" args="(char *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_unescape_c </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert some C escape sequences. </p>
<div class="fragment"><pre class="fragment">(\b\f\n\r\t) </pre></div><p> into the equivalent characters. The string to be converted (will be modified). </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The converted string. </dd></dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01245">1245</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01246"></a>01246 {
<a name="l01247"></a>01247    <span class="keywordtype">char</span> c, *ret, *dst;
<a name="l01248"></a>01248 
<a name="l01249"></a>01249    <span class="keywordflow">if</span> (src == NULL)
<a name="l01250"></a>01250       <span class="keywordflow">return</span> NULL;
<a name="l01251"></a>01251    <span class="keywordflow">for</span> (ret = dst = src; (c = *src++); *dst++ = c ) {
<a name="l01252"></a>01252       <span class="keywordflow">if</span> (c != <span class="charliteral">&apos;\\&apos;</span>)
<a name="l01253"></a>01253          <span class="keywordflow">continue</span>;   <span class="comment">/* copy char at the end of the loop */</span>
<a name="l01254"></a>01254       <span class="keywordflow">switch</span> ((c = *src++)) {
<a name="l01255"></a>01255       <span class="keywordflow">case</span> <span class="charliteral">&apos;\0&apos;</span>:  <span class="comment">/* special, trailing &apos;\&apos; */</span>
<a name="l01256"></a>01256          c = <span class="charliteral">&apos;\\&apos;</span>;
<a name="l01257"></a>01257          <span class="keywordflow">break</span>;
<a name="l01258"></a>01258       <span class="keywordflow">case</span> <span class="charliteral">&apos;b&apos;</span>:   <span class="comment">/* backspace */</span>
<a name="l01259"></a>01259          c = <span class="charliteral">&apos;\b&apos;</span>;
<a name="l01260"></a>01260          <span class="keywordflow">break</span>;
<a name="l01261"></a>01261       <span class="keywordflow">case</span> <span class="charliteral">&apos;f&apos;</span>:   <span class="comment">/* form feed */</span>
<a name="l01262"></a>01262          c = <span class="charliteral">&apos;\f&apos;</span>;
<a name="l01263"></a>01263          <span class="keywordflow">break</span>;
<a name="l01264"></a>01264       <span class="keywordflow">case</span> <span class="charliteral">&apos;n&apos;</span>:
<a name="l01265"></a>01265          c = <span class="charliteral">&apos;\n&apos;</span>;
<a name="l01266"></a>01266          <span class="keywordflow">break</span>;
<a name="l01267"></a>01267       <span class="keywordflow">case</span> <span class="charliteral">&apos;r&apos;</span>:
<a name="l01268"></a>01268          c = <span class="charliteral">&apos;\r&apos;</span>;
<a name="l01269"></a>01269          <span class="keywordflow">break</span>;
<a name="l01270"></a>01270       <span class="keywordflow">case</span> <span class="charliteral">&apos;t&apos;</span>:
<a name="l01271"></a>01271          c = <span class="charliteral">&apos;\t&apos;</span>;
<a name="l01272"></a>01272          <span class="keywordflow">break</span>;
<a name="l01273"></a>01273       }
<a name="l01274"></a>01274       <span class="comment">/* default, use the char literally */</span>
<a name="l01275"></a>01275    }
<a name="l01276"></a>01276    *dst = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01277"></a>01277    <span class="keywordflow">return</span> ret;
<a name="l01278"></a>01278 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20ca5b03887fb1ecf589590182f4a9aa"></a><!-- doxytag: member="utils.c::ast_unescape_semicolon" ref="a20ca5b03887fb1ecf589590182f4a9aa" args="(char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_unescape_semicolon </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Strip backslash for "escaped" semicolons, the string to be stripped (will be modified). </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The stripped string. </dd></dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01226">1226</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l10819">transmit_invite()</a>, and <a class="el" href="chan__sip_8c_source.html#l11341">transmit_notify_custom()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01227"></a>01227 {
<a name="l01228"></a>01228    <span class="keywordtype">char</span> *e;
<a name="l01229"></a>01229    <span class="keywordtype">char</span> *work = <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l01230"></a>01230 
<a name="l01231"></a>01231    <span class="keywordflow">while</span> ((e = strchr(work, <span class="charliteral">&apos;;&apos;</span>))) {
<a name="l01232"></a>01232       <span class="keywordflow">if</span> ((e &gt; work) &amp;&amp; (*(e-1) == <span class="charliteral">&apos;\\&apos;</span>)) {
<a name="l01233"></a>01233          memmove(e - 1, e, strlen(e) + 1);
<a name="l01234"></a>01234          work = e;
<a name="l01235"></a>01235       } <span class="keywordflow">else</span> {
<a name="l01236"></a>01236          work = e + 1;
<a name="l01237"></a>01237       }
<a name="l01238"></a>01238    }
<a name="l01239"></a>01239 
<a name="l01240"></a>01240    <span class="keywordflow">return</span> <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l01241"></a>01241 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adafa7619a91aca23fc519bcc31ae8dff"></a><!-- doxytag: member="utils.c::ast_uri_decode" ref="adafa7619a91aca23fc519bcc31ae8dff" args="(char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_uri_decode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ast_uri_decode: Decode SIP URI, URN, URL (overwrite the string) </p>
<p>Decode URI, URN, URL (overwrite string). </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00414">414</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="func__curl_8c_source.html#l00397">acf_curl_exec()</a>, <a class="el" href="chan__sip_8c_source.html#l14088">check_user_full()</a>, <a class="el" href="res__config__curl_8c_source.html#l00518">config_curl()</a>, <a class="el" href="chan__sip_8c_source.html#l13667">get_also_info()</a>, <a class="el" href="chan__sip_8c_source.html#l13269">get_destination()</a>, <a class="el" href="chan__sip_8c_source.html#l13489">get_refer_info()</a>, <a class="el" href="chan__sip_8c_source.html#l19641">handle_request_invite()</a>, <a class="el" href="http_8c_source.html#l00411">http_decode()</a>, <a class="el" href="res__config__curl_8c_source.html#l00056">realtime_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00128">realtime_multi_curl()</a>, <a class="el" href="chan__sip_8c_source.html#l12942">register_verify()</a>, <a class="el" href="chan__sip_8c_source.html#l06599">sip_new()</a>, and <a class="el" href="func__uri_8c_source.html#l00085">uridecode()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00415"></a>00415 {
<a name="l00416"></a>00416    <span class="keywordtype">char</span> *o;
<a name="l00417"></a>00417    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tmp;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419    <span class="keywordflow">for</span> (o = <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>; *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>; <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>++, o++) {
<a name="l00420"></a>00420       <span class="keywordflow">if</span> (*<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> == <span class="charliteral">&apos;%&apos;</span> &amp;&amp; strlen(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>) &gt; 2 &amp;&amp; sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> + 1, <span class="stringliteral">&quot;%2x&quot;</span>, &amp;tmp) == 1) {
<a name="l00421"></a>00421          <span class="comment">/* have &apos;%&apos;, two chars and correct parsing */</span>
<a name="l00422"></a>00422          *o = tmp;
<a name="l00423"></a>00423          <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> += 2;  <span class="comment">/* Will be incremented once more when we break out */</span>
<a name="l00424"></a>00424       } <span class="keywordflow">else</span> <span class="comment">/* all other cases, just copy */</span>
<a name="l00425"></a>00425          *o = *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l00426"></a>00426    }
<a name="l00427"></a>00427    *o = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00428"></a>00428 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4736440328d6809ea8d9f57c0606f253"></a><!-- doxytag: member="utils.c::ast_uri_encode" ref="a4736440328d6809ea8d9f57c0606f253" args="(const char *string, char *outbuf, int buflen, int doreserved)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_uri_encode </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>outbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>doreserved</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ast_uri_encode: Turn text string to URI-encoded XX version </p>
<p>Turn text string to URI-encoded XX version.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>At this point, we're converting from ISO-8859-x (8-bit), not UTF8 as in the SIP protocol spec If doreserved == 1 we will convert reserved characters also. RFC 2396, section 2.4 outbuf needs to have more memory allocated than the instring to have room for the expansion. Every char that is converted is replaced by three ASCII characters.</dd></dl>
<p>Note: The doreserved option is needed for replaces header in SIP transfers. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00383">383</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="adsistub_8c_source.html#l00059">buf</a>.</p>

<p>Referenced by <a class="el" href="res__config__curl_8c_source.html#l00518">config_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00419">destroy_curl()</a>, <a class="el" href="chan__sip_8c_source.html#l10657">initreqprep()</a>, <a class="el" href="res__agi_8c_source.html#l00617">launch_asyncagi()</a>, <a class="el" href="res__config__curl_8c_source.html#l00056">realtime_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00128">realtime_multi_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00472">require_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00354">store_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00278">update2_curl()</a>, <a class="el" href="res__config__curl_8c_source.html#l00225">update_curl()</a>, and <a class="el" href="func__uri_8c_source.html#l00071">uriencode()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00384"></a>00384 {
<a name="l00385"></a>00385    <span class="keywordtype">char</span> *reserved = <span class="stringliteral">&quot;;/?:@&amp;=+$,# &quot;</span>; <span class="comment">/* Reserved chars */</span>
<a name="l00386"></a>00386 
<a name="l00387"></a>00387    <span class="keyword">const</span> <span class="keywordtype">char</span> *ptr  = string; <span class="comment">/* Start with the string */</span>
<a name="l00388"></a>00388    <span class="keywordtype">char</span> *out = NULL;
<a name="l00389"></a>00389    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> = NULL;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391    <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(outbuf, <span class="keywordtype">string</span>, buflen);
<a name="l00392"></a>00392 
<a name="l00393"></a>00393    <span class="comment">/* If there&apos;s no characters to convert, just go through and don&apos;t do anything */</span>
<a name="l00394"></a>00394    <span class="keywordflow">while</span> (*ptr) {
<a name="l00395"></a>00395       <span class="keywordflow">if</span> ((*ptr &lt; 32) || (doreserved &amp;&amp; strchr(reserved, *ptr))) {
<a name="l00396"></a>00396          <span class="comment">/* Oops, we need to start working here */</span>
<a name="l00397"></a>00397          <span class="keywordflow">if</span> (!buf) {
<a name="l00398"></a>00398             buf = outbuf;
<a name="l00399"></a>00399             out = buf + (ptr - string) ;  <span class="comment">/* Set output ptr */</span>
<a name="l00400"></a>00400          }
<a name="l00401"></a>00401          out += sprintf(out, <span class="stringliteral">&quot;%%%02x&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) *ptr);
<a name="l00402"></a>00402       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (buf) {
<a name="l00403"></a>00403          *out = *ptr;   <span class="comment">/* Continue copying the string */</span>
<a name="l00404"></a>00404          out++;
<a name="l00405"></a>00405       } 
<a name="l00406"></a>00406       ptr++;
<a name="l00407"></a>00407    }
<a name="l00408"></a>00408    <span class="keywordflow">if</span> (buf)
<a name="l00409"></a>00409       *out = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00410"></a>00410    <span class="keywordflow">return</span> outbuf;
<a name="l00411"></a>00411 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7f67fc7c9501569b338913c796d86c45"></a><!-- doxytag: member="utils.c::ast_utils_init" ref="a7f67fc7c9501569b338913c796d86c45" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_utils_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01800">1800</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="cli_8c_source.html#l01927">ast_cli_register_multiple()</a>, and <a class="el" href="utils_8c_source.html#l00347">base64_init()</a>.</p>

<p>Referenced by <a class="el" href="asterisk_8c_source.html#l03095">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01801"></a>01801 {
<a name="l01802"></a>01802 <span class="preprocessor">#ifdef HAVE_DEV_URANDOM</span>
<a name="l01803"></a>01803 <span class="preprocessor"></span>   <a class="code" href="utils_8c.html#a29aac26dfc884358b9b98aa7c89fee44">dev_urandom_fd</a> = open(<span class="stringliteral">&quot;/dev/urandom&quot;</span>, O_RDONLY);
<a name="l01804"></a>01804 <span class="preprocessor">#endif</span>
<a name="l01805"></a>01805 <span class="preprocessor"></span>   <a class="code" href="utils_8c.html#a7bc2df9f50343c9e3bf8b6200c709996">base64_init</a>();
<a name="l01806"></a>01806 <span class="preprocessor">#ifdef DEBUG_THREADS</span>
<a name="l01807"></a>01807 <span class="preprocessor"></span><span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l01808"></a>01808 <span class="preprocessor"></span>   <a class="code" href="cli_8h.html#aadeef34f3106bb78aeb3414032ad7fb7" title="Register multiple commands.">ast_cli_register_multiple</a>(utils_cli, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(utils_cli));
<a name="l01809"></a>01809 <span class="preprocessor">#endif</span>
<a name="l01810"></a>01810 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01811"></a>01811 <span class="preprocessor"></span>   <span class="keywordflow">return</span> 0;
<a name="l01812"></a>01812 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a60404ef44696316455e79c3a002cc71e"></a><!-- doxytag: member="utils.c::ast_wait_for_input" ref="a60404ef44696316455e79c3a002cc71e" args="(int fd, int ms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_wait_for_input </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01051">1051</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="poll-compat_8h_source.html#l00086">ast_poll</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l01591">action_waitevent()</a>, <a class="el" href="tcptls_8c_source.html#l00233">ast_tcptls_server_root()</a>, <a class="el" href="res__timing__dahdi_8c_source.html#l00142">dahdi_test_timer()</a>, <a class="el" href="manager_8c_source.html#l03067">get_input()</a>, and <a class="el" href="res__musiconhold_8c_source.html#l01453">moh_class_destructor()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01052"></a>01052 {
<a name="l01053"></a>01053    <span class="keyword">struct </span>pollfd pfd[1];
<a name="l01054"></a>01054    memset(pfd, 0, <span class="keyword">sizeof</span>(pfd));
<a name="l01055"></a>01055    pfd[0].fd = fd;
<a name="l01056"></a>01056    pfd[0].events = POLLIN|POLLPRI;
<a name="l01057"></a>01057    <span class="keywordflow">return</span> <a class="code" href="poll-compat_8h.html#a5a0c58fa8311e94cd0ed34382aa822f9">ast_poll</a>(pfd, 1, ms);
<a name="l01058"></a>01058 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac58e0f6d4af3a1a7444467e51a300a08"></a><!-- doxytag: member="utils.c::ast_wait_for_output" ref="ac58e0f6d4af3a1a7444467e51a300a08" args="(int fd, int timeoutms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_wait_for_output </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeoutms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01060">1060</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="poll-compat_8h_source.html#l00086">ast_poll</a>, <a class="el" href="time_8h_source.html#l00089">ast_tvdiff_ms()</a>, <a class="el" href="time_8h_source.html#l00141">ast_tvnow()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01154">ast_careful_fwrite()</a>, and <a class="el" href="utils_8c_source.html#l01113">ast_carefulwrite()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01061"></a>01061 {
<a name="l01062"></a>01062    <span class="keyword">struct </span>pollfd pfd = {
<a name="l01063"></a>01063       .fd = fd,
<a name="l01064"></a>01064       .events = POLLOUT,
<a name="l01065"></a>01065    };
<a name="l01066"></a>01066    <span class="keywordtype">int</span> res;
<a name="l01067"></a>01067    <span class="keyword">struct </span>timeval start = <a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>();
<a name="l01068"></a>01068    <span class="keywordtype">int</span> elapsed = 0;
<a name="l01069"></a>01069 
<a name="l01070"></a>01070    <span class="comment">/* poll() until the fd is writable without blocking */</span>
<a name="l01071"></a>01071    <span class="keywordflow">while</span> ((res = <a class="code" href="poll-compat_8h.html#a5a0c58fa8311e94cd0ed34382aa822f9">ast_poll</a>(&amp;pfd, 1, timeoutms - elapsed)) &lt;= 0) {
<a name="l01072"></a>01072       <span class="keywordflow">if</span> (res == 0) {
<a name="l01073"></a>01073          <span class="comment">/* timed out. */</span>
<a name="l01074"></a>01074 <span class="preprocessor">#ifndef STANDALONE</span>
<a name="l01075"></a>01075 <span class="preprocessor"></span>         <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Timed out trying to write\n&quot;</span>);
<a name="l01076"></a>01076 <span class="preprocessor">#endif</span>
<a name="l01077"></a>01077 <span class="preprocessor"></span>         <span class="keywordflow">return</span> -1;
<a name="l01078"></a>01078       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == -1) {
<a name="l01079"></a>01079          <span class="comment">/* poll() returned an error, check to see if it was fatal */</span>
<a name="l01080"></a>01080 
<a name="l01081"></a>01081          <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN) {
<a name="l01082"></a>01082             elapsed = <a class="code" href="time_8h.html#a74e35cffcd45ad6cd7c8587921e8a4c2" title="Computes the difference (in milliseconds) between two struct timeval instances.">ast_tvdiff_ms</a>(<a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>(), start);
<a name="l01083"></a>01083             <span class="keywordflow">if</span> (elapsed &gt;= timeoutms) {
<a name="l01084"></a>01084                <span class="keywordflow">return</span> -1;
<a name="l01085"></a>01085             }
<a name="l01086"></a>01086             <span class="comment">/* This was an acceptable error, go back into poll() */</span>
<a name="l01087"></a>01087             <span class="keywordflow">continue</span>;
<a name="l01088"></a>01088          }
<a name="l01089"></a>01089 
<a name="l01090"></a>01090          <span class="comment">/* Fatal error, bail. */</span>
<a name="l01091"></a>01091          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;poll returned error: %s\n&quot;</span>, strerror(errno));
<a name="l01092"></a>01092 
<a name="l01093"></a>01093          <span class="keywordflow">return</span> -1;
<a name="l01094"></a>01094       }
<a name="l01095"></a>01095       elapsed = <a class="code" href="time_8h.html#a74e35cffcd45ad6cd7c8587921e8a4c2" title="Computes the difference (in milliseconds) between two struct timeval instances.">ast_tvdiff_ms</a>(<a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>(), start);
<a name="l01096"></a>01096       <span class="keywordflow">if</span> (elapsed &gt;= timeoutms) {
<a name="l01097"></a>01097          <span class="keywordflow">return</span> -1;
<a name="l01098"></a>01098       }
<a name="l01099"></a>01099    }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101    <span class="keywordflow">return</span> 0;
<a name="l01102"></a>01102 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7bc2df9f50343c9e3bf8b6200c709996"></a><!-- doxytag: member="utils.c::base64_init" ref="a7bc2df9f50343c9e3bf8b6200c709996" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void base64_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00347">347</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01800">ast_utils_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00348"></a>00348 {
<a name="l00349"></a>00349    <span class="keywordtype">int</span> x;
<a name="l00350"></a>00350    memset(<a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>, -1, <span class="keyword">sizeof</span>(<a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>));
<a name="l00351"></a>00351    <span class="comment">/* Initialize base-64 Conversion table */</span>
<a name="l00352"></a>00352    <span class="keywordflow">for</span> (x = 0; x &lt; 26; x++) {
<a name="l00353"></a>00353       <span class="comment">/* A-Z */</span>
<a name="l00354"></a>00354       <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[x] = <span class="charliteral">&apos;A&apos;</span> + x;
<a name="l00355"></a>00355       <a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[<span class="charliteral">&apos;A&apos;</span> + x] = x;
<a name="l00356"></a>00356       <span class="comment">/* a-z */</span>
<a name="l00357"></a>00357       <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[x + 26] = <span class="charliteral">&apos;a&apos;</span> + x;
<a name="l00358"></a>00358       <a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[<span class="charliteral">&apos;a&apos;</span> + x] = x + 26;
<a name="l00359"></a>00359       <span class="comment">/* 0-9 */</span>
<a name="l00360"></a>00360       <span class="keywordflow">if</span> (x &lt; 10) {
<a name="l00361"></a>00361          <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[x + 52] = <span class="charliteral">&apos;0&apos;</span> + x;
<a name="l00362"></a>00362          <a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[<span class="charliteral">&apos;0&apos;</span> + x] = x + 52;
<a name="l00363"></a>00363       }
<a name="l00364"></a>00364    }
<a name="l00365"></a>00365    <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[62] = <span class="charliteral">&apos;+&apos;</span>;
<a name="l00366"></a>00366    <a class="code" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[63] = <span class="charliteral">&apos;/&apos;</span>;
<a name="l00367"></a>00367    <a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[(int)<span class="charliteral">&apos;+&apos;</span>] = 62;
<a name="l00368"></a>00368    <a class="code" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[(int)<span class="charliteral">&apos;/&apos;</span>] = 63;
<a name="l00369"></a>00369 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a763d9f2734d56e19a6de3b461a396a1a"></a><!-- doxytag: member="utils.c::dummy_start" ref="a763d9f2734d56e19a6de3b461a396a1a" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void* dummy_start </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00933">933</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="lock_8h_source.html#l00096">AST_MUTEX_KIND</a>, <a class="el" href="asterisk_8c_source.html#l00380">ast_register_thread()</a>, <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="asterisk_8c_source.html#l00393">ast_unregister_thread()</a>, <a class="el" href="utils_8c_source.html#l00922">thr_arg::data</a>, <a class="el" href="utils_8c_source.html#l00923">thr_arg::name</a>, <a class="el" href="lock_8h_source.html#l01893">pthread_mutex_init</a>, <a class="el" href="lock_8h_source.html#l01890">pthread_mutex_lock</a>, <a class="el" href="lock_8h_source.html#l01891">pthread_mutex_unlock</a>, <a class="el" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">thr_arg::start_routine</a>, and <a class="el" href="astmm_8h_source.html#l00096">strdup</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00977">ast_pthread_create_stack()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00934"></a>00934 {
<a name="l00935"></a>00935    <span class="keywordtype">void</span> *ret;
<a name="l00936"></a>00936    <span class="keyword">struct </span><a class="code" href="structthr__arg.html">thr_arg</a> a = *((<span class="keyword">struct </span><a class="code" href="structthr__arg.html">thr_arg</a> *) <a class="code" href="structthr__arg.html#a735984d41155bc1032e09bece8f8d66d">data</a>);  <span class="comment">/* make a local copy */</span>
<a name="l00937"></a>00937 <span class="preprocessor">#ifdef DEBUG_THREADS</span>
<a name="l00938"></a>00938 <span class="preprocessor"></span>   <span class="keyword">struct </span>thr_lock_info *<a class="code" href="func__lock_8c.html#a6f6d053b3f8020b2916a9072d01a08d0">lock_info</a>;
<a name="l00939"></a>00939    pthread_mutexattr_t mutex_attr;
<a name="l00940"></a>00940 <span class="preprocessor">#endif</span>
<a name="l00941"></a>00941 <span class="preprocessor"></span>
<a name="l00942"></a>00942    <span class="comment">/* note that even though data-&gt;name is a pointer to allocated memory,</span>
<a name="l00943"></a>00943 <span class="comment">      we are not freeing it here because ast_register_thread is going to</span>
<a name="l00944"></a>00944 <span class="comment">      keep a copy of the pointer and then ast_unregister_thread will</span>
<a name="l00945"></a>00945 <span class="comment">      free the memory</span>
<a name="l00946"></a>00946 <span class="comment">   */</span>
<a name="l00947"></a>00947    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(data);
<a name="l00948"></a>00948    <a class="code" href="utils_8h.html#a8e450762024db98313129c1a2ea07d0c">ast_register_thread</a>(a.<a class="code" href="structthr__arg.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00949"></a>00949    pthread_cleanup_push(<a class="code" href="utils_8h.html#a9795c12483e42e95d18eae6a92482677">ast_unregister_thread</a>, (<span class="keywordtype">void</span> *) pthread_self());
<a name="l00950"></a>00950 
<a name="l00951"></a>00951 <span class="preprocessor">#ifdef DEBUG_THREADS</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (!(lock_info = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;thread_lock_info, <span class="keyword">sizeof</span>(*lock_info))))
<a name="l00953"></a>00953       <span class="keywordflow">return</span> NULL;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955    lock_info-&gt;thread_id = pthread_self();
<a name="l00956"></a>00956    lock_info-&gt;thread_name = <a class="code" href="astmm_8h.html#a33bc8f85636226ba23bf348f78352aef">strdup</a>(a.<a class="code" href="structthr__arg.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00957"></a>00957 
<a name="l00958"></a>00958    pthread_mutexattr_init(&amp;mutex_attr);
<a name="l00959"></a>00959    pthread_mutexattr_settype(&amp;mutex_attr, <a class="code" href="lock_8h.html#aaae8771a56e3420fccffbbf2f6ce8046">AST_MUTEX_KIND</a>);
<a name="l00960"></a>00960    <a class="code" href="lock_8h.html#ad7693eb0c23d9649f82992b785ddbe4e">pthread_mutex_init</a>(&amp;lock_info-&gt;lock, &amp;mutex_attr);
<a name="l00961"></a>00961    pthread_mutexattr_destroy(&amp;mutex_attr);
<a name="l00962"></a>00962 
<a name="l00963"></a>00963    <a class="code" href="lock_8h.html#a6ef26f63d38c1d8cdf05a15b6b368c24">pthread_mutex_lock</a>(&amp;lock_infos_lock.mutex); <span class="comment">/* Intentionally not the wrapper */</span>
<a name="l00964"></a>00964    <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;lock_infos, lock_info, entry);
<a name="l00965"></a>00965    <a class="code" href="lock_8h.html#ab417dd049910b852a43732c15e8dcaf2">pthread_mutex_unlock</a>(&amp;lock_infos_lock.mutex); <span class="comment">/* Intentionally not the wrapper */</span>
<a name="l00966"></a>00966 <span class="preprocessor">#endif </span><span class="comment">/* DEBUG_THREADS */</span>
<a name="l00967"></a>00967 
<a name="l00968"></a>00968    ret = a.<a class="code" href="structthr__arg.html#adcc44de35e470687e55b03b41881a939">start_routine</a>(a.<a class="code" href="structthr__arg.html#a735984d41155bc1032e09bece8f8d66d">data</a>);
<a name="l00969"></a>00969 
<a name="l00970"></a>00970    pthread_cleanup_pop(1);
<a name="l00971"></a>00971 
<a name="l00972"></a>00972    <span class="keywordflow">return</span> ret;
<a name="l00973"></a>00973 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3f966fe2f565bf47d8a37c59475d7958"></a><!-- doxytag: member="utils.c::gethostbyname_r" ref="a3f966fe2f565bf47d8a37c59475d7958" args="(const char *name, struct hostent *ret, char *buf, size_t buflen, struct hostent **result, int *h_errnop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int gethostbyname_r </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct hostent *&nbsp;</td>
          <td class="paramname"> <em>ret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct hostent **&nbsp;</td>
          <td class="paramname"> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>h_errnop</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reentrant replacement for gethostbyname for BSD-based systems. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This routine is derived from code originally written and placed in the public <a class="el" href="structdomain.html" title="Domain data structure.">domain</a> by Enzo Michelangeli &lt;<a href="mailto:em@em.no-ip.com">em@em.no-ip.com</a>&gt; </dd></dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00082">82</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l00075">__mutex</a>, <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="utils_8c_source.html#l00072">ERANGE</a>, and <a class="el" href="lock_8h_source.html#l01907">gethostbyname</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00182">ast_gethostbyname()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00085"></a>00085 {
<a name="l00086"></a>00086    <span class="keywordtype">int</span> hsave;
<a name="l00087"></a>00087    <span class="keyword">struct </span>hostent *ph;
<a name="l00088"></a>00088    <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;<a class="code" href="utils_8c.html#ade4348139e9d2506805737d46317403d">__mutex</a>); <span class="comment">/* begin critical area */</span>
<a name="l00089"></a>00089    hsave = h_errno;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091    ph = <a class="code" href="lock_8h.html#a2b655e0d89e519d3b700bbe677d5de79">gethostbyname</a>(<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00092"></a>00092    *h_errnop = h_errno; <span class="comment">/* copy h_errno to *h_herrnop */</span>
<a name="l00093"></a>00093    <span class="keywordflow">if</span> (ph == NULL) {
<a name="l00094"></a>00094       *result = NULL;
<a name="l00095"></a>00095    } <span class="keywordflow">else</span> {
<a name="l00096"></a>00096       <span class="keywordtype">char</span> **p, **q;
<a name="l00097"></a>00097       <span class="keywordtype">char</span> *pbuf;
<a name="l00098"></a>00098       <span class="keywordtype">int</span> nbytes = 0;
<a name="l00099"></a>00099       <span class="keywordtype">int</span> naddr = 0, naliases = 0;
<a name="l00100"></a>00100       <span class="comment">/* determine if we have enough space in buf */</span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       <span class="comment">/* count how many addresses */</span>
<a name="l00103"></a>00103       <span class="keywordflow">for</span> (p = ph-&gt;h_addr_list; *p != 0; p++) {
<a name="l00104"></a>00104          nbytes += ph-&gt;h_length; <span class="comment">/* addresses */</span>
<a name="l00105"></a>00105          nbytes += <span class="keyword">sizeof</span>(*p); <span class="comment">/* pointers */</span>
<a name="l00106"></a>00106          naddr++;
<a name="l00107"></a>00107       }
<a name="l00108"></a>00108       nbytes += <span class="keyword">sizeof</span>(*p); <span class="comment">/* one more for the terminating NULL */</span>
<a name="l00109"></a>00109 
<a name="l00110"></a>00110       <span class="comment">/* count how many aliases, and total length of strings */</span>
<a name="l00111"></a>00111       <span class="keywordflow">for</span> (p = ph-&gt;h_aliases; *p != 0; p++) {
<a name="l00112"></a>00112          nbytes += (strlen(*p)+1); <span class="comment">/* aliases */</span>
<a name="l00113"></a>00113          nbytes += <span class="keyword">sizeof</span>(*p);  <span class="comment">/* pointers */</span>
<a name="l00114"></a>00114          naliases++;
<a name="l00115"></a>00115       }
<a name="l00116"></a>00116       nbytes += <span class="keyword">sizeof</span>(*p); <span class="comment">/* one more for the terminating NULL */</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118       <span class="comment">/* here nbytes is the number of bytes required in buffer */</span>
<a name="l00119"></a>00119       <span class="comment">/* as a terminator must be there, the minimum value is ph-&gt;h_length */</span>
<a name="l00120"></a>00120       <span class="keywordflow">if</span> (nbytes &gt; buflen) {
<a name="l00121"></a>00121          *result = NULL;
<a name="l00122"></a>00122          <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;<a class="code" href="utils_8c.html#ade4348139e9d2506805737d46317403d">__mutex</a>); <span class="comment">/* end critical area */</span>
<a name="l00123"></a>00123          <span class="keywordflow">return</span> <a class="code" href="utils_8c.html#aa1591a4f3a86360108de5b9ba34980ca">ERANGE</a>; <span class="comment">/* not enough space in buf!! */</span>
<a name="l00124"></a>00124       }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126       <span class="comment">/* There is enough space. Now we need to do a deep copy! */</span>
<a name="l00127"></a>00127       <span class="comment">/* Allocation in buffer:</span>
<a name="l00128"></a>00128 <span class="comment">         from [0] to [(naddr-1) * sizeof(*p)]:</span>
<a name="l00129"></a>00129 <span class="comment">         pointers to addresses</span>
<a name="l00130"></a>00130 <span class="comment">         at [naddr * sizeof(*p)]:</span>
<a name="l00131"></a>00131 <span class="comment">         NULL</span>
<a name="l00132"></a>00132 <span class="comment">         from [(naddr+1) * sizeof(*p)] to [(naddr+naliases) * sizeof(*p)] :</span>
<a name="l00133"></a>00133 <span class="comment">         pointers to aliases</span>
<a name="l00134"></a>00134 <span class="comment">         at [(naddr+naliases+1) * sizeof(*p)]:</span>
<a name="l00135"></a>00135 <span class="comment">         NULL</span>
<a name="l00136"></a>00136 <span class="comment">         then naddr addresses (fixed length), and naliases aliases (asciiz).</span>
<a name="l00137"></a>00137 <span class="comment">      */</span>
<a name="l00138"></a>00138 
<a name="l00139"></a>00139       *ret = *ph;   <span class="comment">/* copy whole structure (not its address!) */</span>
<a name="l00140"></a>00140 
<a name="l00141"></a>00141       <span class="comment">/* copy addresses */</span>
<a name="l00142"></a>00142       q = (<span class="keywordtype">char</span> **)<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>; <span class="comment">/* pointer to pointers area (type: char **) */</span>
<a name="l00143"></a>00143       ret-&gt;h_addr_list = q; <span class="comment">/* update pointer to address list */</span>
<a name="l00144"></a>00144       pbuf = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> + ((naddr + naliases + 2) * <span class="keyword">sizeof</span>(*p)); <span class="comment">/* skip that area */</span>
<a name="l00145"></a>00145       <span class="keywordflow">for</span> (p = ph-&gt;h_addr_list; *p != 0; p++) {
<a name="l00146"></a>00146          memcpy(pbuf, *p, ph-&gt;h_length); <span class="comment">/* copy address bytes */</span>
<a name="l00147"></a>00147          *q++ = pbuf; <span class="comment">/* the pointer is the one inside buf... */</span>
<a name="l00148"></a>00148          pbuf += ph-&gt;h_length; <span class="comment">/* advance pbuf */</span>
<a name="l00149"></a>00149       }
<a name="l00150"></a>00150       *q++ = NULL; <span class="comment">/* address list terminator */</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152       <span class="comment">/* copy aliases */</span>
<a name="l00153"></a>00153       ret-&gt;h_aliases = q; <span class="comment">/* update pointer to aliases list */</span>
<a name="l00154"></a>00154       <span class="keywordflow">for</span> (p = ph-&gt;h_aliases; *p != 0; p++) {
<a name="l00155"></a>00155          strcpy(pbuf, *p); <span class="comment">/* copy alias strings */</span>
<a name="l00156"></a>00156          *q++ = pbuf; <span class="comment">/* the pointer is the one inside buf... */</span>
<a name="l00157"></a>00157          pbuf += strlen(*p); <span class="comment">/* advance pbuf */</span>
<a name="l00158"></a>00158          *pbuf++ = 0; <span class="comment">/* string terminator */</span>
<a name="l00159"></a>00159       }
<a name="l00160"></a>00160       *q++ = NULL; <span class="comment">/* terminator */</span>
<a name="l00161"></a>00161 
<a name="l00162"></a>00162       strcpy(pbuf, ph-&gt;h_name); <span class="comment">/* copy alias strings */</span>
<a name="l00163"></a>00163       ret-&gt;h_name = pbuf;
<a name="l00164"></a>00164       pbuf += strlen(ph-&gt;h_name); <span class="comment">/* advance pbuf */</span>
<a name="l00165"></a>00165       *pbuf++ = 0; <span class="comment">/* string terminator */</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167       *result = ret;  <span class="comment">/* and let *result point to structure */</span>
<a name="l00168"></a>00168 
<a name="l00169"></a>00169    }
<a name="l00170"></a>00170    h_errno = hsave;  <span class="comment">/* restore h_errno */</span>
<a name="l00171"></a>00171    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;<a class="code" href="utils_8c.html#ade4348139e9d2506805737d46317403d">__mutex</a>); <span class="comment">/* end critical area */</span>
<a name="l00172"></a>00172 
<a name="l00173"></a>00173    <span class="keywordflow">return</span> (*result == NULL); <span class="comment">/* return 0 on success, non-zero on error */</span>
<a name="l00174"></a>00174 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae011d19bb4f1d706eecb7e2b0c7ad581"></a><!-- doxytag: member="utils.c::tvfix" ref="ae011d19bb4f1d706eecb7e2b0c7ad581" args="(struct timeval a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct timeval tvfix </td>
          <td>(</td>
          <td class="paramtype">struct timeval&nbsp;</td>
          <td class="paramname"> <em>a</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01350">1350</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="utils_8c_source.html#l01345">ONE_MILLION</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01365">ast_tvadd()</a>, and <a class="el" href="utils_8c_source.html#l01379">ast_tvsub()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01351"></a>01351 {
<a name="l01352"></a>01352    <span class="keywordflow">if</span> (a.tv_usec &gt;= <a class="code" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>) {
<a name="l01353"></a>01353       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;warning too large timestamp %ld.%ld\n&quot;</span>,
<a name="l01354"></a>01354          (<span class="keywordtype">long</span>)a.tv_sec, (<span class="keywordtype">long</span> <span class="keywordtype">int</span>) a.tv_usec);
<a name="l01355"></a>01355       a.tv_sec += a.tv_usec / <a class="code" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>;
<a name="l01356"></a>01356       a.tv_usec %= <a class="code" href="utils_8c.html#a6a146c1b2155b03eb2ffa3f4ba755034">ONE_MILLION</a>;
<a name="l01357"></a>01357    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a.tv_usec &lt; 0) {
<a name="l01358"></a>01358       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;warning negative timestamp %ld.%ld\n&quot;</span>,
<a name="l01359"></a>01359          (<span class="keywordtype">long</span>)a.tv_sec, (<span class="keywordtype">long</span> <span class="keywordtype">int</span>) a.tv_usec);
<a name="l01360"></a>01360       a.tv_usec = 0;
<a name="l01361"></a>01361    }
<a name="l01362"></a>01362    <span class="keywordflow">return</span> a;
<a name="l01363"></a>01363 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="abd7963f51b12591f39f99c08277ec41d"></a><!-- doxytag: member="utils.c::__ast_string_field_empty" ref="abd7963f51b12591f39f99c08277ec41d" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char <a class="el" href="utils_8c.html#abd7963f51b12591f39f99c08277ec41d">__ast_string_field_empty</a>[] = &quot;&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>the empty string </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01474">1474</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="ade4348139e9d2506805737d46317403d"></a><!-- doxytag: member="utils.c::__mutex" ref="ade4348139e9d2506805737d46317403d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a> <a class="el" href="utils_8c.html#ade4348139e9d2506805737d46317403d">__mutex</a> = ((<a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>) PTHREAD_MUTEX_INITIALIZER )<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00075">75</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00082">gethostbyname_r()</a>.</p>

</div>
</div>
<a class="anchor" id="a833369687dfc95492b2d5ef4e82c892f"></a><!-- doxytag: member="utils.c::b2a" ref="a833369687dfc95492b2d5ef4e82c892f" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="utils_8c.html#a833369687dfc95492b2d5ef4e82c892f">b2a</a>[256]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00066">66</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="a094cd85754f67592588ab5a0636cf0ea"></a><!-- doxytag: member="utils.c::base64" ref="a094cd85754f67592588ab5a0636cf0ea" args="[64]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="utils_8c.html#a094cd85754f67592588ab5a0636cf0ea">base64</a>[64]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00065">65</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00895">aji_start_sasl()</a>.</p>

</div>
</div>
<a class="anchor" id="a29aac26dfc884358b9b98aa7c89fee44"></a><!-- doxytag: member="utils.c::dev_urandom_fd" ref="a29aac26dfc884358b9b98aa7c89fee44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="utils_8c.html#a29aac26dfc884358b9b98aa7c89fee44">dev_urandom_fd</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00442">442</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab1a3720160370ec1c8acc7da43ee0095"></a><!-- doxytag: member="utils.c::fetchadd_m" ref="ab1a3720160370ec1c8acc7da43ee0095" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a> <a class="el" href="utils_8c.html#ab1a3720160370ec1c8acc7da43ee0095">fetchadd_m</a> = ((<a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>) PTHREAD_MUTEX_INITIALIZER )<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l01690">1690</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01692">ast_atomic_fetchadd_int_slow()</a>.</p>

</div>
</div>
<a class="anchor" id="ac465762c00b512ce7c2af42eb20cf7f8"></a><!-- doxytag: member="utils.c::inet_ntoa_buf" ref="ac465762c00b512ce7c2af42eb20cf7f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a> <a class="el" href="utils_8c.html#ac465762c00b512ce7c2af42eb20cf7f8">inet_ntoa_buf</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_inet_ntoa_buf , .custom_init = NULL , }<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="utils_8c_source.html#l00068">68</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00431">ast_inet_ntoa()</a>.</p>

</div>
</div>
<a class="anchor" id="aff56af259d6f99172edddacdad8e9372"></a><!-- doxytag: member="utils.c::randomlock" ref="aff56af259d6f99172edddacdad8e9372" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a> <a class="el" href="utils_8c.html#aff56af259d6f99172edddacdad8e9372">randomlock</a> = ((<a class="el" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a>) PTHREAD_MUTEX_INITIALIZER )<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>glibc puts a lock inside random(3), so that the results are thread-safe. BSD libc (and others) do not. </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l01398">1398</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l01401">ast_random()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:23:34 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
