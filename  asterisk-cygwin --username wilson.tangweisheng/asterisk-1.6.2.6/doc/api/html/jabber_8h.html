<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:22:18 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>jabber.h File Reference</h1>
<p>AJI - The Asterisk Jabber Interface.  
<a href="#_details">More...</a></p>
<code>#include &lt;openssl/ssl.h&gt;</code><br/>
<code>#include &lt;openssl/err.h&gt;</code><br/>
<code>#include &lt;iksemel.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="astobj_8h_source.html">asterisk/astobj.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br/>

<p><a href="jabber_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__buddy.html">aji_buddy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__buddy__container.html">aji_buddy_container</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__capabilities.html">aji_capabilities</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__client.html">aji_client</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__client__container.html">aji_client_container</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__message.html">aji_message</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__resource.html">aji_resource</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__transport__container.html">aji_transport_container</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__version.html">aji_version</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#aff8969a8d91846c9e669eb4f0ec5208a">AJI_MAX_JIDLEN</a>&nbsp;&nbsp;&nbsp;3071</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a9d77c90c86960648940da39aa2d25e47">AJI_MAX_RESJIDLEN</a>&nbsp;&nbsp;&nbsp;1023</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a99fa4c2cecd405f4430c8d137af93db9">IKS_NET_EXPIRED</a>&nbsp;&nbsp;&nbsp;12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a88194d0f499931c26ef4df0738f26ec1">NET_IO_BUF_SIZE</a>&nbsp;&nbsp;&nbsp;4096</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#aff0ca0337402eb888baf747ce2469641">SECURE</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#ab432cc1c9f5228a80e1fe12e301a2f0f">TRY_SECURE</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="jabber_8h.html#aeac2de18c0ed342a690b3e2ba3c52426a5bf8f469c15d256015b2a3084bcdef59">AJI_AUTOPRUNE</a> =  (1 &lt;&lt; 0), 
<a class="el" href="jabber_8h.html#aeac2de18c0ed342a690b3e2ba3c52426a7f858074245d785e6248f4abea89b260">AJI_AUTOREGISTER</a> =  (1 &lt;&lt; 1)
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573">aji_btype</a> { <a class="el" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573af7ba2446400c30e569082d8c7c906ca3">AJI_USER</a> = 0, 
<a class="el" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573a6575b0c35092c8561693bf083674147a">AJI_TRANS</a> = 1, 
<a class="el" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573ad4e5e4a7972f9db104bf7bd2b08a3192">AJI_UTRANS</a> = 2
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0">aji_state</a> { <a class="el" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0a9f2e9be855a781b74badbe0c1bda278e">AJI_DISCONNECTING</a>, 
<a class="el" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0a46d3c148625b0889f793b6c355051d3b">AJI_DISCONNECTED</a>, 
<a class="el" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0ade80d6f33c170eeaeb1fbc84ebdb1a2f">AJI_CONNECTING</a>, 
<a class="el" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0ae1921cd67cd09004d94dbbd8473f47d9">AJI_CONNECTED</a>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a5db76dcd239674bf97b84ae06e45e60f">ast_aji_check_roster</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a8ce87df2b2878a7384640e3720ba1c2c">ast_aji_create_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, char *room, char *server, char *topic)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">create a chatroom.  <a href="#a8ce87df2b2878a7384640e3720ba1c2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a06f01ad5dc78d9300fed1415b54be04a">ast_aji_disconnect</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">disconnect from jabber server.  <a href="#a06f01ad5dc78d9300fed1415b54be04a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a6689c8e948c8d55e092f30277336fde7">ast_aji_get_client</a> (const char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">grab a <a class="el" href="structaji__client.html">aji_client</a> structure by label name or JID (without the resource string)  <a href="#a6689c8e948c8d55e092f30277336fde7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structaji__client__container.html">aji_client_container</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a740bf5f4ba6bf40ff9273ca8f7a89710">ast_aji_get_clients</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a6e4ae95e74b73933aa6e6d6817df9023">ast_aji_increment_mid</a> (char *mid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">increments the mid field for messages and other events.  <a href="#a6e4ae95e74b73933aa6e6d6817df9023"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a0fe274254c01bee899843b9057929abe">ast_aji_invite_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, char *<a class="el" href="structuser.html">user</a>, char *room, char *<a class="el" href="structmessage.html">message</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">invite to a chatroom.  <a href="#a0fe274254c01bee899843b9057929abe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#aad4fd8a9604fb1d017882c76511c36f7">ast_aji_join_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, char *room)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">join a chatroom.  <a href="#aad4fd8a9604fb1d017882c76511c36f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a3c77ceecc909619207e971421fc3e9ef">ast_aji_send</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, iks *x)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wraps raw sending.  <a href="#a3c77ceecc909619207e971421fc3e9ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#af2b674ed94b89a5798fe22714a44f046">ast_aji_send_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, const char *address, const char *<a class="el" href="structmessage.html">message</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sends messages.  <a href="#af2b674ed94b89a5798fe22714a44f046"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>AJI - The Asterisk Jabber Interface. </p>
<ul>
<li><a class="el" href="AJI_intro.html">AJI - The Asterisk Jabber Interface</a> <a class="el" href="res__jabber_8c.html">res_jabber.c</a> <dl class="author"><dt><b>Author:</b></dt><dd>Matt O'Gorman &lt;<a href="mailto:mogorman@digium.com">mogorman@digium.com</a>&gt; </dd></dl>
<dl class="extref"><dt><b><a class="el" href="extref.html#_extref000017">ExtRef:</a></b></dt><dd>IKSEMEL <a href="http://iksemel.jabberstudio.org">http://iksemel.jabberstudio.org</a></dd></dl>
</li>
</ul>

<p>Definition in file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aff8969a8d91846c9e669eb4f0ec5208a"></a><!-- doxytag: member="jabber.h::AJI_MAX_JIDLEN" ref="aff8969a8d91846c9e669eb4f0ec5208a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AJI_MAX_JIDLEN&nbsp;&nbsp;&nbsp;3071</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00073">73</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p>Referenced by <a class="el" href="chan__gtalk_8c_source.html#l01683">gtalk_show_channels()</a>, and <a class="el" href="chan__jingle_8c_source.html#l01513">jingle_show_channels()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d77c90c86960648940da39aa2d25e47"></a><!-- doxytag: member="jabber.h::AJI_MAX_RESJIDLEN" ref="a9d77c90c86960648940da39aa2d25e47" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AJI_MAX_RESJIDLEN&nbsp;&nbsp;&nbsp;1023</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00074">74</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

</div>
</div>
<a class="anchor" id="a99fa4c2cecd405f4430c8d137af93db9"></a><!-- doxytag: member="jabber.h::IKS_NET_EXPIRED" ref="a99fa4c2cecd405f4430c8d137af93db9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IKS_NET_EXPIRED&nbsp;&nbsp;&nbsp;12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00057">57</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00721">aji_recv()</a>, and <a class="el" href="res__jabber_8c_source.html#l01985">aji_recv_loop()</a>.</p>

</div>
</div>
<a class="anchor" id="a88194d0f499931c26ef4df0738f26ec1"></a><!-- doxytag: member="jabber.h::NET_IO_BUF_SIZE" ref="a88194d0f499931c26ef4df0738f26ec1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NET_IO_BUF_SIZE&nbsp;&nbsp;&nbsp;4096</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00055">55</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00721">aji_recv()</a>.</p>

</div>
</div>
<a class="anchor" id="aff0ca0337402eb888baf747ce2469641"></a><!-- doxytag: member="jabber.h::SECURE" ref="aff0ca0337402eb888baf747ce2469641" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SECURE&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00051">51</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00583">aji_is_secure()</a>, <a class="el" href="res__jabber_8c_source.html#l00617">aji_tls_handshake()</a>, and <a class="el" href="res__jabber_8c_source.html#l02380">ast_aji_disconnect()</a>.</p>

</div>
</div>
<a class="anchor" id="ab432cc1c9f5228a80e1fe12e301a2f0f"></a><!-- doxytag: member="jabber.h::TRY_SECURE" ref="ab432cc1c9f5228a80e1fe12e301a2f0f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TRY_SECURE&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00050">50</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00944">aji_act_hook()</a>, <a class="el" href="res__jabber_8c_source.html#l00599">aji_start_tls()</a>, and <a class="el" href="res__jabber_8c_source.html#l00617">aji_tls_handshake()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="aeac2de18c0ed342a690b3e2ba3c52426"></a><!-- doxytag: member="jabber.h::@116" ref="aeac2de18c0ed342a690b3e2ba3c52426" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aeac2de18c0ed342a690b3e2ba3c52426a5bf8f469c15d256015b2a3084bcdef59"></a><!-- doxytag: member="AJI_AUTOPRUNE" ref="aeac2de18c0ed342a690b3e2ba3c52426a5bf8f469c15d256015b2a3084bcdef59" args="" -->AJI_AUTOPRUNE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aeac2de18c0ed342a690b3e2ba3c52426a7f858074245d785e6248f4abea89b260"></a><!-- doxytag: member="AJI_AUTOREGISTER" ref="aeac2de18c0ed342a690b3e2ba3c52426a7f858074245d785e6248f4abea89b260" args="" -->AJI_AUTOREGISTER</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00083">83</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00083"></a>00083      {
<a name="l00084"></a>00084    <a class="code" href="jabber_8h.html#aeac2de18c0ed342a690b3e2ba3c52426a5bf8f469c15d256015b2a3084bcdef59">AJI_AUTOPRUNE</a> = (1 &lt;&lt; 0),
<a name="l00085"></a>00085    <a class="code" href="jabber_8h.html#aeac2de18c0ed342a690b3e2ba3c52426a7f858074245d785e6248f4abea89b260">AJI_AUTOREGISTER</a> = (1 &lt;&lt; 1)
<a name="l00086"></a>00086 };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a43544c485b6512baca1e632939f8d573"></a><!-- doxytag: member="jabber.h::aji_btype" ref="a43544c485b6512baca1e632939f8d573" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573">aji_btype</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a43544c485b6512baca1e632939f8d573af7ba2446400c30e569082d8c7c906ca3"></a><!-- doxytag: member="AJI_USER" ref="a43544c485b6512baca1e632939f8d573af7ba2446400c30e569082d8c7c906ca3" args="" -->AJI_USER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a43544c485b6512baca1e632939f8d573a6575b0c35092c8561693bf083674147a"></a><!-- doxytag: member="AJI_TRANS" ref="a43544c485b6512baca1e632939f8d573a6575b0c35092c8561693bf083674147a" args="" -->AJI_TRANS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a43544c485b6512baca1e632939f8d573ad4e5e4a7972f9db104bf7bd2b08a3192"></a><!-- doxytag: member="AJI_UTRANS" ref="a43544c485b6512baca1e632939f8d573ad4e5e4a7972f9db104bf7bd2b08a3192" args="" -->AJI_UTRANS</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00088">88</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00088"></a>00088                {
<a name="l00089"></a>00089    <a class="code" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573af7ba2446400c30e569082d8c7c906ca3">AJI_USER</a>=0,
<a name="l00090"></a>00090    <a class="code" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573a6575b0c35092c8561693bf083674147a">AJI_TRANS</a>=1,
<a name="l00091"></a>00091    <a class="code" href="jabber_8h.html#a43544c485b6512baca1e632939f8d573ad4e5e4a7972f9db104bf7bd2b08a3192">AJI_UTRANS</a>=2
<a name="l00092"></a>00092 };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a75f56fc355bdf37aa9ed1ee97b5986b0"></a><!-- doxytag: member="jabber.h::aji_state" ref="a75f56fc355bdf37aa9ed1ee97b5986b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0">aji_state</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a75f56fc355bdf37aa9ed1ee97b5986b0a9f2e9be855a781b74badbe0c1bda278e"></a><!-- doxytag: member="AJI_DISCONNECTING" ref="a75f56fc355bdf37aa9ed1ee97b5986b0a9f2e9be855a781b74badbe0c1bda278e" args="" -->AJI_DISCONNECTING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a75f56fc355bdf37aa9ed1ee97b5986b0a46d3c148625b0889f793b6c355051d3b"></a><!-- doxytag: member="AJI_DISCONNECTED" ref="a75f56fc355bdf37aa9ed1ee97b5986b0a46d3c148625b0889f793b6c355051d3b" args="" -->AJI_DISCONNECTED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a75f56fc355bdf37aa9ed1ee97b5986b0ade80d6f33c170eeaeb1fbc84ebdb1a2f"></a><!-- doxytag: member="AJI_CONNECTING" ref="a75f56fc355bdf37aa9ed1ee97b5986b0ade80d6f33c170eeaeb1fbc84ebdb1a2f" args="" -->AJI_CONNECTING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a75f56fc355bdf37aa9ed1ee97b5986b0ae1921cd67cd09004d94dbbd8473f47d9"></a><!-- doxytag: member="AJI_CONNECTED" ref="a75f56fc355bdf37aa9ed1ee97b5986b0ae1921cd67cd09004d94dbbd8473f47d9" args="" -->AJI_CONNECTED</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="jabber_8h_source.html#l00076">76</a> of file <a class="el" href="jabber_8h_source.html">jabber.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00076"></a>00076                {
<a name="l00077"></a>00077    <a class="code" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0a9f2e9be855a781b74badbe0c1bda278e">AJI_DISCONNECTING</a>,
<a name="l00078"></a>00078    <a class="code" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0a46d3c148625b0889f793b6c355051d3b">AJI_DISCONNECTED</a>,
<a name="l00079"></a>00079    <a class="code" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0ade80d6f33c170eeaeb1fbc84ebdb1a2f">AJI_CONNECTING</a>,
<a name="l00080"></a>00080    <a class="code" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0ae1921cd67cd09004d94dbbd8473f47d9">AJI_CONNECTED</a>
<a name="l00081"></a>00081 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a5db76dcd239674bf97b84ae06e45e60f"></a><!-- doxytag: member="jabber.h::ast_aji_check_roster" ref="a5db76dcd239674bf97b84ae06e45e60f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_check_roster </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a8ce87df2b2878a7384640e3720ba1c2c"></a><!-- doxytag: member="jabber.h::ast_aji_create_chat" ref="a8ce87df2b2878a7384640e3720ba1c2c" args="(struct aji_client *client, char *room, char *server, char *topic)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_create_chat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>room</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>topic</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>create a chatroom. </p>
<p>Open Chat session</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>the configured XMPP client we use to connect to a XMPP server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>room</em>&nbsp;</td><td>name of room </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>server</em>&nbsp;</td><td>name of server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>topic</em>&nbsp;</td><td>topic for the room. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l01894">1894</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="res__jabber_8c_source.html#l02038">ast_aji_increment_mid()</a>, <a class="el" href="res__jabber_8c_source.html#l00818">ast_aji_send()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, and <a class="el" href="jabber_8h_source.html#l00148">aji_client::mid</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01895"></a>01895 {
<a name="l01896"></a>01896    <span class="keywordtype">int</span> res = 0;
<a name="l01897"></a>01897    iks *iq = NULL;
<a name="l01898"></a>01898    iq = iks_new(<span class="stringliteral">&quot;iq&quot;</span>);
<a name="l01899"></a>01899 
<a name="l01900"></a>01900    <span class="keywordflow">if</span> (iq &amp;&amp; client) {
<a name="l01901"></a>01901       iks_insert_attrib(iq, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;get&quot;</span>);
<a name="l01902"></a>01902       iks_insert_attrib(iq, <span class="stringliteral">&quot;to&quot;</span>, server);
<a name="l01903"></a>01903       iks_insert_attrib(iq, <span class="stringliteral">&quot;id&quot;</span>, client-&gt;<a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>);
<a name="l01904"></a>01904       <a class="code" href="jabber_8h.html#a6e4ae95e74b73933aa6e6d6817df9023" title="increments the mid field for messages and other events.">ast_aji_increment_mid</a>(client-&gt;<a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>);
<a name="l01905"></a>01905       <a class="code" href="jabber_8h.html#a3c77ceecc909619207e971421fc3e9ef" title="Wraps raw sending.">ast_aji_send</a>(client, iq);
<a name="l01906"></a>01906    } <span class="keywordflow">else</span> 
<a name="l01907"></a>01907       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of memory.\n&quot;</span>);
<a name="l01908"></a>01908 
<a name="l01909"></a>01909    iks_delete(iq);
<a name="l01910"></a>01910 
<a name="l01911"></a>01911    <span class="keywordflow">return</span> res;
<a name="l01912"></a>01912 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a06f01ad5dc78d9300fed1415b54be04a"></a><!-- doxytag: member="jabber.h::ast_aji_disconnect" ref="a06f01ad5dc78d9300fed1415b54be04a" args="(struct aji_client *client)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_disconnect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>disconnect from jabber server. </p>
<p>Disconnect jabber client</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>the configured XMPP client we use to connect to a XMPP server </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l02380">2380</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="res__jabber_8c_source.html#l00257">aji_client_destroy()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="astobj_8h_source.html#l00218">ASTOBJ_UNREF</a>, <a class="el" href="jabber_8h_source.html#l00150">aji_client::p</a>, <a class="el" href="jabber_8h_source.html#l00051">SECURE</a>, <a class="el" href="jabber_8h_source.html#l00154">aji_client::ssl_context</a>, <a class="el" href="jabber_8h_source.html#l00155">aji_client::ssl_session</a>, and <a class="el" href="jabber_8h_source.html#l00157">aji_client::stream_flags</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l03061">unload_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02381"></a>02381 {
<a name="l02382"></a>02382    <span class="keywordflow">if</span> (client) {
<a name="l02383"></a>02383       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(4, <span class="stringliteral">&quot;JABBER: Disconnecting\n&quot;</span>);
<a name="l02384"></a>02384 <span class="preprocessor">#ifdef HAVE_OPENSSL</span>
<a name="l02385"></a>02385 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (client-&gt;<a class="code" href="structaji__client.html#aa663ff5d560561c647a50b58adce4e7a">stream_flags</a> &amp; <a class="code" href="jabber_8h.html#aff0ca0337402eb888baf747ce2469641">SECURE</a>) {
<a name="l02386"></a>02386          SSL_shutdown(client-&gt;<a class="code" href="structaji__client.html#a28e9fca20ae2d65b0b00c4c4b16ee59b">ssl_session</a>);
<a name="l02387"></a>02387          SSL_CTX_free(client-&gt;<a class="code" href="structaji__client.html#a8c5d83fcb87f22326009954a4652d92e">ssl_context</a>);
<a name="l02388"></a>02388          SSL_free(client-&gt;<a class="code" href="structaji__client.html#a28e9fca20ae2d65b0b00c4c4b16ee59b">ssl_session</a>);
<a name="l02389"></a>02389       }
<a name="l02390"></a>02390 <span class="preprocessor">#endif</span>
<a name="l02391"></a>02391 <span class="preprocessor"></span>      iks_disconnect(client-&gt;<a class="code" href="structaji__client.html#a04186cc042ab3ec9a3ad454891f7ea72">p</a>);
<a name="l02392"></a>02392       iks_parser_delete(client-&gt;<a class="code" href="structaji__client.html#a04186cc042ab3ec9a3ad454891f7ea72">p</a>);
<a name="l02393"></a>02393       <a class="code" href="astobj_8h.html#aed02826b481ce75ec710c1184ac8f059" title="Decrement the reference count on an object.">ASTOBJ_UNREF</a>(client, <a class="code" href="res__jabber_8c.html#a86b1a4282e5190def65358b7867a5207" title="Deletes the aji_client data structure.">aji_client_destroy</a>);
<a name="l02394"></a>02394    }
<a name="l02395"></a>02395 
<a name="l02396"></a>02396    <span class="keywordflow">return</span> 1;
<a name="l02397"></a>02397 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6689c8e948c8d55e092f30277336fde7"></a><!-- doxytag: member="jabber.h::ast_aji_get_client" ref="a6689c8e948c8d55e092f30277336fde7" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaji__client.html">aji_client</a>* ast_aji_get_client </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>grab a <a class="el" href="structaji__client.html">aji_client</a> structure by label name or JID (without the resource string) </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>label or JID </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structaji__client.html">aji_client</a>. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l02954">2954</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="astobj_8h_source.html#l00401">ASTOBJ_CONTAINER_FIND</a>, <a class="el" href="astobj_8h_source.html#l00376">ASTOBJ_CONTAINER_TRAVERSE</a>, <a class="el" href="res__jabber_8c_source.html#l00246">clients</a>, and <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00489">acf_jabberstatus_read()</a>, <a class="el" href="res__jabber_8c_source.html#l00548">aji_send_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00432">aji_status_exec()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01840">gtalk_create_member()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01154">gtalk_newcall()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01637">gtalk_request()</a>, <a class="el" href="chan__jingle_8c_source.html#l01666">jingle_create_member()</a>, <a class="el" href="chan__jingle_8c_source.html#l00954">jingle_newcall()</a>, <a class="el" href="chan__jingle_8c_source.html#l01468">jingle_request()</a>, and <a class="el" href="res__jabber_8c_source.html#l02994">manager_jabber_send()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02955"></a>02955 {
<a name="l02956"></a>02956    <span class="keyword">struct </span><a class="code" href="structaji__client.html">aji_client</a> *client = NULL;
<a name="l02957"></a>02957    <span class="keywordtype">char</span> *aux = NULL;
<a name="l02958"></a>02958 
<a name="l02959"></a>02959    client = <a class="code" href="astobj_8h.html#aca5d7206cd0c6817140bba786a9b6b8a" title="Find an object in a container.">ASTOBJ_CONTAINER_FIND</a>(&amp;<a class="code" href="res__jabber_8c.html#a412e6d5d6035a37146acd5af40e881cb">clients</a>, <a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l02960"></a>02960    <span class="keywordflow">if</span> (!client &amp;&amp; strchr(<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="charliteral">&apos;@&apos;</span>)) {
<a name="l02961"></a>02961       <a class="code" href="astobj_8h.html#a8483cbd2bcf0b91ac62168fb1cb7f5b1" title="Iterate through the objects in a container.">ASTOBJ_CONTAINER_TRAVERSE</a>(&amp;<a class="code" href="res__jabber_8c.html#a412e6d5d6035a37146acd5af40e881cb">clients</a>, 1, {
<a name="l02962"></a>02962          aux = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(iterator-&gt;user);
<a name="l02963"></a>02963          <span class="keywordflow">if</span> (strchr(aux, <span class="charliteral">&apos;/&apos;</span>)) {
<a name="l02964"></a>02964             <span class="comment">/* strip resource for comparison */</span>
<a name="l02965"></a>02965             aux = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;aux, <span class="stringliteral">&quot;/&quot;</span>);
<a name="l02966"></a>02966          }
<a name="l02967"></a>02967          <span class="keywordflow">if</span> (!strncasecmp(aux, <a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, strlen(aux))) {
<a name="l02968"></a>02968             client = iterator;
<a name="l02969"></a>02969          }           
<a name="l02970"></a>02970       });
<a name="l02971"></a>02971    }
<a name="l02972"></a>02972 
<a name="l02973"></a>02973    <span class="keywordflow">return</span> client;
<a name="l02974"></a>02974 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a740bf5f4ba6bf40ff9273ca8f7a89710"></a><!-- doxytag: member="jabber.h::ast_aji_get_clients" ref="a740bf5f4ba6bf40ff9273ca8f7a89710" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structaji__client__container.html">aji_client_container</a>* ast_aji_get_clients </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l02976">2976</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="res__jabber_8c_source.html#l00246">clients</a>.</p>

<p>Referenced by <a class="el" href="chan__gtalk_8c_source.html#l01901">gtalk_load_config()</a>, and <a class="el" href="chan__jingle_8c_source.html#l01724">jingle_load_config()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02977"></a>02977 {
<a name="l02978"></a>02978    <span class="keywordflow">return</span> &amp;<a class="code" href="res__jabber_8c.html#a412e6d5d6035a37146acd5af40e881cb">clients</a>;
<a name="l02979"></a>02979 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6e4ae95e74b73933aa6e6d6817df9023"></a><!-- doxytag: member="jabber.h::ast_aji_increment_mid" ref="a6e4ae95e74b73933aa6e6d6817df9023" args="(char *mid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_aji_increment_mid </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>mid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>increments the mid field for messages and other events. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mid</em>&nbsp;</td><td>char. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>void. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l02038">2038</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00944">aji_act_hook()</a>, <a class="el" href="res__jabber_8c_source.html#l01604">aji_handle_presence()</a>, <a class="el" href="res__jabber_8c_source.html#l01144">aji_register_approve_handler()</a>, <a class="el" href="res__jabber_8c_source.html#l01894">ast_aji_create_chat()</a>, <a class="el" href="res__jabber_8c_source.html#l01951">ast_aji_invite_chat()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01078">gtalk_action()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00773">gtalk_create_candidates()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01512">gtalk_digit()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00379">gtalk_invite()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00458">gtalk_invite_response()</a>, <a class="el" href="chan__jingle_8c_source.html#l00311">jingle_accept_call()</a>, <a class="el" href="chan__jingle_8c_source.html#l00883">jingle_action()</a>, <a class="el" href="chan__jingle_8c_source.html#l00583">jingle_create_candidates()</a>, <a class="el" href="chan__jingle_8c_source.html#l01284">jingle_digit()</a>, and <a class="el" href="chan__jingle_8c_source.html#l01346">jingle_transmit_invite()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02039"></a>02039 {
<a name="l02040"></a>02040    <span class="keywordtype">int</span> i = 0;
<a name="l02041"></a>02041 
<a name="l02042"></a>02042    <span class="keywordflow">for</span> (i = strlen(<a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>) - 1; i &gt;= 0; i--) {
<a name="l02043"></a>02043       <span class="keywordflow">if</span> (<a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>[i] != <span class="charliteral">&apos;z&apos;</span>) {
<a name="l02044"></a>02044          <a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>[i] = <a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>[i] + 1;
<a name="l02045"></a>02045          i = 0;
<a name="l02046"></a>02046       } <span class="keywordflow">else</span>
<a name="l02047"></a>02047          <a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>[i] = <span class="charliteral">&apos;a&apos;</span>;
<a name="l02048"></a>02048    }
<a name="l02049"></a>02049 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0fe274254c01bee899843b9057929abe"></a><!-- doxytag: member="jabber.h::ast_aji_invite_chat" ref="a0fe274254c01bee899843b9057929abe" args="(struct aji_client *client, char *user, char *room, char *message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_invite_chat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>room</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>message</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>invite to a chatroom. </p>
<p>Invite to opened Chat session</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>the configured XMPP client we use to connect to a XMPP server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structuser.html" title="structure to hold users read from users.conf">user</a></em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>room</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structmessage.html">message</a></em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>res. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l01951">1951</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="res__jabber_8c_source.html#l02038">ast_aji_increment_mid()</a>, <a class="el" href="res__jabber_8c_source.html#l00818">ast_aji_send()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, and <a class="el" href="jabber_8h_source.html#l00148">aji_client::mid</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01952"></a>01952 {
<a name="l01953"></a>01953    <span class="keywordtype">int</span> res = 0;
<a name="l01954"></a>01954    iks *invite, *body, *<span class="keyword">namespace</span>;
<a name="l01955"></a>01955 
<a name="l01956"></a>01956    invite = iks_new(<span class="stringliteral">&quot;message&quot;</span>);
<a name="l01957"></a>01957    body = iks_new(<span class="stringliteral">&quot;body&quot;</span>);
<a name="l01958"></a>01958    <span class="keyword">namespace </span>= iks_new(&quot;x&quot;);
<a name="l01959"></a>01959    <span class="keywordflow">if</span> (client &amp;&amp; invite &amp;&amp; body &amp;&amp; <span class="keyword">namespace</span>) {
<a name="l01960"></a>01960       iks_insert_attrib(invite, <span class="stringliteral">&quot;to&quot;</span>, <a class="code" href="structuser.html" title="structure to hold users read from users.conf">user</a>);
<a name="l01961"></a>01961       iks_insert_attrib(invite, <span class="stringliteral">&quot;id&quot;</span>, client-&gt;<a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>);
<a name="l01962"></a>01962       <a class="code" href="jabber_8h.html#a6e4ae95e74b73933aa6e6d6817df9023" title="increments the mid field for messages and other events.">ast_aji_increment_mid</a>(client-&gt;<a class="code" href="structaji__client.html#abee5661fa88af477fe47bbbd21136301">mid</a>);
<a name="l01963"></a>01963       iks_insert_cdata(body, <a class="code" href="structmessage.html">message</a>, 0);
<a name="l01964"></a>01964       iks_insert_attrib(<span class="keyword">namespace</span>, <span class="stringliteral">&quot;xmlns&quot;</span>, <span class="stringliteral">&quot;jabber:x:conference&quot;</span>);
<a name="l01965"></a>01965       iks_insert_attrib(<span class="keyword">namespace</span>, <span class="stringliteral">&quot;jid&quot;</span>, room);
<a name="l01966"></a>01966       iks_insert_node(invite, body);
<a name="l01967"></a>01967       iks_insert_node(invite, <span class="keyword">namespace</span>);
<a name="l01968"></a>01968       res = <a class="code" href="jabber_8h.html#a3c77ceecc909619207e971421fc3e9ef" title="Wraps raw sending.">ast_aji_send</a>(client, invite);
<a name="l01969"></a>01969    } <span class="keywordflow">else</span> 
<a name="l01970"></a>01970       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of memory.\n&quot;</span>);
<a name="l01971"></a>01971 
<a name="l01972"></a>01972    iks_delete(body);
<a name="l01973"></a>01973    iks_delete(<span class="keyword">namespace</span>);
<a name="l01974"></a>01974    iks_delete(invite);
<a name="l01975"></a>01975    
<a name="l01976"></a>01976    <span class="keywordflow">return</span> res;
<a name="l01977"></a>01977 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aad4fd8a9604fb1d017882c76511c36f7"></a><!-- doxytag: member="jabber.h::ast_aji_join_chat" ref="aad4fd8a9604fb1d017882c76511c36f7" args="(struct aji_client *client, char *room)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_join_chat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>room</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>join a chatroom. </p>
<p>Join existing Chat session</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>the configured XMPP client we use to connect to a XMPP server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>room</em>&nbsp;</td><td>room to join </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>res. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l01920">1920</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="res__jabber_8c_source.html#l00818">ast_aji_send()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01921"></a>01921 {
<a name="l01922"></a>01922    <span class="keywordtype">int</span> res = 0;
<a name="l01923"></a>01923    iks *presence = NULL, *priority = NULL;
<a name="l01924"></a>01924    presence = iks_new(<span class="stringliteral">&quot;presence&quot;</span>);
<a name="l01925"></a>01925    priority = iks_new(<span class="stringliteral">&quot;priority&quot;</span>);
<a name="l01926"></a>01926    <span class="keywordflow">if</span> (presence &amp;&amp; priority &amp;&amp; client) {
<a name="l01927"></a>01927       iks_insert_cdata(priority, <span class="stringliteral">&quot;0&quot;</span>, 1);
<a name="l01928"></a>01928       iks_insert_attrib(presence, <span class="stringliteral">&quot;to&quot;</span>, room);
<a name="l01929"></a>01929       iks_insert_node(presence, priority);
<a name="l01930"></a>01930       res = <a class="code" href="jabber_8h.html#a3c77ceecc909619207e971421fc3e9ef" title="Wraps raw sending.">ast_aji_send</a>(client, presence);
<a name="l01931"></a>01931       iks_insert_cdata(priority, <span class="stringliteral">&quot;5&quot;</span>, 1);
<a name="l01932"></a>01932       iks_insert_attrib(presence, <span class="stringliteral">&quot;to&quot;</span>, room);
<a name="l01933"></a>01933       res = <a class="code" href="jabber_8h.html#a3c77ceecc909619207e971421fc3e9ef" title="Wraps raw sending.">ast_aji_send</a>(client, presence);
<a name="l01934"></a>01934    } <span class="keywordflow">else</span> 
<a name="l01935"></a>01935       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of memory.\n&quot;</span>);
<a name="l01936"></a>01936    
<a name="l01937"></a>01937    iks_delete(presence);
<a name="l01938"></a>01938    iks_delete(priority);
<a name="l01939"></a>01939    
<a name="l01940"></a>01940    <span class="keywordflow">return</span> res;
<a name="l01941"></a>01941 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c77ceecc909619207e971421fc3e9ef"></a><!-- doxytag: member="jabber.h::ast_aji_send" ref="a3c77ceecc909619207e971421fc3e9ef" args="(struct aji_client *client, iks *x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">iks *&nbsp;</td>
          <td class="paramname"> <em>x</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wraps raw sending. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>the configured XMPP client we use to connect to a XMPP server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>the XMPP packet to send </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>IKS_OK on success, any other value on failure </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l00818">818</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="res__jabber_8c_source.html#l00831">aji_send_raw()</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00944">aji_act_hook()</a>, <a class="el" href="res__jabber_8c_source.html#l01353">aji_client_info_handler()</a>, <a class="el" href="res__jabber_8c_source.html#l01413">aji_dinfo_handler()</a>, <a class="el" href="res__jabber_8c_source.html#l01258">aji_ditems_handler()</a>, <a class="el" href="res__jabber_8c_source.html#l02305">aji_get_roster()</a>, <a class="el" href="res__jabber_8c_source.html#l01604">aji_handle_presence()</a>, <a class="el" href="res__jabber_8c_source.html#l01822">aji_handle_subscribe()</a>, <a class="el" href="res__jabber_8c_source.html#l02146">aji_pruneregister()</a>, <a class="el" href="res__jabber_8c_source.html#l01144">aji_register_approve_handler()</a>, <a class="el" href="res__jabber_8c_source.html#l01187">aji_register_query_handler()</a>, <a class="el" href="res__jabber_8c_source.html#l02408">aji_set_presence()</a>, <a class="el" href="res__jabber_8c_source.html#l00895">aji_start_sasl()</a>, <a class="el" href="res__jabber_8c_source.html#l01894">ast_aji_create_chat()</a>, <a class="el" href="res__jabber_8c_source.html#l01951">ast_aji_invite_chat()</a>, <a class="el" href="res__jabber_8c_source.html#l01920">ast_aji_join_chat()</a>, <a class="el" href="res__jabber_8c_source.html#l01867">ast_aji_send_chat()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01078">gtalk_action()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01302">gtalk_add_candidate()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00773">gtalk_create_candidates()</a>, <a class="el" href="chan__gtalk_8c_source.html#l01512">gtalk_digit()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00379">gtalk_invite()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00458">gtalk_invite_response()</a>, <a class="el" href="chan__gtalk_8c_source.html#l00571">gtalk_response()</a>, <a class="el" href="chan__jingle_8c_source.html#l00311">jingle_accept_call()</a>, <a class="el" href="chan__jingle_8c_source.html#l00883">jingle_action()</a>, <a class="el" href="chan__jingle_8c_source.html#l01089">jingle_add_candidate()</a>, <a class="el" href="chan__jingle_8c_source.html#l00583">jingle_create_candidates()</a>, <a class="el" href="chan__jingle_8c_source.html#l01284">jingle_digit()</a>, <a class="el" href="chan__jingle_8c_source.html#l00446">jingle_response()</a>, and <a class="el" href="chan__jingle_8c_source.html#l01346">jingle_transmit_invite()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00819"></a>00819 {
<a name="l00820"></a>00820    <span class="keywordflow">return</span> <a class="code" href="res__jabber_8c.html#a265a12987d4ab3483e7cd733f03ca1d6" title="Sends an XML string over an XMPP connection.">aji_send_raw</a>(client, iks_string(iks_stack(x), x));
<a name="l00821"></a>00821 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af2b674ed94b89a5798fe22714a44f046"></a><!-- doxytag: member="jabber.h::ast_aji_send_chat" ref="af2b674ed94b89a5798fe22714a44f046" args="(struct aji_client *client, const char *address, const char *message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_aji_send_chat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="paramname"> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>message</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sends messages. </p>
<p>Send jabber chat <a class="el" href="structmessage.html">message</a> from connected client to jabber URI</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>client</em>&nbsp;</td><td>the configured XMPP client we use to connect to a XMPP server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structmessage.html">message</a></em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1. </dd></dl>

<p>Definition at line <a class="el" href="res__jabber_8c_source.html#l01867">1867</a> of file <a class="el" href="res__jabber_8c_source.html">res_jabber.c</a>.</p>

<p>References <a class="el" href="jabber_8h_source.html#l00080">AJI_CONNECTED</a>, <a class="el" href="res__jabber_8c_source.html#l00818">ast_aji_send()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="jabber_8h_source.html#l00149">aji_client::jid</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="jabber_8h_source.html#l00159">aji_client::state</a>.</p>

<p>Referenced by <a class="el" href="res__jabber_8c_source.html#l00548">aji_send_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l02595">aji_test()</a>, and <a class="el" href="res__jabber_8c_source.html#l02994">manager_jabber_send()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01868"></a>01868 {
<a name="l01869"></a>01869    <span class="keywordtype">int</span> res = 0;
<a name="l01870"></a>01870    iks *message_packet = NULL;
<a name="l01871"></a>01871    <span class="keywordflow">if</span> (client-&gt;<a class="code" href="structaji__client.html#ab27a750579a23ed7fd9b24c1bf49bf12">state</a> == <a class="code" href="jabber_8h.html#a75f56fc355bdf37aa9ed1ee97b5986b0ae1921cd67cd09004d94dbbd8473f47d9">AJI_CONNECTED</a>) {
<a name="l01872"></a>01872       message_packet = iks_make_msg(IKS_TYPE_CHAT, address, <a class="code" href="structmessage.html">message</a>);
<a name="l01873"></a>01873       <span class="keywordflow">if</span> (message_packet) {
<a name="l01874"></a>01874          iks_insert_attrib(message_packet, <span class="stringliteral">&quot;from&quot;</span>, client-&gt;<a class="code" href="structaji__client.html#af738439b96e613a471505eb1222ac406">jid</a>-&gt;full);
<a name="l01875"></a>01875          res = <a class="code" href="jabber_8h.html#a3c77ceecc909619207e971421fc3e9ef" title="Wraps raw sending.">ast_aji_send</a>(client, message_packet);
<a name="l01876"></a>01876       } <span class="keywordflow">else</span> {
<a name="l01877"></a>01877          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of memory.\n&quot;</span>);
<a name="l01878"></a>01878       }
<a name="l01879"></a>01879 
<a name="l01880"></a>01880       iks_delete(message_packet);
<a name="l01881"></a>01881    } <span class="keywordflow">else</span>
<a name="l01882"></a>01882       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;JABBER: Not connected can&apos;t send\n&quot;</span>);
<a name="l01883"></a>01883    <span class="keywordflow">return</span> 1;
<a name="l01884"></a>01884 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:22:18 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
