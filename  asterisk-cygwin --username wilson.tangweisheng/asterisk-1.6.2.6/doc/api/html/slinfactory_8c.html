<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:23:30 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_afe38fc0ccf2e9eefca5d5c6b03503d9.html">main</a>
  </div>
</div>
<div class="contents">
<h1>slinfactory.c File Reference</h1>
<p>A machine to gather up arbitrary frames and convert them to raw slinear on demand.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="frame_8h_source.html">asterisk/frame.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="slinfactory_8h_source.html">asterisk/slinfactory.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="translate_8h_source.html">asterisk/translate.h</a>&quot;</code><br/>

<p><a href="slinfactory_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#a6c48d283b3d2bce6af0a09c3b8b7fd0e">ast_slinfactory_available</a> (const struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples currently in a slinfactory.  <a href="#a6c48d283b3d2bce6af0a09c3b8b7fd0e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#ab5361491bac02fb60732df5671879652">ast_slinfactory_destroy</a> (struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy the contents of a slinfactory.  <a href="#ab5361491bac02fb60732df5671879652"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#a83e5056051013853a0d80fc5862a9fe8">ast_slinfactory_feed</a> (struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Feed audio into a slinfactory.  <a href="#a83e5056051013853a0d80fc5862a9fe8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#a808da481a1c8673571179c51a97fb009">ast_slinfactory_flush</a> (struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flush the contents of a slinfactory.  <a href="#a808da481a1c8673571179c51a97fb009"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#a213f392fc2df73230ec61af35072c1b2">ast_slinfactory_init</a> (struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a slinfactory.  <a href="#a213f392fc2df73230ec61af35072c1b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#ad47b0e8e9a814856dd20fe4675f46c10">ast_slinfactory_init_rate</a> (struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf, unsigned int sample_rate)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a slinfactory.  <a href="#ad47b0e8e9a814856dd20fe4675f46c10"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="slinfactory_8c.html#a75052c0e654e356675b26afbebe93097">ast_slinfactory_read</a> (struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *sf, short *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, size_t samples)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read samples from a slinfactory.  <a href="#a75052c0e654e356675b26afbebe93097"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>A machine to gather up arbitrary frames and convert them to raw slinear on demand. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Anthony Minessale &lt;<a href="mailto:anthmct@yahoo.com">anthmct@yahoo.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6c48d283b3d2bce6af0a09c3b8b7fd0e"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_available" ref="a6c48d283b3d2bce6af0a09c3b8b7fd0e" args="(const struct ast_slinfactory *sf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ast_slinfactory_available </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve <a class="el" href="structnumber.html" title="Number structure.">number</a> of samples currently in a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory to peek into</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Number of samples in slinfactory </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00192">192</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="slinfactory_8h_source.html#l00039">ast_slinfactory::size</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00121">ast_audiohook_write_frame()</a>, <a class="el" href="audiohook_8c_source.html#l00582">audio_audiohook_write_list()</a>, <a class="el" href="audiohook_8c_source.html#l00197">audiohook_read_frame_both()</a>, <a class="el" href="audiohook_8c_source.html#l00169">audiohook_read_frame_single()</a>, and <a class="el" href="bridge__softmix_8c_source.html#l00211">softmix_bridge_thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00193"></a>00193 {
<a name="l00194"></a>00194    <span class="keywordflow">return</span> sf-&gt;<a class="code" href="structast__slinfactory.html#aac913b3a1f6ef005d66bf7a84428773e">size</a>;
<a name="l00195"></a>00195 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab5361491bac02fb60732df5671879652"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_destroy" ref="ab5361491bac02fb60732df5671879652" args="(struct ast_slinfactory *sf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_slinfactory_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy the contents of a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory that is no longer needed</td></tr>
  </table>
  </dd>
</dl>
<p>This function will free any memory allocated for the contents of the slinfactory. It does not free the slinfactory itself. If the sf is malloc'd, then it must be explicitly free'd after calling this function.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nothing </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00060">60</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00462">ast_frfree</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="translate_8c_source.html#l00253">ast_translator_free_path()</a>, <a class="el" href="format__g726_8c_source.html#l00177">f</a>, <a class="el" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">ast_slinfactory::queue</a>, and <a class="el" href="slinfactory_8h_source.html#l00035">ast_slinfactory::trans</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00091">ast_audiohook_destroy()</a>, and <a class="el" href="bridge__softmix_8c_source.html#l00144">softmix_bridge_leave()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00061"></a>00061 {
<a name="l00062"></a>00062    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064    <span class="keywordflow">if</span> (sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>) {
<a name="l00065"></a>00065       <a class="code" href="translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207" title="Frees a translator path Frees the given translator path structure.">ast_translator_free_path</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>);
<a name="l00066"></a>00066       sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = NULL;
<a name="l00067"></a>00067    }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069    <span class="keywordflow">while</span> ((f = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;sf-&gt;<a class="code" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">queue</a>, frame_list)))
<a name="l00070"></a>00070       <a class="code" href="frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);
<a name="l00071"></a>00071 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a83e5056051013853a0d80fc5862a9fe8"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_feed" ref="a83e5056051013853a0d80fc5862a9fe8" args="(struct ast_slinfactory *sf, struct ast_frame *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_slinfactory_feed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Feed audio into a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory to feed into </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>Frame containing audio to feed in</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Number of frames currently in factory </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00073">73</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00474">ast_frdup()</a>, <a class="el" href="frame_8h_source.html#l00462">ast_frfree</a>, <a class="el" href="frame_8c_source.html#l00389">ast_frisolate()</a>, <a class="el" href="frame_8c_source.html#l00573">ast_getformatname()</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00438">AST_LIST_NEXT</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="translate_8c_source.html#l00308">ast_translate()</a>, <a class="el" href="translate_8c_source.html#l00263">ast_translator_build_path()</a>, <a class="el" href="translate_8c_source.html#l00253">ast_translator_free_path()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="slinfactory_8h_source.html#l00040">ast_slinfactory::format</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="slinfactory_8h_source.html#l00041">ast_slinfactory::output_format</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">ast_slinfactory::queue</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="slinfactory_8h_source.html#l00039">ast_slinfactory::size</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, and <a class="el" href="slinfactory_8h_source.html#l00035">ast_slinfactory::trans</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00121">ast_audiohook_write_frame()</a>, and <a class="el" href="bridge__softmix_8c_source.html#l00161">softmix_bridge_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00074"></a>00074 {
<a name="l00075"></a>00075    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *begin_frame = f, *duped_frame = NULL, *frame_ptr;
<a name="l00076"></a>00076    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x = 0;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078    <span class="comment">/* In some cases, we can be passed a frame which has no data in it, but</span>
<a name="l00079"></a>00079 <span class="comment">    * which has a positive number of samples defined. Once such situation is</span>
<a name="l00080"></a>00080 <span class="comment">    * when a jitter buffer is in use and the jitter buffer interpolates a frame.</span>
<a name="l00081"></a>00081 <span class="comment">    * The frame it produces has data set to NULL, datalen set to 0, and samples</span>
<a name="l00082"></a>00082 <span class="comment">    * set to either 160 or 240.</span>
<a name="l00083"></a>00083 <span class="comment">    */</span>
<a name="l00084"></a>00084    <span class="keywordflow">if</span> (!f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) {
<a name="l00085"></a>00085       <span class="keywordflow">return</span> 0;
<a name="l00086"></a>00086    }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> != sf-&gt;<a class="code" href="structast__slinfactory.html#a359559338b7592c72a7333080fca22e1">output_format</a>) {
<a name="l00089"></a>00089       <span class="keywordflow">if</span> (sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> &amp;&amp; f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> != sf-&gt;<a class="code" href="structast__slinfactory.html#a6fea735e1b12f87689267ca76a7f4037">format</a>) {
<a name="l00090"></a>00090          <a class="code" href="translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207" title="Frees a translator path Frees the given translator path structure.">ast_translator_free_path</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>);
<a name="l00091"></a>00091          sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = NULL;
<a name="l00092"></a>00092       }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094       <span class="keywordflow">if</span> (!sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>) {
<a name="l00095"></a>00095          <span class="keywordflow">if</span> (!(sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = <a class="code" href="translate_8h.html#ae53a058fb0d55f3f0b3264813b50232a" title="Builds a translator path Build a path (possibly NULL) from source to dest.">ast_translator_build_path</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#a359559338b7592c72a7333080fca22e1">output_format</a>, f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>))) {
<a name="l00096"></a>00096             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot build a path from %s to %s\n&quot;</span>, <a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>),
<a name="l00097"></a>00097                <a class="code" href="frame_8h.html#afe8f690984f8ba95cd01a431198c10bf" title="Get the name of a format.">ast_getformatname</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#a359559338b7592c72a7333080fca22e1">output_format</a>));
<a name="l00098"></a>00098             <span class="keywordflow">return</span> 0;
<a name="l00099"></a>00099          }
<a name="l00100"></a>00100          sf-&gt;<a class="code" href="structast__slinfactory.html#a6fea735e1b12f87689267ca76a7f4037">format</a> = f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l00101"></a>00101       }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103       <span class="keywordflow">if</span> (!(begin_frame = <a class="code" href="translate_8h.html#ab09d3ccb95d1f828d2871530226f9456" title="translates one or more frames Apply an input frame into the translator and receive...">ast_translate</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>, f, 0))) {
<a name="l00104"></a>00104          <span class="keywordflow">return</span> 0;
<a name="l00105"></a>00105       }
<a name="l00106"></a>00106       
<a name="l00107"></a>00107       <span class="keywordflow">if</span> (!(duped_frame = <a class="code" href="frame_8h.html#aa7dbd9b12889d9f96fb6c01f94b4909e" title="Makes a frame independent of any static storage.">ast_frisolate</a>(begin_frame))) {
<a name="l00108"></a>00108          <span class="keywordflow">return</span> 0;
<a name="l00109"></a>00109       }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111       <span class="keywordflow">if</span> (duped_frame != begin_frame) {
<a name="l00112"></a>00112          <a class="code" href="frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(begin_frame);
<a name="l00113"></a>00113       }
<a name="l00114"></a>00114    } <span class="keywordflow">else</span> {
<a name="l00115"></a>00115       <span class="keywordflow">if</span> (sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>) {
<a name="l00116"></a>00116          <a class="code" href="translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207" title="Frees a translator path Frees the given translator path structure.">ast_translator_free_path</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>);
<a name="l00117"></a>00117          sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = NULL;
<a name="l00118"></a>00118       }
<a name="l00119"></a>00119       <span class="keywordflow">if</span> (!(duped_frame = <a class="code" href="frame_8h.html#a4b23720d208128250a765490b1a4f145" title="Copies a frame.">ast_frdup</a>(f)))
<a name="l00120"></a>00120          <span class="keywordflow">return</span> 0;
<a name="l00121"></a>00121    }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;sf-&gt;<a class="code" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">queue</a>, frame_ptr, frame_list) {
<a name="l00124"></a>00124       x++;
<a name="l00125"></a>00125    }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127    <span class="comment">/* if the frame was translated, the translator may have returned multiple</span>
<a name="l00128"></a>00128 <span class="comment">      frames, so process each of them</span>
<a name="l00129"></a>00129 <span class="comment">   */</span>
<a name="l00130"></a>00130    <span class="keywordflow">for</span> (begin_frame = duped_frame; begin_frame; begin_frame = <a class="code" href="linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6" title="Returns the next entry in the list after the given entry.">AST_LIST_NEXT</a>(begin_frame, frame_list)) {
<a name="l00131"></a>00131       <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;sf-&gt;<a class="code" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">queue</a>, begin_frame, frame_list);
<a name="l00132"></a>00132       sf-&gt;<a class="code" href="structast__slinfactory.html#aac913b3a1f6ef005d66bf7a84428773e">size</a> += begin_frame-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;
<a name="l00133"></a>00133    }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135    <span class="keywordflow">return</span> x;
<a name="l00136"></a>00136 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a808da481a1c8673571179c51a97fb009"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_flush" ref="a808da481a1c8673571179c51a97fb009" args="(struct ast_slinfactory *sf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_slinfactory_flush </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flush the contents of a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory to flush</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nothing </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00197">197</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00462">ast_frfree</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="translate_8c_source.html#l00253">ast_translator_free_path()</a>, <a class="el" href="slinfactory_8h_source.html#l00036">ast_slinfactory::hold</a>, <a class="el" href="slinfactory_8h_source.html#l00038">ast_slinfactory::holdlen</a>, <a class="el" href="slinfactory_8h_source.html#l00037">ast_slinfactory::offset</a>, <a class="el" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">ast_slinfactory::queue</a>, <a class="el" href="slinfactory_8h_source.html#l00039">ast_slinfactory::size</a>, and <a class="el" href="slinfactory_8h_source.html#l00035">ast_slinfactory::trans</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00121">ast_audiohook_write_frame()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00198"></a>00198 {
<a name="l00199"></a>00199    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *fr = NULL;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201    <span class="keywordflow">if</span> (sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>) {
<a name="l00202"></a>00202       <a class="code" href="translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207" title="Frees a translator path Frees the given translator path structure.">ast_translator_free_path</a>(sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>);
<a name="l00203"></a>00203       sf-&gt;<a class="code" href="structast__slinfactory.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = NULL;
<a name="l00204"></a>00204    }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206    <span class="keywordflow">while</span> ((fr = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;sf-&gt;<a class="code" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">queue</a>, frame_list)))
<a name="l00207"></a>00207       <a class="code" href="frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209    sf-&gt;<a class="code" href="structast__slinfactory.html#aac913b3a1f6ef005d66bf7a84428773e">size</a> = sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> = 0;
<a name="l00210"></a>00210    sf-&gt;<a class="code" href="structast__slinfactory.html#a3e02381adcf575c98eaecd9b7b486a2e">offset</a> = sf-&gt;<a class="code" href="structast__slinfactory.html#adbc873a076c71ebf9935148849ebf62a">hold</a>;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212    <span class="keywordflow">return</span>;
<a name="l00213"></a>00213 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a213f392fc2df73230ec61af35072c1b2"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_init" ref="a213f392fc2df73230ec61af35072c1b2" args="(struct ast_slinfactory *sf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_slinfactory_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory to initialize</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nothing </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00035">35</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="slinfactory_8h_source.html#l00036">ast_slinfactory::hold</a>, <a class="el" href="slinfactory_8h_source.html#l00037">ast_slinfactory::offset</a>, and <a class="el" href="slinfactory_8h_source.html#l00041">ast_slinfactory::output_format</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00060">ast_audiohook_init()</a>, and <a class="el" href="bridge__softmix_8c_source.html#l00111">softmix_bridge_join()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00036"></a>00036 {
<a name="l00037"></a>00037    memset(sf, 0, <span class="keyword">sizeof</span>(*sf));
<a name="l00038"></a>00038    sf-&gt;<a class="code" href="structast__slinfactory.html#a3e02381adcf575c98eaecd9b7b486a2e">offset</a> = sf-&gt;<a class="code" href="structast__slinfactory.html#adbc873a076c71ebf9935148849ebf62a">hold</a>;
<a name="l00039"></a>00039    sf-&gt;<a class="code" href="structast__slinfactory.html#a359559338b7592c72a7333080fca22e1">output_format</a> = <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>;
<a name="l00040"></a>00040 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad47b0e8e9a814856dd20fe4675f46c10"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_init_rate" ref="ad47b0e8e9a814856dd20fe4675f46c10" args="(struct ast_slinfactory *sf, unsigned int sample_rate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_slinfactory_init_rate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>sample_rate</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory to initialize </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sample_rate</em>&nbsp;</td><td>The output sample rate desired</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, non-zero on failure </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00042">42</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00271">AST_FORMAT_SLINEAR16</a>, <a class="el" href="slinfactory_8h_source.html#l00036">ast_slinfactory::hold</a>, <a class="el" href="slinfactory_8h_source.html#l00037">ast_slinfactory::offset</a>, and <a class="el" href="slinfactory_8h_source.html#l00041">ast_slinfactory::output_format</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00043"></a>00043 {
<a name="l00044"></a>00044    memset(sf, 0, <span class="keyword">sizeof</span>(*sf));
<a name="l00045"></a>00045    sf-&gt;<a class="code" href="structast__slinfactory.html#a3e02381adcf575c98eaecd9b7b486a2e">offset</a> = sf-&gt;<a class="code" href="structast__slinfactory.html#adbc873a076c71ebf9935148849ebf62a">hold</a>;
<a name="l00046"></a>00046    <span class="keywordflow">switch</span> (sample_rate) {
<a name="l00047"></a>00047    <span class="keywordflow">case</span> 8000:
<a name="l00048"></a>00048       sf-&gt;<a class="code" href="structast__slinfactory.html#a359559338b7592c72a7333080fca22e1">output_format</a> = <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>;
<a name="l00049"></a>00049       <span class="keywordflow">break</span>;
<a name="l00050"></a>00050    <span class="keywordflow">case</span> 16000:
<a name="l00051"></a>00051       sf-&gt;<a class="code" href="structast__slinfactory.html#a359559338b7592c72a7333080fca22e1">output_format</a> = <a class="code" href="frame_8h.html#a6e078550fcf3f2038f6c343b3d65a936">AST_FORMAT_SLINEAR16</a>;
<a name="l00052"></a>00052       <span class="keywordflow">break</span>;
<a name="l00053"></a>00053    <span class="keywordflow">default</span>:
<a name="l00054"></a>00054       <span class="keywordflow">return</span> -1;
<a name="l00055"></a>00055    }
<a name="l00056"></a>00056 
<a name="l00057"></a>00057    <span class="keywordflow">return</span> 0;
<a name="l00058"></a>00058 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a75052c0e654e356675b26afbebe93097"></a><!-- doxytag: member="slinfactory.c::ast_slinfactory_read" ref="a75052c0e654e356675b26afbebe93097" args="(struct ast_slinfactory *sf, short *buf, size_t samples)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_slinfactory_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__slinfactory.html">ast_slinfactory</a> *&nbsp;</td>
          <td class="paramname"> <em>sf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>samples</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read samples from a slinfactory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sf</em>&nbsp;</td><td>The slinfactory to read from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>Buffer to put samples into </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>samples</em>&nbsp;</td><td>Number of samples wanted</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Number of samples read </dd></dl>

<p>Definition at line <a class="el" href="slinfactory_8c_source.html#l00138">138</a> of file <a class="el" href="slinfactory_8c_source.html">slinfactory.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00462">ast_frfree</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="slinfactory_8h_source.html#l00031">AST_SLINFACTORY_MAX_HOLD</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="slinfactory_8h_source.html#l00036">ast_slinfactory::hold</a>, <a class="el" href="slinfactory_8h_source.html#l00038">ast_slinfactory::holdlen</a>, <a class="el" href="slinfactory_8h_source.html#l00037">ast_slinfactory::offset</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">ast_slinfactory::queue</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, and <a class="el" href="slinfactory_8h_source.html#l00039">ast_slinfactory::size</a>.</p>

<p>Referenced by <a class="el" href="audiohook_8c_source.html#l00582">audio_audiohook_write_list()</a>, <a class="el" href="audiohook_8c_source.html#l00197">audiohook_read_frame_both()</a>, <a class="el" href="audiohook_8c_source.html#l00169">audiohook_read_frame_single()</a>, and <a class="el" href="bridge__softmix_8c_source.html#l00211">softmix_bridge_thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00139"></a>00139 {
<a name="l00140"></a>00140    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *frame_ptr;
<a name="l00141"></a>00141    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sofar = 0, ineed, remain;
<a name="l00142"></a>00142    <span class="keywordtype">short</span> *frame_data, *<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00143"></a>00143 
<a name="l00144"></a>00144    <span class="keywordflow">while</span> (sofar &lt; <a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>) {
<a name="l00145"></a>00145       ineed = <a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> - sofar;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147       <span class="keywordflow">if</span> (sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a>) {
<a name="l00148"></a>00148          <span class="keywordflow">if</span> (sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> &lt;= ineed) {
<a name="l00149"></a>00149             memcpy(offset, sf-&gt;<a class="code" href="structast__slinfactory.html#adbc873a076c71ebf9935148849ebf62a">hold</a>, sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> * <span class="keyword">sizeof</span>(*offset));
<a name="l00150"></a>00150             sofar += sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a>;
<a name="l00151"></a>00151             offset += sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a>;
<a name="l00152"></a>00152             sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> = 0;
<a name="l00153"></a>00153             sf-&gt;<a class="code" href="structast__slinfactory.html#a3e02381adcf575c98eaecd9b7b486a2e">offset</a> = sf-&gt;<a class="code" href="structast__slinfactory.html#adbc873a076c71ebf9935148849ebf62a">hold</a>;
<a name="l00154"></a>00154          } <span class="keywordflow">else</span> {
<a name="l00155"></a>00155             remain = sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> - ineed;
<a name="l00156"></a>00156             memcpy(offset, sf-&gt;<a class="code" href="structast__slinfactory.html#a3e02381adcf575c98eaecd9b7b486a2e">offset</a>, ineed * <span class="keyword">sizeof</span>(*offset));
<a name="l00157"></a>00157             sofar += ineed;
<a name="l00158"></a>00158             sf-&gt;<a class="code" href="structast__slinfactory.html#a3e02381adcf575c98eaecd9b7b486a2e">offset</a> += ineed;
<a name="l00159"></a>00159             sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> = remain;
<a name="l00160"></a>00160          }
<a name="l00161"></a>00161          <span class="keywordflow">continue</span>;
<a name="l00162"></a>00162       }
<a name="l00163"></a>00163       
<a name="l00164"></a>00164       <span class="keywordflow">if</span> ((frame_ptr = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;sf-&gt;<a class="code" href="structast__slinfactory.html#abbcfe8520f5236f07e7aaa90e7e9d685">queue</a>, frame_list))) {
<a name="l00165"></a>00165          frame_data = frame_ptr-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;
<a name="l00166"></a>00166          
<a name="l00167"></a>00167          <span class="keywordflow">if</span> (frame_ptr-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> &lt;= ineed) {
<a name="l00168"></a>00168             memcpy(offset, frame_data, frame_ptr-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> * <span class="keyword">sizeof</span>(*offset));
<a name="l00169"></a>00169             sofar += frame_ptr-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;
<a name="l00170"></a>00170             offset += frame_ptr-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;
<a name="l00171"></a>00171          } <span class="keywordflow">else</span> {
<a name="l00172"></a>00172             remain = frame_ptr-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> - ineed;
<a name="l00173"></a>00173             memcpy(offset, frame_data, ineed * <span class="keyword">sizeof</span>(*offset));
<a name="l00174"></a>00174             sofar += ineed;
<a name="l00175"></a>00175             frame_data += ineed;
<a name="l00176"></a>00176             <span class="keywordflow">if</span> (remain &gt; (<a class="code" href="slinfactory_8h.html#a156e0707db1580839637c64332098bee">AST_SLINFACTORY_MAX_HOLD</a> - sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a>)) {
<a name="l00177"></a>00177                remain = <a class="code" href="slinfactory_8h.html#a156e0707db1580839637c64332098bee">AST_SLINFACTORY_MAX_HOLD</a> - sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a>;
<a name="l00178"></a>00178             }
<a name="l00179"></a>00179             memcpy(sf-&gt;<a class="code" href="structast__slinfactory.html#adbc873a076c71ebf9935148849ebf62a">hold</a>, frame_data, remain * <span class="keyword">sizeof</span>(*offset));
<a name="l00180"></a>00180             sf-&gt;<a class="code" href="structast__slinfactory.html#ac21e94e113ef23637f956a359a7b5473">holdlen</a> = remain;
<a name="l00181"></a>00181          }
<a name="l00182"></a>00182          <a class="code" href="frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(frame_ptr);
<a name="l00183"></a>00183       } <span class="keywordflow">else</span> {
<a name="l00184"></a>00184          <span class="keywordflow">break</span>;
<a name="l00185"></a>00185       }
<a name="l00186"></a>00186    }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188    sf-&gt;<a class="code" href="structast__slinfactory.html#aac913b3a1f6ef005d66bf7a84428773e">size</a> -= sofar;
<a name="l00189"></a>00189    <span class="keywordflow">return</span> sofar;
<a name="l00190"></a>00190 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:23:30 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
