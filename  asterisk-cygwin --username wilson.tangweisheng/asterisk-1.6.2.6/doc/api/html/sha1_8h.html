<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:23:30 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>sha1.h File Reference</h1>
<p><a href="sha1_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSHA1Context.html">SHA1Context</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This structure will hold context information for the SHA-1 hashing operation.  <a href="structSHA1Context.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha1_8h.html#affb0e361992e82550da290d8dccc6c52">SHA1HashSize</a>&nbsp;&nbsp;&nbsp;20</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a> =  0, 
<a class="el" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>, 
<a class="el" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada383493bb8927060f349e11f915cbb636">shaInputTooLong</a>, 
<a class="el" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha1_8h.html#abcec0fbbb48793f9e9ccfea9b9792aad">SHA1Input</a> (<a class="el" href="structSHA1Context.html">SHA1Context</a> *, const uint8_t *, unsigned int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SHA1Input.  <a href="#abcec0fbbb48793f9e9ccfea9b9792aad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha1_8h.html#ab4d7125efac9b487ca663d692e78af36">SHA1Reset</a> (<a class="el" href="structSHA1Context.html">SHA1Context</a> *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SHA1Reset.  <a href="#ab4d7125efac9b487ca663d692e78af36"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sha1_8h.html#a12d619787f5a12702e890b2c3907510e">SHA1Result</a> (<a class="el" href="structSHA1Context.html">SHA1Context</a> *, uint8_t Message_Digest[SHA1HashSize])</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SHA1Result.  <a href="#a12d619787f5a12702e890b2c3907510e"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="affb0e361992e82550da290d8dccc6c52"></a><!-- doxytag: member="sha1.h::SHA1HashSize" ref="affb0e361992e82550da290d8dccc6c52" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHA1HashSize&nbsp;&nbsp;&nbsp;20</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sha1_8h_source.html#l00041">41</a> of file <a class="el" href="sha1_8h_source.html">sha1.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a1e8054db89feba236b2235d16d0bd1ad"></a><!-- doxytag: member="sha1.h::@135" ref="a1e8054db89feba236b2235d16d0bd1ad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa"></a><!-- doxytag: member="shaSuccess" ref="a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa" args="" -->shaSuccess</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70"></a><!-- doxytag: member="shaNull" ref="a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70" args="" -->shaNull</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a1e8054db89feba236b2235d16d0bd1ada383493bb8927060f349e11f915cbb636"></a><!-- doxytag: member="shaInputTooLong" ref="a1e8054db89feba236b2235d16d0bd1ada383493bb8927060f349e11f915cbb636" args="" -->shaInputTooLong</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a1e8054db89feba236b2235d16d0bd1adaf95bed729cc00460585fb8d76f0c384d"></a><!-- doxytag: member="shaStateError" ref="a1e8054db89feba236b2235d16d0bd1adaf95bed729cc00460585fb8d76f0c384d" args="" -->shaStateError</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="sha1_8h_source.html#l00033">33</a> of file <a class="el" href="sha1_8h_source.html">sha1.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00034"></a>00034 {
<a name="l00035"></a>00035     <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a> = 0,
<a name="l00036"></a>00036     <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>,            <span class="comment">/* Null pointer parameter */</span>
<a name="l00037"></a>00037     <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada383493bb8927060f349e11f915cbb636">shaInputTooLong</a>,    <span class="comment">/* input data too long */</span>
<a name="l00038"></a>00038     <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>       <span class="comment">/* called Input after Result */</span>
<a name="l00039"></a>00039 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="abcec0fbbb48793f9e9ccfea9b9792aad"></a><!-- doxytag: member="sha1.h::SHA1Input" ref="abcec0fbbb48793f9e9ccfea9b9792aad" args="(SHA1Context *, const uint8_t *, unsigned int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1Input </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSHA1Context.html">SHA1Context</a> *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>message_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>length</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SHA1Input. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>[in/out] The SHA context to update </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>message_array</em>&nbsp;</td><td>[in] An array of characters representing the next portion of the <a class="el" href="structmessage.html">message</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>[in] The length of the <a class="el" href="structmessage.html">message</a> in message_array. This function accepts an array of octets as the next portion of the <a class="el" href="structmessage.html">message</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>sha Error Code. </dd></dl>

<p>Definition at line <a class="el" href="sha1_8c_source.html#l00154">154</a> of file <a class="el" href="sha1_8c_source.html">sha1.c</a>.</p>

<p>References <a class="el" href="sha1_8h_source.html#l00057">SHA1Context::Computed</a>, <a class="el" href="sha1_8h_source.html#l00058">SHA1Context::Corrupted</a>, <a class="el" href="sha1_8h_source.html#l00051">SHA1Context::Length_High</a>, <a class="el" href="sha1_8h_source.html#l00050">SHA1Context::Length_Low</a>, <a class="el" href="sha1_8h_source.html#l00055">SHA1Context::Message_Block</a>, <a class="el" href="sha1_8h_source.html#l00054">SHA1Context::Message_Block_Index</a>, <a class="el" href="sha1_8c_source.html#l00203">SHA1ProcessMessageBlock()</a>, <a class="el" href="sha1_8h_source.html#l00036">shaNull</a>, <a class="el" href="sha1_8h_source.html#l00038">shaStateError</a>, and <a class="el" href="sha1_8h_source.html#l00035">shaSuccess</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00246">ast_sha1_hash()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00155"></a>00155 {
<a name="l00156"></a>00156    <span class="keywordflow">if</span> (!length) {
<a name="l00157"></a>00157       <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00158"></a>00158    }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160    <span class="keywordflow">if</span> (!context || !message_array) {
<a name="l00161"></a>00161       <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00162"></a>00162    }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164    <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a>) {
<a name="l00165"></a>00165       context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a> = <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>;
<a name="l00166"></a>00166       <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>;
<a name="l00167"></a>00167    }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169    <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>) {
<a name="l00170"></a>00170       <span class="keywordflow">return</span> context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;
<a name="l00171"></a>00171    }
<a name="l00172"></a>00172 
<a name="l00173"></a>00173    <span class="keywordflow">while</span> (length-- &amp;&amp; !context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>) {
<a name="l00174"></a>00174       context-&gt;<a class="code" href="structSHA1Context.html#a33d55b1ff652119922a5edbcba624e57">Message_Block</a>[context-&gt;<a class="code" href="structSHA1Context.html#a9a5636d2ef44435a283e280804a4e36d">Message_Block_Index</a>++] = (*message_array &amp; 0xFF);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176       context-&gt;<a class="code" href="structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> += 8;
<a name="l00177"></a>00177       <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> == 0) {
<a name="l00178"></a>00178          context-&gt;<a class="code" href="structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a>++;
<a name="l00179"></a>00179          <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> == 0) {
<a name="l00180"></a>00180             <span class="comment">/* Message is too long */</span>
<a name="l00181"></a>00181             context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a> = 1;
<a name="l00182"></a>00182          }
<a name="l00183"></a>00183       }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185       <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structSHA1Context.html#a9a5636d2ef44435a283e280804a4e36d">Message_Block_Index</a> == 64) {
<a name="l00186"></a>00186          <a class="code" href="sha1_8c.html#ab81d8ed84300e21cb68e5b9db4804c93" title="Process the next 512 bits of the message stored in the Message_Block array.">SHA1ProcessMessageBlock</a>(context);
<a name="l00187"></a>00187       }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189       message_array++;
<a name="l00190"></a>00190    }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192    <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00193"></a>00193 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab4d7125efac9b487ca663d692e78af36"></a><!-- doxytag: member="sha1.h::SHA1Reset" ref="ab4d7125efac9b487ca663d692e78af36" args="(SHA1Context *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1Reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSHA1Context.html">SHA1Context</a> *&nbsp;</td>
          <td class="paramname"> <em>context</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SHA1Reset. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>the context to be reset. This function will initialize the <a class="el" href="structSHA1Context.html" title="This structure will hold context information for the SHA-1 hashing operation.">SHA1Context</a> in preparation for computing a new SHA1 <a class="el" href="structmessage.html">message</a> digest. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>sha Error Code. </dd></dl>

<p>Definition at line <a class="el" href="sha1_8c_source.html#l00081">81</a> of file <a class="el" href="sha1_8c_source.html">sha1.c</a>.</p>

<p>References <a class="el" href="sha1_8h_source.html#l00057">SHA1Context::Computed</a>, <a class="el" href="sha1_8h_source.html#l00058">SHA1Context::Corrupted</a>, <a class="el" href="sha1_8h_source.html#l00048">SHA1Context::Intermediate_Hash</a>, <a class="el" href="sha1_8h_source.html#l00051">SHA1Context::Length_High</a>, <a class="el" href="sha1_8h_source.html#l00050">SHA1Context::Length_Low</a>, <a class="el" href="sha1_8h_source.html#l00054">SHA1Context::Message_Block_Index</a>, <a class="el" href="sha1_8h_source.html#l00036">shaNull</a>, and <a class="el" href="sha1_8h_source.html#l00035">shaSuccess</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00246">ast_sha1_hash()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00082"></a>00082 {
<a name="l00083"></a>00083    <span class="keywordflow">if</span> (!context) {
<a name="l00084"></a>00084       <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00085"></a>00085    }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087    context-&gt;<a class="code" href="structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a>             = 0;
<a name="l00088"></a>00088    context-&gt;<a class="code" href="structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a>            = 0;
<a name="l00089"></a>00089    context-&gt;<a class="code" href="structSHA1Context.html#a9a5636d2ef44435a283e280804a4e36d">Message_Block_Index</a>    = 0;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091    context-&gt;<a class="code" href="structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[0]   = 0x67452301;
<a name="l00092"></a>00092    context-&gt;<a class="code" href="structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[1]   = 0xEFCDAB89;
<a name="l00093"></a>00093    context-&gt;<a class="code" href="structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[2]   = 0x98BADCFE;
<a name="l00094"></a>00094    context-&gt;<a class="code" href="structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[3]   = 0x10325476;
<a name="l00095"></a>00095    context-&gt;<a class="code" href="structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[4]   = 0xC3D2E1F0;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097    context-&gt;<a class="code" href="structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a>               = 0;
<a name="l00098"></a>00098    context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>              = 0;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100    <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00101"></a>00101 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a12d619787f5a12702e890b2c3907510e"></a><!-- doxytag: member="sha1.h::SHA1Result" ref="a12d619787f5a12702e890b2c3907510e" args="(SHA1Context *, uint8_t Message_Digest[SHA1HashSize])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1Result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSHA1Context.html">SHA1Context</a> *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>Message_Digest</em>[SHA1HashSize]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SHA1Result. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>[in/out] The context to use to calculate the SHA-1 hash. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Message_Digest</em>&nbsp;</td><td>[out] Where the digest is returned. This function will return the 160-bit <a class="el" href="structmessage.html">message</a> digest into the Message_Digest array provided by the caller. </td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>The first octet of hash is stored in the 0th element, the last octet of hash in the 19th element. </dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>sha Error Code. </dd></dl>

<p>Definition at line <a class="el" href="sha1_8c_source.html#l00113">113</a> of file <a class="el" href="sha1_8c_source.html">sha1.c</a>.</p>

<p>References <a class="el" href="sha1_8h_source.html#l00057">SHA1Context::Computed</a>, <a class="el" href="sha1_8h_source.html#l00058">SHA1Context::Corrupted</a>, <a class="el" href="sha1_8h_source.html#l00048">SHA1Context::Intermediate_Hash</a>, <a class="el" href="sha1_8h_source.html#l00051">SHA1Context::Length_High</a>, <a class="el" href="sha1_8h_source.html#l00050">SHA1Context::Length_Low</a>, <a class="el" href="sha1_8h_source.html#l00055">SHA1Context::Message_Block</a>, <a class="el" href="sha1_8c_source.html#l00298">SHA1PadMessage()</a>, <a class="el" href="sha1_8h_source.html#l00036">shaNull</a>, and <a class="el" href="sha1_8h_source.html#l00035">shaSuccess</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00246">ast_sha1_hash()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00115"></a>00115 {
<a name="l00116"></a>00116    <span class="keywordtype">int</span> i;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118    <span class="keywordflow">if</span> (!context || !Message_Digest) {
<a name="l00119"></a>00119       <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1adae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;
<a name="l00120"></a>00120    }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122    <span class="keywordflow">if</span> (context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>) {
<a name="l00123"></a>00123       <span class="keywordflow">return</span> context-&gt;<a class="code" href="structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;
<a name="l00124"></a>00124    }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126    <span class="keywordflow">if</span> (!context-&gt;<a class="code" href="structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a>) {
<a name="l00127"></a>00127       <a class="code" href="sha1_8c.html#a70796b1d75e73547b19bb9d3f8c1d83a" title="Pad message to be 512 bits.">SHA1PadMessage</a>(context);
<a name="l00128"></a>00128       <span class="keywordflow">for</span> (i = 0; i &lt; 64; ++i) {
<a name="l00129"></a>00129          <span class="comment">/* message may be sensitive, clear it out */</span>
<a name="l00130"></a>00130          context-&gt;<a class="code" href="structSHA1Context.html#a33d55b1ff652119922a5edbcba624e57">Message_Block</a>[i] = 0;
<a name="l00131"></a>00131       }
<a name="l00132"></a>00132       context-&gt;<a class="code" href="structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> = 0;    <span class="comment">/* and clear length */</span>
<a name="l00133"></a>00133       context-&gt;<a class="code" href="structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> = 0;
<a name="l00134"></a>00134       context-&gt;<a class="code" href="structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a> = 1;
<a name="l00135"></a>00135    }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="sha1_8h.html#affb0e361992e82550da290d8dccc6c52">SHA1HashSize</a>; ++i) {
<a name="l00138"></a>00138       Message_Digest[i] = context-&gt;<a class="code" href="structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[i &gt;&gt; 2] &gt;&gt; 8 * ( 3 - ( i &amp; 0x03 ) );
<a name="l00139"></a>00139    }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141    <span class="keywordflow">return</span> <a class="code" href="sha1_8h.html#a1e8054db89feba236b2235d16d0bd1ada581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;
<a name="l00142"></a>00142 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:23:30 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
