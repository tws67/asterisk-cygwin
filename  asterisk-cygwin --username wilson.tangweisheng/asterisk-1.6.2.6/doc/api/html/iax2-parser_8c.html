<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:22:11 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_0ca6ff3bf6b340411b2c6edd15b1a34d.html">channels</a>
  </div>
</div>
<div class="contents">
<h1>iax2-parser.c File Reference</h1>
<p>Implementation of Inter-Asterisk eXchange Protocol, v 2.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;netinet/in.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="frame_8h_source.html">asterisk/frame.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="unaligned_8h_source.html">asterisk/unaligned.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="config_8h_source.html">asterisk/config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadstorage_8h_source.html">asterisk/threadstorage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iax2_8h_source.html">iax2.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iax2-parser_8h_source.html">iax2-parser.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iax2-provision_8h_source.html">iax2-provision.h</a>&quot;</code><br/>

<p><a href="iax2-parser_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiax2__ie.html">iax2_ie</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structiax__frames.html">iax_frames</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a5323507292adb03f4b5b83a23460d9d6">FRAME_CACHE_MAX_SIZE</a>&nbsp;&nbsp;&nbsp;20</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#aebe7173ae49f76df898d14281c9d9329">AST_LIST_HEAD_NOLOCK</a> (iax_frame_list, <a class="el" href="structiax__frame.html">iax_frame</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is just so <a class="el" href="structiax__frames.html">iax_frames</a>, a list head struct for holding a list of <a class="el" href="structiax__frame.html">iax_frame</a> structures, is defined.  <a href="#aebe7173ae49f76df898d14281c9d9329"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a15443140cf0a7b97e5f749e3bf05b26f">AST_THREADSTORAGE_CUSTOM</a> (<a class="el" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>, NULL, frame_cache_cleanup)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A per-thread cache of <a class="el" href="structiax__frame.html">iax_frame</a> structures.  <a href="#a15443140cf0a7b97e5f749e3bf05b26f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ad9f329a41c223e1d504beec76af9a52a">dump_addr</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ab365060e9ec943b9e45df526eaf3ac99">dump_byte</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a87925227b23f8f17d6b04a2783520fb0">dump_datetime</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a574433590c08bd9b8eb0646cba35c731">dump_ies</a> (unsigned char *iedata, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a05a9372c1f98ba2161cbf1233429b135">dump_int</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a6977b70e3aee361a7ce63e381b6e6360">dump_ipaddr</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#af6086f0897aa6f5a7a4f0a33aca73a1a">dump_prefs</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a37cfef2e320cb46d53831d56fe669eeb">dump_prov</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ac07305c59dae2ed46859dc8e7c5765c2">dump_prov_flags</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#aadd7ab6671105489bffde1904386207c">dump_prov_ies</a> (char *output, int maxlen, unsigned char *iedata, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a1aecd8fd437157d487c0bc13dc2f3b00">dump_samprate</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a42708db312208d7cd0e3a870e7ab432f">dump_short</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a8ad3d361daa621230b02bc8518a38db3">dump_string</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ace90933aaed2321d073928bfad8a14a3">dump_string_hex</a> (char *output, int maxlen, void *value, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ae0047382e2ea1dac90f6f8c8dcd2bfb8">frame_cache_cleanup</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a56f011ba4b698f0c5a98920de44926eb">iax_frame_free</a> (struct <a class="el" href="structiax__frame.html">iax_frame</a> *fr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structiax__frame.html">iax_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a99aa3f5f21d75970ba8d9f4700d03d38">iax_frame_new</a> (int direction, int datalen, unsigned int cacheable)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a28158f904f6769628409254d45a266a1">iax_frame_subclass2str</a> (enum <a class="el" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466eff">iax_frame_subclass</a> subclass, char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, size_t len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ac7172830d863702f96f81d8a09612428">iax_frame_wrap</a> (struct <a class="el" href="structiax__frame.html">iax_frame</a> *fr, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#af455cee6f84e3172efd275baa2f42181">iax_get_frames</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a0718dbbbf3999ce541b0bb41b8668186">iax_get_iframes</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#abb3748c6e76b50fb32c55e70a12cd056">iax_get_oframes</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a721c7ff90c2590abc60ef8057a2c8fd5">iax_ie2str</a> (int ie)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a8cac52b8ffe1019fe3dbd5bb605994d1">iax_ie_append</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a3f0c77bd0c7403e0ca0340006e1260d7">iax_ie_append_addr</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie, const struct sockaddr_in *sin)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a4543258d0eaca83fe806bfae857f65d8">iax_ie_append_byte</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie, unsigned char dat)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#aa67b90e85b844cfc53a539813aca05ca">iax_ie_append_int</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie, unsigned int value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie, const void *data, int datalen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ad08e1debfa7325dfa3f22a8cc09f4945">iax_ie_append_short</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie, unsigned short value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#ad94f0fdb4e50d38876577242d132709f">iax_ie_append_str</a> (struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *ied, unsigned char ie, const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a008130bffa0c54d95782e1bb14bb24fd">iax_parse_ies</a> (struct <a class="el" href="structiax__ies.html">iax_ies</a> *ies, unsigned char *data, int datalen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a6b6a249db189867d6e8c66f88c035097">iax_set_error</a> (void(*func)(const char *))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a7dfa14e449512cc3937a0d8dd596aee5">iax_set_output</a> (void(*func)(const char *))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a2865d35dffad22a73ab8f0ef67db8b99">iax_showframe</a> (struct <a class="el" href="structiax__frame.html">iax_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>, struct <a class="el" href="structast__iax2__full__hdr.html">ast_iax2_full_hdr</a> *fhi, int rx, struct sockaddr_in *sin, int datalen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#aa2f9a933ed930ced2a59dfe7ffd00537">internalerror</a> (const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#adc5133b4c0d70e8f71d2d1f8d121b864">internaloutput</a> (const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a> )(const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) = internalerror</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a4a94e1f2fcd545095095ed8773a7a31a">iframes</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structiax2__ie.html">iax2_ie</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a785b37b3e12c475bfe912f87ca09e236">oframes</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a> )(const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) = internaloutput</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structiax2__ie.html">iax2_ie</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Implementation of Inter-Asterisk eXchange Protocol, v 2. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Mark Spencer &lt;<a href="mailto:markster@digium.com">markster@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a5323507292adb03f4b5b83a23460d9d6"></a><!-- doxytag: member="iax2&#45;parser.c::FRAME_CACHE_MAX_SIZE" ref="a5323507292adb03f4b5b83a23460d9d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAME_CACHE_MAX_SIZE&nbsp;&nbsp;&nbsp;20</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00064">64</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>Referenced by <a class="el" href="frame_8c_source.html#l00333">__frame_free()</a>, <a class="el" href="iax2-parser_8c_source.html#l01168">iax_frame_free()</a>, and <a class="el" href="iax2-parser_8c_source.html#l01110">iax_frame_new()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aebe7173ae49f76df898d14281c9d9329"></a><!-- doxytag: member="iax2&#45;parser.c::AST_LIST_HEAD_NOLOCK" ref="aebe7173ae49f76df898d14281c9d9329" args="(iax_frame_list, iax_frame)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_LIST_HEAD_NOLOCK </td>
          <td>(</td>
          <td class="paramtype">iax_frame_list&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structiax__frame.html">iax_frame</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is just so <a class="el" href="structiax__frames.html">iax_frames</a>, a list head struct for holding a list of <a class="el" href="structiax__frame.html">iax_frame</a> structures, is defined. </p>

</div>
</div>
<a class="anchor" id="a15443140cf0a7b97e5f749e3bf05b26f"></a><!-- doxytag: member="iax2&#45;parser.c::AST_THREADSTORAGE_CUSTOM" ref="a15443140cf0a7b97e5f749e3bf05b26f" args="(frame_cache, NULL, frame_cache_cleanup)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_THREADSTORAGE_CUSTOM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NULL&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">frame_cache_cleanup&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A per-thread cache of <a class="el" href="structiax__frame.html">iax_frame</a> structures. </p>

</div>
</div>
<a class="anchor" id="ad9f329a41c223e1d504beec76af9a52a"></a><!-- doxytag: member="iax2&#45;parser.c::dump_addr" ref="ad9f329a41c223e1d504beec76af9a52a" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_addr </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00080">80</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="utils_8c_source.html#l00431">ast_inet_ntoa()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081 {
<a name="l00082"></a>00082    <span class="keyword">struct </span>sockaddr_in sin;
<a name="l00083"></a>00083    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(sin)) {
<a name="l00084"></a>00084       memcpy(&amp;sin, value, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l00085"></a>00085       snprintf(output, maxlen, <span class="stringliteral">&quot;IPV4 %s:%d&quot;</span>, <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(sin.sin_addr), ntohs(sin.sin_port));
<a name="l00086"></a>00086    } <span class="keywordflow">else</span> {
<a name="l00087"></a>00087       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid Address&quot;</span>, maxlen);
<a name="l00088"></a>00088    }
<a name="l00089"></a>00089 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab365060e9ec943b9e45df526eaf3ac99"></a><!-- doxytag: member="iax2&#45;parser.c::dump_byte" ref="ab365060e9ec943b9e45df526eaf3ac99" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_byte </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00145">145</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00146"></a>00146 {
<a name="l00147"></a>00147    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>))
<a name="l00148"></a>00148       snprintf(output, maxlen, <span class="stringliteral">&quot;%d&quot;</span>, *((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)value));
<a name="l00149"></a>00149    <span class="keywordflow">else</span>
<a name="l00150"></a>00150       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid BYTE&quot;</span>, maxlen);
<a name="l00151"></a>00151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a87925227b23f8f17d6b04a2783520fb0"></a><!-- doxytag: member="iax2&#45;parser.c::dump_datetime" ref="a87925227b23f8f17d6b04a2783520fb0" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_datetime </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00153">153</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="localtime_8c_source.html#l01928">ast_strftime()</a>, <a class="el" href="unaligned_8h_source.html#l00032">get_unaligned_uint32()</a>, <a class="el" href="localtime_8h_source.html#l00030">ast_tm::tm_hour</a>, <a class="el" href="localtime_8h_source.html#l00031">ast_tm::tm_mday</a>, <a class="el" href="localtime_8h_source.html#l00029">ast_tm::tm_min</a>, <a class="el" href="localtime_8h_source.html#l00032">ast_tm::tm_mon</a>, <a class="el" href="localtime_8h_source.html#l00028">ast_tm::tm_sec</a>, and <a class="el" href="localtime_8h_source.html#l00033">ast_tm::tm_year</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00154"></a>00154 {
<a name="l00155"></a>00155    <span class="keyword">struct </span><a class="code" href="structast__tm.html">ast_tm</a> tm;
<a name="l00156"></a>00156    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structval.html">val</a> = (<span class="keywordtype">unsigned</span> long) ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(value));
<a name="l00157"></a>00157    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int)) {
<a name="l00158"></a>00158       tm.tm_sec  = (val &amp; 0x1f) &lt;&lt; 1;
<a name="l00159"></a>00159       tm.tm_min  = (val &gt;&gt; 5) &amp; 0x3f;
<a name="l00160"></a>00160       tm.tm_hour = (val &gt;&gt; 11) &amp; 0x1f;
<a name="l00161"></a>00161       tm.tm_mday = (val &gt;&gt; 16) &amp; 0x1f;
<a name="l00162"></a>00162       tm.tm_mon  = ((val &gt;&gt; 21) &amp; 0x0f) - 1;
<a name="l00163"></a>00163       tm.tm_year = ((val &gt;&gt; 25) &amp; 0x7f) + 100;
<a name="l00164"></a>00164       <a class="code" href="localtime_8h.html#aa8e63928b14a347bd3973d680b885f93" title="Special version of strftime(3) that handles fractions of a second. Takes the same...">ast_strftime</a>(output, maxlen, <span class="stringliteral">&quot;%Y-%m-%d  %T&quot;</span>, &amp;tm); 
<a name="l00165"></a>00165    } <span class="keywordflow">else</span>
<a name="l00166"></a>00166       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid DATETIME format!&quot;</span>, maxlen);
<a name="l00167"></a>00167 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a574433590c08bd9b8eb0646cba35c731"></a><!-- doxytag: member="iax2&#45;parser.c::dump_ies" ref="a574433590c08bd9b8eb0646cba35c731" args="(unsigned char *iedata, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_ies </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>iedata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00365">365</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="structiax2__ie.html#ae76bfae2e4083b90dd4d9eadb3bad3f4">iax2_ie::dump</a>, <a class="el" href="iax2-parser_8c_source.html#l00224">iax2_ie::ie</a>, <a class="el" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>, <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>, and <a class="el" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>.</p>

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l00543">iax_showframe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00366"></a>00366 {
<a name="l00367"></a>00367    <span class="keywordtype">int</span> ielen;
<a name="l00368"></a>00368    <span class="keywordtype">int</span> ie;
<a name="l00369"></a>00369    <span class="keywordtype">int</span> x;
<a name="l00370"></a>00370    <span class="keywordtype">int</span> found;
<a name="l00371"></a>00371    <span class="keywordtype">char</span> interp[1024];
<a name="l00372"></a>00372    <span class="keywordtype">char</span> tmp[1024];
<a name="l00373"></a>00373    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> &lt; 2)
<a name="l00374"></a>00374       <span class="keywordflow">return</span>;
<a name="l00375"></a>00375    <span class="keywordflow">while</span>(<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> &gt; 2) {
<a name="l00376"></a>00376       ie = iedata[0];
<a name="l00377"></a>00377       ielen = iedata[1];
<a name="l00378"></a>00378       <span class="keywordflow">if</span> (ielen + 2&gt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>) {
<a name="l00379"></a>00379          snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Total IE length of %d bytes exceeds remaining frame length of %d bytes\n&quot;</span>, ielen + 2, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l00380"></a>00380          <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l00381"></a>00381          <span class="keywordflow">return</span>;
<a name="l00382"></a>00382       }
<a name="l00383"></a>00383       found = 0;
<a name="l00384"></a>00384       <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>); x++) {
<a name="l00385"></a>00385          <span class="keywordflow">if</span> (<a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].ie == ie) {
<a name="l00386"></a>00386             <span class="keywordflow">if</span> (<a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].dump) {
<a name="l00387"></a>00387                <a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].<a class="code" href="structiax2__ie.html#ae76bfae2e4083b90dd4d9eadb3bad3f4">dump</a>(interp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(interp), iedata + 2, ielen);
<a name="l00388"></a>00388                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;   %-15.15s : %s\n&quot;</span>, <a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, interp);
<a name="l00389"></a>00389                <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l00390"></a>00390             } <span class="keywordflow">else</span> {
<a name="l00391"></a>00391                <span class="keywordflow">if</span> (ielen)
<a name="l00392"></a>00392                   snprintf(interp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(interp), <span class="stringliteral">&quot;%d bytes&quot;</span>, ielen);
<a name="l00393"></a>00393                <span class="keywordflow">else</span>
<a name="l00394"></a>00394                   strcpy(interp, <span class="stringliteral">&quot;Present&quot;</span>);
<a name="l00395"></a>00395                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;   %-15.15s : %s\n&quot;</span>, <a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, interp);
<a name="l00396"></a>00396                <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l00397"></a>00397             }
<a name="l00398"></a>00398             found++;
<a name="l00399"></a>00399          }
<a name="l00400"></a>00400       }
<a name="l00401"></a>00401       <span class="keywordflow">if</span> (!found) {
<a name="l00402"></a>00402          snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;   Unknown IE %03d  : Present\n&quot;</span>, ie);
<a name="l00403"></a>00403          <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l00404"></a>00404       }
<a name="l00405"></a>00405       iedata += (2 + ielen);
<a name="l00406"></a>00406       <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> -= (2 + ielen);
<a name="l00407"></a>00407    }
<a name="l00408"></a>00408    <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00409"></a>00409 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05a9372c1f98ba2161cbf1233429b135"></a><!-- doxytag: member="iax2&#45;parser.c::dump_int" ref="a05a9372c1f98ba2161cbf1233429b135" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_int </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00129">129</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="unaligned_8h_source.html#l00032">get_unaligned_uint32()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00130"></a>00130 {
<a name="l00131"></a>00131    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>))
<a name="l00132"></a>00132       snprintf(output, maxlen, <span class="stringliteral">&quot;%lu&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(value)));
<a name="l00133"></a>00133    <span class="keywordflow">else</span>
<a name="l00134"></a>00134       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid INT&quot;</span>, maxlen); 
<a name="l00135"></a>00135 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6977b70e3aee361a7ce63e381b6e6360"></a><!-- doxytag: member="iax2&#45;parser.c::dump_ipaddr" ref="a6977b70e3aee361a7ce63e381b6e6360" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_ipaddr </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00169">169</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="utils_8c_source.html#l00431">ast_inet_ntoa()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00170"></a>00170 {
<a name="l00171"></a>00171    <span class="keyword">struct </span>sockaddr_in sin;
<a name="l00172"></a>00172    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00173"></a>00173       memcpy(&amp;sin.sin_addr, value, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l00174"></a>00174       snprintf(output, maxlen, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(sin.sin_addr));
<a name="l00175"></a>00175    } <span class="keywordflow">else</span>
<a name="l00176"></a>00176       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid IPADDR&quot;</span>, maxlen);
<a name="l00177"></a>00177 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af6086f0897aa6f5a7a4f0a33aca73a1a"></a><!-- doxytag: member="iax2&#45;parser.c::dump_prefs" ref="af6086f0897aa6f5a7a4f0a33aca73a1a" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_prefs </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00110">110</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="frame_8c_source.html#l00974">ast_codec_pref_convert()</a>, and <a class="el" href="frame_8c_source.html#l00997">ast_codec_pref_string()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00111"></a>00111 {
<a name="l00112"></a>00112    <span class="keyword">struct </span><a class="code" href="structast__codec__pref.html">ast_codec_pref</a> pref;
<a name="l00113"></a>00113    <span class="keywordtype">int</span> total_len = 0;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115    maxlen--;
<a name="l00116"></a>00116    total_len = maxlen;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118    <span class="keywordflow">if</span> (maxlen &gt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)
<a name="l00119"></a>00119       maxlen = <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121    strncpy(output, value, maxlen);
<a name="l00122"></a>00122    output[maxlen] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00123"></a>00123    
<a name="l00124"></a>00124    <a class="code" href="frame_8h.html#a42cc334b6773ff33cb3c24ca5a916842" title="Shift an audio codec preference list up or down 65 bytes so that it becomes an ASCII...">ast_codec_pref_convert</a>(&amp;pref, output, total_len, 0);
<a name="l00125"></a>00125    memset(output,0,total_len);
<a name="l00126"></a>00126    <a class="code" href="frame_8h.html#a784e4f7371cbfce0b3e9f957f7ce54e3" title="Dump audio codec preference list into a string.">ast_codec_pref_string</a>(&amp;pref, output, total_len);
<a name="l00127"></a>00127 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37cfef2e320cb46d53831d56fe669eeb"></a><!-- doxytag: member="iax2&#45;parser.c::dump_prov" ref="a37cfef2e320cb46d53831d56fe669eeb" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_prov </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00218">218</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00313">dump_prov_ies()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00219"></a>00219 {
<a name="l00220"></a>00220    <a class="code" href="iax2-parser_8c.html#aadd7ab6671105489bffde1904386207c">dump_prov_ies</a>(output, maxlen, value, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l00221"></a>00221 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac07305c59dae2ed46859dc8e7c5765c2"></a><!-- doxytag: member="iax2&#45;parser.c::dump_prov_flags" ref="ac07305c59dae2ed46859dc8e7c5765c2" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_prov_flags </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00180">180</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, <a class="el" href="unaligned_8h_source.html#l00032">get_unaligned_uint32()</a>, and <a class="el" href="iax2-provision_8c_source.html#l00085">iax_provflags2str()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00181"></a>00181 {
<a name="l00182"></a>00182    <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[256] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00183"></a>00183    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>))
<a name="l00184"></a>00184       snprintf(output, maxlen, <span class="stringliteral">&quot;%lu (%s)&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(value)),
<a name="l00185"></a>00185          <a class="code" href="iax2-provision_8c.html#a6ac38b0d78b4ca300da3815c64e158be">iax_provflags2str</a>(buf, <span class="keyword">sizeof</span>(buf), ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(value))));
<a name="l00186"></a>00186    <span class="keywordflow">else</span>
<a name="l00187"></a>00187       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid INT&quot;</span>, maxlen);
<a name="l00188"></a>00188 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aadd7ab6671105489bffde1904386207c"></a><!-- doxytag: member="iax2&#45;parser.c::dump_prov_ies" ref="aadd7ab6671105489bffde1904386207c" args="(char *output, int maxlen, unsigned char *iedata, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_prov_ies </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>iedata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00313">313</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="structiax2__ie.html#ae76bfae2e4083b90dd4d9eadb3bad3f4">iax2_ie::dump</a>, <a class="el" href="iax2-parser_8c_source.html#l00224">iax2_ie::ie</a>, and <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>.</p>

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l00218">dump_prov()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00314"></a>00314 {
<a name="l00315"></a>00315    <span class="keywordtype">int</span> ielen;
<a name="l00316"></a>00316    <span class="keywordtype">int</span> ie;
<a name="l00317"></a>00317    <span class="keywordtype">int</span> x;
<a name="l00318"></a>00318    <span class="keywordtype">int</span> found;
<a name="l00319"></a>00319    <span class="keywordtype">char</span> interp[80];
<a name="l00320"></a>00320    <span class="keywordtype">char</span> tmp[256];
<a name="l00321"></a>00321    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> &lt; 2)
<a name="l00322"></a>00322       <span class="keywordflow">return</span>;
<a name="l00323"></a>00323    strcpy(output, <span class="stringliteral">&quot;\n&quot;</span>); 
<a name="l00324"></a>00324    maxlen -= strlen(output); output += strlen(output);
<a name="l00325"></a>00325    <span class="keywordflow">while</span>(<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> &gt; 2) {
<a name="l00326"></a>00326       ie = iedata[0];
<a name="l00327"></a>00327       ielen = iedata[1];
<a name="l00328"></a>00328       <span class="keywordflow">if</span> (ielen + 2&gt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>) {
<a name="l00329"></a>00329          snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Total Prov IE length of %d bytes exceeds remaining prov frame length of %d bytes\n&quot;</span>, ielen + 2, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l00330"></a>00330          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, tmp, maxlen);
<a name="l00331"></a>00331          maxlen -= strlen(output);
<a name="l00332"></a>00332          output += strlen(output);
<a name="l00333"></a>00333          <span class="keywordflow">return</span>;
<a name="l00334"></a>00334       }
<a name="l00335"></a>00335       found = 0;
<a name="l00336"></a>00336       <span class="keywordflow">for</span> (x=0;x&lt;(int)<span class="keyword">sizeof</span>(<a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>) / (int)<span class="keyword">sizeof</span>(<a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[0]); x++) {
<a name="l00337"></a>00337          <span class="keywordflow">if</span> (<a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[x].ie == ie) {
<a name="l00338"></a>00338             <span class="keywordflow">if</span> (<a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[x].dump) {
<a name="l00339"></a>00339                <a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[x].<a class="code" href="structiax2__ie.html#ae76bfae2e4083b90dd4d9eadb3bad3f4">dump</a>(interp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(interp), iedata + 2, ielen);
<a name="l00340"></a>00340                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;       %-15.15s : %s\n&quot;</span>, <a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[x].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, interp);
<a name="l00341"></a>00341                <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, tmp, maxlen);
<a name="l00342"></a>00342                maxlen -= strlen(output); output += strlen(output);
<a name="l00343"></a>00343             } <span class="keywordflow">else</span> {
<a name="l00344"></a>00344                <span class="keywordflow">if</span> (ielen)
<a name="l00345"></a>00345                   snprintf(interp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(interp), <span class="stringliteral">&quot;%d bytes&quot;</span>, ielen);
<a name="l00346"></a>00346                <span class="keywordflow">else</span>
<a name="l00347"></a>00347                   strcpy(interp, <span class="stringliteral">&quot;Present&quot;</span>);
<a name="l00348"></a>00348                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;       %-15.15s : %s\n&quot;</span>, <a class="code" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[x].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, interp);
<a name="l00349"></a>00349                <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, tmp, maxlen);
<a name="l00350"></a>00350                maxlen -= strlen(output); output += strlen(output);
<a name="l00351"></a>00351             }
<a name="l00352"></a>00352             found++;
<a name="l00353"></a>00353          }
<a name="l00354"></a>00354       }
<a name="l00355"></a>00355       <span class="keywordflow">if</span> (!found) {
<a name="l00356"></a>00356          snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;       Unknown Prov IE %03d  : Present\n&quot;</span>, ie);
<a name="l00357"></a>00357          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, tmp, maxlen);
<a name="l00358"></a>00358          maxlen -= strlen(output); output += strlen(output);
<a name="l00359"></a>00359       }
<a name="l00360"></a>00360       iedata += (2 + ielen);
<a name="l00361"></a>00361       <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> -= (2 + ielen);
<a name="l00362"></a>00362    }
<a name="l00363"></a>00363 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1aecd8fd437157d487c0bc13dc2f3b00"></a><!-- doxytag: member="iax2&#45;parser.c::dump_samprate" ref="a1aecd8fd437157d487c0bc13dc2f3b00" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_samprate </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00190">190</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="iax2_8h_source.html#l00202">IAX_RATE_11KHZ</a>, <a class="el" href="iax2_8h_source.html#l00203">IAX_RATE_16KHZ</a>, <a class="el" href="iax2_8h_source.html#l00204">IAX_RATE_22KHZ</a>, <a class="el" href="iax2_8h_source.html#l00205">IAX_RATE_44KHZ</a>, <a class="el" href="iax2_8h_source.html#l00206">IAX_RATE_48KHZ</a>, and <a class="el" href="iax2_8h_source.html#l00201">IAX_RATE_8KHZ</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00191"></a>00191 {
<a name="l00192"></a>00192    <span class="keywordtype">char</span> tmp[256]=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00193"></a>00193    <span class="keywordtype">int</span> sr;
<a name="l00194"></a>00194    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00195"></a>00195       sr = ntohs(*((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)value));
<a name="l00196"></a>00196       <span class="keywordflow">if</span> (sr &amp; <a class="code" href="iax2_8h.html#a54798572f4746ab5197989cd44d6e16d">IAX_RATE_8KHZ</a>)
<a name="l00197"></a>00197          strcat(tmp, <span class="stringliteral">&quot;,8khz&quot;</span>);
<a name="l00198"></a>00198       <span class="keywordflow">if</span> (sr &amp; <a class="code" href="iax2_8h.html#a3716adeeb6f3c5437bf6a961c9990e7b">IAX_RATE_11KHZ</a>)
<a name="l00199"></a>00199          strcat(tmp, <span class="stringliteral">&quot;,11.025khz&quot;</span>);
<a name="l00200"></a>00200       <span class="keywordflow">if</span> (sr &amp; <a class="code" href="iax2_8h.html#a9af15ce90688d741d6f43e6c901848f1">IAX_RATE_16KHZ</a>)
<a name="l00201"></a>00201          strcat(tmp, <span class="stringliteral">&quot;,16khz&quot;</span>);
<a name="l00202"></a>00202       <span class="keywordflow">if</span> (sr &amp; <a class="code" href="iax2_8h.html#afcc6b2622276f54bd8d61ab85effe164">IAX_RATE_22KHZ</a>)
<a name="l00203"></a>00203          strcat(tmp, <span class="stringliteral">&quot;,22.05khz&quot;</span>);
<a name="l00204"></a>00204       <span class="keywordflow">if</span> (sr &amp; <a class="code" href="iax2_8h.html#ac78f8ccb015b0bf9bf6976e9734da252">IAX_RATE_44KHZ</a>)
<a name="l00205"></a>00205          strcat(tmp, <span class="stringliteral">&quot;,44.1khz&quot;</span>);
<a name="l00206"></a>00206       <span class="keywordflow">if</span> (sr &amp; <a class="code" href="iax2_8h.html#a28e06ca44f2ffb539517c4cfd3bd3531">IAX_RATE_48KHZ</a>)
<a name="l00207"></a>00207          strcat(tmp, <span class="stringliteral">&quot;,48khz&quot;</span>);
<a name="l00208"></a>00208       <span class="keywordflow">if</span> (strlen(tmp))
<a name="l00209"></a>00209          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, &amp;tmp[1], maxlen);
<a name="l00210"></a>00210       <span class="keywordflow">else</span>
<a name="l00211"></a>00211          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;None Specified!\n&quot;</span>, maxlen);
<a name="l00212"></a>00212    } <span class="keywordflow">else</span>
<a name="l00213"></a>00213       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid SHORT&quot;</span>, maxlen);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a42708db312208d7cd0e3a870e7ab432f"></a><!-- doxytag: member="iax2&#45;parser.c::dump_short" ref="a42708db312208d7cd0e3a870e7ab432f" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_short </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00137">137</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="unaligned_8h_source.html#l00038">get_unaligned_uint16()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00138"></a>00138 {
<a name="l00139"></a>00139    <span class="keywordflow">if</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> == (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>))
<a name="l00140"></a>00140       snprintf(output, maxlen, <span class="stringliteral">&quot;%d&quot;</span>, ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(value)));
<a name="l00141"></a>00141    <span class="keywordflow">else</span>
<a name="l00142"></a>00142       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(output, <span class="stringliteral">&quot;Invalid SHORT&quot;</span>, maxlen);
<a name="l00143"></a>00143 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8ad3d361daa621230b02bc8518a38db3"></a><!-- doxytag: member="iax2&#45;parser.c::dump_string" ref="a8ad3d361daa621230b02bc8518a38db3" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_string </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00101">101</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00102"></a>00102 {
<a name="l00103"></a>00103    maxlen--;
<a name="l00104"></a>00104    <span class="keywordflow">if</span> (maxlen &gt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)
<a name="l00105"></a>00105       maxlen = <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;
<a name="l00106"></a>00106    strncpy(output, value, maxlen);
<a name="l00107"></a>00107    output[maxlen] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00108"></a>00108 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ace90933aaed2321d073928bfad8a14a3"></a><!-- doxytag: member="iax2&#45;parser.c::dump_string_hex" ref="ace90933aaed2321d073928bfad8a14a3" args="(char *output, int maxlen, void *value, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dump_string_hex </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00091">91</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00092"></a>00092 {
<a name="l00093"></a>00093    <span class="keywordtype">int</span> i = 0;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095    <span class="keywordflow">while</span> (<a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>-- &amp;&amp; (i + 1) * 4 &lt; maxlen) {
<a name="l00096"></a>00096       sprintf(output + (4 * i), <span class="stringliteral">&quot;\\x%2.2x&quot;</span>, *((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)value + i));
<a name="l00097"></a>00097       i++;
<a name="l00098"></a>00098    }
<a name="l00099"></a>00099 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae0047382e2ea1dac90f6f8c8dcd2bfb8"></a><!-- doxytag: member="iax2&#45;parser.c::frame_cache_cleanup" ref="ae0047382e2ea1dac90f6f8c8dcd2bfb8" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void frame_cache_cleanup </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01208">1208</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, and <a class="el" href="iax2-parser_8c_source.html#l00060">iax_frames::list</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01209"></a>01209 {
<a name="l01210"></a>01210    <span class="keyword">struct </span><a class="code" href="structiax__frames.html">iax_frames</a> *framelist = data;
<a name="l01211"></a>01211    <span class="keyword">struct </span><a class="code" href="structiax__frame.html">iax_frame</a> *current;
<a name="l01212"></a>01212 
<a name="l01213"></a>01213    <span class="keywordflow">while</span> ((current = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;framelist-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>, list)))
<a name="l01214"></a>01214       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(current);
<a name="l01215"></a>01215 
<a name="l01216"></a>01216    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(framelist);
<a name="l01217"></a>01217 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56f011ba4b698f0c5a98920de44926eb"></a><!-- doxytag: member="iax2&#45;parser.c::iax_frame_free" ref="a56f011ba4b698f0c5a98920de44926eb" args="(struct iax_frame *fr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax_frame_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__frame.html">iax_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>fr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01168">1168</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8h_source.html#l00140">iax_frame::afdatalen</a>, <a class="el" href="lock_8h_source.html#l01964">ast_atomic_fetchadd_int()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00420">AST_LIST_FIRST</a>, <a class="el" href="linkedlists_8h_source.html#l00695">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="iax2-parser_8h_source.html#l00120">iax_frame::cacheable</a>, <a class="el" href="iax2-parser_8h_source.html#l00118">iax_frame::direction</a>, <a class="el" href="iax2-parser_8h_source.html#l00084">DIRECTION_INGRESS</a>, <a class="el" href="iax2-parser_8h_source.html#l00085">DIRECTION_OUTGRESS</a>, <a class="el" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>, <a class="el" href="frame_8c_source.html#l00047">frame_cache</a>, <a class="el" href="iax2-parser_8c_source.html#l00064">FRAME_CACHE_MAX_SIZE</a>, <a class="el" href="iax2-parser_8c_source.html#l00060">iax_frames::list</a>, and <a class="el" href="iax2-parser_8c_source.html#l00061">iax_frames::size</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l01650">iax2_frame_free()</a>, and <a class="el" href="chan__iax2_8c_source.html#l11640">network_thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01169"></a>01169 {
<a name="l01170"></a>01170 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l01171"></a>01171 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structiax__frames.html">iax_frames</a> *<a class="code" href="structiax__frames.html">iax_frames</a> = NULL;
<a name="l01172"></a>01172 <span class="preprocessor">#endif</span>
<a name="l01173"></a>01173 <span class="preprocessor"></span>
<a name="l01174"></a>01174    <span class="comment">/* Note: does not remove from scheduler! */</span>
<a name="l01175"></a>01175    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structiax__frame.html#ac7e977c3f00d50b1cd332813fa428b4d">direction</a> == <a class="code" href="iax2-parser_8h.html#ac0a2881003b5f94b330a60f36367ee57">DIRECTION_INGRESS</a>)
<a name="l01176"></a>01176       <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="iax2-parser_8c.html#a4a94e1f2fcd545095095ed8773a7a31a">iframes</a>, -1);
<a name="l01177"></a>01177    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structiax__frame.html#ac7e977c3f00d50b1cd332813fa428b4d">direction</a> == <a class="code" href="iax2-parser_8h.html#a1de532894b7fc3607e6f16281fbfc07f">DIRECTION_OUTGRESS</a>)
<a name="l01178"></a>01178       <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="iax2-parser_8c.html#a785b37b3e12c475bfe912f87ca09e236">oframes</a>, -1);
<a name="l01179"></a>01179    <span class="keywordflow">else</span> {
<a name="l01180"></a>01180       <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(<span class="stringliteral">&quot;Attempt to double free frame detected\n&quot;</span>);
<a name="l01181"></a>01181       <span class="keywordflow">return</span>;
<a name="l01182"></a>01182    }
<a name="l01183"></a>01183    <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a>, -1);
<a name="l01184"></a>01184 
<a name="l01185"></a>01185 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l01186"></a>01186 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (!fr-&gt;<a class="code" href="structiax__frame.html#af80030526d3bbc6bf90c9ab6cdcdba59">cacheable</a> || !(iax_frames = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;<a class="code" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>, <span class="keyword">sizeof</span>(*iax_frames)))) {
<a name="l01187"></a>01187       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fr);
<a name="l01188"></a>01188       <span class="keywordflow">return</span>;
<a name="l01189"></a>01189    }
<a name="l01190"></a>01190 
<a name="l01191"></a>01191    <span class="keywordflow">if</span> (iax_frames-&gt;<a class="code" href="structiax__frames.html#a854352f53b148adc24983a58a1866d66">size</a> &lt; <a class="code" href="iax2-parser_8c.html#a5323507292adb03f4b5b83a23460d9d6">FRAME_CACHE_MAX_SIZE</a>) {
<a name="l01192"></a>01192       fr-&gt;<a class="code" href="structiax__frame.html#ac7e977c3f00d50b1cd332813fa428b4d">direction</a> = 0;
<a name="l01193"></a>01193       <span class="comment">/* Pseudo-sort: keep smaller frames at the top of the list. This should</span>
<a name="l01194"></a>01194 <span class="comment">       * increase the chance that we pick the smallest applicable frame for use. */</span>
<a name="l01195"></a>01195       <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5" title="Returns the first entry contained in a list.">AST_LIST_FIRST</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>) &amp;&amp; <a class="code" href="linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5" title="Returns the first entry contained in a list.">AST_LIST_FIRST</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>)-&gt;afdatalen &lt; fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a>) {
<a name="l01196"></a>01196          <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>, fr, <a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>);
<a name="l01197"></a>01197       } <span class="keywordflow">else</span> {
<a name="l01198"></a>01198          <a class="code" href="linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307" title="Inserts a list entry at the head of a list.">AST_LIST_INSERT_HEAD</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>, fr, <a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>);
<a name="l01199"></a>01199       }
<a name="l01200"></a>01200       iax_frames-&gt;<a class="code" href="structiax__frames.html#a854352f53b148adc24983a58a1866d66">size</a>++;
<a name="l01201"></a>01201       <span class="keywordflow">return</span>;
<a name="l01202"></a>01202    }
<a name="l01203"></a>01203 <span class="preprocessor">#endif</span>
<a name="l01204"></a>01204 <span class="preprocessor"></span>   <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fr);
<a name="l01205"></a>01205 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a99aa3f5f21d75970ba8d9f4700d03d38"></a><!-- doxytag: member="iax2&#45;parser.c::iax_frame_new" ref="a99aa3f5f21d75970ba8d9f4700d03d38" args="(int direction, int datalen, unsigned int cacheable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structiax__frame.html">iax_frame</a>* iax_frame_new </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>datalen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>cacheable</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01110">1110</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8h_source.html#l00140">iax_frame::afdatalen</a>, <a class="el" href="lock_8h_source.html#l01964">ast_atomic_fetchadd_int()</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="astmm_8h_source.html#l00075">ast_calloc_cache</a>, <a class="el" href="linkedlists_8h_source.html#l00420">AST_LIST_FIRST</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00838">AST_LIST_REMOVE</a>, <a class="el" href="linkedlists_8h_source.html#l00553">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00599">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="astmm_8h_source.html#l00093">ast_realloc</a>, <a class="el" href="threadstorage_8h_source.html#l00191">ast_threadstorage_get()</a>, <a class="el" href="iax2-parser_8h_source.html#l00120">iax_frame::cacheable</a>, <a class="el" href="iax2-parser_8h_source.html#l00118">iax_frame::direction</a>, <a class="el" href="iax2-parser_8h_source.html#l00084">DIRECTION_INGRESS</a>, <a class="el" href="frame_8c_source.html#l00047">frame_cache</a>, <a class="el" href="iax2-parser_8c_source.html#l00064">FRAME_CACHE_MAX_SIZE</a>, <a class="el" href="iax2-parser_8c_source.html#l00060">iax_frames::list</a>, <a class="el" href="iax2-parser_8h_source.html#l00126">iax_frame::retrans</a>, and <a class="el" href="iax2-parser_8c_source.html#l00061">iax_frames::size</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l06045">iax2_send()</a>, and <a class="el" href="chan__iax2_8c_source.html#l01805">iaxfrdup2()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01111"></a>01111 {
<a name="l01112"></a>01112    <span class="keyword">struct </span><a class="code" href="structiax__frame.html">iax_frame</a> *fr = NULL;
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l01115"></a>01115 <span class="preprocessor"></span>   <span class="keyword">struct </span><a class="code" href="structiax__frames.html">iax_frames</a> *<a class="code" href="structiax__frames.html">iax_frames</a> = NULL;
<a name="l01116"></a>01116    <span class="keyword">struct </span><a class="code" href="structiax__frame.html">iax_frame</a> *smallest = NULL;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118    <span class="comment">/* Attempt to get a frame from this thread&apos;s cache */</span>
<a name="l01119"></a>01119    <span class="keywordflow">if</span> ((iax_frames = <a class="code" href="threadstorage_8h.html#a9153839e218c987b2ae47cbd39ac1ab5" title="Retrieve thread storage.">ast_threadstorage_get</a>(&amp;<a class="code" href="frame_8c.html#a0aa5ff72fc86609f2fe7385e7747b52e">frame_cache</a>, <span class="keyword">sizeof</span>(*iax_frames)))) {
<a name="l01120"></a>01120       smallest = <a class="code" href="linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5" title="Returns the first entry contained in a list.">AST_LIST_FIRST</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>);
<a name="l01121"></a>01121       <a class="code" href="linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d" title="Loops safely over (traverses) the entries in a list.">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>, fr, list) {
<a name="l01122"></a>01122          <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a> &gt;= <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>) {
<a name="l01123"></a>01123             <span class="keywordtype">size_t</span> <a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a> = fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a>;
<a name="l01124"></a>01124             <a class="code" href="linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c" title="Removes the current entry from a list during a traversal.">AST_LIST_REMOVE_CURRENT</a>(list);
<a name="l01125"></a>01125             iax_frames-&gt;<a class="code" href="structiax__frames.html#a854352f53b148adc24983a58a1866d66">size</a>--;
<a name="l01126"></a>01126             memset(fr, 0, <span class="keyword">sizeof</span>(*fr));
<a name="l01127"></a>01127             fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a> = afdatalen;
<a name="l01128"></a>01128             <span class="keywordflow">break</span>;
<a name="l01129"></a>01129          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (smallest-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a> &gt; fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a>) {
<a name="l01130"></a>01130             smallest = fr;
<a name="l01131"></a>01131          }
<a name="l01132"></a>01132       }
<a name="l01133"></a>01133       <a class="code" href="linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9" title="Closes a safe loop traversal block.">AST_LIST_TRAVERSE_SAFE_END</a>;
<a name="l01134"></a>01134    }
<a name="l01135"></a>01135    <span class="keywordflow">if</span> (!fr) {
<a name="l01136"></a>01136       <span class="keywordflow">if</span> (iax_frames-&gt;<a class="code" href="structiax__frames.html#a854352f53b148adc24983a58a1866d66">size</a> &gt;= <a class="code" href="iax2-parser_8c.html#a5323507292adb03f4b5b83a23460d9d6">FRAME_CACHE_MAX_SIZE</a> &amp;&amp; smallest) {
<a name="l01137"></a>01137          <span class="comment">/* Make useless cache into something more useful */</span>
<a name="l01138"></a>01138          <a class="code" href="linkedlists_8h.html#aa36e72b77f1b80881cd0a9fcca66ce19" title="Removes a specific entry from a list.">AST_LIST_REMOVE</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>, smallest, list);
<a name="l01139"></a>01139          <span class="keywordflow">if</span> (!(fr = <a class="code" href="astmm_8h.html#aa852314efa0cfeecee97ffc51b649734">ast_realloc</a>(smallest, <span class="keyword">sizeof</span>(*fr) + <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>))) {
<a name="l01140"></a>01140             <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;iax_frames-&gt;<a class="code" href="structiax__frames.html#a8039d4739e7d0cf81eabf62e41a3a971">list</a>, smallest, list);
<a name="l01141"></a>01141             <span class="keywordflow">return</span> NULL;
<a name="l01142"></a>01142          }
<a name="l01143"></a>01143       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(fr = <a class="code" href="astmm_8h.html#a690471dda49603174e7dd93a29fea87a">ast_calloc_cache</a>(1, <span class="keyword">sizeof</span>(*fr) + <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>)))
<a name="l01144"></a>01144          <span class="keywordflow">return</span> NULL;
<a name="l01145"></a>01145       fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a> = <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l01146"></a>01146    }
<a name="l01147"></a>01147 <span class="preprocessor">#else</span>
<a name="l01148"></a>01148 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (!(fr = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*fr) + <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>)))
<a name="l01149"></a>01149       <span class="keywordflow">return</span> NULL;
<a name="l01150"></a>01150    fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a> = <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l01151"></a>01151 <span class="preprocessor">#endif</span>
<a name="l01152"></a>01152 <span class="preprocessor"></span>
<a name="l01153"></a>01153 
<a name="l01154"></a>01154    fr-&gt;<a class="code" href="structiax__frame.html#ac7e977c3f00d50b1cd332813fa428b4d">direction</a> = <a class="code" href="structiax__frame.html#ac7e977c3f00d50b1cd332813fa428b4d">direction</a>;
<a name="l01155"></a>01155    fr-&gt;<a class="code" href="structiax__frame.html#a4ab21dd2375ec54e44ae4da973a3d4ca">retrans</a> = -1;
<a name="l01156"></a>01156    fr-&gt;<a class="code" href="structiax__frame.html#af80030526d3bbc6bf90c9ab6cdcdba59">cacheable</a> = <a class="code" href="structiax__frame.html#af80030526d3bbc6bf90c9ab6cdcdba59">cacheable</a>;
<a name="l01157"></a>01157    
<a name="l01158"></a>01158    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structiax__frame.html#ac7e977c3f00d50b1cd332813fa428b4d">direction</a> == <a class="code" href="iax2-parser_8h.html#ac0a2881003b5f94b330a60f36367ee57">DIRECTION_INGRESS</a>)
<a name="l01159"></a>01159       <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="iax2-parser_8c.html#a4a94e1f2fcd545095095ed8773a7a31a">iframes</a>, 1);
<a name="l01160"></a>01160    <span class="keywordflow">else</span>
<a name="l01161"></a>01161       <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="iax2-parser_8c.html#a785b37b3e12c475bfe912f87ca09e236">oframes</a>, 1);
<a name="l01162"></a>01162    
<a name="l01163"></a>01163    <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a>, 1);
<a name="l01164"></a>01164 
<a name="l01165"></a>01165    <span class="keywordflow">return</span> fr;
<a name="l01166"></a>01166 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a28158f904f6769628409254d45a266a1"></a><!-- doxytag: member="iax2&#45;parser.c::iax_frame_subclass2str" ref="a28158f904f6769628409254d45a266a1" args="(enum iax_frame_subclass subclass, char *str, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax_frame_subclass2str </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466eff">iax_frame_subclass</a>&nbsp;</td>
          <td class="paramname"> <em>subclass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00411">411</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="iax2_8h_source.html#l00054">IAX_COMMAND_ACCEPT</a>, <a class="el" href="iax2_8h_source.html#l00051">IAX_COMMAND_ACK</a>, <a class="el" href="iax2_8h_source.html#l00056">IAX_COMMAND_AUTHREP</a>, <a class="el" href="iax2_8h_source.html#l00055">IAX_COMMAND_AUTHREQ</a>, <a class="el" href="iax2_8h_source.html#l00115">IAX_COMMAND_CALLTOKEN</a>, <a class="el" href="iax2_8h_source.html#l00077">IAX_COMMAND_DIAL</a>, <a class="el" href="iax2_8h_source.html#l00075">IAX_COMMAND_DPREP</a>, <a class="el" href="iax2_8h_source.html#l00073">IAX_COMMAND_DPREQ</a>, <a class="el" href="iax2_8h_source.html#l00109">IAX_COMMAND_FWDATA</a>, <a class="el" href="iax2_8h_source.html#l00107">IAX_COMMAND_FWDOWNL</a>, <a class="el" href="iax2_8h_source.html#l00052">IAX_COMMAND_HANGUP</a>, <a class="el" href="iax2_8h_source.html#l00057">IAX_COMMAND_INVAL</a>, <a class="el" href="iax2_8h_source.html#l00059">IAX_COMMAND_LAGRP</a>, <a class="el" href="iax2_8h_source.html#l00058">IAX_COMMAND_LAGRQ</a>, <a class="el" href="iax2_8h_source.html#l00099">IAX_COMMAND_MWI</a>, <a class="el" href="iax2_8h_source.html#l00048">IAX_COMMAND_NEW</a>, <a class="el" href="iax2_8h_source.html#l00097">IAX_COMMAND_PAGE</a>, <a class="el" href="iax2_8h_source.html#l00049">IAX_COMMAND_PING</a>, <a class="el" href="iax2_8h_source.html#l00095">IAX_COMMAND_POKE</a>, <a class="el" href="iax2_8h_source.html#l00050">IAX_COMMAND_PONG</a>, <a class="el" href="iax2_8h_source.html#l00105">IAX_COMMAND_PROVISION</a>, <a class="el" href="iax2_8h_source.html#l00091">IAX_COMMAND_QUELCH</a>, <a class="el" href="iax2_8h_source.html#l00065">IAX_COMMAND_REGACK</a>, <a class="el" href="iax2_8h_source.html#l00063">IAX_COMMAND_REGAUTH</a>, <a class="el" href="iax2_8h_source.html#l00067">IAX_COMMAND_REGREJ</a>, <a class="el" href="iax2_8h_source.html#l00069">IAX_COMMAND_REGREL</a>, <a class="el" href="iax2_8h_source.html#l00061">IAX_COMMAND_REGREQ</a>, <a class="el" href="iax2_8h_source.html#l00053">IAX_COMMAND_REJECT</a>, <a class="el" href="iax2_8h_source.html#l00113">IAX_COMMAND_RTKEY</a>, <a class="el" href="iax2_8h_source.html#l00103">IAX_COMMAND_TRANSFER</a>, <a class="el" href="iax2_8h_source.html#l00083">IAX_COMMAND_TXACC</a>, <a class="el" href="iax2_8h_source.html#l00081">IAX_COMMAND_TXCNT</a>, <a class="el" href="iax2_8h_source.html#l00111">IAX_COMMAND_TXMEDIA</a>, <a class="el" href="iax2_8h_source.html#l00085">IAX_COMMAND_TXREADY</a>, <a class="el" href="iax2_8h_source.html#l00089">IAX_COMMAND_TXREJ</a>, <a class="el" href="iax2_8h_source.html#l00087">IAX_COMMAND_TXREL</a>, <a class="el" href="iax2_8h_source.html#l00079">IAX_COMMAND_TXREQ</a>, <a class="el" href="iax2_8h_source.html#l00093">IAX_COMMAND_UNQUELCH</a>, <a class="el" href="iax2_8h_source.html#l00101">IAX_COMMAND_UNSUPPORT</a>, and <a class="el" href="iax2_8h_source.html#l00071">IAX_COMMAND_VNAK</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l06891">ast_cli_netstats()</a>, <a class="el" href="chan__iax2_8c_source.html#l06825">handle_cli_iax2_show_channels()</a>, and <a class="el" href="iax2-parser_8c_source.html#l00543">iax_showframe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00412"></a>00412 {
<a name="l00413"></a>00413    <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd = <span class="stringliteral">&quot;Unknown&quot;</span>;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415    <span class="comment">/* if an error occurs here during compile, that means a new iax frame subclass</span>
<a name="l00416"></a>00416 <span class="comment">    * has been added to the iax_frame_subclass enum.  Add the new subclass to the</span>
<a name="l00417"></a>00417 <span class="comment">    * switch case and make sure to update it with a new string representation. */</span>
<a name="l00418"></a>00418    <span class="keywordflow">switch</span> (subclass) {
<a name="l00419"></a>00419    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa9c6e063c4579ed81af4f9115ab023919">IAX_COMMAND_NEW</a>:
<a name="l00420"></a>00420       cmd = <span class="stringliteral">&quot;NEW    &quot;</span>;
<a name="l00421"></a>00421       <span class="keywordflow">break</span>;
<a name="l00422"></a>00422    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa6092ebf7be4bb70be5c0f1fdb48017a4">IAX_COMMAND_PING</a>:
<a name="l00423"></a>00423       cmd = <span class="stringliteral">&quot;PING   &quot;</span>;
<a name="l00424"></a>00424       <span class="keywordflow">break</span>;
<a name="l00425"></a>00425    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa499c741ada032d5c451e6f45580a6444">IAX_COMMAND_PONG</a>:
<a name="l00426"></a>00426       cmd = <span class="stringliteral">&quot;PONG   &quot;</span>;
<a name="l00427"></a>00427       <span class="keywordflow">break</span>;
<a name="l00428"></a>00428    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa3d4ce8b7180dff4ce0087b6dd262fedc">IAX_COMMAND_ACK</a>:
<a name="l00429"></a>00429       cmd = <span class="stringliteral">&quot;ACK    &quot;</span>;
<a name="l00430"></a>00430       <span class="keywordflow">break</span>;
<a name="l00431"></a>00431    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa4b934f8100fc77df870a27d2aa09b9ee">IAX_COMMAND_HANGUP</a>:
<a name="l00432"></a>00432       cmd = <span class="stringliteral">&quot;HANGUP &quot;</span>;
<a name="l00433"></a>00433       <span class="keywordflow">break</span>;
<a name="l00434"></a>00434    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa325e3e45e9f3b7c45800e4fbce7dae09">IAX_COMMAND_REJECT</a>:
<a name="l00435"></a>00435       cmd = <span class="stringliteral">&quot;REJECT &quot;</span>;
<a name="l00436"></a>00436       <span class="keywordflow">break</span>;
<a name="l00437"></a>00437    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa932a80e68f2fe87e57820e76c25caedb">IAX_COMMAND_ACCEPT</a>:
<a name="l00438"></a>00438       cmd = <span class="stringliteral">&quot;ACCEPT &quot;</span>;
<a name="l00439"></a>00439       <span class="keywordflow">break</span>;
<a name="l00440"></a>00440    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa85a01799deb4255dd6bd5fc06cd719f3">IAX_COMMAND_AUTHREQ</a>:
<a name="l00441"></a>00441       cmd = <span class="stringliteral">&quot;AUTHREQ&quot;</span>;
<a name="l00442"></a>00442       <span class="keywordflow">break</span>;
<a name="l00443"></a>00443    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa1408b2e0afffb3e8b241b059b5ffdc29">IAX_COMMAND_AUTHREP</a>:
<a name="l00444"></a>00444       cmd = <span class="stringliteral">&quot;AUTHREP&quot;</span>;
<a name="l00445"></a>00445       <span class="keywordflow">break</span>;
<a name="l00446"></a>00446    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa2f3a575dc003c6d3456b534e47640b67">IAX_COMMAND_INVAL</a>:
<a name="l00447"></a>00447       cmd = <span class="stringliteral">&quot;INVAL  &quot;</span>;
<a name="l00448"></a>00448       <span class="keywordflow">break</span>;
<a name="l00449"></a>00449    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa4aa1de389272603658d92a449bb6009f">IAX_COMMAND_LAGRQ</a>:
<a name="l00450"></a>00450       cmd = <span class="stringliteral">&quot;LAGRQ  &quot;</span>;
<a name="l00451"></a>00451       <span class="keywordflow">break</span>;
<a name="l00452"></a>00452    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa7651116cd23210a0c999063a6c1d6b64">IAX_COMMAND_LAGRP</a>:
<a name="l00453"></a>00453       cmd = <span class="stringliteral">&quot;LAGRP  &quot;</span>;
<a name="l00454"></a>00454       <span class="keywordflow">break</span>;
<a name="l00455"></a>00455    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effab17acacea946abf3ccde08f4f49fbfdb">IAX_COMMAND_REGREQ</a>:
<a name="l00456"></a>00456       cmd = <span class="stringliteral">&quot;REGREQ &quot;</span>;
<a name="l00457"></a>00457       <span class="keywordflow">break</span>;
<a name="l00458"></a>00458    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa2c4ec8dabaa27f540b64c4a586e7ba95">IAX_COMMAND_REGAUTH</a>:
<a name="l00459"></a>00459       cmd = <span class="stringliteral">&quot;REGAUTH&quot;</span>;
<a name="l00460"></a>00460       <span class="keywordflow">break</span>;
<a name="l00461"></a>00461    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa7f307f817f7c28c8f6351d7dfe355c53">IAX_COMMAND_REGACK</a>:
<a name="l00462"></a>00462       cmd = <span class="stringliteral">&quot;REGACK &quot;</span>;
<a name="l00463"></a>00463       <span class="keywordflow">break</span>;
<a name="l00464"></a>00464    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa8c1a50616eeef8353b4985462e736419">IAX_COMMAND_REGREJ</a>:
<a name="l00465"></a>00465       cmd = <span class="stringliteral">&quot;REGREJ &quot;</span>;
<a name="l00466"></a>00466       <span class="keywordflow">break</span>;
<a name="l00467"></a>00467    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa9189574bea9c0b4772606120cd74718d">IAX_COMMAND_REGREL</a>:
<a name="l00468"></a>00468       cmd = <span class="stringliteral">&quot;REGREL &quot;</span>;
<a name="l00469"></a>00469       <span class="keywordflow">break</span>;
<a name="l00470"></a>00470    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effabc19cf9ba5ac0470de593a7132027fca">IAX_COMMAND_VNAK</a>:
<a name="l00471"></a>00471       cmd = <span class="stringliteral">&quot;VNAK   &quot;</span>;
<a name="l00472"></a>00472       <span class="keywordflow">break</span>;
<a name="l00473"></a>00473    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effae89a0a9be99682834a3f7fc9434e7625">IAX_COMMAND_DPREQ</a>:
<a name="l00474"></a>00474       cmd = <span class="stringliteral">&quot;DPREQ  &quot;</span>;
<a name="l00475"></a>00475       <span class="keywordflow">break</span>;
<a name="l00476"></a>00476    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa2bf840cb539605d405a6bbd7d2c87b23">IAX_COMMAND_DPREP</a>:
<a name="l00477"></a>00477       cmd = <span class="stringliteral">&quot;DPREP  &quot;</span>;
<a name="l00478"></a>00478       <span class="keywordflow">break</span>;
<a name="l00479"></a>00479    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa93040da167cdb2a8b51aa0510a079496">IAX_COMMAND_DIAL</a>:
<a name="l00480"></a>00480       cmd = <span class="stringliteral">&quot;DIAL   &quot;</span>;
<a name="l00481"></a>00481       <span class="keywordflow">break</span>;
<a name="l00482"></a>00482    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effae3c92188ac1dca64149abbf8c89326c7">IAX_COMMAND_TXREQ</a>:
<a name="l00483"></a>00483       cmd = <span class="stringliteral">&quot;TXREQ  &quot;</span>;
<a name="l00484"></a>00484       <span class="keywordflow">break</span>;
<a name="l00485"></a>00485    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa7ca0f1c9bff1cc0247c00886923689ae">IAX_COMMAND_TXCNT</a>:
<a name="l00486"></a>00486       cmd = <span class="stringliteral">&quot;TXCNT  &quot;</span>;
<a name="l00487"></a>00487       <span class="keywordflow">break</span>;
<a name="l00488"></a>00488    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa55974a2898c20aa393530d70cc8c6bc5">IAX_COMMAND_TXACC</a>:
<a name="l00489"></a>00489       cmd = <span class="stringliteral">&quot;TXACC  &quot;</span>;
<a name="l00490"></a>00490       <span class="keywordflow">break</span>;
<a name="l00491"></a>00491    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa4f91d0a7331e8c4fd90a40f8994e5398">IAX_COMMAND_TXREADY</a>:
<a name="l00492"></a>00492       cmd = <span class="stringliteral">&quot;TXREADY&quot;</span>;
<a name="l00493"></a>00493       <span class="keywordflow">break</span>;
<a name="l00494"></a>00494    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa0bc169da2923ae3cbda0e73e4881b95c">IAX_COMMAND_TXREL</a>:
<a name="l00495"></a>00495       cmd = <span class="stringliteral">&quot;TXREL  &quot;</span>;
<a name="l00496"></a>00496       <span class="keywordflow">break</span>;
<a name="l00497"></a>00497    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa865644fc2ba5a8075bfd3f79faa1afe6">IAX_COMMAND_TXREJ</a>:
<a name="l00498"></a>00498       cmd = <span class="stringliteral">&quot;TXREJ  &quot;</span>;
<a name="l00499"></a>00499       <span class="keywordflow">break</span>;
<a name="l00500"></a>00500    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa59245c77d40ee22cf6a2188ae0adc606">IAX_COMMAND_QUELCH</a>:
<a name="l00501"></a>00501       cmd = <span class="stringliteral">&quot;QUELCH &quot;</span>;
<a name="l00502"></a>00502       <span class="keywordflow">break</span>;
<a name="l00503"></a>00503    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effae115542d0e74987e1dc7bfd0fa29f591">IAX_COMMAND_UNQUELCH</a>:
<a name="l00504"></a>00504       cmd = <span class="stringliteral">&quot;UNQULCH&quot;</span>;
<a name="l00505"></a>00505       <span class="keywordflow">break</span>;
<a name="l00506"></a>00506    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effaa68c0d056acb361b1117cbad4121d418">IAX_COMMAND_POKE</a>:
<a name="l00507"></a>00507       cmd = <span class="stringliteral">&quot;POKE   &quot;</span>;
<a name="l00508"></a>00508       <span class="keywordflow">break</span>;
<a name="l00509"></a>00509    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effaa70e4a134be852e7d42772fdcafba165">IAX_COMMAND_PAGE</a>:
<a name="l00510"></a>00510       cmd = <span class="stringliteral">&quot;PAGE   &quot;</span>;
<a name="l00511"></a>00511       <span class="keywordflow">break</span>;
<a name="l00512"></a>00512    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa048272679ef351ac9541c2e0d47c3597">IAX_COMMAND_MWI</a>:
<a name="l00513"></a>00513       cmd = <span class="stringliteral">&quot;MWI    &quot;</span>;
<a name="l00514"></a>00514       <span class="keywordflow">break</span>;
<a name="l00515"></a>00515    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa99c917cc159a60dec921b9ed9b9ad856">IAX_COMMAND_UNSUPPORT</a>:
<a name="l00516"></a>00516       cmd = <span class="stringliteral">&quot;UNSPRTD&quot;</span>;
<a name="l00517"></a>00517       <span class="keywordflow">break</span>;
<a name="l00518"></a>00518    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa6e92b95649c6f900a7bc462c9d7e9a5d">IAX_COMMAND_TRANSFER</a>:
<a name="l00519"></a>00519       cmd = <span class="stringliteral">&quot;TRANSFR&quot;</span>;
<a name="l00520"></a>00520       <span class="keywordflow">break</span>;
<a name="l00521"></a>00521    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa25b3d114235e7e41d8043944e82e0666">IAX_COMMAND_PROVISION</a>:
<a name="l00522"></a>00522       cmd = <span class="stringliteral">&quot;PROVISN&quot;</span>;
<a name="l00523"></a>00523       <span class="keywordflow">break</span>;
<a name="l00524"></a>00524    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa08fdcdfce4a4fa82cb861365beb5f9eb">IAX_COMMAND_FWDOWNL</a>:
<a name="l00525"></a>00525       cmd = <span class="stringliteral">&quot;FWDWNLD&quot;</span>;
<a name="l00526"></a>00526       <span class="keywordflow">break</span>;
<a name="l00527"></a>00527    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa32a7a195c53bf249c707e6473096bf9e">IAX_COMMAND_FWDATA</a>:
<a name="l00528"></a>00528       cmd = <span class="stringliteral">&quot;FWDATA &quot;</span>;
<a name="l00529"></a>00529       <span class="keywordflow">break</span>;
<a name="l00530"></a>00530    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa12c553d53876a263016d12a0d87ab22a">IAX_COMMAND_TXMEDIA</a>:
<a name="l00531"></a>00531       cmd = <span class="stringliteral">&quot;TXMEDIA&quot;</span>;
<a name="l00532"></a>00532       <span class="keywordflow">break</span>;
<a name="l00533"></a>00533    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effae414fa2006b58341d7f3679d131d3327">IAX_COMMAND_RTKEY</a>:
<a name="l00534"></a>00534       cmd = <span class="stringliteral">&quot;RTKEY  &quot;</span>;
<a name="l00535"></a>00535       <span class="keywordflow">break</span>;
<a name="l00536"></a>00536    <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0f43e8c7dccbe27d9017497e83466effa92c28bf63f730ca1f2836b5a1a26ac38">IAX_COMMAND_CALLTOKEN</a>:
<a name="l00537"></a>00537       cmd = <span class="stringliteral">&quot;CTOKEN &quot;</span>;
<a name="l00538"></a>00538       <span class="keywordflow">break</span>;
<a name="l00539"></a>00539    }
<a name="l00540"></a>00540    <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, cmd, <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);
<a name="l00541"></a>00541 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7172830d863702f96f81d8a09612428"></a><!-- doxytag: member="iax2&#45;parser.c::iax_frame_wrap" ref="ac7172830d863702f96f81d8a09612428" args="(struct iax_frame *fr, struct ast_frame *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax_frame_wrap </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__frame.html">iax_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>fr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01079">1079</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8h_source.html#l00138">iax_frame::af</a>, <a class="el" href="iax2-parser_8h_source.html#l00142">iax_frame::afdata</a>, <a class="el" href="iax2-parser_8h_source.html#l00140">iax_frame::afdatalen</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h_source.html#l00203">AST_FRIENDLY_OFFSET</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="frame_8c_source.html#l00551">ast_swapcopy_samples()</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="frame_8h_source.html#l00161">ast_frame::delivery</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="frame_8h_source.html#l00169">ast_frame::len</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="frame_8h_source.html#l00151">ast_frame::mallocd</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="frame_8h_source.html#l00157">ast_frame::src</a>, and <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l06045">iax2_send()</a>, <a class="el" href="chan__iax2_8c_source.html#l01805">iaxfrdup2()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09260">socket_process_meta()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01080"></a>01080 {
<a name="l01081"></a>01081    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>;
<a name="l01082"></a>01082    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>;
<a name="l01083"></a>01083    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = 0;           <span class="comment">/* Our frame is static relative to the container */</span>
<a name="l01084"></a>01084    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l01085"></a>01085    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>;
<a name="l01086"></a>01086    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l01087"></a>01087    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = f-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a>;
<a name="l01088"></a>01088    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>.tv_sec = 0;
<a name="l01089"></a>01089    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a41a708025486b4c9383e7432e9ba3f0e">delivery</a>.tv_usec = 0;
<a name="l01090"></a>01090    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = fr-&gt;<a class="code" href="structiax__frame.html#a6caa911aa752e04eba40c71e08843888">afdata</a>;
<a name="l01091"></a>01091    fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a> = f-&gt;<a class="code" href="structast__frame.html#aaccba9d5adc3f6c39aad767db95ba484">len</a>;
<a name="l01092"></a>01092    <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>) {
<a name="l01093"></a>01093       <span class="keywordtype">size_t</span> copy_len = fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l01094"></a>01094       <span class="keywordflow">if</span> (copy_len &gt; fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a>) {
<a name="l01095"></a>01095          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Losing frame data because destination buffer size &apos;%d&apos; bytes not big enough for &apos;%d&apos; bytes in the frame\n&quot;</span>,
<a name="l01096"></a>01096             (<span class="keywordtype">int</span>) fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a>, (<span class="keywordtype">int</span>) fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);
<a name="l01097"></a>01097          copy_len = fr-&gt;<a class="code" href="structiax__frame.html#ac6dd018a429627fc0ad8d167c7c46ef4">afdatalen</a>;
<a name="l01098"></a>01098       }
<a name="l01099"></a>01099 <span class="preprocessor">#if __BYTE_ORDER == __LITTLE_ENDIAN</span>
<a name="l01100"></a>01100 <span class="preprocessor"></span>      <span class="comment">/* We need to byte-swap slinear samples from network byte order */</span>
<a name="l01101"></a>01101       <span class="keywordflow">if</span> ((fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) &amp;&amp; (fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> == <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>)) {
<a name="l01102"></a>01102          <span class="comment">/* 2 bytes / sample for SLINEAR */</span>
<a name="l01103"></a>01103          <a class="code" href="frame_8h.html#ad3313ac3c6813594f1ea408e26505be7">ast_swapcopy_samples</a>(fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, copy_len / 2);
<a name="l01104"></a>01104       } <span class="keywordflow">else</span>
<a name="l01105"></a>01105 <span class="preprocessor">#endif</span>
<a name="l01106"></a>01106 <span class="preprocessor"></span>         memcpy(fr-&gt;<a class="code" href="structiax__frame.html#aed3d7ad666c6711b52855819a1e49612">af</a>.<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, copy_len);
<a name="l01107"></a>01107    }
<a name="l01108"></a>01108 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af455cee6f84e3172efd275baa2f42181"></a><!-- doxytag: member="iax2&#45;parser.c::iax_get_frames" ref="af455cee6f84e3172efd275baa2f42181" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_get_frames </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01220">1220</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l03670">handle_cli_iax2_show_stats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01220"></a>01220 { <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0718dbbbf3999ce541b0bb41b8668186"></a><!-- doxytag: member="iax2&#45;parser.c::iax_get_iframes" ref="a0718dbbbf3999ce541b0bb41b8668186" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_get_iframes </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01221">1221</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l03670">handle_cli_iax2_show_stats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01221"></a>01221 { <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#a4a94e1f2fcd545095095ed8773a7a31a">iframes</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abb3748c6e76b50fb32c55e70a12cd056"></a><!-- doxytag: member="iax2&#45;parser.c::iax_get_oframes" ref="abb3748c6e76b50fb32c55e70a12cd056" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_get_oframes </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l01222">1222</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l03670">handle_cli_iax2_show_stats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01222"></a>01222 { <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#a785b37b3e12c475bfe912f87ca09e236">oframes</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a721c7ff90c2590abc60ef8057a2c8fd5"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie2str" ref="a721c7ff90c2590abc60ef8057a2c8fd5" args="(int ie)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* iax_ie2str </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ie</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00302">302</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>, and <a class="el" href="iax2-parser_8c_source.html#l00225">iax2_ie::name</a>.</p>

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>, and <a class="el" href="iax2-parser_8c_source.html#l00717">iax_parse_ies()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00303"></a>00303 {
<a name="l00304"></a>00304    <span class="keywordtype">int</span> x;
<a name="l00305"></a>00305    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>); x++) {
<a name="l00306"></a>00306       <span class="keywordflow">if</span> (<a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].ie == ie)
<a name="l00307"></a>00307          <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#a3dd967af3ebc9b54f3f81e9f95f1dab1">infoelts</a>[x].<a class="code" href="structiax2__ie.html#a5ac083a645d964373f022d03df4849c8">name</a>;
<a name="l00308"></a>00308    }
<a name="l00309"></a>00309    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Unknown IE&quot;</span>;
<a name="l00310"></a>00310 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8cac52b8ffe1019fe3dbd5bb605994d1"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append" ref="a8cac52b8ffe1019fe3dbd5bb605994d1" args="(struct iax_ie_data *ied, unsigned char ie)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00702">702</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l04777">iax2_call()</a>, and <a class="el" href="chan__iax2_8c_source.html#l03012">iax_firmware_append()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00703"></a>00703 {
<a name="l00704"></a>00704    <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a>(ied, ie, NULL, 0);
<a name="l00705"></a>00705 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3f0c77bd0c7403e0ca0340006e1260d7"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append_addr" ref="a3f0c77bd0c7403e0ca0340006e1260d7" args="(struct iax_ie_data *ied, unsigned char ie, const struct sockaddr_in *sin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append_addr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>sin</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00673">673</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l05121">iax2_start_transfer()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00674"></a>00674 {
<a name="l00675"></a>00675    <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a>(ied, ie, sin, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));
<a name="l00676"></a>00676 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4543258d0eaca83fe806bfae857f65d8"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append_byte" ref="a4543258d0eaca83fe806bfae857f65d8" args="(struct iax_ie_data *ied, unsigned char ie, unsigned char dat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append_byte </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>dat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00697">697</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l08606">__auth_reject()</a>, <a class="el" href="chan__iax2_8c_source.html#l08655">__auto_hangup()</a>, <a class="el" href="chan__iax2_8c_source.html#l07462">authenticate_request()</a>, <a class="el" href="chan__iax2_8c_source.html#l04777">iax2_call()</a>, <a class="el" href="chan__iax2_8c_source.html#l04970">iax2_hangup()</a>, <a class="el" href="iax2-provision_8c_source.html#l00206">iax_provision_build()</a>, and <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00698"></a>00698 {
<a name="l00699"></a>00699    <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a>(ied, ie, &amp;dat, 1);
<a name="l00700"></a>00700 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa67b90e85b844cfc53a539813aca05ca"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append_int" ref="aa67b90e85b844cfc53a539813aca05ca" args="(struct iax_ie_data *ied, unsigned char ie, unsigned int value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append_int </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00678">678</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l13001">cache_get_callno_locked()</a>, <a class="el" href="chan__iax2_8c_source.html#l09007">construct_rr()</a>, <a class="el" href="chan__iax2_8c_source.html#l04777">iax2_call()</a>, <a class="el" href="chan__iax2_8c_source.html#l05121">iax2_start_transfer()</a>, <a class="el" href="chan__iax2_8c_source.html#l03012">iax_firmware_append()</a>, <a class="el" href="iax2-provision_8c_source.html#l00206">iax_provision_build()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, <a class="el" href="chan__iax2_8c_source.html#l07944">try_transfer()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00679"></a>00679 {
<a name="l00680"></a>00680    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newval;
<a name="l00681"></a>00681    newval = htonl(value);
<a name="l00682"></a>00682    <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a>(ied, ie, &amp;newval, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(newval));
<a name="l00683"></a>00683 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa54841eb569031c28321281dcd31e4f3"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append_raw" ref="aa54841eb569031c28321281dcd31e4f3" args="(struct iax_ie_data *ied, unsigned char ie, const void *data, int datalen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append_raw </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>datalen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00658">658</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8h_source.html#l00146">iax_ie_data::buf</a>, <a class="el" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>, <a class="el" href="iax2-parser_8c_source.html#l00302">iax_ie2str()</a>, and <a class="el" href="iax2-parser_8h_source.html#l00147">iax_ie_data::pos</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l04777">iax2_call()</a>, <a class="el" href="chan__iax2_8c_source.html#l05088">iax2_key_rotate()</a>, <a class="el" href="chan__iax2_8c_source.html#l11321">iax2_provision()</a>, <a class="el" href="chan__iax2_8c_source.html#l03012">iax_firmware_append()</a>, <a class="el" href="iax2-parser_8c_source.html#l00702">iax_ie_append()</a>, <a class="el" href="iax2-parser_8c_source.html#l00673">iax_ie_append_addr()</a>, <a class="el" href="iax2-parser_8c_source.html#l00697">iax_ie_append_byte()</a>, <a class="el" href="iax2-parser_8c_source.html#l00678">iax_ie_append_int()</a>, <a class="el" href="iax2-parser_8c_source.html#l00685">iax_ie_append_short()</a>, and <a class="el" href="iax2-parser_8c_source.html#l00692">iax_ie_append_str()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00659"></a>00659 {
<a name="l00660"></a>00660    <span class="keywordtype">char</span> tmp[256];
<a name="l00661"></a>00661    <span class="keywordflow">if</span> (<a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> &gt; ((<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(ied-&gt;<a class="code" href="structiax__ie__data.html#a8d0196caa4b00a1c9678508b882b33ee">buf</a>) - ied-&gt;<a class="code" href="structiax__ie__data.html#a1910d262855b71da353ed0d07a6c7823">pos</a>)) {
<a name="l00662"></a>00662       snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Out of space for ie &apos;%s&apos; (%d), need %d have %d\n&quot;</span>, <a class="code" href="iax2-parser_8c.html#a721c7ff90c2590abc60ef8057a2c8fd5">iax_ie2str</a>(ie), ie, <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(ied-&gt;<a class="code" href="structiax__ie__data.html#a8d0196caa4b00a1c9678508b882b33ee">buf</a>) - ied-&gt;<a class="code" href="structiax__ie__data.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);
<a name="l00663"></a>00663       <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00664"></a>00664       <span class="keywordflow">return</span> -1;
<a name="l00665"></a>00665    }
<a name="l00666"></a>00666    ied-&gt;<a class="code" href="structiax__ie__data.html#a8d0196caa4b00a1c9678508b882b33ee">buf</a>[ied-&gt;<a class="code" href="structiax__ie__data.html#a1910d262855b71da353ed0d07a6c7823">pos</a>++] = ie;
<a name="l00667"></a>00667    ied-&gt;<a class="code" href="structiax__ie__data.html#a8d0196caa4b00a1c9678508b882b33ee">buf</a>[ied-&gt;<a class="code" href="structiax__ie__data.html#a1910d262855b71da353ed0d07a6c7823">pos</a>++] = <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00668"></a>00668    memcpy(ied-&gt;<a class="code" href="structiax__ie__data.html#a8d0196caa4b00a1c9678508b882b33ee">buf</a> + ied-&gt;<a class="code" href="structiax__ie__data.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, <a class="code" href="structiax__frame.html#a735984d41155bc1032e09bece8f8d66d">data</a>, <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);
<a name="l00669"></a>00669    ied-&gt;<a class="code" href="structiax__ie__data.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="structiax__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>;
<a name="l00670"></a>00670    <span class="keywordflow">return</span> 0;
<a name="l00671"></a>00671 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad08e1debfa7325dfa3f22a8cc09f4945"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append_short" ref="ad08e1debfa7325dfa3f22a8cc09f4945" args="(struct iax_ie_data *ied, unsigned char ie, unsigned short value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append_short </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00685">685</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l07462">authenticate_request()</a>, <a class="el" href="chan__iax2_8c_source.html#l13001">cache_get_callno_locked()</a>, <a class="el" href="chan__iax2_8c_source.html#l09007">construct_rr()</a>, <a class="el" href="chan__iax2_8c_source.html#l08855">dp_lookup()</a>, <a class="el" href="chan__iax2_8c_source.html#l04777">iax2_call()</a>, <a class="el" href="chan__iax2_8c_source.html#l11265">iax2_do_register()</a>, <a class="el" href="chan__iax2_8c_source.html#l05121">iax2_start_transfer()</a>, <a class="el" href="iax2-provision_8c_source.html#l00206">iax_provision_build()</a>, <a class="el" href="chan__iax2_8c_source.html#l08505">registry_authrequest()</a>, <a class="el" href="chan__iax2_8c_source.html#l08553">registry_rerequest()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00686"></a>00686 {
<a name="l00687"></a>00687    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> newval;
<a name="l00688"></a>00688    newval = htons(value);
<a name="l00689"></a>00689    <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a>(ied, ie, &amp;newval, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(newval));
<a name="l00690"></a>00690 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad94f0fdb4e50d38876577242d132709f"></a><!-- doxytag: member="iax2&#45;parser.c::iax_ie_append_str" ref="ad94f0fdb4e50d38876577242d132709f" args="(struct iax_ie_data *ied, unsigned char ie, const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_ie_append_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ie__data.html">iax_ie_data</a> *&nbsp;</td>
          <td class="paramname"> <em>ied</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00692">692</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l08606">__auth_reject()</a>, <a class="el" href="chan__iax2_8c_source.html#l08655">__auto_hangup()</a>, <a class="el" href="chan__iax2_8c_source.html#l07754">authenticate()</a>, <a class="el" href="chan__iax2_8c_source.html#l07462">authenticate_request()</a>, <a class="el" href="chan__iax2_8c_source.html#l13001">cache_get_callno_locked()</a>, <a class="el" href="chan__iax2_8c_source.html#l08855">dp_lookup()</a>, <a class="el" href="chan__iax2_8c_source.html#l04634">handle_call_token()</a>, <a class="el" href="chan__iax2_8c_source.html#l04777">iax2_call()</a>, <a class="el" href="chan__iax2_8c_source.html#l11265">iax2_do_register()</a>, <a class="el" href="chan__iax2_8c_source.html#l08685">iax2_dprequest()</a>, <a class="el" href="chan__iax2_8c_source.html#l05375">iax2_transfer()</a>, <a class="el" href="iax2-provision_8c_source.html#l00206">iax_provision_build()</a>, <a class="el" href="chan__iax2_8c_source.html#l08505">registry_authrequest()</a>, <a class="el" href="chan__iax2_8c_source.html#l08553">registry_rerequest()</a>, <a class="el" href="chan__iax2_8c_source.html#l04510">resend_with_token()</a>, <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00693"></a>00693 {
<a name="l00694"></a>00694    <span class="keywordflow">return</span> <a class="code" href="iax2-parser_8c.html#aa54841eb569031c28321281dcd31e4f3">iax_ie_append_raw</a>(ied, ie, <a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, strlen(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>));
<a name="l00695"></a>00695 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a008130bffa0c54d95782e1bb14bb24fd"></a><!-- doxytag: member="iax2&#45;parser.c::iax_parse_ies" ref="a008130bffa0c54d95782e1bb14bb24fd" args="(struct iax_ies *ies, unsigned char *data, int datalen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax_parse_ies </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__ies.html">iax_ies</a> *&nbsp;</td>
          <td class="paramname"> <em>ies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>datalen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00717">717</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8h_source.html#l00040">iax_ies::adsicpe</a>, <a class="el" href="iax2-parser_8h_source.html#l00048">iax_ies::apparent_addr</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="strings_8h_source.html#l00488">ast_str_buffer()</a>, <a class="el" href="strings_8h_source.html#l00415">ast_str_create()</a>, <a class="el" href="strings_8h_source.html#l00825">ast_str_set()</a>, <a class="el" href="config_8c_source.html#l00223">ast_variable_new()</a>, <a class="el" href="iax2-parser_8h_source.html#l00043">iax_ies::authmethods</a>, <a class="el" href="iax2-parser_8h_source.html#l00056">iax_ies::autoanswer</a>, <a class="el" href="iax2-parser_8h_source.html#l00032">iax_ies::called_context</a>, <a class="el" href="iax2-parser_8h_source.html#l00025">iax_ies::called_number</a>, <a class="el" href="iax2-parser_8h_source.html#l00027">iax_ies::calling_ani</a>, <a class="el" href="iax2-parser_8h_source.html#l00028">iax_ies::calling_name</a>, <a class="el" href="iax2-parser_8h_source.html#l00026">iax_ies::calling_number</a>, <a class="el" href="iax2-parser_8h_source.html#l00031">iax_ies::calling_pres</a>, <a class="el" href="iax2-parser_8h_source.html#l00030">iax_ies::calling_tns</a>, <a class="el" href="iax2-parser_8h_source.html#l00029">iax_ies::calling_ton</a>, <a class="el" href="iax2-parser_8h_source.html#l00051">iax_ies::callno</a>, <a class="el" href="iax2-parser_8h_source.html#l00080">iax_ies::calltoken</a>, <a class="el" href="iax2-parser_8h_source.html#l00081">iax_ies::calltokendata</a>, <a class="el" href="iax2-parser_8h_source.html#l00035">iax_ies::capability</a>, <a class="el" href="iax2-parser_8h_source.html#l00052">iax_ies::cause</a>, <a class="el" href="iax2-parser_8h_source.html#l00053">iax_ies::causecode</a>, <a class="el" href="iax2-parser_8h_source.html#l00045">iax_ies::challenge</a>, <a class="el" href="iax2-parser_8h_source.html#l00037">iax_ies::codec_prefs</a>, <a class="el" href="iax2-parser_8h_source.html#l00059">iax_ies::datetime</a>, <a class="el" href="iax2-parser_8h_source.html#l00060">iax_ies::devicetype</a>, <a class="el" href="iax2-parser_8h_source.html#l00041">iax_ies::dnid</a>, <a class="el" href="iax2-parser_8h_source.html#l00050">iax_ies::dpstatus</a>, <a class="el" href="iax2-parser_8h_source.html#l00066">iax_ies::enckey</a>, <a class="el" href="iax2-parser_8h_source.html#l00067">iax_ies::enckeylen</a>, <a class="el" href="iax2-parser_8h_source.html#l00044">iax_ies::encmethods</a>, <a class="el" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>, <a class="el" href="config_8h_source.html#l00079">ast_variable::file</a>, <a class="el" href="iax2-parser_8h_source.html#l00062">iax_ies::firmwarever</a>, <a class="el" href="iax2-parser_8h_source.html#l00036">iax_ies::format</a>, <a class="el" href="iax2-parser_8h_source.html#l00064">iax_ies::fwdata</a>, <a class="el" href="iax2-parser_8h_source.html#l00065">iax_ies::fwdatalen</a>, <a class="el" href="iax2-parser_8h_source.html#l00063">iax_ies::fwdesc</a>, <a class="el" href="unaligned_8h_source.html#l00038">get_unaligned_uint16()</a>, <a class="el" href="unaligned_8h_source.html#l00032">get_unaligned_uint32()</a>, <a class="el" href="iax2-parser_8c_source.html#l00302">iax_ie2str()</a>, <a class="el" href="iax2_8h_source.html#l00138">IAX_IE_ADSICPE</a>, <a class="el" href="iax2_8h_source.html#l00144">IAX_IE_APPARENT_ADDR</a>, <a class="el" href="iax2_8h_source.html#l00140">IAX_IE_AUTHMETHODS</a>, <a class="el" href="iax2_8h_source.html#l00151">IAX_IE_AUTOANSWER</a>, <a class="el" href="iax2_8h_source.html#l00131">IAX_IE_CALLED_CONTEXT</a>, <a class="el" href="iax2_8h_source.html#l00127">IAX_IE_CALLED_NUMBER</a>, <a class="el" href="iax2_8h_source.html#l00129">IAX_IE_CALLING_ANI</a>, <a class="el" href="iax2_8h_source.html#l00130">IAX_IE_CALLING_NAME</a>, <a class="el" href="iax2_8h_source.html#l00128">IAX_IE_CALLING_NUMBER</a>, <a class="el" href="iax2_8h_source.html#l00164">IAX_IE_CALLINGPRES</a>, <a class="el" href="iax2_8h_source.html#l00166">IAX_IE_CALLINGTNS</a>, <a class="el" href="iax2_8h_source.html#l00165">IAX_IE_CALLINGTON</a>, <a class="el" href="iax2_8h_source.html#l00147">IAX_IE_CALLNO</a>, <a class="el" href="iax2_8h_source.html#l00181">IAX_IE_CALLTOKEN</a>, <a class="el" href="iax2_8h_source.html#l00134">IAX_IE_CAPABILITY</a>, <a class="el" href="iax2_8h_source.html#l00148">IAX_IE_CAUSE</a>, <a class="el" href="iax2_8h_source.html#l00168">IAX_IE_CAUSECODE</a>, <a class="el" href="iax2_8h_source.html#l00141">IAX_IE_CHALLENGE</a>, <a class="el" href="iax2_8h_source.html#l00171">IAX_IE_CODEC_PREFS</a>, <a class="el" href="iax2_8h_source.html#l00157">IAX_IE_DATETIME</a>, <a class="el" href="iax2_8h_source.html#l00158">IAX_IE_DEVICETYPE</a>, <a class="el" href="iax2_8h_source.html#l00139">IAX_IE_DNID</a>, <a class="el" href="iax2_8h_source.html#l00146">IAX_IE_DPSTATUS</a>, <a class="el" href="iax2_8h_source.html#l00170">IAX_IE_ENCKEY</a>, <a class="el" href="iax2_8h_source.html#l00169">IAX_IE_ENCRYPTION</a>, <a class="el" href="iax2_8h_source.html#l00160">IAX_IE_FIRMWAREVER</a>, <a class="el" href="iax2_8h_source.html#l00135">IAX_IE_FORMAT</a>, <a class="el" href="iax2_8h_source.html#l00162">IAX_IE_FWBLOCKDATA</a>, <a class="el" href="iax2_8h_source.html#l00161">IAX_IE_FWBLOCKDESC</a>, <a class="el" href="iax2_8h_source.html#l00149">IAX_IE_IAX_UNKNOWN</a>, <a class="el" href="iax2_8h_source.html#l00136">IAX_IE_LANGUAGE</a>, <a class="el" href="iax2_8h_source.html#l00142">IAX_IE_MD5_RESULT</a>, <a class="el" href="iax2_8h_source.html#l00150">IAX_IE_MSGCOUNT</a>, <a class="el" href="iax2_8h_source.html#l00152">IAX_IE_MUSICONHOLD</a>, <a class="el" href="iax2_8h_source.html#l00180">IAX_IE_OSPTOKEN</a>, <a class="el" href="iax2_8h_source.html#l00133">IAX_IE_PASSWORD</a>, <a class="el" href="iax2_8h_source.html#l00163">IAX_IE_PROVVER</a>, <a class="el" href="iax2_8h_source.html#l00154">IAX_IE_RDNIS</a>, <a class="el" href="iax2_8h_source.html#l00145">IAX_IE_REFRESH</a>, <a class="el" href="iax2_8h_source.html#l00176">IAX_IE_RR_DELAY</a>, <a class="el" href="iax2_8h_source.html#l00177">IAX_IE_RR_DROPPED</a>, <a class="el" href="iax2_8h_source.html#l00173">IAX_IE_RR_JITTER</a>, <a class="el" href="iax2_8h_source.html#l00174">IAX_IE_RR_LOSS</a>, <a class="el" href="iax2_8h_source.html#l00178">IAX_IE_RR_OOO</a>, <a class="el" href="iax2_8h_source.html#l00175">IAX_IE_RR_PKTS</a>, <a class="el" href="iax2_8h_source.html#l00143">IAX_IE_RSA_RESULT</a>, <a class="el" href="iax2_8h_source.html#l00167">IAX_IE_SAMPLINGRATE</a>, <a class="el" href="iax2_8h_source.html#l00159">IAX_IE_SERVICEIDENT</a>, <a class="el" href="iax2_8h_source.html#l00153">IAX_IE_TRANSFERID</a>, <a class="el" href="iax2_8h_source.html#l00132">IAX_IE_USERNAME</a>, <a class="el" href="iax2_8h_source.html#l00179">IAX_IE_VARIABLE</a>, <a class="el" href="iax2_8h_source.html#l00137">IAX_IE_VERSION</a>, <a class="el" href="iax2_8h_source.html#l00184">IAX_MAX_OSPBLOCK_NUM</a>, <a class="el" href="iax2_8h_source.html#l00201">IAX_RATE_8KHZ</a>, <a class="el" href="iax2-parser_8h_source.html#l00054">iax_ies::iax_unknown</a>, <a class="el" href="iax2-parser_8h_source.html#l00038">iax_ies::language</a>, <a class="el" href="func__strings_8c_source.html#l00821">len()</a>, <a class="el" href="iax2-parser_8h_source.html#l00046">iax_ies::md5_result</a>, <a class="el" href="iax2-parser_8h_source.html#l00055">iax_ies::msgcount</a>, <a class="el" href="iax2-parser_8h_source.html#l00057">iax_ies::musiconhold</a>, <a class="el" href="config_8h_source.html#l00075">ast_variable::name</a>, <a class="el" href="config_8h_source.html#l00077">ast_variable::next</a>, <a class="el" href="iax2-parser_8h_source.html#l00079">iax_ies::ospblocklength</a>, <a class="el" href="iax2-parser_8h_source.html#l00078">iax_ies::osptokenblock</a>, <a class="el" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>, <a class="el" href="iax2-parser_8h_source.html#l00034">iax_ies::password</a>, <a class="el" href="iax2-parser_8h_source.html#l00068">iax_ies::provver</a>, <a class="el" href="iax2-parser_8h_source.html#l00070">iax_ies::provverpres</a>, <a class="el" href="iax2-parser_8h_source.html#l00042">iax_ies::rdnis</a>, <a class="el" href="iax2-parser_8h_source.html#l00049">iax_ies::refresh</a>, <a class="el" href="iax2-parser_8h_source.html#l00074">iax_ies::rr_delay</a>, <a class="el" href="iax2-parser_8h_source.html#l00075">iax_ies::rr_dropped</a>, <a class="el" href="iax2-parser_8h_source.html#l00071">iax_ies::rr_jitter</a>, <a class="el" href="iax2-parser_8h_source.html#l00072">iax_ies::rr_loss</a>, <a class="el" href="iax2-parser_8h_source.html#l00076">iax_ies::rr_ooo</a>, <a class="el" href="iax2-parser_8h_source.html#l00073">iax_ies::rr_pkts</a>, <a class="el" href="iax2-parser_8h_source.html#l00047">iax_ies::rsa_result</a>, <a class="el" href="iax2-parser_8h_source.html#l00069">iax_ies::samprate</a>, <a class="el" href="iax2-parser_8h_source.html#l00061">iax_ies::serviceident</a>, <a class="el" href="app__jack_8c_source.html#l00142">str</a>, <a class="el" href="iax2-parser_8h_source.html#l00058">iax_ies::transferid</a>, <a class="el" href="iax2-parser_8h_source.html#l00033">iax_ies::username</a>, <a class="el" href="config_8h_source.html#l00076">ast_variable::value</a>, <a class="el" href="ast__expr2f_8c_source.html#l00613">var</a>, <a class="el" href="iax2-parser_8h_source.html#l00077">iax_ies::vars</a>, and <a class="el" href="iax2-parser_8h_source.html#l00039">iax_ies::version</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l09458">socket_process()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00718"></a>00718 {
<a name="l00719"></a>00719    <span class="comment">/* Parse data into information elements */</span>
<a name="l00720"></a>00720    <span class="keywordtype">int</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;
<a name="l00721"></a>00721    <span class="keywordtype">int</span> ie;
<a name="l00722"></a>00722    <span class="keywordtype">char</span> tmp[256], *tmp2;
<a name="l00723"></a>00723    <span class="keyword">struct </span><a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *<a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, *var2, *prev;
<a name="l00724"></a>00724    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count;
<a name="l00725"></a>00725    memset(ies, 0, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structiax__ies.html">iax_ies</a>));
<a name="l00726"></a>00726    ies-&gt;<a class="code" href="structiax__ies.html#a7060b2731bf71abb7fd8b9b1ebbb01c9">msgcount</a> = -1;
<a name="l00727"></a>00727    ies-&gt;<a class="code" href="structiax__ies.html#a6b9683ca47d524037ebe09bb62ff4010">firmwarever</a> = -1;
<a name="l00728"></a>00728    ies-&gt;<a class="code" href="structiax__ies.html#a57eabf92fe7c9f440fe38fb529c57f91">calling_ton</a> = -1;
<a name="l00729"></a>00729    ies-&gt;<a class="code" href="structiax__ies.html#a7ab4a847c94ceca414d76c2abe5587aa">calling_tns</a> = -1;
<a name="l00730"></a>00730    ies-&gt;<a class="code" href="structiax__ies.html#aa16fb44247d3656e98d82796a24c0ec6">calling_pres</a> = -1;
<a name="l00731"></a>00731    ies-&gt;<a class="code" href="structiax__ies.html#aa7e6b946115ac6e6a4decf48932c9abf">samprate</a> = <a class="code" href="iax2_8h.html#a54798572f4746ab5197989cd44d6e16d">IAX_RATE_8KHZ</a>;
<a name="l00732"></a>00732    <span class="keywordflow">while</span>(datalen &gt;= 2) {
<a name="l00733"></a>00733       ie = data[0];
<a name="l00734"></a>00734       len = data[1];
<a name="l00735"></a>00735       <span class="keywordflow">if</span> (len &gt; datalen - 2) {
<a name="l00736"></a>00736          <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(<span class="stringliteral">&quot;Information element length exceeds message size\n&quot;</span>);
<a name="l00737"></a>00737          <span class="keywordflow">return</span> -1;
<a name="l00738"></a>00738       }
<a name="l00739"></a>00739       <span class="keywordflow">switch</span>(ie) {
<a name="l00740"></a>00740       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#aa0f5d6e9b74df33a17772be8afde5bc7">IAX_IE_CALLED_NUMBER</a>:
<a name="l00741"></a>00741          ies-&gt;<a class="code" href="structiax__ies.html#a7fcf5cf7f21e8f71a3e50c431fa18800">called_number</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00742"></a>00742          <span class="keywordflow">break</span>;
<a name="l00743"></a>00743       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a247e96f38f42f791fdd95a78d614dff5">IAX_IE_CALLING_NUMBER</a>:
<a name="l00744"></a>00744          ies-&gt;<a class="code" href="structiax__ies.html#a503b1570b953edc1cbff315709acf943">calling_number</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00745"></a>00745          <span class="keywordflow">break</span>;
<a name="l00746"></a>00746       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a349591fc903d8fd2b7081ac0650fa7d8">IAX_IE_CALLING_ANI</a>:
<a name="l00747"></a>00747          ies-&gt;<a class="code" href="structiax__ies.html#a5350a6c582e732ca4bc0dedf3def8c26">calling_ani</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00748"></a>00748          <span class="keywordflow">break</span>;
<a name="l00749"></a>00749       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a5d435e4bb28522353ca7937e06e2689c">IAX_IE_CALLING_NAME</a>:
<a name="l00750"></a>00750          ies-&gt;<a class="code" href="structiax__ies.html#a38b197bb85bb9735b9ff9bed4bf196db">calling_name</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00751"></a>00751          <span class="keywordflow">break</span>;
<a name="l00752"></a>00752       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#af19a0a52d9c678fd55a44e6cda94cd88">IAX_IE_CALLED_CONTEXT</a>:
<a name="l00753"></a>00753          ies-&gt;<a class="code" href="structiax__ies.html#a3da3c62d7c7467fda1c782c92a44987c">called_context</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00754"></a>00754          <span class="keywordflow">break</span>;
<a name="l00755"></a>00755       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#afd193c12d8825d240b437532f7fa7990">IAX_IE_USERNAME</a>:
<a name="l00756"></a>00756          ies-&gt;<a class="code" href="structiax__ies.html#a9b20c006bd90a09e1465fb668700e81d">username</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00757"></a>00757          <span class="keywordflow">break</span>;
<a name="l00758"></a>00758       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a0068830a768cd96da372f33082f718c7">IAX_IE_PASSWORD</a>:
<a name="l00759"></a>00759          ies-&gt;<a class="code" href="structiax__ies.html#a59460a3ff2c12443d1022e5cc0fba85c">password</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00760"></a>00760          <span class="keywordflow">break</span>;
<a name="l00761"></a>00761       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a9dd09f4ce469613f783dc92fe36e3ff2">IAX_IE_CODEC_PREFS</a>:
<a name="l00762"></a>00762          ies-&gt;<a class="code" href="structiax__ies.html#a8b5755e8142680babf7044c7e2642e29">codec_prefs</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00763"></a>00763          <span class="keywordflow">break</span>;
<a name="l00764"></a>00764       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#aa6bc44b17b9a99b1f91f205b9c2112bf">IAX_IE_CAPABILITY</a>:
<a name="l00765"></a>00765          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int)) {
<a name="l00766"></a>00766             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting capability to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00767"></a>00767             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00768"></a>00768          } <span class="keywordflow">else</span>
<a name="l00769"></a>00769             ies-&gt;<a class="code" href="structiax__ies.html#abc53d773b98b94081314ce6de8d61b04">capability</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00770"></a>00770          <span class="keywordflow">break</span>;
<a name="l00771"></a>00771       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a81b21fd8bbf4f19527fbb21277687bd5">IAX_IE_FORMAT</a>:
<a name="l00772"></a>00772          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00773"></a>00773             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting format to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00774"></a>00774             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00775"></a>00775          } <span class="keywordflow">else</span>
<a name="l00776"></a>00776             ies-&gt;<a class="code" href="structiax__ies.html#a6fea735e1b12f87689267ca76a7f4037">format</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00777"></a>00777          <span class="keywordflow">break</span>;
<a name="l00778"></a>00778       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a758c277d538d6a8ab6130a606df1ff7a">IAX_IE_LANGUAGE</a>:
<a name="l00779"></a>00779          ies-&gt;<a class="code" href="structiax__ies.html#a8ae4b47621b125e915cee8ccdaa2095c">language</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00780"></a>00780          <span class="keywordflow">break</span>;
<a name="l00781"></a>00781       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#aba2ed51c46cc5e0e09ab9da295eafc12">IAX_IE_VERSION</a>:
<a name="l00782"></a>00782          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short)) {
<a name="l00783"></a>00783             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp),  <span class="stringliteral">&quot;Expecting version to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00784"></a>00784             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00785"></a>00785          } <span class="keywordflow">else</span>
<a name="l00786"></a>00786             ies-&gt;<a class="code" href="structiax__ies.html#aad880fc4455c253781e8968f2239d56f">version</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00787"></a>00787          <span class="keywordflow">break</span>;
<a name="l00788"></a>00788       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a657e780d9d73b1f270b4434d19ac7a56">IAX_IE_ADSICPE</a>:
<a name="l00789"></a>00789          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00790"></a>00790             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting adsicpe to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00791"></a>00791             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00792"></a>00792          } <span class="keywordflow">else</span>
<a name="l00793"></a>00793             ies-&gt;<a class="code" href="structiax__ies.html#a07ca21361341fda1fca2d2fa67ea6bf4">adsicpe</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00794"></a>00794          <span class="keywordflow">break</span>;
<a name="l00795"></a>00795       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a24f965b8df49d388fc95a910714eb7c0">IAX_IE_SAMPLINGRATE</a>:
<a name="l00796"></a>00796          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00797"></a>00797             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting samplingrate to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00798"></a>00798             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00799"></a>00799          } <span class="keywordflow">else</span>
<a name="l00800"></a>00800             ies-&gt;<a class="code" href="structiax__ies.html#aa7e6b946115ac6e6a4decf48932c9abf">samprate</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00801"></a>00801          <span class="keywordflow">break</span>;
<a name="l00802"></a>00802       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a15784fe7e4dcbfeed0eeebe293878782">IAX_IE_DNID</a>:
<a name="l00803"></a>00803          ies-&gt;<a class="code" href="structiax__ies.html#a2a6880647fbfdf5fc8a74248d645589c">dnid</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00804"></a>00804          <span class="keywordflow">break</span>;
<a name="l00805"></a>00805       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a782e6d7b50cb8c4966f3c2979a9291df">IAX_IE_RDNIS</a>:
<a name="l00806"></a>00806          ies-&gt;<a class="code" href="structiax__ies.html#ae161ae5c75aa3dced11bcb9d2c7db674">rdnis</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00807"></a>00807          <span class="keywordflow">break</span>;
<a name="l00808"></a>00808       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#addd02aa42471088b1d38a0915b69c506">IAX_IE_AUTHMETHODS</a>:
<a name="l00809"></a>00809          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short))  {
<a name="l00810"></a>00810             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting authmethods to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00811"></a>00811             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00812"></a>00812          } <span class="keywordflow">else</span>
<a name="l00813"></a>00813             ies-&gt;<a class="code" href="structiax__ies.html#a23e4b8fa5e973ab5ee519df548401897">authmethods</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00814"></a>00814          <span class="keywordflow">break</span>;
<a name="l00815"></a>00815       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a82301ee077d892ac535637a33eeff904">IAX_IE_ENCRYPTION</a>:
<a name="l00816"></a>00816          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>))  {
<a name="l00817"></a>00817             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting encryption to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00818"></a>00818             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00819"></a>00819          } <span class="keywordflow">else</span>
<a name="l00820"></a>00820             ies-&gt;<a class="code" href="structiax__ies.html#a91fce818393dd09b9565b16568e991db">encmethods</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00821"></a>00821          <span class="keywordflow">break</span>;
<a name="l00822"></a>00822       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#afdfe925c29c3385317252633f5cf74d1">IAX_IE_CHALLENGE</a>:
<a name="l00823"></a>00823          ies-&gt;<a class="code" href="structiax__ies.html#a2929a7d62f294309a5126ccb738f6060">challenge</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00824"></a>00824          <span class="keywordflow">break</span>;
<a name="l00825"></a>00825       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ab019e7b283ca9d475618bab90e6ed8b7">IAX_IE_MD5_RESULT</a>:
<a name="l00826"></a>00826          ies-&gt;<a class="code" href="structiax__ies.html#a8312d1962ec7c4e621bc54d1a1604423">md5_result</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00827"></a>00827          <span class="keywordflow">break</span>;
<a name="l00828"></a>00828       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a3987a24c3026cd822133ae678ae0d924">IAX_IE_RSA_RESULT</a>:
<a name="l00829"></a>00829          ies-&gt;<a class="code" href="structiax__ies.html#a9f6e740e9f8b0cd5f02ccbcca34fcdfe">rsa_result</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00830"></a>00830          <span class="keywordflow">break</span>;
<a name="l00831"></a>00831       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ac0ffc43863d8212c5ddfe5ee71bbac9a">IAX_IE_APPARENT_ADDR</a>:
<a name="l00832"></a>00832          ies-&gt;<a class="code" href="structiax__ies.html#ae853c4fd16ea01a56ca46a7a6e83cd52">apparent_addr</a> = ((<span class="keyword">struct </span>sockaddr_in *)(data + 2));
<a name="l00833"></a>00833          <span class="keywordflow">break</span>;
<a name="l00834"></a>00834       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ac3c0ea95efa7bab2684e56443fc94d0a">IAX_IE_REFRESH</a>:
<a name="l00835"></a>00835          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short)) {
<a name="l00836"></a>00836             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp),  <span class="stringliteral">&quot;Expecting refresh to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00837"></a>00837             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00838"></a>00838          } <span class="keywordflow">else</span>
<a name="l00839"></a>00839             ies-&gt;<a class="code" href="structiax__ies.html#ab28395d53189be3496131ad9cf9a0a10">refresh</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00840"></a>00840          <span class="keywordflow">break</span>;
<a name="l00841"></a>00841       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a1f823cae4105f55cb634b2ae4d6fd61a">IAX_IE_DPSTATUS</a>:
<a name="l00842"></a>00842          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00843"></a>00843             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp),  <span class="stringliteral">&quot;Expecting dpstatus to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00844"></a>00844             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00845"></a>00845          } <span class="keywordflow">else</span>
<a name="l00846"></a>00846             ies-&gt;<a class="code" href="structiax__ies.html#a99983189eaa20f95b80f8aa3a53879b1">dpstatus</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00847"></a>00847          <span class="keywordflow">break</span>;
<a name="l00848"></a>00848       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ac0828e81d9d2d2cc0524ea44a8c654e2">IAX_IE_CALLNO</a>:
<a name="l00849"></a>00849          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00850"></a>00850             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp),  <span class="stringliteral">&quot;Expecting callno to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00851"></a>00851             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00852"></a>00852          } <span class="keywordflow">else</span>
<a name="l00853"></a>00853             ies-&gt;<a class="code" href="structiax__ies.html#a80cb2705f540fcd4a6d6276addb98819">callno</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00854"></a>00854          <span class="keywordflow">break</span>;
<a name="l00855"></a>00855       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a1e7246fa61f5cf1f9e4c6e85edc6f5b6">IAX_IE_CAUSE</a>:
<a name="l00856"></a>00856          ies-&gt;<a class="code" href="structiax__ies.html#aafb1a6fb6b61eddeaa9d3aa635858acc">cause</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00857"></a>00857          <span class="keywordflow">break</span>;
<a name="l00858"></a>00858       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ad59b2c2e074c261ca2bd7978343fb322">IAX_IE_CAUSECODE</a>:
<a name="l00859"></a>00859          <span class="keywordflow">if</span> (len != 1) {
<a name="l00860"></a>00860             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting causecode to be single byte but was %d\n&quot;</span>, len);
<a name="l00861"></a>00861             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00862"></a>00862          } <span class="keywordflow">else</span> {
<a name="l00863"></a>00863             ies-&gt;<a class="code" href="structiax__ies.html#a63efaaaa95c2ebe89b8533ecc499656b">causecode</a> = data[2];
<a name="l00864"></a>00864          }
<a name="l00865"></a>00865          <span class="keywordflow">break</span>;
<a name="l00866"></a>00866       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a4066d5e4a23fa85bcda90cf516a26ae5">IAX_IE_IAX_UNKNOWN</a>:
<a name="l00867"></a>00867          <span class="keywordflow">if</span> (len == 1)
<a name="l00868"></a>00868             ies-&gt;<a class="code" href="structiax__ies.html#a1b99a0cc0f25036bed643dac2c1abff5">iax_unknown</a> = data[2];
<a name="l00869"></a>00869          <span class="keywordflow">else</span> {
<a name="l00870"></a>00870             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected single byte Unknown command, but was %d long\n&quot;</span>, len);
<a name="l00871"></a>00871             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00872"></a>00872          }
<a name="l00873"></a>00873          <span class="keywordflow">break</span>;
<a name="l00874"></a>00874       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a3a1aee00db812d30993975c0d5ab3728">IAX_IE_MSGCOUNT</a>:
<a name="l00875"></a>00875          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00876"></a>00876             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting msgcount to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00877"></a>00877             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00878"></a>00878          } <span class="keywordflow">else</span>
<a name="l00879"></a>00879             ies-&gt;<a class="code" href="structiax__ies.html#a7060b2731bf71abb7fd8b9b1ebbb01c9">msgcount</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));   
<a name="l00880"></a>00880          <span class="keywordflow">break</span>;
<a name="l00881"></a>00881       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ab3a598f06cede6d1cd658908c4af76d0">IAX_IE_AUTOANSWER</a>:
<a name="l00882"></a>00882          ies-&gt;<a class="code" href="structiax__ies.html#aa682db27c8180700165db1398964b3c8">autoanswer</a> = 1;
<a name="l00883"></a>00883          <span class="keywordflow">break</span>;
<a name="l00884"></a>00884       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a7f969443a2a4d895cca23f969e5301dd">IAX_IE_MUSICONHOLD</a>:
<a name="l00885"></a>00885          ies-&gt;<a class="code" href="structiax__ies.html#ab220afb42ba31a5068247ff52b8ff56e">musiconhold</a> = 1;
<a name="l00886"></a>00886          <span class="keywordflow">break</span>;
<a name="l00887"></a>00887       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a26484916834eef30492cc1548209c863">IAX_IE_TRANSFERID</a>:
<a name="l00888"></a>00888          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00889"></a>00889             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting transferid to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00890"></a>00890             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00891"></a>00891          } <span class="keywordflow">else</span>
<a name="l00892"></a>00892             ies-&gt;<a class="code" href="structiax__ies.html#a5b080a99616f700383dff816ef563ae2">transferid</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00893"></a>00893          <span class="keywordflow">break</span>;
<a name="l00894"></a>00894       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a1d106f79be9f6e388fd852185a62a67f">IAX_IE_DATETIME</a>:
<a name="l00895"></a>00895          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00896"></a>00896             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting date/time to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00897"></a>00897             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00898"></a>00898          } <span class="keywordflow">else</span>
<a name="l00899"></a>00899             ies-&gt;<a class="code" href="structiax__ies.html#a5bfbcff4413aff01dc3ee342abeed0a2">datetime</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00900"></a>00900          <span class="keywordflow">break</span>;
<a name="l00901"></a>00901       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a8bfd7218b8db56daaa02741a45579bcb">IAX_IE_FIRMWAREVER</a>:
<a name="l00902"></a>00902          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00903"></a>00903             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting firmwarever to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00904"></a>00904             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00905"></a>00905          } <span class="keywordflow">else</span>
<a name="l00906"></a>00906             ies-&gt;<a class="code" href="structiax__ies.html#a6b9683ca47d524037ebe09bb62ff4010">firmwarever</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));   
<a name="l00907"></a>00907          <span class="keywordflow">break</span>;
<a name="l00908"></a>00908       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ad643d792f11f6db90010b8bc9370c62f">IAX_IE_DEVICETYPE</a>:
<a name="l00909"></a>00909          ies-&gt;<a class="code" href="structiax__ies.html#ad5fcf043f3db7ed14e6180f743d95b27">devicetype</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00910"></a>00910          <span class="keywordflow">break</span>;
<a name="l00911"></a>00911       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a15fc10bdbf713778c87c1fea05d7d157">IAX_IE_SERVICEIDENT</a>:
<a name="l00912"></a>00912          ies-&gt;<a class="code" href="structiax__ies.html#ac21dd7ebf66d8aa74c1f1b9be3883484">serviceident</a> = (<span class="keywordtype">char</span> *)data + 2;
<a name="l00913"></a>00913          <span class="keywordflow">break</span>;
<a name="l00914"></a>00914       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ae8bf4fc0764a2125546e77b9c0e5633a">IAX_IE_FWBLOCKDESC</a>:
<a name="l00915"></a>00915          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int)) {
<a name="l00916"></a>00916             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected block desc to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00917"></a>00917             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00918"></a>00918          } <span class="keywordflow">else</span>
<a name="l00919"></a>00919             ies-&gt;<a class="code" href="structiax__ies.html#a5332d70b47d044215dd8376a27d38080">fwdesc</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00920"></a>00920          <span class="keywordflow">break</span>;
<a name="l00921"></a>00921       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#aa5bb34c412f90c90c90851f9b696ad88">IAX_IE_FWBLOCKDATA</a>:
<a name="l00922"></a>00922          ies-&gt;<a class="code" href="structiax__ies.html#a93b844afa55f61deb4adb54d6d5c6054">fwdata</a> = data + 2;
<a name="l00923"></a>00923          ies-&gt;<a class="code" href="structiax__ies.html#aadf3f984d07de3f8cb36eae16de57436">fwdatalen</a> = len;
<a name="l00924"></a>00924          <span class="keywordflow">break</span>;
<a name="l00925"></a>00925       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a50706834e0901505439450c323c659f4">IAX_IE_ENCKEY</a>:
<a name="l00926"></a>00926          ies-&gt;<a class="code" href="structiax__ies.html#a4665b33417c4f5f146bd833d4b02c16e">enckey</a> = data + 2;
<a name="l00927"></a>00927          ies-&gt;<a class="code" href="structiax__ies.html#ae4b42ead49a67cf74a06eb036d63a335">enckeylen</a> = len;
<a name="l00928"></a>00928          <span class="keywordflow">break</span>;
<a name="l00929"></a>00929       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ac4d8123a84fa8ee289dc1d07de912930">IAX_IE_PROVVER</a>:
<a name="l00930"></a>00930          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00931"></a>00931             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected provisioning version to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00932"></a>00932             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00933"></a>00933          } <span class="keywordflow">else</span> {
<a name="l00934"></a>00934             ies-&gt;<a class="code" href="structiax__ies.html#a86275d095709be06b32c7447d7bbabb9">provverpres</a> = 1;
<a name="l00935"></a>00935             ies-&gt;<a class="code" href="structiax__ies.html#a0eaa250f80df1e07e6613ed6814af9a9">provver</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00936"></a>00936          }
<a name="l00937"></a>00937          <span class="keywordflow">break</span>;
<a name="l00938"></a>00938       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ad467d714d8713c98eda20b5c036c5c4d">IAX_IE_CALLINGPRES</a>:
<a name="l00939"></a>00939          <span class="keywordflow">if</span> (len == 1)
<a name="l00940"></a>00940             ies-&gt;<a class="code" href="structiax__ies.html#aa16fb44247d3656e98d82796a24c0ec6">calling_pres</a> = data[2];
<a name="l00941"></a>00941          <span class="keywordflow">else</span> {
<a name="l00942"></a>00942             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected single byte callingpres, but was %d long\n&quot;</span>, len);
<a name="l00943"></a>00943             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00944"></a>00944          }
<a name="l00945"></a>00945          <span class="keywordflow">break</span>;
<a name="l00946"></a>00946       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#af1c412a0c60a9b1fb6aaa6726fba088e">IAX_IE_CALLINGTON</a>:
<a name="l00947"></a>00947          <span class="keywordflow">if</span> (len == 1)
<a name="l00948"></a>00948             ies-&gt;<a class="code" href="structiax__ies.html#a57eabf92fe7c9f440fe38fb529c57f91">calling_ton</a> = data[2];
<a name="l00949"></a>00949          <span class="keywordflow">else</span> {
<a name="l00950"></a>00950             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected single byte callington, but was %d long\n&quot;</span>, len);
<a name="l00951"></a>00951             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00952"></a>00952          }
<a name="l00953"></a>00953          <span class="keywordflow">break</span>;
<a name="l00954"></a>00954       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a37ecb07d951c76538b9492849d9ef2c6">IAX_IE_CALLINGTNS</a>:
<a name="l00955"></a>00955          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00956"></a>00956             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expecting callingtns to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00957"></a>00957             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00958"></a>00958          } <span class="keywordflow">else</span>
<a name="l00959"></a>00959             ies-&gt;<a class="code" href="structiax__ies.html#a7ab4a847c94ceca414d76c2abe5587aa">calling_tns</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));   
<a name="l00960"></a>00960          <span class="keywordflow">break</span>;
<a name="l00961"></a>00961                <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a100faac82e7a555b80800464d51552f3">IAX_IE_RR_JITTER</a>:
<a name="l00962"></a>00962                        <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00963"></a>00963                                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected jitter rr to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00964"></a>00964                                <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00965"></a>00965                        } <span class="keywordflow">else</span> {
<a name="l00966"></a>00966                                ies-&gt;<a class="code" href="structiax__ies.html#a080276071d3f1453a3ff09eb12dc7be5">rr_jitter</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00967"></a>00967                        }
<a name="l00968"></a>00968                        <span class="keywordflow">break</span>;
<a name="l00969"></a>00969                <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#ae75f46f96732b97c840acf7fcad50ccb">IAX_IE_RR_LOSS</a>:
<a name="l00970"></a>00970                        <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00971"></a>00971                                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected loss rr to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00972"></a>00972                                <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00973"></a>00973                        } <span class="keywordflow">else</span> {
<a name="l00974"></a>00974                                ies-&gt;<a class="code" href="structiax__ies.html#a1ead91972465bf96d2e22e175f0451e6">rr_loss</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00975"></a>00975                        }
<a name="l00976"></a>00976                        <span class="keywordflow">break</span>;
<a name="l00977"></a>00977                <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a08a91f2b8fdd4126433d23fb4b740a3c">IAX_IE_RR_PKTS</a>:
<a name="l00978"></a>00978                        <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00979"></a>00979                                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected packets rr to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00980"></a>00980                                <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00981"></a>00981                        } <span class="keywordflow">else</span> {
<a name="l00982"></a>00982                                ies-&gt;<a class="code" href="structiax__ies.html#a12dbd4506d9440630fbc064c7eaac5d7">rr_pkts</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00983"></a>00983                        }
<a name="l00984"></a>00984                        <span class="keywordflow">break</span>;
<a name="l00985"></a>00985                <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#afff7da2dbd90c2c0a92ae1dbfdfaee46">IAX_IE_RR_DELAY</a>:
<a name="l00986"></a>00986                        <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)) {
<a name="l00987"></a>00987                                snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected loss rr to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), len);
<a name="l00988"></a>00988                         <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00989"></a>00989                        } <span class="keywordflow">else</span> {
<a name="l00990"></a>00990                                ies-&gt;<a class="code" href="structiax__ies.html#ae1c0ba6c72f9ff39b2a31183bfe8f63c">rr_delay</a> = ntohs(<a class="code" href="unaligned_8h.html#aa4e7c12e3e86ceccab7309f71c29f0ea">get_unaligned_uint16</a>(data + 2));
<a name="l00991"></a>00991                        }
<a name="l00992"></a>00992                        <span class="keywordflow">break</span>;
<a name="l00993"></a>00993       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a7d903c665bc2b4ffcf30491cd1c3bf44">IAX_IE_RR_DROPPED</a>:
<a name="l00994"></a>00994          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l00995"></a>00995             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected packets rr to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l00996"></a>00996             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l00997"></a>00997          } <span class="keywordflow">else</span> {
<a name="l00998"></a>00998             ies-&gt;<a class="code" href="structiax__ies.html#a603c4be1ba3662978da1ef517995af10">rr_dropped</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l00999"></a>00999          }
<a name="l01000"></a>01000          <span class="keywordflow">break</span>;
<a name="l01001"></a>01001       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#abe860b9fd18425323db7b4b42b4fb563">IAX_IE_RR_OOO</a>:
<a name="l01002"></a>01002          <span class="keywordflow">if</span> (len != (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)) {
<a name="l01003"></a>01003             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected packets rr to be %d bytes long but was %d\n&quot;</span>, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), len);
<a name="l01004"></a>01004             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l01005"></a>01005          } <span class="keywordflow">else</span> {
<a name="l01006"></a>01006             ies-&gt;<a class="code" href="structiax__ies.html#accda334a94b4f129ecdd0b9ad87bc423">rr_ooo</a> = ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(data + 2));
<a name="l01007"></a>01007          }
<a name="l01008"></a>01008          <span class="keywordflow">break</span>;
<a name="l01009"></a>01009       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a6ec683aa068fc1d484a7abcca1ef600b">IAX_IE_VARIABLE</a>:
<a name="l01010"></a>01010          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(tmp, (<span class="keywordtype">char</span> *)data + 2, len + 1);
<a name="l01011"></a>01011          tmp2 = strchr(tmp, <span class="charliteral">&apos;=&apos;</span>);
<a name="l01012"></a>01012          <span class="keywordflow">if</span> (tmp2)
<a name="l01013"></a>01013             *tmp2++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01014"></a>01014          <span class="keywordflow">else</span>
<a name="l01015"></a>01015             tmp2 = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01016"></a>01016          {
<a name="l01017"></a>01017             <span class="keyword">struct </span><a class="code" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a> *<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="strings_8h.html#a8ec37e4acb6ecb20eb6f6edd1141cd76" title="Create a malloc&amp;#39;ed dynamic length string.">ast_str_create</a>(16);
<a name="l01018"></a>01018             <span class="comment">/* Existing variable or new variable? */</span>
<a name="l01019"></a>01019             <span class="keywordflow">for</span> (var2 = ies-&gt;<a class="code" href="structiax__ies.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>, prev = NULL; var2; prev = var2, var2 = var2-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l01020"></a>01020                <span class="keywordflow">if</span> (strcmp(tmp, var2-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>) == 0) {
<a name="l01021"></a>01021                   <a class="code" href="strings_8h.html#a4a3222f04f84c80a1d70f51e2dff00ea" title="Set a dynamic string using variable arguments.">ast_str_set</a>(&amp;str, 0, <span class="stringliteral">&quot;%s%s&quot;</span>, var2-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, tmp2);
<a name="l01022"></a>01022                   var = <a class="code" href="config_8h.html#a08e94d96f459e7301a74daf32035423b">ast_variable_new</a>(tmp, <a class="code" href="strings_8h.html#a053bdfc229997a75f112bdd7b995e00b" title="Returns the string buffer within the ast_str buf.">ast_str_buffer</a>(str), var2-&gt;<a class="code" href="structast__variable.html#adf16cd437526a5c5e0e0af87745acbb8">file</a>);
<a name="l01023"></a>01023                   var-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a> = var2-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>;
<a name="l01024"></a>01024                   <span class="keywordflow">if</span> (prev) {
<a name="l01025"></a>01025                      prev-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a> = var;
<a name="l01026"></a>01026                   } <span class="keywordflow">else</span> {
<a name="l01027"></a>01027                      ies-&gt;<a class="code" href="structiax__ies.html#a134fe67053d035e763d6cf99916c1bf8">vars</a> = var;
<a name="l01028"></a>01028                   }
<a name="l01029"></a>01029                   snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Assigned (%p)%s to (%p)%s\n&quot;</span>, var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l01030"></a>01030                   <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l01031"></a>01031                   <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(var2);
<a name="l01032"></a>01032                   <span class="keywordflow">break</span>;
<a name="l01033"></a>01033                }
<a name="l01034"></a>01034             }
<a name="l01035"></a>01035             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(str);
<a name="l01036"></a>01036          }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038          <span class="keywordflow">if</span> (!var2) {
<a name="l01039"></a>01039             var = <a class="code" href="config_8h.html#a08e94d96f459e7301a74daf32035423b">ast_variable_new</a>(tmp, tmp2, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01040"></a>01040             snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Assigned (%p)%s to (%p)%s\n&quot;</span>, var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l01041"></a>01041             <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l01042"></a>01042             var-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a> = ies-&gt;<a class="code" href="structiax__ies.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>;
<a name="l01043"></a>01043             ies-&gt;<a class="code" href="structiax__ies.html#a134fe67053d035e763d6cf99916c1bf8">vars</a> = var;
<a name="l01044"></a>01044          }
<a name="l01045"></a>01045          <span class="keywordflow">break</span>;
<a name="l01046"></a>01046       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a739827413438b153d6fecb939f938771">IAX_IE_OSPTOKEN</a>:
<a name="l01047"></a>01047          <span class="keywordflow">if</span> ((count = data[2]) &lt; <a class="code" href="iax2_8h.html#ac5ec2eb1824053498ea1d9aaf6d85793">IAX_MAX_OSPBLOCK_NUM</a>) {
<a name="l01048"></a>01048             ies-&gt;<a class="code" href="structiax__ies.html#af5b31290a66339ea3d76c1a8735f4f5a">osptokenblock</a>[count] = (<span class="keywordtype">char</span> *)data + 2 + 1;
<a name="l01049"></a>01049             ies-&gt;<a class="code" href="structiax__ies.html#a6f573c32d646cf725e7fc1709c49d5d4">ospblocklength</a>[count] = len - 1;
<a name="l01050"></a>01050          } <span class="keywordflow">else</span> {
<a name="l01051"></a>01051             snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Expected OSP token block index to be 0~%d but was %d\n&quot;</span>, <a class="code" href="iax2_8h.html#ac5ec2eb1824053498ea1d9aaf6d85793">IAX_MAX_OSPBLOCK_NUM</a> - 1, count);
<a name="l01052"></a>01052             <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(tmp);
<a name="l01053"></a>01053          }
<a name="l01054"></a>01054          <span class="keywordflow">break</span>;
<a name="l01055"></a>01055       <span class="keywordflow">case</span> <a class="code" href="iax2_8h.html#a2e6cad4127d6f7a21d8a8820d5f5bf14">IAX_IE_CALLTOKEN</a>:
<a name="l01056"></a>01056          <span class="keywordflow">if</span> (len) {
<a name="l01057"></a>01057             ies-&gt;<a class="code" href="structiax__ies.html#a119ad7b93a7881e4bf3a15272e509b8e">calltokendata</a> = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) data + 2;
<a name="l01058"></a>01058          }
<a name="l01059"></a>01059          ies-&gt;<a class="code" href="structiax__ies.html#a15e68c5804dbbb3cb4bc693a965426ee">calltoken</a> = 1;
<a name="l01060"></a>01060          <span class="keywordflow">break</span>;
<a name="l01061"></a>01061       <span class="keywordflow">default</span>:
<a name="l01062"></a>01062          snprintf(tmp, (<span class="keywordtype">int</span>)<span class="keyword">sizeof</span>(tmp), <span class="stringliteral">&quot;Ignoring unknown information element &apos;%s&apos; (%d) of length %d\n&quot;</span>, <a class="code" href="iax2-parser_8c.html#a721c7ff90c2590abc60ef8057a2c8fd5">iax_ie2str</a>(ie), ie, len);
<a name="l01063"></a>01063          <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l01064"></a>01064       }
<a name="l01065"></a>01065       <span class="comment">/* Overwrite information element with 0, to null terminate previous portion */</span>
<a name="l01066"></a>01066       data[0] = 0;
<a name="l01067"></a>01067       datalen -= (len + 2);
<a name="l01068"></a>01068       data += (len + 2);
<a name="l01069"></a>01069    }
<a name="l01070"></a>01070    <span class="comment">/* Null-terminate last field */</span>
<a name="l01071"></a>01071    *data = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01072"></a>01072    <span class="keywordflow">if</span> (datalen) {
<a name="l01073"></a>01073       <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>(<span class="stringliteral">&quot;Invalid information element contents, strange boundary\n&quot;</span>);
<a name="l01074"></a>01074       <span class="keywordflow">return</span> -1;
<a name="l01075"></a>01075    }
<a name="l01076"></a>01076    <span class="keywordflow">return</span> 0;
<a name="l01077"></a>01077 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6b6a249db189867d6e8c66f88c035097"></a><!-- doxytag: member="iax2&#45;parser.c::iax_set_error" ref="a6b6a249db189867d6e8c66f88c035097" args="(void(*func)(const char *))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax_set_error </td>
          <td>(</td>
          <td class="paramtype">void(*)(const char *)&nbsp;</td>
          <td class="paramname"> <em>func</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00712">712</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l13805">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00713"></a>00713 {
<a name="l00714"></a>00714    <a class="code" href="iax2-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a> = func;
<a name="l00715"></a>00715 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7dfa14e449512cc3937a0d8dd596aee5"></a><!-- doxytag: member="iax2&#45;parser.c::iax_set_output" ref="a7dfa14e449512cc3937a0d8dd596aee5" args="(void(*func)(const char *))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax_set_output </td>
          <td>(</td>
          <td class="paramtype">void(*)(const char *)&nbsp;</td>
          <td class="paramname"> <em>func</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00707">707</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l13805">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00708"></a>00708 {
<a name="l00709"></a>00709    <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a> = func;
<a name="l00710"></a>00710 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2865d35dffad22a73ab8f0ef67db8b99"></a><!-- doxytag: member="iax2&#45;parser.c::iax_showframe" ref="a2865d35dffad22a73ab8f0ef67db8b99" args="(struct iax_frame *f, struct ast_iax2_full_hdr *fhi, int rx, struct sockaddr_in *sin, int datalen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax_showframe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structiax__frame.html">iax_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__iax2__full__hdr.html">ast_iax2_full_hdr</a> *&nbsp;</td>
          <td class="paramname"> <em>fhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>sin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>datalen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00543">543</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h_source.html#l00122">AST_FRAME_DTMF_BEGIN</a>, <a class="el" href="frame_8h_source.html#l00099">AST_FRAME_DTMF_END</a>, <a class="el" href="frame_8h_source.html#l00109">AST_FRAME_IAX</a>, <a class="el" href="utils_8c_source.html#l00431">ast_inet_ntoa()</a>, <a class="el" href="iax2_8h_source.html#l00222">ast_iax2_full_hdr::csub</a>, <a class="el" href="iax2-parser_8h_source.html#l00100">iax_frame::data</a>, <a class="el" href="iax2_8h_source.html#l00217">ast_iax2_full_hdr::dcallno</a>, <a class="el" href="adsistub_8c_source.html#l00077">dir</a>, <a class="el" href="iax2-parser_8c_source.html#l00365">dump_ies()</a>, <a class="el" href="iax2_8h_source.html#l00036">IAX_FLAG_FULL</a>, <a class="el" href="iax2_8h_source.html#l00038">IAX_FLAG_RETRANS</a>, <a class="el" href="iax2-parser_8c_source.html#l00411">iax_frame_subclass2str()</a>, <a class="el" href="iax2_8h_source.html#l00223">ast_iax2_full_hdr::iedata</a>, <a class="el" href="iax2_8h_source.html#l00220">ast_iax2_full_hdr::iseqno</a>, <a class="el" href="iax2_8h_source.html#l00219">ast_iax2_full_hdr::oseqno</a>, <a class="el" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>, <a class="el" href="iax2-parser_8h_source.html#l00104">iax_frame::retries</a>, <a class="el" href="iax2_8h_source.html#l00216">ast_iax2_full_hdr::scallno</a>, <a class="el" href="iax2_8h_source.html#l00218">ast_iax2_full_hdr::ts</a>, and <a class="el" href="iax2_8h_source.html#l00221">ast_iax2_full_hdr::type</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l01045">iax_outputframe()</a>, and <a class="el" href="chan__iax2_8c_source.html#l03164">send_packet()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00544"></a>00544 {
<a name="l00545"></a>00545    <span class="keyword">const</span> <span class="keywordtype">char</span> *framelist[] = {
<a name="l00546"></a>00546       <span class="stringliteral">&quot;(0?)&quot;</span>,
<a name="l00547"></a>00547       <span class="stringliteral">&quot;DTMF_E &quot;</span>,
<a name="l00548"></a>00548       <span class="stringliteral">&quot;VOICE  &quot;</span>,
<a name="l00549"></a>00549       <span class="stringliteral">&quot;VIDEO  &quot;</span>,
<a name="l00550"></a>00550       <span class="stringliteral">&quot;CONTROL&quot;</span>,
<a name="l00551"></a>00551       <span class="stringliteral">&quot;NULL   &quot;</span>,
<a name="l00552"></a>00552       <span class="stringliteral">&quot;IAX    &quot;</span>,
<a name="l00553"></a>00553       <span class="stringliteral">&quot;TEXT   &quot;</span>,
<a name="l00554"></a>00554       <span class="stringliteral">&quot;IMAGE  &quot;</span>,
<a name="l00555"></a>00555       <span class="stringliteral">&quot;HTML   &quot;</span>,
<a name="l00556"></a>00556       <span class="stringliteral">&quot;CNG    &quot;</span>,
<a name="l00557"></a>00557       <span class="stringliteral">&quot;MODEM  &quot;</span>,
<a name="l00558"></a>00558       <span class="stringliteral">&quot;DTMF_B &quot;</span>,
<a name="l00559"></a>00559    };
<a name="l00560"></a>00560    <span class="keyword">const</span> <span class="keywordtype">char</span> *cmds[] = {
<a name="l00561"></a>00561       <span class="stringliteral">&quot;(0?)&quot;</span>,
<a name="l00562"></a>00562       <span class="stringliteral">&quot;HANGUP &quot;</span>,
<a name="l00563"></a>00563       <span class="stringliteral">&quot;RING   &quot;</span>,
<a name="l00564"></a>00564       <span class="stringliteral">&quot;RINGING&quot;</span>,
<a name="l00565"></a>00565       <span class="stringliteral">&quot;ANSWER &quot;</span>,
<a name="l00566"></a>00566       <span class="stringliteral">&quot;BUSY   &quot;</span>,
<a name="l00567"></a>00567       <span class="stringliteral">&quot;TKOFFHK&quot;</span>,
<a name="l00568"></a>00568       <span class="stringliteral">&quot;OFFHOOK&quot;</span>,
<a name="l00569"></a>00569       <span class="stringliteral">&quot;CONGSTN&quot;</span>,
<a name="l00570"></a>00570       <span class="stringliteral">&quot;FLASH  &quot;</span>,
<a name="l00571"></a>00571       <span class="stringliteral">&quot;WINK   &quot;</span>,
<a name="l00572"></a>00572       <span class="stringliteral">&quot;OPTION &quot;</span>,
<a name="l00573"></a>00573       <span class="stringliteral">&quot;RDKEY  &quot;</span>,
<a name="l00574"></a>00574       <span class="stringliteral">&quot;RDUNKEY&quot;</span>,
<a name="l00575"></a>00575       <span class="stringliteral">&quot;PROGRES&quot;</span>,
<a name="l00576"></a>00576       <span class="stringliteral">&quot;PROCDNG&quot;</span>,
<a name="l00577"></a>00577       <span class="stringliteral">&quot;HOLD   &quot;</span>,
<a name="l00578"></a>00578       <span class="stringliteral">&quot;UNHOLD &quot;</span>,
<a name="l00579"></a>00579       <span class="stringliteral">&quot;VIDUPDT&quot;</span>,
<a name="l00580"></a>00580       <span class="stringliteral">&quot;T38    &quot;</span>,
<a name="l00581"></a>00581       <span class="stringliteral">&quot;SRCUPDT&quot;</span>,
<a name="l00582"></a>00582    };
<a name="l00583"></a>00583    <span class="keyword">struct </span><a class="code" href="structast__iax2__full__hdr.html">ast_iax2_full_hdr</a> *fh;
<a name="l00584"></a>00584    <span class="keywordtype">char</span> retries[20];
<a name="l00585"></a>00585    <span class="keywordtype">char</span> class2[20];
<a name="l00586"></a>00586    <span class="keywordtype">char</span> subclass2[20];
<a name="l00587"></a>00587    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">class</span>;
<a name="l00588"></a>00588    <span class="keyword">const</span> <span class="keywordtype">char</span> *subclass;
<a name="l00589"></a>00589    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#a946c6fe93168120f0fa86002b4e9d575">dir</a>;
<a name="l00590"></a>00590    <span class="keywordtype">char</span> tmp[512];
<a name="l00591"></a>00591 
<a name="l00592"></a>00592    <span class="keywordflow">switch</span>(rx) {
<a name="l00593"></a>00593    <span class="keywordflow">case</span> 0:
<a name="l00594"></a>00594       dir = <span class="stringliteral">&quot;Tx&quot;</span>;
<a name="l00595"></a>00595       <span class="keywordflow">break</span>;
<a name="l00596"></a>00596    <span class="keywordflow">case</span> 2:
<a name="l00597"></a>00597       dir = <span class="stringliteral">&quot;TE&quot;</span>;
<a name="l00598"></a>00598       <span class="keywordflow">break</span>;
<a name="l00599"></a>00599    <span class="keywordflow">case</span> 3:
<a name="l00600"></a>00600       dir = <span class="stringliteral">&quot;RD&quot;</span>;
<a name="l00601"></a>00601       <span class="keywordflow">break</span>;
<a name="l00602"></a>00602    <span class="keywordflow">default</span>:
<a name="l00603"></a>00603       dir = <span class="stringliteral">&quot;Rx&quot;</span>;
<a name="l00604"></a>00604       <span class="keywordflow">break</span>;
<a name="l00605"></a>00605    }
<a name="l00606"></a>00606    <span class="keywordflow">if</span> (f) {
<a name="l00607"></a>00607       fh = f-&gt;<a class="code" href="structiax__frame.html#a735984d41155bc1032e09bece8f8d66d">data</a>;
<a name="l00608"></a>00608       snprintf(retries, <span class="keyword">sizeof</span>(retries), <span class="stringliteral">&quot;%03d&quot;</span>, f-&gt;<a class="code" href="structiax__frame.html#a8ba735ab56b2afeb844916994c86f3f5">retries</a>);
<a name="l00609"></a>00609    } <span class="keywordflow">else</span> {
<a name="l00610"></a>00610       fh = fhi;
<a name="l00611"></a>00611       <span class="keywordflow">if</span> (ntohs(fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a1af9c60d2317000d8de8f5a746900015">dcallno</a>) &amp; <a class="code" href="iax2_8h.html#a9c7b219ff307b8867b301264fd443c62">IAX_FLAG_RETRANS</a>)
<a name="l00612"></a>00612          strcpy(retries, <span class="stringliteral">&quot;Yes&quot;</span>);
<a name="l00613"></a>00613       <span class="keywordflow">else</span>
<a name="l00614"></a>00614          strcpy(retries, <span class="stringliteral">&quot; No&quot;</span>);
<a name="l00615"></a>00615    }
<a name="l00616"></a>00616    <span class="keywordflow">if</span> (!(ntohs(fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a2640b46953901875b712fd2416abca6b">scallno</a>) &amp; <a class="code" href="iax2_8h.html#a7968f5206ddf50157fd5a89cc8243594">IAX_FLAG_FULL</a>)) {
<a name="l00617"></a>00617       <span class="comment">/* Don&apos;t mess with mini-frames */</span>
<a name="l00618"></a>00618       <span class="keywordflow">return</span>;
<a name="l00619"></a>00619    }
<a name="l00620"></a>00620    <span class="keywordflow">if</span> (fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a> &gt;= <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(framelist)) {
<a name="l00621"></a>00621       snprintf(class2, <span class="keyword">sizeof</span>(class2), <span class="stringliteral">&quot;(%d?)&quot;</span>, fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a>);
<a name="l00622"></a>00622       <span class="keyword">class </span>= class2;
<a name="l00623"></a>00623    } <span class="keywordflow">else</span> {
<a name="l00624"></a>00624       <span class="keyword">class </span>= framelist[(int)fh-&gt;<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>];
<a name="l00625"></a>00625    }
<a name="l00626"></a>00626    <span class="keywordflow">if</span> (fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a9b350360a64b55c7590f1ec03db480be">AST_FRAME_DTMF_BEGIN</a> || fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b">AST_FRAME_DTMF_END</a>) {
<a name="l00627"></a>00627       sprintf(subclass2, <span class="stringliteral">&quot;%c&quot;</span>, fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a73182c303ad7f5aab20b65f13efa2582">csub</a>);
<a name="l00628"></a>00628       subclass = subclass2;
<a name="l00629"></a>00629    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a7f7e5bdc9f8a8ef45c4d078f96b52624">AST_FRAME_IAX</a>) {
<a name="l00630"></a>00630          <a class="code" href="iax2-parser_8c.html#a28158f904f6769628409254d45a266a1">iax_frame_subclass2str</a>((<span class="keywordtype">int</span>)fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a73182c303ad7f5aab20b65f13efa2582">csub</a>, subclass2, <span class="keyword">sizeof</span>(subclass2));
<a name="l00631"></a>00631          subclass = subclass2;
<a name="l00632"></a>00632    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>) {
<a name="l00633"></a>00633       <span class="keywordflow">if</span> (fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a73182c303ad7f5aab20b65f13efa2582">csub</a> &gt;= <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cmds)) {
<a name="l00634"></a>00634          snprintf(subclass2, <span class="keyword">sizeof</span>(subclass2), <span class="stringliteral">&quot;(%d?)&quot;</span>, fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a73182c303ad7f5aab20b65f13efa2582">csub</a>);
<a name="l00635"></a>00635          subclass = subclass2;
<a name="l00636"></a>00636       } <span class="keywordflow">else</span> {
<a name="l00637"></a>00637          subclass = cmds[(int)fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a73182c303ad7f5aab20b65f13efa2582">csub</a>];
<a name="l00638"></a>00638       }
<a name="l00639"></a>00639    } <span class="keywordflow">else</span> {
<a name="l00640"></a>00640       snprintf(subclass2, <span class="keyword">sizeof</span>(subclass2), <span class="stringliteral">&quot;%d&quot;</span>, fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a73182c303ad7f5aab20b65f13efa2582">csub</a>);
<a name="l00641"></a>00641       subclass = subclass2;
<a name="l00642"></a>00642    }
<a name="l00643"></a>00643    snprintf(tmp, <span class="keyword">sizeof</span>(tmp), 
<a name="l00644"></a>00644        <span class="stringliteral">&quot;%s-Frame Retry[%s] -- OSeqno: %3.3d ISeqno: %3.3d Type: %s Subclass: %s\n&quot;</span>,
<a name="l00645"></a>00645        dir,
<a name="l00646"></a>00646        retries, fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a9887965bdbba3acab90015e43cde575a">oseqno</a>, fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a69fdde8d8d12a358d2a608b2c821454b">iseqno</a>, <span class="keyword">class</span>, subclass);
<a name="l00647"></a>00647    <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l00648"></a>00648    snprintf(tmp, <span class="keyword">sizeof</span>(tmp), 
<a name="l00649"></a>00649        <span class="stringliteral">&quot;   Timestamp: %05lums  SCall: %5.5d  DCall: %5.5d [%s:%d]\n&quot;</span>,
<a name="l00650"></a>00650        (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)ntohl(fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a5b83e949350cb6c2cdf2bcc8871d5d18">ts</a>),
<a name="l00651"></a>00651        ntohs(fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a2640b46953901875b712fd2416abca6b">scallno</a>) &amp; ~<a class="code" href="iax2_8h.html#a7968f5206ddf50157fd5a89cc8243594">IAX_FLAG_FULL</a>, ntohs(fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a1af9c60d2317000d8de8f5a746900015">dcallno</a>) &amp; ~<a class="code" href="iax2_8h.html#a9c7b219ff307b8867b301264fd443c62">IAX_FLAG_RETRANS</a>,
<a name="l00652"></a>00652        <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(sin-&gt;sin_addr), ntohs(sin-&gt;sin_port));
<a name="l00653"></a>00653    <a class="code" href="iax2-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>(tmp);
<a name="l00654"></a>00654    <span class="keywordflow">if</span> (fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#aa5044999f3339d2ba3b1bf22fa6cfe95">type</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a7f7e5bdc9f8a8ef45c4d078f96b52624">AST_FRAME_IAX</a>)
<a name="l00655"></a>00655       <a class="code" href="iax2-parser_8c.html#a574433590c08bd9b8eb0646cba35c731">dump_ies</a>(fh-&gt;<a class="code" href="structast__iax2__full__hdr.html#a06ffed4776045e012eec04fa40c9d3b7">iedata</a>, datalen);
<a name="l00656"></a>00656 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa2f9a933ed930ced2a59dfe7ffd00537"></a><!-- doxytag: member="iax2&#45;parser.c::internalerror" ref="aa2f9a933ed930ced2a59dfe7ffd00537" args="(const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void internalerror </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00072">72</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00073"></a>00073 {
<a name="l00074"></a>00074    fprintf(stderr, <span class="stringliteral">&quot;WARNING: %s&quot;</span>, <a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00075"></a>00075 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adc5133b4c0d70e8f71d2d1f8d121b864"></a><!-- doxytag: member="iax2&#45;parser.c::internaloutput" ref="adc5133b4c0d70e8f71d2d1f8d121b864" args="(const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void internaloutput </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00067">67</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00068"></a>00068 {
<a name="l00069"></a>00069    fputs(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, stdout);
<a name="l00070"></a>00070 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a3ef91a3a0758e782c0fae24cd423b1b5"></a><!-- doxytag: member="iax2&#45;parser.c::errorf" ref="a3ef91a3a0758e782c0fae24cd423b1b5" args=")(const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="dundi-parser_8c.html#a3ef91a3a0758e782c0fae24cd423b1b5">errorf</a>)(const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) = internalerror<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l01168">iax_frame_free()</a>, <a class="el" href="iax2-parser_8c_source.html#l00658">iax_ie_append_raw()</a>, <a class="el" href="iax2-parser_8c_source.html#l00717">iax_parse_ies()</a>, and <a class="el" href="iax2-parser_8c_source.html#l00712">iax_set_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a61217d5bc9d5b446d9c08e7ca401b733"></a><!-- doxytag: member="iax2&#45;parser.c::frames" ref="a61217d5bc9d5b446d9c08e7ca401b733" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="iax2-parser_8c.html#a61217d5bc9d5b446d9c08e7ca401b733">frames</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00045">45</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l01850">__ast_answer()</a>, <a class="el" href="channel_8c_source.html#l00991">__ast_queue_frame()</a>, <a class="el" href="frame_8c_source.html#l00333">__frame_free()</a>, <a class="el" href="frame_8c_source.html#l00291">ast_frame_header_new()</a>, <a class="el" href="frame_8c_source.html#l00474">ast_frdup()</a>, <a class="el" href="fixedjitterbuf_8c_source.html#l00290">fixed_jb_get()</a>, <a class="el" href="frame_8c_source.html#l00321">frame_cache_cleanup()</a>, and <a class="el" href="jitterbuf_8c_source.html#l00319">queue_put()</a>.</p>

</div>
</div>
<a class="anchor" id="a4a94e1f2fcd545095095ed8773a7a31a"></a><!-- doxytag: member="iax2&#45;parser.c::iframes" ref="a4a94e1f2fcd545095095ed8773a7a31a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="iax2-parser_8c.html#a4a94e1f2fcd545095095ed8773a7a31a">iframes</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00046">46</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3dd967af3ebc9b54f3f81e9f95f1dab1"></a><!-- doxytag: member="iax2&#45;parser.c::infoelts" ref="a3dd967af3ebc9b54f3f81e9f95f1dab1" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structiax2__ie.html">iax2_ie</a>  <a class="el" href="dundi-parser_8c.html#a8d39b5ff4318333ee162a62251045cf4">infoelts</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l00365">dump_ies()</a>, and <a class="el" href="iax2-parser_8c_source.html#l00302">iax_ie2str()</a>.</p>

</div>
</div>
<a class="anchor" id="a785b37b3e12c475bfe912f87ca09e236"></a><!-- doxytag: member="iax2&#45;parser.c::oframes" ref="a785b37b3e12c475bfe912f87ca09e236" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="iax2-parser_8c.html#a785b37b3e12c475bfe912f87ca09e236">oframes</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00047">47</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

</div>
</div>
<a class="anchor" id="a687f0ce64511bf149cb22d7eba257556"></a><!-- doxytag: member="iax2&#45;parser.c::outputf" ref="a687f0ce64511bf149cb22d7eba257556" args=")(const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="dundi-parser_8c.html#a687f0ce64511bf149cb22d7eba257556">outputf</a>)(const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) = internaloutput<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="iax2-parser_8c_source.html#l00365">dump_ies()</a>, <a class="el" href="iax2-parser_8c_source.html#l00717">iax_parse_ies()</a>, <a class="el" href="iax2-parser_8c_source.html#l00707">iax_set_output()</a>, and <a class="el" href="iax2-parser_8c_source.html#l00543">iax_showframe()</a>.</p>

</div>
</div>
<a class="anchor" id="a7d7ab1c8aba01cfb8e99ae306ee3b4d7"></a><!-- doxytag: member="iax2&#45;parser.c::prov_ies" ref="a7d7ab1c8aba01cfb8e99ae306ee3b4d7" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structiax2__ie.html">iax2_ie</a> <a class="el" href="iax2-parser_8c.html#a7d7ab1c8aba01cfb8e99ae306ee3b4d7">prov_ies</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="iax2-parser_8c_source.html#l00282">282</a> of file <a class="el" href="iax2-parser_8c_source.html">iax2-parser.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:22:12 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
