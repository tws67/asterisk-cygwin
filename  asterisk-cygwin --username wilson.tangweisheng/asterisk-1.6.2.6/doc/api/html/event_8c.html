<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:22:01 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_afe38fc0ccf2e9eefca5d5c6b03503d9.html">main</a>
  </div>
</div>
<div class="contents">
<h1>event.c File Reference</h1>
<p>Internal generic event system.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="__private_8h_source.html">asterisk/_private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="event_8h_source.html">asterisk/event.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="dlinkedlists_8h_source.html">asterisk/dlinkedlists.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="unaligned_8h_source.html">asterisk/unaligned.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="taskprocessor_8h_source.html">asterisk/taskprocessor.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br/>

<p><a href="event_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event.html">ast_event</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">An event.  <a href="structast__event.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event__ie.html">ast_event_ie</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">An event information element.  <a href="structast__event__ie.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event__ie__str__payload.html">ast_event_ie_str_payload</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The payload for a string information element.  <a href="structast__event__ie__str__payload.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event__ie__val.html">ast_event_ie_val</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event__ref.html">ast_event_ref</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A holder for an event.  <a href="structast__event__ref.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event__sub.html">ast_event_sub</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event subscription.  <a href="structast__event__sub.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__event__sub__list.html">ast_event_sub_list</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event subscriptions The event subscribers are indexed by which event they are subscribed to.  <a href="structast__event__sub__list.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structevent__name.html">event_name</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structie__map.html">ie_map</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#acc8e4f6e8aea396d805176e63de7e143">MAX_CACHE_ARGS</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a>&nbsp;&nbsp;&nbsp;563</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__event__ref.html">ast_event_ref</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#ac522ef0b99074a82366fb537be860f9d">alloc_event_ref</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aabc5e8aa1db613cf02136391830c5a25">ast_event_append_ie_raw</a> (struct <a class="el" href="structast__event.html">ast_event</a> **event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, const void *data, size_t data_len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append an information element that has a raw payload.  <a href="#aabc5e8aa1db613cf02136391830c5a25"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a5b498b3f3d2abf74ba1274064e2cd972">ast_event_append_ie_str</a> (struct <a class="el" href="structast__event.html">ast_event</a> **event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append an information element that has a string payload.  <a href="#a5b498b3f3d2abf74ba1274064e2cd972"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#ac426e171245008ad590d9e365066584b">ast_event_append_ie_uint</a> (struct <a class="el" href="structast__event.html">ast_event</a> **event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, uint32_t data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append an information element that has an integer payload.  <a href="#ac426e171245008ad590d9e365066584b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5">ast_event_subscriber_res</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#abc730ab05aa3864860d84a34eb8cfca4">ast_event_check_subscriber</a> (enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if subscribers exist.  <a href="#abc730ab05aa3864860d84a34eb8cfca4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a035a5a41a4ae577dc7dcfb6c521f4262">ast_event_cmp</a> (void *obj, void *arg, int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a50b34e0161630dbbc0880a06eb78ad7a">ast_event_destroy</a> (struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy an event.  <a href="#a50b34e0161630dbbc0880a06eb78ad7a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a5bf46b1495a96ddf1de399a324795ddc">ast_event_dump_cache</a> (const struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *<a class="el" href="devicestate_8c.html#a513dfcfff59f0204dab3a9b22ed3c6c0">event_sub</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump the event cache for the subscribed event type.  <a href="#a5bf46b1495a96ddf1de399a324795ddc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a618797a29c6a8542770edcf8b13dbb4b">ast_event_dup</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#abd69b1e34572883b69860756ef3d69bd">ast_event_dup_and_cache</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Duplicate an event and add it to the cache.  <a href="#abd69b1e34572883b69860756ef3d69bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#adf483ab583cc0713d05efe32827c1121">ast_event_get_cached</a> (enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve an event from the cache.  <a href="#adf483ab583cc0713d05efe32827c1121"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6">ast_event_ie_pltype</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a477abc0141be950b28166b8a795c4c35">ast_event_get_ie_pltype</a> (enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the payload type for a given information element type.  <a href="#a477abc0141be950b28166b8a795c4c35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#acaf805e5e914c76e884a5722efd2c0da">ast_event_get_ie_raw</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of an information element that has a raw payload.  <a href="#acaf805e5e914c76e884a5722efd2c0da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a0cfdd21162f4795714da583c31477151">ast_event_get_ie_str</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of an information element that has a string payload.  <a href="#a0cfdd21162f4795714da583c31477151"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a7fe95eea5df516edcbb7619375c90172">ast_event_get_ie_str_hash</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the hash for the string payload of an IE.  <a href="#a7fe95eea5df516edcbb7619375c90172"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a7c877c624fbb6f9091873b4739bc5a9c">ast_event_get_ie_type_name</a> (enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the string representation of an information element type.  <a href="#a7c877c624fbb6f9091873b4739bc5a9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a317f6947b933acd0da82df6e9a4672e5">ast_event_get_ie_uint</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of an information element that has an integer payload.  <a href="#a317f6947b933acd0da82df6e9a4672e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a225c7a00f535f291cf0394f609ee9189">ast_event_get_size</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the size of an event.  <a href="#a225c7a00f535f291cf0394f609ee9189"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#ab3055e3d85399352f0a4ca7404549d4b">ast_event_get_type</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the type for an event.  <a href="#ab3055e3d85399352f0a4ca7404549d4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aba6bf9f8f4b152ebce6d07df92353909">ast_event_get_type_name</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the string representation of the type of the given event.  <a href="#aba6bf9f8f4b152ebce6d07df92353909"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a6fe45949a73e5cf7873252dcf58d27c4">ast_event_hash</a> (const void *obj, const int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aef78a76feb381fe9251d3523b232f754">ast_event_hash_devstate</a> (const void *obj, const int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a8f63b317b29d7589331f705437fc1252">ast_event_hash_devstate_change</a> (const void *obj, const int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a8e6a3c179349c56bef20891f3cd1ab86">ast_event_hash_mwi</a> (const void *obj, const int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a60d50b16f7ea1bc953a3bab12bb57a53">ast_event_ie_val_destroy</a> (struct <a class="el" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aec784d4f5e2d7d9d6115f85531f17536">ast_event_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a28864f3757ef7e984964ea4adc940c16">ast_event_iterator_get_ie_raw</a> (struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of the current IE in the iterator instance that has a raw payload.  <a href="#a28864f3757ef7e984964ea4adc940c16"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a5530313cb1748db1621f26ff8e7cca1a">ast_event_iterator_get_ie_str</a> (struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of the current IE in the iterator as a string payload.  <a href="#a5530313cb1748db1621f26ff8e7cca1a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a9489c71e419286a9a953d7b42f137e8d">ast_event_iterator_get_ie_type</a> (struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the type of the current IE in the iterator instance.  <a href="#a9489c71e419286a9a953d7b42f137e8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#afc251e977f9c0f4556969b53021396bb">ast_event_iterator_get_ie_uint</a> (struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of the current IE in the ierator as an integer payload.  <a href="#afc251e977f9c0f4556969b53021396bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a626ad7a515a386627d3ccefdf1296854">ast_event_iterator_init</a> (struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *iterator, const struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize an event iterator instance.  <a href="#a626ad7a515a386627d3ccefdf1296854"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a9bfda528d51f60f72549f1089f4cd12f">ast_event_iterator_next</a> (struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Move iterator instance to next IE.  <a href="#a9bfda528d51f60f72549f1089f4cd12f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#add66927845c7f5eada84081eec47306b">ast_event_new</a> (enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new event.  <a href="#add66927845c7f5eada84081eec47306b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a4cb88202df41eff644ed6748156d6e73">ast_event_queue</a> (struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue an event.  <a href="#a4cb88202df41eff644ed6748156d6e73"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a5ef4e1053ab8a91ebdcf4dd6ad1c81c4">ast_event_queue_and_cache</a> (struct <a class="el" href="structast__event.html">ast_event</a> *event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue and cache an event.  <a href="#a5ef4e1053ab8a91ebdcf4dd6ad1c81c4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aa8caee91d1ab18db35f3a4bfd18c1536">ast_event_ref_destroy</a> (void *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a44b01d7e4b04a98a8fce9943e1e5affd">ast_event_report_subs</a> (const struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *<a class="el" href="devicestate_8c.html#a513dfcfff59f0204dab3a9b22ed3c6c0">event_sub</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send AST_EVENT_SUB events to this subscriber of ... subscriber events.  <a href="#a44b01d7e4b04a98a8fce9943e1e5affd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a2605cfdf3e95c109391eacf586989956">ast_event_str_to_event_type</a> (const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> *event_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a string into an event type.  <a href="#a2605cfdf3e95c109391eacf586989956"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a55d3ae1fabf653848a3c888070e4fa34">ast_event_str_to_ie_type</a> (const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> *ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a string to an IE type.  <a href="#a55d3ae1fabf653848a3c888070e4fa34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a102995befaeb86bcfce49ae115de8af7">ast_event_sub_activate</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Activate a dynamically built subscription.  <a href="#a102995befaeb86bcfce49ae115de8af7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a0a6b2d7c7635155d29a834ef07a4b2d6">ast_event_sub_append_ie_exists</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append an 'exists' parameter to a subscription.  <a href="#a0a6b2d7c7635155d29a834ef07a4b2d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a46fe7c7a6d01947d0151ab8345c4f08f">ast_event_sub_append_ie_raw</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, void *data, size_t raw_datalen)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append a raw parameter to a subscription.  <a href="#a46fe7c7a6d01947d0151ab8345c4f08f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a5f74d5a16df9f79c01741ebd6c00988c">ast_event_sub_append_ie_str</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append a string parameter to a subscription.  <a href="#a5f74d5a16df9f79c01741ebd6c00988c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a5e91d7d3347599d928a3384f45bda234">ast_event_sub_append_ie_uint</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub, enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ie_type, uint32_t unsigned_int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append a uint parameter to a subscription.  <a href="#a5e91d7d3347599d928a3384f45bda234"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a46f2b4218be0062cf49cfcf7b0b810f3">ast_event_sub_destroy</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy an allocated subscription.  <a href="#a46f2b4218be0062cf49cfcf7b0b810f3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#ac88cc01ecc4f9ff19e34f9d6b2d1edc8">ast_event_subscribe</a> (enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, <a class="el" href="event_8h.html#adfe111a34f216524cbcc53576744cc0a">ast_event_cb_t</a> cb, void *userdata,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Subscribe to events.  <a href="#ac88cc01ecc4f9ff19e34f9d6b2d1edc8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#abbf3a2d3f2ccc44cd6a8864e5b95600c">ast_event_subscribe_new</a> (enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, <a class="el" href="event_8h.html#adfe111a34f216524cbcc53576744cc0a">ast_event_cb_t</a> cb, void *userdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a subscription, but do not activate it.  <a href="#abbf3a2d3f2ccc44cd6a8864e5b95600c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#ad8983ddfd12f5ccc2fbae04f81fe5e93">ast_event_unsubscribe</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Un-subscribe from events.  <a href="#ad8983ddfd12f5ccc2fbae04f81fe5e93"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#afe66d84d6cf2a2825ca566539b959c02">dump_cache_cb</a> (void *obj, void *arg, int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#ae353ab13a10332fac23149d28efc0189">gen_sub_event</a> (struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *sub)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a519439b120decff748c793c7ecf0c1ce">handle_event</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#aabc6de4b84b07d34bc6da81fbff369cb">match_ie_val</a> (const struct <a class="el" href="structast__event.html">ast_event</a> *event, const struct <a class="el" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val, const struct <a class="el" href="structast__event.html">ast_event</a> *event2)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;&nbsp;&nbsp;<a class="el" href="event_8c.html#aced40ae98059778f8ceecd70e552461b">cache_args</a> [MAX_CACHE_ARGS]</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Information Elements used for caching.  <a href="#aced40ae98059778f8ceecd70e552461b"></a><br/></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;struct <a class="el" href="structao2__container.html">ao2_container</a> *&nbsp;&nbsp;&nbsp;<a class="el" href="event_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Container of cached events.  <a href="#a7ea220e4d14b05876af4430e9832ce47"></a><br/></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="astobj2_8h.html#ab29eb962131d79590e1ee1f07ba41818">ao2_hash_fn</a> *&nbsp;&nbsp;&nbsp;<a class="el" href="event_8c.html#affe6d185cf034f97d9e746dbfc8fb11c">hash_fn</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event type specific hash function.  <a href="#affe6d185cf034f97d9e746dbfc8fb11c"></a><br/></td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a> [AST_EVENT_TOTAL]</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event types that are kept in the cache.  <a href="#a51c4315d37378bad0246dff9c0ebf523"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__event__sub__list.html">ast_event_sub_list</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a> [AST_EVENT_TOTAL]</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event subscriptions The event subscribers are indexed by which event they are subscribed to.  <a href="#a301e72880aab9fd98fcbb3f721ed0dd5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__taskprocessor.html">ast_taskprocessor</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a09a2211349df9d6af32a8a88153037a1">event_dispatcher</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structevent__name.html">event_name</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structie__map.html">ie_map</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="event_8c.html#a44ca53b7d1ea1e5328847963d485c271">sub_uniqueid</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Internal generic event system. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Russell Bryant &lt;<a href="mailto:russell@digium.com">russell@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="event_8c_source.html">event.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="acc8e4f6e8aea396d805176e63de7e143"></a><!-- doxytag: member="event.c::MAX_CACHE_ARGS" ref="acc8e4f6e8aea396d805176e63de7e143" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CACHE_ARGS&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00145">145</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa2c7ce70c25f706f8eafad4001c28daa"></a><!-- doxytag: member="event.c::NUM_CACHE_BUCKETS" ref="aa2c7ce70c25f706f8eafad4001c28daa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_CACHE_BUCKETS&nbsp;&nbsp;&nbsp;563</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00142">142</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac522ef0b99074a82366fb537be860f9d"></a><!-- doxytag: member="event.c::alloc_event_ref" ref="ac522ef0b99074a82366fb537be860f9d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__event__ref.html">ast_event_ref</a>* alloc_event_ref </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01064">1064</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00413">ao2_alloc</a>, and <a class="el" href="event_8c_source.html#l00968">ast_event_ref_destroy()</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, and <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01065"></a>01065 {
<a name="l01066"></a>01066    <span class="keywordflow">return</span> <a class="code" href="astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a>), <a class="code" href="event_8c.html#aa8caee91d1ab18db35f3a4bfd18c1536">ast_event_ref_destroy</a>);
<a name="l01067"></a>01067 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aabc5e8aa1db613cf02136391830c5a25"></a><!-- doxytag: member="event.c::ast_event_append_ie_raw" ref="aabc5e8aa1db613cf02136391830c5a25" args="(struct ast_event **event, enum ast_event_ie_type ie_type, const void *data, size_t data_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_append_ie_raw </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event.html">ast_event</a> **&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>data_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append an information element that has a raw payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event that the IE will be appended to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of IE to append </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>A pointer to the raw data for the payload of the IE </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data_len</em>&nbsp;</td><td>The amount of data to copy into the payload</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<p>The pointer to the event will get updated with the new location for the event that now contains the appended information element. If the re-allocation of the memory for this event fails, it will be set to NULL. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00874">874</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00093">ast_realloc</a>, <a class="el" href="event_8c_source.html#l00056">ast_event_ie::ie_payload</a>, and <a class="el" href="event_8c_source.html#l00053">ast_event_ie::ie_payload_len</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00852">ast_event_append_ie_str()</a>, <a class="el" href="event_8c_source.html#l00867">ast_event_append_ie_uint()</a>, <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, and <a class="el" href="event_8c_source.html#l00472">gen_sub_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00876"></a>00876 {
<a name="l00877"></a>00877    <span class="keyword">struct </span><a class="code" href="structast__event__ie.html" title="An event information element.">ast_event_ie</a> *ie;
<a name="l00878"></a>00878    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> extra_len;
<a name="l00879"></a>00879    uint16_t event_len;
<a name="l00880"></a>00880 
<a name="l00881"></a>00881    event_len = ntohs((*event)-&gt;event_len);
<a name="l00882"></a>00882    extra_len = <span class="keyword">sizeof</span>(*ie) + data_len;
<a name="l00883"></a>00883 
<a name="l00884"></a>00884    <span class="keywordflow">if</span> (!(*event = <a class="code" href="astmm_8h.html#aa852314efa0cfeecee97ffc51b649734">ast_realloc</a>(*event, event_len + extra_len)))
<a name="l00885"></a>00885       <span class="keywordflow">return</span> -1;
<a name="l00886"></a>00886 
<a name="l00887"></a>00887    ie = (<span class="keyword">struct </span><a class="code" href="structast__event__ie.html" title="An event information element.">ast_event_ie</a> *) ( ((<span class="keywordtype">char</span> *) *event) + event_len );
<a name="l00888"></a>00888    ie-&gt;ie_type = htons(ie_type);
<a name="l00889"></a>00889    ie-&gt;<a class="code" href="structast__event__ie.html#ad7093978981d9bdb2b5d522b1197899f">ie_payload_len</a> = htons(data_len);
<a name="l00890"></a>00890    memcpy(ie-&gt;<a class="code" href="structast__event__ie.html#a327a94a0d22e249894388f963e369616">ie_payload</a>, data, data_len);
<a name="l00891"></a>00891 
<a name="l00892"></a>00892    (*event)-&gt;event_len = htons(event_len + extra_len);
<a name="l00893"></a>00893 
<a name="l00894"></a>00894    <span class="keywordflow">return</span> 0;
<a name="l00895"></a>00895 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5b498b3f3d2abf74ba1274064e2cd972"></a><!-- doxytag: member="event.c::ast_event_append_ie_str" ref="a5b498b3f3d2abf74ba1274064e2cd972" args="(struct ast_event **event, enum ast_event_ie_type ie_type, const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_append_ie_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event.html">ast_event</a> **&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append an information element that has a string payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event that the IE will be appended to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of IE to append </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>The string for the payload of the IE</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<p>The pointer to the event will get updated with the new location for the event that now contains the appended information element. If the re-allocation of the memory for this event fails, it will be set to NULL. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00852">852</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00874">ast_event_append_ie_raw()</a>, <a class="el" href="strings_8h_source.html#l00856">ast_str_hash()</a>, <a class="el" href="event_8c_source.html#l00064">ast_event_ie_str_payload::hash</a>, and <a class="el" href="event_8c_source.html#l00066">ast_event_ie_str_payload::str</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, and <a class="el" href="event_8c_source.html#l00472">gen_sub_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00854"></a>00854 {
<a name="l00855"></a>00855    <span class="keyword">struct </span><a class="code" href="structast__event__ie__str__payload.html" title="The payload for a string information element.">ast_event_ie_str_payload</a> *str_payload;
<a name="l00856"></a>00856    <span class="keywordtype">size_t</span> payload_len;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858    payload_len = <span class="keyword">sizeof</span>(*str_payload) + strlen(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00859"></a>00859    str_payload = alloca(payload_len);
<a name="l00860"></a>00860 
<a name="l00861"></a>00861    strcpy(str_payload-&gt;<a class="code" href="structast__event__ie__str__payload.html#a116e6a69d08490a4a76cc9f5254271b6" title="The actual string, null terminated.">str</a>, <a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00862"></a>00862    str_payload-&gt;<a class="code" href="structast__event__ie__str__payload.html#a11ecb029164e055f28f4123ce3748862" title="A hash calculated with ast_str_hash(), to speed up comparisons.">hash</a> = <a class="code" href="strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55" title="Compute a hash value on a string.">ast_str_hash</a>(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864    <span class="keywordflow">return</span> <a class="code" href="event_8h.html#aabc5e8aa1db613cf02136391830c5a25" title="Append an information element that has a raw payload.">ast_event_append_ie_raw</a>(event, ie_type, str_payload, payload_len);
<a name="l00865"></a>00865 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac426e171245008ad590d9e365066584b"></a><!-- doxytag: member="event.c::ast_event_append_ie_uint" ref="ac426e171245008ad590d9e365066584b" args="(struct ast_event **event, enum ast_event_ie_type ie_type, uint32_t data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_append_ie_uint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event.html">ast_event</a> **&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append an information element that has an integer payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event that the IE will be appended to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of IE to append </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The integer for the payload of the IE</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<p>The pointer to the event will get updated with the new location for the event that now contains the appended information element. If the re-allocation of the memory for this event fails, it will be set to NULL. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00867">867</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00874">ast_event_append_ie_raw()</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, and <a class="el" href="event_8c_source.html#l00472">gen_sub_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00869"></a>00869 {
<a name="l00870"></a>00870    data = htonl(data);
<a name="l00871"></a>00871    <span class="keywordflow">return</span> <a class="code" href="event_8h.html#aabc5e8aa1db613cf02136391830c5a25" title="Append an information element that has a raw payload.">ast_event_append_ie_raw</a>(event, ie_type, &amp;data, <span class="keyword">sizeof</span>(data));
<a name="l00872"></a>00872 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abc730ab05aa3864860d84a34eb8cfca4"></a><!-- doxytag: member="event.c::ast_event_check_subscriber" ref="abc730ab05aa3864860d84a34eb8cfca4" args="(enum ast_event_type type,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5">ast_event_subscriber_res</a> ast_event_check_subscriber </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a>&nbsp;</td>
          <td class="paramname"> <em>event_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if subscribers exist. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event_type</em>&nbsp;</td><td>This is the type of event that the caller would like to check for subscribers to.</td></tr>
  </table>
  </dd>
</dl>
<p>The rest of the arguments to this function specify additional parameters for checking for subscriptions to subsets of an event type. The arguments must in sets of: </p>
<div class="fragment"><pre class="fragment">    &lt;<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>&gt;, [<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>, [payload] ]
</pre></div><p> and must end with AST_EVENT_IE_END.</p>
<p>If the ie_type specified is *not* AST_EVENT_IE_END, then it must be followed by a valid IE payload type. If the payload type specified is AST_EVENT_IE_PLTYPE_EXISTS, then the 3rd argument should not be provided. Otherwise, a payload must also be specified.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns one of the <a class="el" href="structvalues.html">values</a> defined in the ast_event_subscriber_res enum which will indicate if subscribers exist that match the given criteria.</dd></dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">if</span> (<a class="code" href="event_8h.html#aa1c7994fe2874e895ef28b615bb9aaa6" title="Check if subscribers exist.">ast_event_check_subscriber</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa9a217b1f500680b3e458d62b048c0892">AST_EVENT_MWI</a>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aae6c80d8f4c6ab3cee006ed57d874710" title="Mailbox name.">AST_EVENT_IE_MAILBOX</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>) == <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5af298aea21d354fd45878d4c0769f0844">AST_EVENT_SUB_NONE</a>) {
       <span class="keywordflow">return</span>;
 }
</pre></div><p>This example will check if there are any subscribers to MWI events for the mailbox defined in the "mailbox" variable. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00322">322</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="dlinkedlists_8h_source.html#l00462">AST_DLLIST_EMPTY</a>, <a class="el" href="event__defs_8h_source.html#l00033">AST_EVENT_ALL</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event__defs_8h_source.html#l00151">AST_EVENT_SUB_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00149">AST_EVENT_SUB_NONE</a>, <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>, <a class="el" href="linkedlists_8h_source.html#l00345">AST_LIST_HEAD_NOLOCK_STATIC</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="dlinkedlists_8h_source.html#l00071">AST_RWDLLIST_RDLOCK</a>, <a class="el" href="dlinkedlists_8h_source.html#l00506">AST_RWDLLIST_TRAVERSE</a>, <a class="el" href="dlinkedlists_8h_source.html#l00134">AST_RWDLLIST_UNLOCK</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00113">ast_event_ie_val::raw</a>, <a class="el" href="event_8c_source.html#l00115">ast_event_ie_val::raw_datalen</a>, <a class="el" href="event_8c_source.html#l00111">ast_event_ie_val::str</a>, and <a class="el" href="event_8c_source.html#l00108">ast_event_ie_val::uint</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>, <a class="el" href="event_8c_source.html#l00660">ast_event_sub_activate()</a>, and <a class="el" href="event_8c_source.html#l00743">ast_event_unsubscribe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00323"></a>00323 {
<a name="l00324"></a>00324    va_list ap;
<a name="l00325"></a>00325    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a> ie_type;
<a name="l00326"></a>00326    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5" title="Results for checking for subscribers.">ast_event_subscriber_res</a> res = <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5af298aea21d354fd45878d4c0769f0844">AST_EVENT_SUB_NONE</a>;
<a name="l00327"></a>00327    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val, *sub_ie_val;
<a name="l00328"></a>00328    <span class="keyword">struct </span><a class="code" href="structast__event__sub.html" title="Event subscription.">ast_event_sub</a> *sub;
<a name="l00329"></a>00329    <a class="code" href="linkedlists_8h.html#a547735280f0983afc46bf476d17be24a" title="Defines a structure to be used to hold a list of specified type, statically initialized...">AST_LIST_HEAD_NOLOCK_STATIC</a>(<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, <a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a>);
<a name="l00330"></a>00330 
<a name="l00331"></a>00331    <span class="keywordflow">if</span> (<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> &gt;= <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a>) {
<a name="l00332"></a>00332       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%u is an invalid type!\n&quot;</span>, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l00333"></a>00333       <span class="keywordflow">return</span> res;
<a name="l00334"></a>00334    }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336    va_start(ap, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l00337"></a>00337    <span class="keywordflow">for</span> (ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>);
<a name="l00338"></a>00338       ie_type != <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>;
<a name="l00339"></a>00339       ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>))
<a name="l00340"></a>00340    {
<a name="l00341"></a>00341       <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_value = alloca(<span class="keyword">sizeof</span>(*ie_value));
<a name="l00342"></a>00342       memset(ie_value, 0, <span class="keyword">sizeof</span>(*ie_value));
<a name="l00343"></a>00343       ie_value-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = ie_type;
<a name="l00344"></a>00344       ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>);
<a name="l00345"></a>00345       <span class="keywordflow">if</span> (ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>)
<a name="l00346"></a>00346          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a> = va_arg(ap, uint32_t);
<a name="l00347"></a>00347       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>)
<a name="l00348"></a>00348          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(va_arg(ap, <span class="keyword">const</span> <span class="keywordtype">char</span> *));
<a name="l00349"></a>00349       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>) {
<a name="l00350"></a>00350          <span class="keywordtype">void</span> *data = va_arg(ap, <span class="keywordtype">void</span> *);
<a name="l00351"></a>00351          <span class="keywordtype">size_t</span> datalen = va_arg(ap, <span class="keywordtype">size_t</span>);
<a name="l00352"></a>00352          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a> = alloca(datalen);
<a name="l00353"></a>00353          memcpy(ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, data, datalen);
<a name="l00354"></a>00354          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a> = datalen;
<a name="l00355"></a>00355       }
<a name="l00356"></a>00356       <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;ie_vals, ie_value, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>);
<a name="l00357"></a>00357    }
<a name="l00358"></a>00358    va_end(ap);
<a name="l00359"></a>00359 
<a name="l00360"></a>00360    <a class="code" href="dlinkedlists_8h.html#ac3f1fc4c00a1454e2ce161fa9ad3636c" title="Read locks a list.">AST_RWDLLIST_RDLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>]);
<a name="l00361"></a>00361    <a class="code" href="dlinkedlists_8h.html#a192b1276ffe754b8201a72985ed5d434">AST_RWDLLIST_TRAVERSE</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>], sub, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00362"></a>00362       <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;ie_vals, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00363"></a>00363          <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, sub_ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00364"></a>00364             <span class="keywordflow">if</span> (sub_ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> == ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>)
<a name="l00365"></a>00365                <span class="keywordflow">break</span>;
<a name="l00366"></a>00366          }
<a name="l00367"></a>00367          <span class="keywordflow">if</span> (!sub_ie_val) {
<a name="l00368"></a>00368             <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>)
<a name="l00369"></a>00369                <span class="keywordflow">break</span>;
<a name="l00370"></a>00370             <span class="keywordflow">continue</span>;
<a name="l00371"></a>00371          }
<a name="l00372"></a>00372          <span class="comment">/* The subscriber doesn&apos;t actually care what the value is */</span>
<a name="l00373"></a>00373          <span class="keywordflow">if</span> (sub_ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>)
<a name="l00374"></a>00374             <span class="keywordflow">continue</span>;
<a name="l00375"></a>00375          <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a> &amp;&amp;
<a name="l00376"></a>00376             ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a> != sub_ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a>)
<a name="l00377"></a>00377             <span class="keywordflow">break</span>;
<a name="l00378"></a>00378          <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a> &amp;&amp;
<a name="l00379"></a>00379             strcmp(ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, sub_ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>))
<a name="l00380"></a>00380             <span class="keywordflow">break</span>;
<a name="l00381"></a>00381          <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a> &amp;&amp;
<a name="l00382"></a>00382             memcmp(ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, sub_ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>))
<a name="l00383"></a>00383             <span class="keywordflow">break</span>;
<a name="l00384"></a>00384       }
<a name="l00385"></a>00385       <span class="keywordflow">if</span> (!ie_val)
<a name="l00386"></a>00386          <span class="keywordflow">break</span>;
<a name="l00387"></a>00387    }
<a name="l00388"></a>00388    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[type]);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390    <span class="keywordflow">if</span> (sub) <span class="comment">/* All parameters were matched */</span>
<a name="l00391"></a>00391       <span class="keywordflow">return</span> <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5ae1b22bc7674606abd9ab44730c7d71bd">AST_EVENT_SUB_EXISTS</a>;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393    <a class="code" href="dlinkedlists_8h.html#ac3f1fc4c00a1454e2ce161fa9ad3636c" title="Read locks a list.">AST_RWDLLIST_RDLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faa0800b824d33fd3ff1b078a9ccd9a33b">AST_EVENT_ALL</a>]);
<a name="l00394"></a>00394    <span class="keywordflow">if</span> (!<a class="code" href="dlinkedlists_8h.html#a0a8c2aa62310165b41265294ce44db42" title="Checks whether the specified list contains any entries.">AST_DLLIST_EMPTY</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faa0800b824d33fd3ff1b078a9ccd9a33b">AST_EVENT_ALL</a>]))
<a name="l00395"></a>00395       res = <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5ae1b22bc7674606abd9ab44730c7d71bd">AST_EVENT_SUB_EXISTS</a>;
<a name="l00396"></a>00396    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[AST_EVENT_ALL]);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398    <span class="keywordflow">return</span> res;
<a name="l00399"></a>00399 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a035a5a41a4ae577dc7dcfb6c521f4262"></a><!-- doxytag: member="event.c::ast_event_cmp" ref="a035a5a41a4ae577dc7dcfb6c521f4262" args="(void *obj, void *arg, int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_event_cmp </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01258">1258</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l00265">ast_event_get_ie_pltype()</a>, <a class="el" href="event_8c_source.html#l00807">ast_event_get_type()</a>, <a class="el" href="event_8c_source.html#l00168">cache_args</a>, <a class="el" href="astobj2_8h_source.html#l00653">CMP_MATCH</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, and <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>, and <a class="el" href="event_8c_source.html#l01094">ast_event_queue_and_cache()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01259"></a>01259 {
<a name="l01260"></a>01260    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref, *event_ref2;
<a name="l01261"></a>01261    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event, *event2;
<a name="l01262"></a>01262    <span class="keywordtype">int</span> res = <a class="code" href="astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;
<a name="l01263"></a>01263    <span class="keywordtype">int</span> i;
<a name="l01264"></a>01264    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a> *<a class="code" href="event_8c.html#aced40ae98059778f8ceecd70e552461b" title="Information Elements used for caching.">cache_args</a>;
<a name="l01265"></a>01265 
<a name="l01266"></a>01266    event_ref = obj;
<a name="l01267"></a>01267    <span class="keyword">event</span> = event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>;
<a name="l01268"></a>01268 
<a name="l01269"></a>01269    event_ref2 = arg;
<a name="l01270"></a>01270    event2 = event_ref2-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>;
<a name="l01271"></a>01271 
<a name="l01272"></a>01272    cache_args = <a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[<a class="code" href="event_8h.html#ab3055e3d85399352f0a4ca7404549d4b" title="Get the type for an event.">ast_event_get_type</a>(event)].cache_args;
<a name="l01273"></a>01273 
<a name="l01274"></a>01274    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[0].cache_args) &amp;&amp; cache_args[i]; i++) {
<a name="l01275"></a>01275       <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> ie_val = {
<a name="l01276"></a>01276          .ie_pltype = <a class="code" href="event_8h.html#a477abc0141be950b28166b8a795c4c35" title="Get the payload type for a given information element type.">ast_event_get_ie_pltype</a>(cache_args[i]),
<a name="l01277"></a>01277          .ie_type = cache_args[i],
<a name="l01278"></a>01278       };
<a name="l01279"></a>01279 
<a name="l01280"></a>01280       <span class="keywordflow">if</span> (!<a class="code" href="event_8c.html#aabc6de4b84b07d34bc6da81fbff369cb">match_ie_val</a>(event, &amp;ie_val, event2)) {
<a name="l01281"></a>01281          res = 0;
<a name="l01282"></a>01282          <span class="keywordflow">break</span>;
<a name="l01283"></a>01283       }
<a name="l01284"></a>01284    }
<a name="l01285"></a>01285 
<a name="l01286"></a>01286    <span class="keywordflow">return</span> res;
<a name="l01287"></a>01287 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a50b34e0161630dbbc0880a06eb78ad7a"></a><!-- doxytag: member="event.c::ast_event_destroy" ref="a50b34e0161630dbbc0880a06eb78ad7a" args="(struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_event_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy an event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event to destroy</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nothing</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Events that have been queued should *not* be destroyed by the code that created the event. It will be automatically destroyed after being dispatched to the appropriate subscribers. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00963">963</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>, <a class="el" href="event_8c_source.html#l00968">ast_event_ref_destroy()</a>, <a class="el" href="event_8c_source.html#l00510">ast_event_report_subs()</a>, <a class="el" href="devicestate_8c_source.html#l00288">devstate_cached()</a>, <a class="el" href="chan__sip_8c_source.html#l22258">get_cached_mwi()</a>, <a class="el" href="chan__dahdi_8c_source.html#l03001">has_voicemail()</a>, <a class="el" href="devicestate_8c_source.html#l00593">process_collection()</a>, <a class="el" href="chan__unistim_8c_source.html#l04379">unistim_send_mwi_to_peer()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00964"></a>00964 {
<a name="l00965"></a>00965    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(event);
<a name="l00966"></a>00966 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5bf46b1495a96ddf1de399a324795ddc"></a><!-- doxytag: member="event.c::ast_event_dump_cache" ref="a5bf46b1495a96ddf1de399a324795ddc" args="(const struct ast_event_sub *event_sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_event_dump_cache </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>event_sub</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dump the event cache for the subscribed event type. </p>
<p>Dump the event cache for the subscriber. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00466">466</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00916">ao2_callback</a>, <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l00444">dump_cache_cb()</a>, <a class="el" href="astobj2_8h_source.html#l00667">OBJ_NODATA</a>, and <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>.</p>

<p>Referenced by <a class="el" href="evt_8c_source.html#l00300">add_publish_event()</a>, and <a class="el" href="devicestate_8c_source.html#l00646">handle_devstate_change()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00467"></a>00467 {
<a name="l00468"></a>00468    <a class="code" href="astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(<a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[event_sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>].container, <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>,
<a name="l00469"></a>00469          <a class="code" href="event_8c.html#afe66d84d6cf2a2825ca566539b959c02">dump_cache_cb</a>, (<span class="keywordtype">void</span> *) event_sub);
<a name="l00470"></a>00470 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a618797a29c6a8542770edcf8b13dbb4b"></a><!-- doxytag: member="event.c::ast_event_dup" ref="a618797a29c6a8542770edcf8b13dbb4b" args="(const struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__event.html">ast_event</a>* ast_event_dup </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00975">975</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="event_8c_source.html#l00295">ast_event_get_size()</a>, and <a class="el" href="event_8c_source.html#l00082">ast_event::event_len</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, and <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00976"></a>00976 {
<a name="l00977"></a>00977    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *dup_event;
<a name="l00978"></a>00978    uint16_t <a class="code" href="structast__event.html#a6f0feaf780ae1896ac987af24831a066">event_len</a>;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980    event_len = <a class="code" href="event_8h.html#a225c7a00f535f291cf0394f609ee9189" title="Get the size of an event.">ast_event_get_size</a>(event);
<a name="l00981"></a>00981 
<a name="l00982"></a>00982    <span class="keywordflow">if</span> (!(dup_event = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, event_len))) {
<a name="l00983"></a>00983       <span class="keywordflow">return</span> NULL;
<a name="l00984"></a>00984    }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986    memcpy(dup_event, event, event_len);
<a name="l00987"></a>00987 
<a name="l00988"></a>00988    <span class="keywordflow">return</span> dup_event;
<a name="l00989"></a>00989 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd69b1e34572883b69860756ef3d69bd"></a><!-- doxytag: member="event.c::ast_event_dup_and_cache" ref="abd69b1e34572883b69860756ef3d69bd" args="(const struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_event_dup_and_cache </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Duplicate an event and add it to the cache. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This assumes this index in to the cache is locked </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l01071">1071</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l01064">alloc_event_ref()</a>, <a class="el" href="astobj2_8h_source.html#l00782">ao2_link</a>, <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>, <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l00963">ast_event_destroy()</a>, <a class="el" href="event_8c_source.html#l00975">ast_event_dup()</a>, <a class="el" href="event_8c_source.html#l00807">ast_event_get_type()</a>, <a class="el" href="event_8c_source.html#l00157">container</a>, and <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01094">ast_event_queue_and_cache()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01072"></a>01072 {
<a name="l01073"></a>01073    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *dup_event;
<a name="l01074"></a>01074    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref;
<a name="l01075"></a>01075 
<a name="l01076"></a>01076    <span class="keywordflow">if</span> (!(dup_event = <a class="code" href="event_8c.html#a618797a29c6a8542770edcf8b13dbb4b">ast_event_dup</a>(event))) {
<a name="l01077"></a>01077       <span class="keywordflow">return</span> -1;
<a name="l01078"></a>01078    }
<a name="l01079"></a>01079 
<a name="l01080"></a>01080    <span class="keywordflow">if</span> (!(event_ref = <a class="code" href="event_8c.html#ac522ef0b99074a82366fb537be860f9d">alloc_event_ref</a>())) {
<a name="l01081"></a>01081       <a class="code" href="event_8h.html#a50b34e0161630dbbc0880a06eb78ad7a" title="Destroy an event.">ast_event_destroy</a>(dup_event);
<a name="l01082"></a>01082       <span class="keywordflow">return</span> -1;
<a name="l01083"></a>01083    }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085    event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a> = dup_event;
<a name="l01086"></a>01086 
<a name="l01087"></a>01087    <a class="code" href="astobj2_8h.html#a210544bdcc5afe0601d01d6e529c22d8">ao2_link</a>(<a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[<a class="code" href="event_8h.html#ab3055e3d85399352f0a4ca7404549d4b" title="Get the type for an event.">ast_event_get_type</a>(event)].<a class="code" href="event_8c.html#a7ea220e4d14b05876af4430e9832ce47" title="Container of cached events.">container</a>, event_ref);
<a name="l01088"></a>01088 
<a name="l01089"></a>01089    <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(event_ref, -1);
<a name="l01090"></a>01090 
<a name="l01091"></a>01091    <span class="keywordflow">return</span> 0;
<a name="l01092"></a>01092 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adf483ab583cc0713d05efe32827c1121"></a><!-- doxytag: member="event.c::ast_event_get_cached" ref="adf483ab583cc0713d05efe32827c1121" args="(enum ast_event_type type,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__event.html">ast_event</a>* ast_event_get_cached </td>
          <td>(</td>
          <td class="paramtype">enum&nbsp;</td>
          <td class="paramname"> <em>ast_event_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve an event from the cache. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ast_event_type</em>&nbsp;</td><td>The type of event to retrieve from the cache</td></tr>
  </table>
  </dd>
</dl>
<p>The rest of the arguments to this function specify information elements to match for retrieving events from the cache. They are specified in the form: </p>
<div class="fragment"><pre class="fragment">    &lt;<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>&gt;, [<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>, [payload] ]
</pre></div><p> and must end with AST_EVENT_IE_END.</p>
<p>If the ie_type specified is *not* AST_EVENT_IE_END, then it must be followed by a valid IE payload type. If the payload type specified is AST_EVENT_IE_PLTYPE_EXISTS, then the 3rd argument should not be provided. Otherwise, a payload must also be specified.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>A reference to an event retrieved from the cache. If no event was found that matches the specified criteria, then NULL will be returned.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If more than one event in the cache matches the specified criteria, only one will be returned, and it is undefined which one it will be.</dd>
<dd>
The caller of this function *must* call <a class="el" href="event_8h.html#a50b34e0161630dbbc0880a06eb78ad7a" title="Destroy an event.">ast_event_destroy()</a> on the returned event after it is done using it.</dd></dl>
<p>Example Usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">event</span> = <a class="code" href="event_8h.html#a419385710c135873656b047df8f72e7e" title="Retrieve an event from the cache.">ast_event_get_cached</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa9a217b1f500680b3e458d62b048c0892">AST_EVENT_MWI</a>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aae6c80d8f4c6ab3cee006ed57d874710" title="Mailbox name.">AST_EVENT_IE_MAILBOX</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>);
</pre></div><p>This example will check for an MWI event in the cache that matches the specified mailbox. This would be the way to find out the last known <a class="el" href="structstate.html">state</a> of a mailbox without having to poll the mailbox directly. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00991">991</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00968">ao2_find</a>, <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>, <a class="el" href="event_8c_source.html#l00874">ast_event_append_ie_raw()</a>, <a class="el" href="event_8c_source.html#l00852">ast_event_append_ie_str()</a>, <a class="el" href="event_8c_source.html#l00867">ast_event_append_ie_uint()</a>, <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l00963">ast_event_destroy()</a>, <a class="el" href="event_8c_source.html#l00975">ast_event_dup()</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event__defs_8h_source.html#l00131">AST_EVENT_IE_PLTYPE_UNKNOWN</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="event_8c_source.html#l00157">container</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="astobj2_8h_source.html#l00678">OBJ_POINTER</a>.</p>

<p>Referenced by <a class="el" href="devicestate_8c_source.html#l00288">devstate_cached()</a>, <a class="el" href="chan__sip_8c_source.html#l22258">get_cached_mwi()</a>, <a class="el" href="chan__dahdi_8c_source.html#l03001">has_voicemail()</a>, <a class="el" href="devicestate_8c_source.html#l00593">process_collection()</a>, <a class="el" href="chan__unistim_8c_source.html#l04379">unistim_send_mwi_to_peer()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00992"></a>00992 {
<a name="l00993"></a>00993    va_list ap;
<a name="l00994"></a>00994    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a> ie_type;
<a name="l00995"></a>00995    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *dup_event = NULL;
<a name="l00996"></a>00996    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *cached_event_ref;
<a name="l00997"></a>00997    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *cache_arg_event;
<a name="l00998"></a>00998    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> tmp_event_ref = {
<a name="l00999"></a>00999       .event = NULL,
<a name="l01000"></a>01000    };
<a name="l01001"></a>01001    <span class="keyword">struct </span><a class="code" href="structao2__container.html">ao2_container</a> *<a class="code" href="event_8c.html#a7ea220e4d14b05876af4430e9832ce47" title="Container of cached events.">container</a> = NULL;
<a name="l01002"></a>01002 
<a name="l01003"></a>01003    <span class="keywordflow">if</span> (<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> &gt;= <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a>) {
<a name="l01004"></a>01004       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%u is an invalid type!\n&quot;</span>, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l01005"></a>01005       <span class="keywordflow">return</span> NULL;
<a name="l01006"></a>01006    }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008    <span class="keywordflow">if</span> (!(container = <a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>].container)) {
<a name="l01009"></a>01009       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%u is not a cached event type\n&quot;</span>, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l01010"></a>01010       <span class="keywordflow">return</span> NULL;
<a name="l01011"></a>01011    }
<a name="l01012"></a>01012 
<a name="l01013"></a>01013    <span class="keywordflow">if</span> (!(cache_arg_event = <a class="code" href="event_8h.html#afb4a2a00de28bb0733037060da8c4bac" title="Create a new event.">ast_event_new</a>(<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>))) {
<a name="l01014"></a>01014       <span class="keywordflow">return</span> NULL;
<a name="l01015"></a>01015    }
<a name="l01016"></a>01016 
<a name="l01017"></a>01017    va_start(ap, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l01018"></a>01018    <span class="keywordflow">for</span> (ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>);
<a name="l01019"></a>01019       ie_type != <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>;
<a name="l01020"></a>01020       ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>))
<a name="l01021"></a>01021    {
<a name="l01022"></a>01022       <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a> ie_pltype;
<a name="l01023"></a>01023 
<a name="l01024"></a>01024       ie_pltype = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>);
<a name="l01025"></a>01025 
<a name="l01026"></a>01026       <span class="keywordflow">switch</span> (ie_pltype) {
<a name="l01027"></a>01027       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>:
<a name="l01028"></a>01028          <a class="code" href="event_8h.html#ac426e171245008ad590d9e365066584b" title="Append an information element that has an integer payload.">ast_event_append_ie_uint</a>(&amp;cache_arg_event, ie_type, va_arg(ap, uint32_t));
<a name="l01029"></a>01029          <span class="keywordflow">break</span>;
<a name="l01030"></a>01030       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>:
<a name="l01031"></a>01031          <a class="code" href="event_8h.html#a5b498b3f3d2abf74ba1274064e2cd972" title="Append an information element that has a string payload.">ast_event_append_ie_str</a>(&amp;cache_arg_event, ie_type, va_arg(ap, <span class="keyword">const</span> <span class="keywordtype">char</span> *));
<a name="l01032"></a>01032          <span class="keywordflow">break</span>;
<a name="l01033"></a>01033       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>:
<a name="l01034"></a>01034       {
<a name="l01035"></a>01035          <span class="keywordtype">void</span> *data = va_arg(ap, <span class="keywordtype">void</span> *);
<a name="l01036"></a>01036          <span class="keywordtype">size_t</span> datalen = va_arg(ap, <span class="keywordtype">size_t</span>);
<a name="l01037"></a>01037          <a class="code" href="event_8h.html#aabc5e8aa1db613cf02136391830c5a25" title="Append an information element that has a raw payload.">ast_event_append_ie_raw</a>(&amp;cache_arg_event, ie_type, data, datalen);
<a name="l01038"></a>01038       }
<a name="l01039"></a>01039       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>:
<a name="l01040"></a>01040          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;PLTYPE_EXISTS not supported by this function\n&quot;</span>);
<a name="l01041"></a>01041          <span class="keywordflow">break</span>;
<a name="l01042"></a>01042       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6aefc05976cb496dd18e686b0e62773e54">AST_EVENT_IE_PLTYPE_UNKNOWN</a>:
<a name="l01043"></a>01043          <span class="keywordflow">break</span>;
<a name="l01044"></a>01044       }
<a name="l01045"></a>01045    }
<a name="l01046"></a>01046    va_end(ap);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    tmp_event_ref.<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a> = cache_arg_event;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050    cached_event_ref = <a class="code" href="astobj2_8h.html#a618587b42226725315b96db394b13673">ao2_find</a>(container, &amp;tmp_event_ref, <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca32d49976aaebc093266f0b080f9c9a73">OBJ_POINTER</a>);
<a name="l01051"></a>01051 
<a name="l01052"></a>01052    <a class="code" href="event_8h.html#a50b34e0161630dbbc0880a06eb78ad7a" title="Destroy an event.">ast_event_destroy</a>(cache_arg_event);
<a name="l01053"></a>01053    cache_arg_event = NULL;
<a name="l01054"></a>01054 
<a name="l01055"></a>01055    <span class="keywordflow">if</span> (cached_event_ref) {
<a name="l01056"></a>01056       dup_event = <a class="code" href="event_8c.html#a618797a29c6a8542770edcf8b13dbb4b">ast_event_dup</a>(cached_event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>);
<a name="l01057"></a>01057       <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cached_event_ref, -1);
<a name="l01058"></a>01058       cached_event_ref = NULL;
<a name="l01059"></a>01059    }
<a name="l01060"></a>01060 
<a name="l01061"></a>01061    <span class="keywordflow">return</span> dup_event;
<a name="l01062"></a>01062 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a477abc0141be950b28166b8a795c4c35"></a><!-- doxytag: member="event.c::ast_event_get_ie_pltype" ref="a477abc0141be950b28166b8a795c4c35" args="(enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6">ast_event_ie_pltype</a> ast_event_get_ie_pltype </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the payload type for a given information element type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the information element type to get the payload type of</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the payload type for the provided IE type </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00265">265</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00125">AST_EVENT_IE_MAX</a>, <a class="el" href="event__defs_8h_source.html#l00131">AST_EVENT_IE_PLTYPE_UNKNOWN</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>, <a class="el" href="event_8c_source.html#l00205">ie_map::ie_pltype</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00266"></a>00266 {
<a name="l00267"></a>00267    <span class="keywordflow">if</span> (ie_type &lt;= 0 || ie_type &gt; <a class="code" href="event__defs_8h.html#ad7be258e037648898cc41ff9ed733ed7">AST_EVENT_IE_MAX</a>) {
<a name="l00268"></a>00268       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid IE type - &apos;%d&apos;\n&quot;</span>, ie_type);
<a name="l00269"></a>00269       <span class="keywordflow">return</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6aefc05976cb496dd18e686b0e62773e54">AST_EVENT_IE_PLTYPE_UNKNOWN</a>;
<a name="l00270"></a>00270    }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272    <span class="keywordflow">if</span> (<a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[ie_type].ie_type != ie_type) {
<a name="l00273"></a>00273       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;The ie type passed in does not match the ie type defined in the ie table.\n&quot;</span>);
<a name="l00274"></a>00274       <span class="keywordflow">return</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6aefc05976cb496dd18e686b0e62773e54">AST_EVENT_IE_PLTYPE_UNKNOWN</a>;
<a name="l00275"></a>00275    }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277    <span class="keywordflow">return</span> <a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[ie_type].<a class="code" href="structie__map.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a>;
<a name="l00278"></a>00278 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acaf805e5e914c76e884a5722efd2c0da"></a><!-- doxytag: member="event.c::ast_event_get_ie_raw" ref="acaf805e5e914c76e884a5722efd2c0da" args="(const struct ast_event *event, enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const void* ast_event_get_ie_raw </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of an information element that has a raw payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event to get the IE from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of information element to retrieve</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the payload of the information element with the given type. If the information element isn't found, NULL will be returned. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00839">839</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00802">ast_event_iterator_get_ie_raw()</a>, <a class="el" href="event_8c_source.html#l00783">ast_event_iterator_get_ie_type()</a>, <a class="el" href="event_8c_source.html#l00769">ast_event_iterator_init()</a>, and <a class="el" href="event_8c_source.html#l00777">ast_event_iterator_next()</a>.</p>

<p>Referenced by <a class="el" href="evt_8c_source.html#l00172">ast_event_cb()</a>, <a class="el" href="event_8c_source.html#l00830">ast_event_get_ie_str()</a>, <a class="el" href="event_8c_source.html#l00821">ast_event_get_ie_str_hash()</a>, <a class="el" href="event_8c_source.html#l00812">ast_event_get_ie_uint()</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, <a class="el" href="devicestate_8c_source.html#l00568">devstate_cache_cb()</a>, <a class="el" href="devicestate_8c_source.html#l00692">devstate_change_collector_cb()</a>, <a class="el" href="evt_8c_source.html#l00118">evt_event_deliver_cb()</a>, and <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00840"></a>00840 {
<a name="l00841"></a>00841    <span class="keyword">struct </span><a class="code" href="structast__event__iterator.html" title="supposed to be an opaque type">ast_event_iterator</a> iterator;
<a name="l00842"></a>00842    <span class="keywordtype">int</span> res = 0;
<a name="l00843"></a>00843 
<a name="l00844"></a>00844    <span class="keywordflow">for</span> (<a class="code" href="event_8h.html#a626ad7a515a386627d3ccefdf1296854" title="Initialize an event iterator instance.">ast_event_iterator_init</a>(&amp;iterator, event); !res; res = <a class="code" href="event_8h.html#a9bfda528d51f60f72549f1089f4cd12f" title="Move iterator instance to next IE.">ast_event_iterator_next</a>(&amp;iterator)) {
<a name="l00845"></a>00845       <span class="keywordflow">if</span> (<a class="code" href="event_8h.html#a9489c71e419286a9a953d7b42f137e8d" title="Get the type of the current IE in the iterator instance.">ast_event_iterator_get_ie_type</a>(&amp;iterator) == ie_type)
<a name="l00846"></a>00846          <span class="keywordflow">return</span> <a class="code" href="event_8h.html#a28864f3757ef7e984964ea4adc940c16" title="Get the value of the current IE in the iterator instance that has a raw payload.">ast_event_iterator_get_ie_raw</a>(&amp;iterator);
<a name="l00847"></a>00847    }
<a name="l00848"></a>00848 
<a name="l00849"></a>00849    <span class="keywordflow">return</span> NULL;
<a name="l00850"></a>00850 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0cfdd21162f4795714da583c31477151"></a><!-- doxytag: member="event.c::ast_event_get_ie_str" ref="a0cfdd21162f4795714da583c31477151" args="(const struct ast_event *event, enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_event_get_ie_str </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of an information element that has a string payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event to get the IE from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of information element to retrieve</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the payload of the information element with the given type. If the information element isn't found, NULL will be returned. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00830">830</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>, and <a class="el" href="event_8c_source.html#l00066">ast_event_ie_str_payload::str</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01201">ast_event_hash_devstate()</a>, <a class="el" href="event_8c_source.html#l01217">ast_event_hash_devstate_change()</a>, <a class="el" href="event_8c_source.html#l01183">ast_event_hash_mwi()</a>, <a class="el" href="app__queue_8c_source.html#l01090">device_state_cb()</a>, <a class="el" href="devicestate_8c_source.html#l00692">devstate_change_collector_cb()</a>, <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>, and <a class="el" href="app__voicemail_8c_source.html#l10372">mwi_sub_event_cb()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00831"></a>00831 {
<a name="l00832"></a>00832    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event__ie__str__payload.html" title="The payload for a string information element.">ast_event_ie_str_payload</a> *str_payload;
<a name="l00833"></a>00833 
<a name="l00834"></a>00834    str_payload = <a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event, ie_type);
<a name="l00835"></a>00835 
<a name="l00836"></a>00836    <span class="keywordflow">return</span> str_payload ? str_payload-&gt;<a class="code" href="structast__event__ie__str__payload.html#a116e6a69d08490a4a76cc9f5254271b6" title="The actual string, null terminated.">str</a> : NULL;
<a name="l00837"></a>00837 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7fe95eea5df516edcbb7619375c90172"></a><!-- doxytag: member="event.c::ast_event_get_ie_str_hash" ref="a7fe95eea5df516edcbb7619375c90172" args="(const struct ast_event *event, enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ast_event_get_ie_str_hash </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the hash for the string payload of an IE. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event to get the IE from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of information element to retrieve the hash for</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This function returns the hash value as calculated by <a class="el" href="strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55" title="Compute a hash value on a string.">ast_str_hash()</a> for the string payload. This is stored in the event to avoid unnecessary string comparisons. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00821">821</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>, and <a class="el" href="event_8c_source.html#l00064">ast_event_ie_str_payload::hash</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00822"></a>00822 {
<a name="l00823"></a>00823    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event__ie__str__payload.html" title="The payload for a string information element.">ast_event_ie_str_payload</a> *str_payload;
<a name="l00824"></a>00824 
<a name="l00825"></a>00825    str_payload = <a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event, ie_type);
<a name="l00826"></a>00826 
<a name="l00827"></a>00827    <span class="keywordflow">return</span> str_payload ? str_payload-&gt;<a class="code" href="structast__event__ie__str__payload.html#a11ecb029164e055f28f4123ce3748862" title="A hash calculated with ast_str_hash(), to speed up comparisons.">hash</a> : 0;
<a name="l00828"></a>00828 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c877c624fbb6f9091873b4739bc5a9c"></a><!-- doxytag: member="event.c::ast_event_get_ie_type_name" ref="a7c877c624fbb6f9091873b4739bc5a9c" args="(enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_event_get_ie_type_name </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the string representation of an information element type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the information element type to get the string representation of</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the string representation of the information element type </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00250">250</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00125">AST_EVENT_IE_MAX</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, and <a class="el" href="event_8c_source.html#l00206">ie_map::name</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00251"></a>00251 {
<a name="l00252"></a>00252    <span class="keywordflow">if</span> (ie_type &lt;= 0 || ie_type &gt; <a class="code" href="event__defs_8h.html#ad7be258e037648898cc41ff9ed733ed7">AST_EVENT_IE_MAX</a>) {
<a name="l00253"></a>00253       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid IE type - &apos;%d&apos;\n&quot;</span>, ie_type);
<a name="l00254"></a>00254       <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00255"></a>00255    }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257    <span class="keywordflow">if</span> (<a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[ie_type].ie_type != ie_type) {
<a name="l00258"></a>00258       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;The ie type passed in does not match the ie type defined in the ie table.\n&quot;</span>);
<a name="l00259"></a>00259       <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00260"></a>00260    }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262    <span class="keywordflow">return</span> <a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[ie_type].<a class="code" href="structie__map.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;
<a name="l00263"></a>00263 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a317f6947b933acd0da82df6e9a4672e5"></a><!-- doxytag: member="event.c::ast_event_get_ie_uint" ref="a317f6947b933acd0da82df6e9a4672e5" args="(const struct ast_event *event, enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ast_event_get_ie_uint </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of an information element that has an integer payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event to get the IE from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the type of information element to retrieve</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the payload of the information element with the given type. However, an IE with a payload of 0, and the case where no IE is found yield the same return value. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00812">812</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>, and <a class="el" href="unaligned_8h_source.html#l00032">get_unaligned_uint32()</a>.</p>

<p>Referenced by <a class="el" href="app__queue_8c_source.html#l01090">device_state_cb()</a>, <a class="el" href="devicestate_8c_source.html#l00568">devstate_cache_cb()</a>, <a class="el" href="devicestate_8c_source.html#l00288">devstate_cached()</a>, <a class="el" href="devicestate_8c_source.html#l00692">devstate_change_collector_cb()</a>, <a class="el" href="chan__sip_8c_source.html#l22258">get_cached_mwi()</a>, <a class="el" href="chan__dahdi_8c_source.html#l03001">has_voicemail()</a>, <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>, <a class="el" href="chan__skinny_8c_source.html#l02520">mwi_event_cb()</a>, <a class="el" href="app__voicemail_8c_source.html#l10372">mwi_sub_event_cb()</a>, <a class="el" href="app__voicemail_8c_source.html#l10356">mwi_unsub_event_cb()</a>, <a class="el" href="devicestate_8c_source.html#l00593">process_collection()</a>, <a class="el" href="chan__sip_8c_source.html#l22279">sip_send_mwi_to_peer()</a>, <a class="el" href="chan__unistim_8c_source.html#l04379">unistim_send_mwi_to_peer()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00813"></a>00813 {
<a name="l00814"></a>00814    <span class="keyword">const</span> uint32_t *ie_val;
<a name="l00815"></a>00815 
<a name="l00816"></a>00816    ie_val = <a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event, ie_type);
<a name="l00817"></a>00817 
<a name="l00818"></a>00818    <span class="keywordflow">return</span> ie_val ? ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(ie_val)) : 0;
<a name="l00819"></a>00819 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a225c7a00f535f291cf0394f609ee9189"></a><!-- doxytag: member="event.c::ast_event_get_size" ref="a225c7a00f535f291cf0394f609ee9189" args="(const struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t ast_event_get_size </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the size of an event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event to get the size of</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the <a class="el" href="structnumber.html" title="Number structure.">number</a> of bytes contained in the event </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00295">295</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00082">ast_event::event_len</a>.</p>

<p>Referenced by <a class="el" href="evt_8c_source.html#l00172">ast_event_cb()</a>, and <a class="el" href="event_8c_source.html#l00975">ast_event_dup()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00296"></a>00296 {
<a name="l00297"></a>00297    <span class="keywordtype">size_t</span> res;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299    res = ntohs(event-&gt;<a class="code" href="structast__event.html#a6f0feaf780ae1896ac987af24831a066">event_len</a>);
<a name="l00300"></a>00300 
<a name="l00301"></a>00301    <span class="keywordflow">return</span> res;
<a name="l00302"></a>00302 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab3055e3d85399352f0a4ca7404549d4b"></a><!-- doxytag: member="event.c::ast_event_get_type" ref="ab3055e3d85399352f0a4ca7404549d4b" args="(const struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> ast_event_get_type </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the type for an event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event to get the type for</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the event type as represented by one of the <a class="el" href="structvalues.html">values</a> in the ast_event_type enum </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00807">807</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>Referenced by <a class="el" href="evt_8c_source.html#l00172">ast_event_cb()</a>, <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>, <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, <a class="el" href="event_8c_source.html#l00221">ast_event_get_type_name()</a>, <a class="el" href="event_8c_source.html#l01224">ast_event_hash()</a>, <a class="el" href="event_8c_source.html#l01094">ast_event_queue_and_cache()</a>, <a class="el" href="app__voicemail_8c_source.html#l10372">mwi_sub_event_cb()</a>, and <a class="el" href="app__voicemail_8c_source.html#l10356">mwi_unsub_event_cb()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00808"></a>00808 {
<a name="l00809"></a>00809    <span class="keywordflow">return</span> ntohs(event-&gt;type);
<a name="l00810"></a>00810 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aba6bf9f8f4b152ebce6d07df92353909"></a><!-- doxytag: member="event.c::ast_event_get_type_name" ref="aba6bf9f8f4b152ebce6d07df92353909" args="(const struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_event_get_type_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the string representation of the type of the given event. </p>
<ul>
<li>event the event to get the type of</li>
</ul>
<dl class="return"><dt><b>Returns:</b></dt><dd>the string representation of the event type of the provided event </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00221">221</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00807">ast_event_get_type()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="event_8c_source.html#l00189">event_name::name</a>, and <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00222"></a>00222 {
<a name="l00223"></a>00223    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f" title="Event types.">ast_event_type</a> <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>;
<a name="l00224"></a>00224 
<a name="l00225"></a>00225    type = <a class="code" href="event_8h.html#ab3055e3d85399352f0a4ca7404549d4b" title="Get the type for an event.">ast_event_get_type</a>(event);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227    <span class="keywordflow">if</span> (type &gt;= <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a> || type &lt; 0) {
<a name="l00228"></a>00228       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid event type - &apos;%d&apos;\n&quot;</span>, type);
<a name="l00229"></a>00229       <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00230"></a>00230    }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232    <span class="keywordflow">return</span> <a class="code" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>[type].<a class="code" href="structevent__name.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;
<a name="l00233"></a>00233 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6fe45949a73e5cf7873252dcf58d27c4"></a><!-- doxytag: member="event.c::ast_event_hash" ref="a6fe45949a73e5cf7873252dcf58d27c4" args="(const void *obj, const int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_event_hash </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01224">1224</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l00807">ast_event_get_type()</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, and <a class="el" href="event_8c_source.html#l00159">hash_fn</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01225"></a>01225 {
<a name="l01226"></a>01226    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref;
<a name="l01227"></a>01227    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event;
<a name="l01228"></a>01228    <a class="code" href="astobj2_8h.html#ab29eb962131d79590e1ee1f07ba41818">ao2_hash_fn</a> *<a class="code" href="event_8c.html#affe6d185cf034f97d9e746dbfc8fb11c" title="Event type specific hash function.">hash_fn</a>;
<a name="l01229"></a>01229 
<a name="l01230"></a>01230    event_ref = obj;
<a name="l01231"></a>01231    <span class="keyword">event</span> = event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>;
<a name="l01232"></a>01232 
<a name="l01233"></a>01233    <span class="keywordflow">if</span> (!(hash_fn = <a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[<a class="code" href="event_8h.html#ab3055e3d85399352f0a4ca7404549d4b" title="Get the type for an event.">ast_event_get_type</a>(event)].hash_fn)) {
<a name="l01234"></a>01234       <span class="keywordflow">return</span> 0;
<a name="l01235"></a>01235    }
<a name="l01236"></a>01236 
<a name="l01237"></a>01237    <span class="keywordflow">return</span> <a class="code" href="event_8c.html#affe6d185cf034f97d9e746dbfc8fb11c" title="Event type specific hash function.">hash_fn</a>(event, flags);
<a name="l01238"></a>01238 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aef78a76feb381fe9251d3523b232f754"></a><!-- doxytag: member="event.c::ast_event_hash_devstate" ref="aef78a76feb381fe9251d3523b232f754" args="(const void *obj, const int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_event_hash_devstate </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01201">1201</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00830">ast_event_get_ie_str()</a>, <a class="el" href="event__defs_8h_source.html#l00101">AST_EVENT_IE_DEVICE</a>, and <a class="el" href="strings_8h_source.html#l00856">ast_str_hash()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01202"></a>01202 {
<a name="l01203"></a>01203    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *<span class="keyword">event</span> = obj;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205    <span class="keywordflow">return</span> <a class="code" href="strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55" title="Compute a hash value on a string.">ast_str_hash</a>(<a class="code" href="event_8h.html#a0cfdd21162f4795714da583c31477151" title="Get the value of an information element that has a string payload.">ast_event_get_ie_str</a>(event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a675632af9f21fe7696772885593140e3" title="Device Name Used by AST_EVENT_DEVICE_STATE_CHANGE Payload type: STR.">AST_EVENT_IE_DEVICE</a>));
<a name="l01206"></a>01206 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f63b317b29d7589331f705437fc1252"></a><!-- doxytag: member="event.c::ast_event_hash_devstate_change" ref="a8f63b317b29d7589331f705437fc1252" args="(const void *obj, const int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_event_hash_devstate_change </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01217">1217</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00830">ast_event_get_ie_str()</a>, <a class="el" href="event__defs_8h_source.html#l00101">AST_EVENT_IE_DEVICE</a>, and <a class="el" href="strings_8h_source.html#l00856">ast_str_hash()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01218"></a>01218 {
<a name="l01219"></a>01219    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *<span class="keyword">event</span> = obj;
<a name="l01220"></a>01220 
<a name="l01221"></a>01221    <span class="keywordflow">return</span> <a class="code" href="strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55" title="Compute a hash value on a string.">ast_str_hash</a>(<a class="code" href="event_8h.html#a0cfdd21162f4795714da583c31477151" title="Get the value of an information element that has a string payload.">ast_event_get_ie_str</a>(event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a675632af9f21fe7696772885593140e3" title="Device Name Used by AST_EVENT_DEVICE_STATE_CHANGE Payload type: STR.">AST_EVENT_IE_DEVICE</a>));
<a name="l01222"></a>01222 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e6a3c179349c56bef20891f3cd1ab86"></a><!-- doxytag: member="event.c::ast_event_hash_mwi" ref="a8e6a3c179349c56bef20891f3cd1ab86" args="(const void *obj, const int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_event_hash_mwi </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01183">1183</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00830">ast_event_get_ie_str()</a>, <a class="el" href="event__defs_8h_source.html#l00115">AST_EVENT_IE_CONTEXT</a>, <a class="el" href="event__defs_8h_source.html#l00077">AST_EVENT_IE_MAILBOX</a>, <a class="el" href="strings_8h_source.html#l00856">ast_str_hash()</a>, <a class="el" href="strings_8h_source.html#l00881">ast_str_hash_add()</a>, <a class="el" href="chan__alsa_8c_source.html#l00105">context</a>, and <a class="el" href="chan__mgcp_8c_source.html#l00185">mailbox</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01184"></a>01184 {
<a name="l01185"></a>01185    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *<span class="keyword">event</span> = obj;
<a name="l01186"></a>01186    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a> = <a class="code" href="event_8h.html#a0cfdd21162f4795714da583c31477151" title="Get the value of an information element that has a string payload.">ast_event_get_ie_str</a>(event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aae6c80d8f4c6ab3cee006ed57d874710" title="Mailbox name.">AST_EVENT_IE_MAILBOX</a>);
<a name="l01187"></a>01187    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="event_8h.html#a0cfdd21162f4795714da583c31477151" title="Get the value of an information element that has a string payload.">ast_event_get_ie_str</a>(event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a25764e2fb734ccb3ee1f6f41caba5318" title="Context IE Used by AST_EVENT_MWI Payload type: str.">AST_EVENT_IE_CONTEXT</a>);
<a name="l01188"></a>01188 
<a name="l01189"></a>01189    <span class="keywordflow">return</span> <a class="code" href="strings_8h.html#af5b9c2f00e4b0c1fe92f6d565a4b93e5" title="Compute a hash value on a string.">ast_str_hash_add</a>(context, <a class="code" href="strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55" title="Compute a hash value on a string.">ast_str_hash</a>(mailbox));
<a name="l01190"></a>01190 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a60d50b16f7ea1bc953a3bab12bb57a53"></a><!-- doxytag: member="event.c::ast_event_ie_val_destroy" ref="a60d50b16f7ea1bc953a3bab12bb57a53" args="(struct ast_event_ie_val *ie_val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_event_ie_val_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__ie__val.html">ast_event_ie_val</a> *&nbsp;</td>
          <td class="paramname"> <em>ie_val</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00304">304</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event__defs_8h_source.html#l00131">AST_EVENT_IE_PLTYPE_UNKNOWN</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00113">ast_event_ie_val::raw</a>, and <a class="el" href="event_8c_source.html#l00111">ast_event_ie_val::str</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00733">ast_event_sub_destroy()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00305"></a>00305 {
<a name="l00306"></a>00306    <span class="keywordflow">switch</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a>) {
<a name="l00307"></a>00307    <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>:
<a name="l00308"></a>00308       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">char</span> *) ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00309"></a>00309       <span class="keywordflow">break</span>;
<a name="l00310"></a>00310    <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>:
<a name="l00311"></a>00311       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>);
<a name="l00312"></a>00312       <span class="keywordflow">break</span>;
<a name="l00313"></a>00313    <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>:
<a name="l00314"></a>00314    <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>:
<a name="l00315"></a>00315    <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6aefc05976cb496dd18e686b0e62773e54">AST_EVENT_IE_PLTYPE_UNKNOWN</a>:
<a name="l00316"></a>00316       <span class="keywordflow">break</span>;
<a name="l00317"></a>00317    }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ie_val);
<a name="l00320"></a>00320 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aec784d4f5e2d7d9d6115f85531f17536"></a><!-- doxytag: member="event.c::ast_event_init" ref="aec784d4f5e2d7d9d6115f85531f17536" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Provided by <a class="el" href="event_8c.html" title="Internal generic event system.">event.c</a> </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l01289">1289</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00727">ao2_container_alloc</a>, <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>, <a class="el" href="event_8c_source.html#l01224">ast_event_hash()</a>, <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>, <a class="el" href="dlinkedlists_8h_source.html#l00797">AST_RWDLLIST_HEAD_INIT</a>, <a class="el" href="taskprocessor_8c_source.html#l00407">ast_taskprocessor_get()</a>, <a class="el" href="event_8c_source.html#l00157">container</a>, <a class="el" href="event_8c_source.html#l00159">hash_fn</a>, and <a class="el" href="event_8c_source.html#l00142">NUM_CACHE_BUCKETS</a>.</p>

<p>Referenced by <a class="el" href="asterisk_8c_source.html#l03095">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01290"></a>01290 {
<a name="l01291"></a>01291    <span class="keywordtype">int</span> i;
<a name="l01292"></a>01292 
<a name="l01293"></a>01293    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a>; i++) {
<a name="l01294"></a>01294       <a class="code" href="dlinkedlists_8h.html#ab53efffc0cc9f1f562346f3cdaacdd86" title="Initializes an rwlist head structure.">AST_RWDLLIST_HEAD_INIT</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[i]);
<a name="l01295"></a>01295    }
<a name="l01296"></a>01296 
<a name="l01297"></a>01297    <span class="keywordflow">for</span> (i = 0; i &lt; AST_EVENT_TOTAL; i++) {
<a name="l01298"></a>01298       <span class="keywordflow">if</span> (!<a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[i].<a class="code" href="event_8c.html#affe6d185cf034f97d9e746dbfc8fb11c" title="Event type specific hash function.">hash_fn</a>) {
<a name="l01299"></a>01299          <span class="comment">/* This event type is not cached. */</span>
<a name="l01300"></a>01300          <span class="keywordflow">continue</span>;
<a name="l01301"></a>01301       }
<a name="l01302"></a>01302 
<a name="l01303"></a>01303       <span class="keywordflow">if</span> (!(<a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[i].<a class="code" href="event_8c.html#a7ea220e4d14b05876af4430e9832ce47" title="Container of cached events.">container</a> = <a class="code" href="astobj2_8h.html#a82534c91be59ec9a3d3318ec85ac5695">ao2_container_alloc</a>(<a class="code" href="event_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a>,
<a name="l01304"></a>01304             <a class="code" href="event_8c.html#a6fe45949a73e5cf7873252dcf58d27c4">ast_event_hash</a>, <a class="code" href="event_8c.html#a035a5a41a4ae577dc7dcfb6c521f4262">ast_event_cmp</a>))) {
<a name="l01305"></a>01305          <span class="keywordflow">return</span> -1;
<a name="l01306"></a>01306       }
<a name="l01307"></a>01307    }
<a name="l01308"></a>01308 
<a name="l01309"></a>01309    <span class="keywordflow">if</span> (!(<a class="code" href="event_8c.html#a09a2211349df9d6af32a8a88153037a1">event_dispatcher</a> = <a class="code" href="taskprocessor_8h.html#a3d670ce6d9ed07b5db0dae8d2c11d275" title="Get a reference to a taskprocessor with the specified name and create the taskprocessor...">ast_taskprocessor_get</a>(<span class="stringliteral">&quot;core_event_dispatcher&quot;</span>, 0))) {
<a name="l01310"></a>01310       <span class="keywordflow">return</span> -1;
<a name="l01311"></a>01311    }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313    <span class="keywordflow">return</span> 0;
<a name="l01314"></a>01314 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a28864f3757ef7e984964ea4adc940c16"></a><!-- doxytag: member="event.c::ast_event_iterator_get_ie_raw" ref="a28864f3757ef7e984964ea4adc940c16" args="(struct ast_event_iterator *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* ast_event_iterator_get_ie_raw </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of the current IE in the iterator instance that has a raw payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterator</em>&nbsp;</td><td>The iterator instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the payload of the information element as type raw. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00802">802</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00167">ast_event_iterator::ie</a>, and <a class="el" href="event_8c_source.html#l00056">ast_event_ie::ie_payload</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00803"></a>00803 {
<a name="l00804"></a>00804    <span class="keywordflow">return</span> iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>-&gt;<a class="code" href="structast__event__ie.html#a327a94a0d22e249894388f963e369616">ie_payload</a>;
<a name="l00805"></a>00805 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5530313cb1748db1621f26ff8e7cca1a"></a><!-- doxytag: member="event.c::ast_event_iterator_get_ie_str" ref="a5530313cb1748db1621f26ff8e7cca1a" args="(struct ast_event_iterator *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_event_iterator_get_ie_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of the current IE in the iterator as a string payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterator</em>&nbsp;</td><td>The iterator instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the payload of the information element as a string. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00793">793</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00167">ast_event_iterator::ie</a>, <a class="el" href="event_8c_source.html#l00056">ast_event_ie::ie_payload</a>, and <a class="el" href="event_8c_source.html#l00066">ast_event_ie_str_payload::str</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00794"></a>00794 {
<a name="l00795"></a>00795    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event__ie__str__payload.html" title="The payload for a string information element.">ast_event_ie_str_payload</a> *str_payload;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797    str_payload = (<span class="keyword">struct </span><a class="code" href="structast__event__ie__str__payload.html" title="The payload for a string information element.">ast_event_ie_str_payload</a> *) iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>-&gt;<a class="code" href="structast__event__ie.html#a327a94a0d22e249894388f963e369616">ie_payload</a>;
<a name="l00798"></a>00798 
<a name="l00799"></a>00799    <span class="keywordflow">return</span> str_payload ? str_payload-&gt;<a class="code" href="structast__event__ie__str__payload.html#a116e6a69d08490a4a76cc9f5254271b6" title="The actual string, null terminated.">str</a> : NULL;
<a name="l00800"></a>00800 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9489c71e419286a9a953d7b42f137e8d"></a><!-- doxytag: member="event.c::ast_event_iterator_get_ie_type" ref="a9489c71e419286a9a953d7b42f137e8d" args="(struct ast_event_iterator *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> ast_event_iterator_get_ie_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the type of the current IE in the iterator instance. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterator</em>&nbsp;</td><td>The iterator instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the ie type as represented by one of the value sin the ast_event_ie_type enum </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00783">783</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00167">ast_event_iterator::ie</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00784"></a>00784 {
<a name="l00785"></a>00785    <span class="keywordflow">return</span> ntohs(iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>-&gt;ie_type);
<a name="l00786"></a>00786 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc251e977f9c0f4556969b53021396bb"></a><!-- doxytag: member="event.c::ast_event_iterator_get_ie_uint" ref="afc251e977f9c0f4556969b53021396bb" args="(struct ast_event_iterator *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t ast_event_iterator_get_ie_uint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of the current IE in the ierator as an integer payload. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterator</em>&nbsp;</td><td>The iterator instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the payload of the information element as a uint. </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00788">788</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="unaligned_8h_source.html#l00032">get_unaligned_uint32()</a>, <a class="el" href="event__defs_8h_source.html#l00167">ast_event_iterator::ie</a>, and <a class="el" href="event_8c_source.html#l00056">ast_event_ie::ie_payload</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00789"></a>00789 {
<a name="l00790"></a>00790    <span class="keywordflow">return</span> ntohl(<a class="code" href="unaligned_8h.html#a20439709a482f3784d175d2b8fa67973">get_unaligned_uint32</a>(iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>-&gt;<a class="code" href="structast__event__ie.html#a327a94a0d22e249894388f963e369616">ie_payload</a>));
<a name="l00791"></a>00791 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a626ad7a515a386627d3ccefdf1296854"></a><!-- doxytag: member="event.c::ast_event_iterator_init" ref="a626ad7a515a386627d3ccefdf1296854" args="(struct ast_event_iterator *iterator, const struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_event_iterator_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize an event iterator instance. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterator</em>&nbsp;</td><td>The iterator instance to initialize </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event that will be iterated through</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Nothing </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00769">769</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00166">ast_event_iterator::event</a>, <a class="el" href="event_8c_source.html#l00082">ast_event::event_len</a>, <a class="el" href="event__defs_8h_source.html#l00165">ast_event_iterator::event_len</a>, and <a class="el" href="event__defs_8h_source.html#l00167">ast_event_iterator::ie</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00770"></a>00770 {
<a name="l00771"></a>00771    iterator-&gt;<a class="code" href="structast__event__iterator.html#a6f0feaf780ae1896ac987af24831a066">event_len</a> = ntohs(event-&gt;<a class="code" href="structast__event.html#a6f0feaf780ae1896ac987af24831a066">event_len</a>);
<a name="l00772"></a>00772    iterator-&gt;<a class="code" href="structast__event__iterator.html#a29023d239b1af1921483e7904625ec48">event</a> = event;
<a name="l00773"></a>00773    iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a> = (<span class="keyword">struct </span><a class="code" href="structast__event__ie.html" title="An event information element.">ast_event_ie</a> *) ( ((<span class="keywordtype">char</span> *) event) + <span class="keyword">sizeof</span>(*event) );
<a name="l00774"></a>00774    <span class="keywordflow">return</span>;
<a name="l00775"></a>00775 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9bfda528d51f60f72549f1089f4cd12f"></a><!-- doxytag: member="event.c::ast_event_iterator_next" ref="a9bfda528d51f60f72549f1089f4cd12f" args="(struct ast_event_iterator *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_iterator_next </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__iterator.html">ast_event_iterator</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Move iterator instance to next IE. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterator</em>&nbsp;</td><td>The iterator instance</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>if end is reached </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00777">777</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00166">ast_event_iterator::event</a>, <a class="el" href="event__defs_8h_source.html#l00165">ast_event_iterator::event_len</a>, <a class="el" href="event__defs_8h_source.html#l00167">ast_event_iterator::ie</a>, and <a class="el" href="event_8c_source.html#l00053">ast_event_ie::ie_payload_len</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00778"></a>00778 {
<a name="l00779"></a>00779    iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a> = (<span class="keyword">struct </span><a class="code" href="structast__event__ie.html" title="An event information element.">ast_event_ie</a> *) ( ((<span class="keywordtype">char</span> *) iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>) + <span class="keyword">sizeof</span>(*iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>) + ntohs(iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>-&gt;<a class="code" href="structast__event__ie.html#ad7093978981d9bdb2b5d522b1197899f">ie_payload_len</a>));
<a name="l00780"></a>00780    <span class="keywordflow">return</span> ((iterator-&gt;<a class="code" href="structast__event__iterator.html#a6f0feaf780ae1896ac987af24831a066">event_len</a> &lt;= (((<span class="keywordtype">char</span> *) iterator-&gt;<a class="code" href="structast__event__iterator.html#ad28c072642f7cebe4d10e4dc3c002600">ie</a>) - ((<span class="keywordtype">char</span> *) iterator-&gt;<a class="code" href="structast__event__iterator.html#a29023d239b1af1921483e7904625ec48">event</a>))) ? -1 : 0);
<a name="l00781"></a>00781 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="add66927845c7f5eada84081eec47306b"></a><!-- doxytag: member="event.c::ast_event_new" ref="add66927845c7f5eada84081eec47306b" args="(enum ast_event_type type,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__event.html">ast_event</a>* ast_event_new </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a>&nbsp;</td>
          <td class="paramname"> <em>event_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event_type</em>&nbsp;</td><td>The type of event to create</td></tr>
  </table>
  </dd>
</dl>
<p>The rest of the arguments to this function specify information elements to add to the event. They are specified in the form: </p>
<div class="fragment"><pre class="fragment">    &lt;<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>&gt;, [<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>, [payload] ]
</pre></div><p> and must end with AST_EVENT_IE_END.</p>
<p>If the ie_type specified is *not* AST_EVENT_IE_END, then it must be followed by a valid IE payload type. The payload type, EXISTS, should not be used here because it makes no sense to do so. So, a payload must also be specified after the IE payload type.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns the event that has been created. If there is an error creating the event, NULL will be returned.</dd></dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">if</span> (!(event = <a class="code" href="event_8h.html#afb4a2a00de28bb0733037060da8c4bac" title="Create a new event.">ast_event_new</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa9a217b1f500680b3e458d62b048c0892">AST_EVENT_MWI</a>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aae6c80d8f4c6ab3cee006ed57d874710" title="Mailbox name.">AST_EVENT_IE_MAILBOX</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aff40847f0450f17c96e94e721aee38f2" title="Number of new messages Used by: AST_EVENT_MWI Payload type: UINT.">AST_EVENT_IE_NEWMSGS</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, <span class="keyword">new</span>,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aeda30786b0dfece37a9a06b84a653fd9" title="Number of Used by: AST_EVENT_MWI Payload type: UINT.">AST_EVENT_IE_OLDMSGS</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, old,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>))) {
       <span class="keywordflow">return</span>;
 }
</pre></div><p>This creates a MWI event with 3 information elements, a mailbox which is a string, and the <a class="el" href="structnumber.html" title="Number structure.">number</a> of new and old messages, specified as integers. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00897">897</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="asterisk_8c_source.html#l00185">ast_eid_default</a>, <a class="el" href="event_8c_source.html#l00874">ast_event_append_ie_raw()</a>, <a class="el" href="event_8c_source.html#l00852">ast_event_append_ie_str()</a>, <a class="el" href="event_8c_source.html#l00867">ast_event_append_ie_uint()</a>, <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>, <a class="el" href="event__defs_8h_source.html#l00122">AST_EVENT_IE_EID</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="linkedlists_8h_source.html#l00345">AST_LIST_HEAD_NOLOCK_STATIC</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00113">ast_event_ie_val::raw</a>, <a class="el" href="event_8c_source.html#l00115">ast_event_ie_val::raw_datalen</a>, <a class="el" href="event_8c_source.html#l00111">ast_event_ie_val::str</a>, and <a class="el" href="event_8c_source.html#l00108">ast_event_ie_val::uint</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l00743">ast_event_unsubscribe()</a>, <a class="el" href="devicestate_8c_source.html#l00427">devstate_event()</a>, <a class="el" href="event_8c_source.html#l00472">gen_sub_event()</a>, <a class="el" href="chan__sip_8c_source.html#l18980">handle_request_notify()</a>, <a class="el" href="chan__dahdi_8c_source.html#l02940">notify_message()</a>, <a class="el" href="devicestate_8c_source.html#l00593">process_collection()</a>, and <a class="el" href="app__minivm_8c_source.html#l01771">queue_mwi_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00898"></a>00898 {
<a name="l00899"></a>00899    va_list ap;
<a name="l00900"></a>00900    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event;
<a name="l00901"></a>00901    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a> ie_type;
<a name="l00902"></a>00902    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00903"></a>00903    <a class="code" href="linkedlists_8h.html#a547735280f0983afc46bf476d17be24a" title="Defines a structure to be used to hold a list of specified type, statically initialized...">AST_LIST_HEAD_NOLOCK_STATIC</a>(ie_vals, <a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a>);
<a name="l00904"></a>00904 
<a name="l00905"></a>00905    <span class="comment">/* Invalid type */</span>
<a name="l00906"></a>00906    <span class="keywordflow">if</span> (<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> &gt;= <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a>) {
<a name="l00907"></a>00907       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Someone tried to create an event of invalid &quot;</span>
<a name="l00908"></a>00908          <span class="stringliteral">&quot;type &apos;%d&apos;!\n&quot;</span>, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l00909"></a>00909       <span class="keywordflow">return</span> NULL;
<a name="l00910"></a>00910    }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912    va_start(ap, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l00913"></a>00913    <span class="keywordflow">for</span> (ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>);
<a name="l00914"></a>00914       ie_type != <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>;
<a name="l00915"></a>00915       ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>))
<a name="l00916"></a>00916    {
<a name="l00917"></a>00917       <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_value = alloca(<span class="keyword">sizeof</span>(*ie_value));
<a name="l00918"></a>00918       memset(ie_value, 0, <span class="keyword">sizeof</span>(*ie_value));
<a name="l00919"></a>00919       ie_value-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = ie_type;
<a name="l00920"></a>00920       ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>);
<a name="l00921"></a>00921       <span class="keywordflow">if</span> (ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>)
<a name="l00922"></a>00922          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a> = va_arg(ap, uint32_t);
<a name="l00923"></a>00923       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>)
<a name="l00924"></a>00924          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(va_arg(ap, <span class="keyword">const</span> <span class="keywordtype">char</span> *));
<a name="l00925"></a>00925       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>) {
<a name="l00926"></a>00926          <span class="keywordtype">void</span> *data = va_arg(ap, <span class="keywordtype">void</span> *);
<a name="l00927"></a>00927          <span class="keywordtype">size_t</span> datalen = va_arg(ap, <span class="keywordtype">size_t</span>);
<a name="l00928"></a>00928          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a> = alloca(datalen);
<a name="l00929"></a>00929          memcpy(ie_value-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, data, datalen);
<a name="l00930"></a>00930          ie_value-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a> = datalen;
<a name="l00931"></a>00931       }
<a name="l00932"></a>00932       <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;ie_vals, ie_value, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>);
<a name="l00933"></a>00933    }
<a name="l00934"></a>00934    va_end(ap);
<a name="l00935"></a>00935 
<a name="l00936"></a>00936    <span class="keywordflow">if</span> (!(event = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*event))))
<a name="l00937"></a>00937       <span class="keywordflow">return</span> NULL;
<a name="l00938"></a>00938 
<a name="l00939"></a>00939    <span class="keyword">event</span>-&gt;type = htons(<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l00940"></a>00940    <span class="keyword">event</span>-&gt;event_len = htons(<span class="keyword">sizeof</span>(*event));
<a name="l00941"></a>00941 
<a name="l00942"></a>00942    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;ie_vals, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00943"></a>00943       <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>)
<a name="l00944"></a>00944          <a class="code" href="event_8h.html#a5b498b3f3d2abf74ba1274064e2cd972" title="Append an information element that has a string payload.">ast_event_append_ie_str</a>(&amp;event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00945"></a>00945       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>)
<a name="l00946"></a>00946          <a class="code" href="event_8h.html#ac426e171245008ad590d9e365066584b" title="Append an information element that has an integer payload.">ast_event_append_ie_uint</a>(&amp;event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a>);
<a name="l00947"></a>00947       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>)
<a name="l00948"></a>00948          <a class="code" href="event_8h.html#aabc5e8aa1db613cf02136391830c5a25" title="Append an information element that has a raw payload.">ast_event_append_ie_raw</a>(&amp;event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>);
<a name="l00949"></a>00949 
<a name="l00950"></a>00950       <span class="keywordflow">if</span> (!event)
<a name="l00951"></a>00951          <span class="keywordflow">break</span>;
<a name="l00952"></a>00952    }
<a name="l00953"></a>00953 
<a name="l00954"></a>00954    <span class="keywordflow">if</span> (!<a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a8e38c9805132c95123e80568ba508b17" title="Entity ID Used by All events Payload type: RAW This IE indicates which server the...">AST_EVENT_IE_EID</a>)) {
<a name="l00955"></a>00955       <span class="comment">/* If the event is originating on this server, add the server&apos;s</span>
<a name="l00956"></a>00956 <span class="comment">       * entity ID to the event. */</span>
<a name="l00957"></a>00957       <a class="code" href="event_8h.html#aabc5e8aa1db613cf02136391830c5a25" title="Append an information element that has a raw payload.">ast_event_append_ie_raw</a>(&amp;event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a8e38c9805132c95123e80568ba508b17" title="Entity ID Used by All events Payload type: RAW This IE indicates which server the...">AST_EVENT_IE_EID</a>, &amp;<a class="code" href="utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f" title="Global EID.">ast_eid_default</a>, <span class="keyword">sizeof</span>(<a class="code" href="utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f" title="Global EID.">ast_eid_default</a>));
<a name="l00958"></a>00958    }
<a name="l00959"></a>00959 
<a name="l00960"></a>00960    <span class="keywordflow">return</span> event;
<a name="l00961"></a>00961 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4cb88202df41eff644ed6748156d6e73"></a><!-- doxytag: member="event.c::ast_event_queue" ref="a4cb88202df41eff644ed6748156d6e73" args="(struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_queue </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Queue an event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event to be queued</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>zero</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure. Note that the caller of this function is responsible for destroying the event in the case of a failure.</td></tr>
  </table>
  </dd>
</dl>
<p>This function queues an event to be dispatched to all of the appropriate subscribers. This function will not block while the event is being dispatched because the event is queued up for a dispatching thread to handle. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l01153">1153</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l01064">alloc_event_ref()</a>, <a class="el" href="event_8c_source.html#l00322">ast_event_check_subscriber()</a>, <a class="el" href="event_8c_source.html#l00963">ast_event_destroy()</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00149">AST_EVENT_SUB_NONE</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="taskprocessor_8c_source.html#l00482">ast_taskprocessor_push()</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, <a class="el" href="event_8c_source.html#l01117">handle_event()</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01094">ast_event_queue_and_cache()</a>, <a class="el" href="event_8c_source.html#l00660">ast_event_sub_activate()</a>, and <a class="el" href="event_8c_source.html#l00743">ast_event_unsubscribe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01154"></a>01154 {
<a name="l01155"></a>01155    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref;
<a name="l01156"></a>01156    uint16_t host_event_type;
<a name="l01157"></a>01157 
<a name="l01158"></a>01158    host_event_type = ntohs(event-&gt;type);
<a name="l01159"></a>01159 
<a name="l01160"></a>01160    <span class="comment">/* Invalid type */</span>
<a name="l01161"></a>01161    <span class="keywordflow">if</span> (host_event_type &gt;= <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a>) {
<a name="l01162"></a>01162       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Someone tried to queue an event of invalid &quot;</span>
<a name="l01163"></a>01163          <span class="stringliteral">&quot;type &apos;%d&apos;!\n&quot;</span>, host_event_type);
<a name="l01164"></a>01164       <span class="keywordflow">return</span> -1;
<a name="l01165"></a>01165    }
<a name="l01166"></a>01166 
<a name="l01167"></a>01167    <span class="comment">/* If nobody has subscribed to this event type, throw it away now */</span>
<a name="l01168"></a>01168    <span class="keywordflow">if</span> (<a class="code" href="event_8h.html#aa1c7994fe2874e895ef28b615bb9aaa6" title="Check if subscribers exist.">ast_event_check_subscriber</a>(host_event_type, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>)
<a name="l01169"></a>01169          == <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5af298aea21d354fd45878d4c0769f0844">AST_EVENT_SUB_NONE</a>) {
<a name="l01170"></a>01170       <a class="code" href="event_8h.html#a50b34e0161630dbbc0880a06eb78ad7a" title="Destroy an event.">ast_event_destroy</a>(event);
<a name="l01171"></a>01171       <span class="keywordflow">return</span> 0;
<a name="l01172"></a>01172    }
<a name="l01173"></a>01173 
<a name="l01174"></a>01174    <span class="keywordflow">if</span> (!(event_ref = <a class="code" href="event_8c.html#ac522ef0b99074a82366fb537be860f9d">alloc_event_ref</a>())) {
<a name="l01175"></a>01175       <span class="keywordflow">return</span> -1;
<a name="l01176"></a>01176    }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178    event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a> = event;
<a name="l01179"></a>01179 
<a name="l01180"></a>01180    <span class="keywordflow">return</span> <a class="code" href="taskprocessor_8h.html#a815e690b2db467f47655ebaa5d85fb69" title="Push a task into the specified taskprocessor queue and signal the taskprocessor thread...">ast_taskprocessor_push</a>(<a class="code" href="event_8c.html#a09a2211349df9d6af32a8a88153037a1">event_dispatcher</a>, <a class="code" href="event_8c.html#a519439b120decff748c793c7ecf0c1ce">handle_event</a>, event_ref);
<a name="l01181"></a>01181 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5ef4e1053ab8a91ebdcf4dd6ad1c81c4"></a><!-- doxytag: member="event.c::ast_event_queue_and_cache" ref="a5ef4e1053ab8a91ebdcf4dd6ad1c81c4" args="(struct ast_event *event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_queue_and_cache </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Queue and cache an event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>the event to be queued and cached</td></tr>
  </table>
  </dd>
</dl>
<p>The purpose of caching events is so that the core can retain the last known information for events that represent some sort of <a class="el" href="structstate.html">state</a>. That way, when code needs to find out the current <a class="el" href="structstate.html">state</a>, it can query the cache.</p>
<p>The event API already knows which events can be cached and how to cache them.</p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure. If failure is returned, the event must be destroyed by the caller of this function. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l01094">1094</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00916">ao2_callback</a>, <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>, <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>, <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, <a class="el" href="event_8c_source.html#l00807">ast_event_get_type()</a>, <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="event_8c_source.html#l00157">container</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="astobj2_8h_source.html#l00673">OBJ_MULTIPLE</a>, <a class="el" href="astobj2_8h_source.html#l00667">OBJ_NODATA</a>, <a class="el" href="astobj2_8h_source.html#l00678">OBJ_POINTER</a>, <a class="el" href="astobj2_8h_source.html#l00664">OBJ_UNLINK</a>, and <a class="el" href="evt_8c_source.html#l00113">queue_event()</a>.</p>

<p>Referenced by <a class="el" href="devicestate_8c_source.html#l00427">devstate_event()</a>, <a class="el" href="chan__sip_8c_source.html#l18980">handle_request_notify()</a>, <a class="el" href="chan__dahdi_8c_source.html#l02940">notify_message()</a>, <a class="el" href="devicestate_8c_source.html#l00593">process_collection()</a>, <a class="el" href="evt_8c_source.html#l00113">queue_event()</a>, and <a class="el" href="app__minivm_8c_source.html#l01771">queue_mwi_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01095"></a>01095 {
<a name="l01096"></a>01096    <span class="keyword">struct </span><a class="code" href="structao2__container.html">ao2_container</a> *<a class="code" href="event_8c.html#a7ea220e4d14b05876af4430e9832ce47" title="Container of cached events.">container</a>;
<a name="l01097"></a>01097    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> tmp_event_ref = {
<a name="l01098"></a>01098       .event = event,
<a name="l01099"></a>01099    };
<a name="l01100"></a>01100    <span class="keywordtype">int</span> res = -1;
<a name="l01101"></a>01101 
<a name="l01102"></a>01102    <span class="keywordflow">if</span> (!(container = <a class="code" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523" title="Event types that are kept in the cache.">ast_event_cache</a>[<a class="code" href="event_8h.html#ab3055e3d85399352f0a4ca7404549d4b" title="Get the type for an event.">ast_event_get_type</a>(event)].container)) {
<a name="l01103"></a>01103       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;cache requested for non-cached event type\n&quot;</span>);
<a name="l01104"></a>01104       <span class="keywordflow">goto</span> <a class="code" href="evt_8c.html#a3d81c0c295b9f24eb05c884226e95245">queue_event</a>;
<a name="l01105"></a>01105    }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107    <span class="comment">/* Remove matches from the cache */</span>
<a name="l01108"></a>01108    <a class="code" href="astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(container, <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca32d49976aaebc093266f0b080f9c9a73">OBJ_POINTER</a> | <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>,
<a name="l01109"></a>01109          <a class="code" href="event_8c.html#a035a5a41a4ae577dc7dcfb6c521f4262">ast_event_cmp</a>, &amp;tmp_event_ref);
<a name="l01110"></a>01110 
<a name="l01111"></a>01111    res = <a class="code" href="event_8c.html#abd69b1e34572883b69860756ef3d69bd" title="Duplicate an event and add it to the cache.">ast_event_dup_and_cache</a>(event);
<a name="l01112"></a>01112 
<a name="l01113"></a>01113 <a class="code" href="evt_8c.html#a3d81c0c295b9f24eb05c884226e95245">queue_event</a>:
<a name="l01114"></a>01114    <span class="keywordflow">return</span> <a class="code" href="event_8h.html#a4cb88202df41eff644ed6748156d6e73" title="Queue an event.">ast_event_queue</a>(event) ? -1 : res;
<a name="l01115"></a>01115 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa8caee91d1ab18db35f3a4bfd18c1536"></a><!-- doxytag: member="event.c::ast_event_ref_destroy" ref="aa8caee91d1ab18db35f3a4bfd18c1536" args="(void *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ast_event_ref_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00968">968</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00963">ast_event_destroy()</a>, and <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01064">alloc_event_ref()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00969"></a>00969 {
<a name="l00970"></a>00970    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref = obj;
<a name="l00971"></a>00971 
<a name="l00972"></a>00972    <a class="code" href="event_8h.html#a50b34e0161630dbbc0880a06eb78ad7a" title="Destroy an event.">ast_event_destroy</a>(event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>);
<a name="l00973"></a>00973 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a44b01d7e4b04a98a8fce9943e1e5affd"></a><!-- doxytag: member="event.c::ast_event_report_subs" ref="a44b01d7e4b04a98a8fce9943e1e5affd" args="(const struct ast_event_sub *event_sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_event_report_subs </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>event_sub</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send AST_EVENT_SUB events to this subscriber of ... subscriber events. </p>
<p>Report current subscriptions to a subscription subscriber. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00510">510</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00963">ast_event_destroy()</a>, <a class="el" href="event__defs_8h_source.html#l00089">AST_EVENT_IE_EVENTTYPE</a>, <a class="el" href="event__defs_8h_source.html#l00042">AST_EVENT_SUB</a>, <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="dlinkedlists_8h_source.html#l00071">AST_RWDLLIST_RDLOCK</a>, <a class="el" href="dlinkedlists_8h_source.html#l00506">AST_RWDLLIST_TRAVERSE</a>, <a class="el" href="dlinkedlists_8h_source.html#l00134">AST_RWDLLIST_UNLOCK</a>, <a class="el" href="event_8c_source.html#l00121">ast_event_sub::cb</a>, <a class="el" href="event_8c_source.html#l00472">gen_sub_event()</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>, <a class="el" href="event_8c_source.html#l00108">ast_event_ie_val::uint</a>, and <a class="el" href="event_8c_source.html#l00122">ast_event_sub::userdata</a>.</p>

<p>Referenced by <a class="el" href="app__voicemail_8c_source.html#l10395">start_poll_thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00511"></a>00511 {
<a name="l00512"></a>00512    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event;
<a name="l00513"></a>00513    <span class="keyword">struct </span><a class="code" href="structast__event__sub.html" title="Event subscription.">ast_event_sub</a> *sub;
<a name="l00514"></a>00514    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f" title="Event types.">ast_event_type</a> event_type = -1;
<a name="l00515"></a>00515    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517    <span class="keywordflow">if</span> (event_sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> != <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faefc08b90f280fd17876d70595c2c0eda">AST_EVENT_SUB</a>)
<a name="l00518"></a>00518       <span class="keywordflow">return</span>;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;event_sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00521"></a>00521       <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> == <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491adef1da9ee188613895b2bbfd05960710" title="Event type Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_EVENTTYPE</a>) {
<a name="l00522"></a>00522          event_type = ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a>;
<a name="l00523"></a>00523          <span class="keywordflow">break</span>;
<a name="l00524"></a>00524       }
<a name="l00525"></a>00525    }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527    <span class="keywordflow">if</span> (event_type == -1)
<a name="l00528"></a>00528       <span class="keywordflow">return</span>;
<a name="l00529"></a>00529 
<a name="l00530"></a>00530    <a class="code" href="dlinkedlists_8h.html#ac3f1fc4c00a1454e2ce161fa9ad3636c" title="Read locks a list.">AST_RWDLLIST_RDLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[event_type]);
<a name="l00531"></a>00531    <a class="code" href="dlinkedlists_8h.html#a192b1276ffe754b8201a72985ed5d434">AST_RWDLLIST_TRAVERSE</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[event_type], sub, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00532"></a>00532       <span class="keywordflow">if</span> (event_sub == sub)
<a name="l00533"></a>00533          <span class="keywordflow">continue</span>;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535       <span class="keyword">event</span> = <a class="code" href="event_8c.html#ae353ab13a10332fac23149d28efc0189">gen_sub_event</a>(sub);
<a name="l00536"></a>00536 
<a name="l00537"></a>00537       <span class="keywordflow">if</span> (!event)
<a name="l00538"></a>00538          <span class="keywordflow">continue</span>;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540       event_sub-&gt;<a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a>(event, event_sub-&gt;<a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>);
<a name="l00541"></a>00541 
<a name="l00542"></a>00542       <a class="code" href="event_8h.html#a50b34e0161630dbbc0880a06eb78ad7a" title="Destroy an event.">ast_event_destroy</a>(event);
<a name="l00543"></a>00543    }
<a name="l00544"></a>00544    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[event_type]);
<a name="l00545"></a>00545 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2605cfdf3e95c109391eacf586989956"></a><!-- doxytag: member="event.c::ast_event_str_to_event_type" ref="a2605cfdf3e95c109391eacf586989956" args="(const char *str, enum ast_event_type *event_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_str_to_event_type </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a> *&nbsp;</td>
          <td class="paramname"> <em>event_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert a string into an event type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>the string to convert </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>event_type</em>&nbsp;</td><td>an output parameter for the event type</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00235">235</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>, <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>, and <a class="el" href="event_8c_source.html#l00188">event_name::type</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00236"></a>00236 {
<a name="l00237"></a>00237    <span class="keywordtype">int</span> i;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>); i++) {
<a name="l00240"></a>00240       <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>[i].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>))
<a name="l00241"></a>00241          <span class="keywordflow">continue</span>;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243       *event_type = <a class="code" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>[i].<a class="code" href="structevent__name.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>;
<a name="l00244"></a>00244       <span class="keywordflow">return</span> 0;
<a name="l00245"></a>00245    }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247    <span class="keywordflow">return</span> -1;
<a name="l00248"></a>00248 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a55d3ae1fabf653848a3c888070e4fa34"></a><!-- doxytag: member="event.c::ast_event_str_to_ie_type" ref="a55d3ae1fabf653848a3c888070e4fa34" args="(const char *str, enum ast_event_ie_type *ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_str_to_ie_type </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> *&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert a string to an IE type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>the string to convert </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>an output parameter for the IE type</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00280">280</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>, <a class="el" href="event_8c_source.html#l00204">ie_map::ie_type</a>, and <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00281"></a>00281 {
<a name="l00282"></a>00282    <span class="keywordtype">int</span> i;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>); i++) {
<a name="l00285"></a>00285       <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[i].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>))
<a name="l00286"></a>00286          <span class="keywordflow">continue</span>;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288       *<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = <a class="code" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[i].<a class="code" href="structie__map.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>;
<a name="l00289"></a>00289       <span class="keywordflow">return</span> 0;
<a name="l00290"></a>00290    }
<a name="l00291"></a>00291 
<a name="l00292"></a>00292    <span class="keywordflow">return</span> -1;
<a name="l00293"></a>00293 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a102995befaeb86bcfce49ae115de8af7"></a><!-- doxytag: member="event.c::ast_event_sub_activate" ref="a102995befaeb86bcfce49ae115de8af7" args="(struct ast_event_sub *sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_sub_activate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Activate a dynamically built subscription. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>the subscription to activate that was allocated using <a class="el" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new()</a></td></tr>
  </table>
  </dd>
</dl>
<p>Once a dynamically built subscription has had all of the parameters added to it, it should be activated using this function.</p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00660">660</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00322">ast_event_check_subscriber()</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00089">AST_EVENT_IE_EVENTTYPE</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>, <a class="el" href="event__defs_8h_source.html#l00042">AST_EVENT_SUB</a>, <a class="el" href="event__defs_8h_source.html#l00149">AST_EVENT_SUB_NONE</a>, <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>, <a class="el" href="dlinkedlists_8h_source.html#l00937">AST_RWDLLIST_INSERT_TAIL</a>, <a class="el" href="dlinkedlists_8h_source.html#l00134">AST_RWDLLIST_UNLOCK</a>, <a class="el" href="dlinkedlists_8h_source.html#l00058">AST_RWDLLIST_WRLOCK</a>, <a class="el" href="event_8c_source.html#l00472">gen_sub_event()</a>, and <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00680">ast_event_subscribe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00661"></a>00661 {
<a name="l00662"></a>00662    <span class="keywordflow">if</span> (<a class="code" href="event_8h.html#aa1c7994fe2874e895ef28b615bb9aaa6" title="Check if subscribers exist.">ast_event_check_subscriber</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faefc08b90f280fd17876d70595c2c0eda">AST_EVENT_SUB</a>,
<a name="l00663"></a>00663       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491adef1da9ee188613895b2bbfd05960710" title="Event type Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_EVENTTYPE</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,
<a name="l00664"></a>00664       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>) != <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5af298aea21d354fd45878d4c0769f0844">AST_EVENT_SUB_NONE</a>) {
<a name="l00665"></a>00665       <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event;
<a name="l00666"></a>00666 
<a name="l00667"></a>00667       <span class="keyword">event</span> = <a class="code" href="event_8c.html#ae353ab13a10332fac23149d28efc0189">gen_sub_event</a>(sub);
<a name="l00668"></a>00668 
<a name="l00669"></a>00669       <span class="keywordflow">if</span> (event)
<a name="l00670"></a>00670          <a class="code" href="event_8h.html#a4cb88202df41eff644ed6748156d6e73" title="Queue an event.">ast_event_queue</a>(event);
<a name="l00671"></a>00671    }
<a name="l00672"></a>00672 
<a name="l00673"></a>00673    <a class="code" href="dlinkedlists_8h.html#af5c1ad3d535f30eb60b432b0c8c42e0b" title="Write locks a list.">AST_RWDLLIST_WRLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>]);
<a name="l00674"></a>00674    <a class="code" href="dlinkedlists_8h.html#ae2f7ac5ebcd1ae969f91d32d940ca4b9">AST_RWDLLIST_INSERT_TAIL</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>], sub, entry);
<a name="l00675"></a>00675    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>]);
<a name="l00676"></a>00676 
<a name="l00677"></a>00677    <span class="keywordflow">return</span> 0;
<a name="l00678"></a>00678 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0a6b2d7c7635155d29a834ef07a4b2d6"></a><!-- doxytag: member="event.c::ast_event_sub_append_ie_exists" ref="a0a6b2d7c7635155d29a834ef07a4b2d6" args="(struct ast_event_sub *sub, enum ast_event_ie_type ie_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_sub_append_ie_exists </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append an 'exists' parameter to a subscription. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>the dynamic subscription allocated with <a class="el" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the information element type that must be present in the event for it to match this subscription.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00588">588</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="event__defs_8h_source.html#l00125">AST_EVENT_IE_MAX</a>, <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, and <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00680">ast_event_subscribe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00590"></a>00590 {
<a name="l00591"></a>00591    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593    <span class="keywordflow">if</span> (ie_type &lt; 0 || ie_type &gt; <a class="code" href="event__defs_8h.html#ad7be258e037648898cc41ff9ed733ed7">AST_EVENT_IE_MAX</a>)
<a name="l00594"></a>00594       <span class="keywordflow">return</span> -1;
<a name="l00595"></a>00595 
<a name="l00596"></a>00596    <span class="keywordflow">if</span> (!(ie_val = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*ie_val))))
<a name="l00597"></a>00597       <span class="keywordflow">return</span> -1;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = <a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>;
<a name="l00600"></a>00600    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> = <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>;
<a name="l00601"></a>00601 
<a name="l00602"></a>00602    <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>);
<a name="l00603"></a>00603 
<a name="l00604"></a>00604    <span class="keywordflow">return</span> 0;
<a name="l00605"></a>00605 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a46fe7c7a6d01947d0151ab8345c4f08f"></a><!-- doxytag: member="event.c::ast_event_sub_append_ie_raw" ref="a46fe7c7a6d01947d0151ab8345c4f08f" args="(struct ast_event_sub *sub, enum ast_event_ie_type ie_type, void *data, size_t raw_datalen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_sub_append_ie_raw </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>raw_datalen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append a raw parameter to a subscription. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>the dynamic subscription allocated with <a class="el" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the information element type for the parameter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>raw</em>&nbsp;</td><td>the data that must be present in the event to match this subscription</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00633">633</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="event__defs_8h_source.html#l00125">AST_EVENT_IE_MAX</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="astmm_8h_source.html#l00081">ast_malloc</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00113">ast_event_ie_val::raw</a>, and <a class="el" href="event_8c_source.html#l00115">ast_event_ie_val::raw_datalen</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00680">ast_event_subscribe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00635"></a>00635 {
<a name="l00636"></a>00636    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00637"></a>00637 
<a name="l00638"></a>00638    <span class="keywordflow">if</span> (ie_type &lt; 0 || ie_type &gt; <a class="code" href="event__defs_8h.html#ad7be258e037648898cc41ff9ed733ed7">AST_EVENT_IE_MAX</a>)
<a name="l00639"></a>00639       <span class="keywordflow">return</span> -1;
<a name="l00640"></a>00640 
<a name="l00641"></a>00641    <span class="keywordflow">if</span> (!(ie_val = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*ie_val))))
<a name="l00642"></a>00642       <span class="keywordflow">return</span> -1;
<a name="l00643"></a>00643 
<a name="l00644"></a>00644    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = <a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>;
<a name="l00645"></a>00645    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> = <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>;
<a name="l00646"></a>00646    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a> = <a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648    <span class="keywordflow">if</span> (!(ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>))) {
<a name="l00649"></a>00649       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ie_val);
<a name="l00650"></a>00650       <span class="keywordflow">return</span> -1;
<a name="l00651"></a>00651    }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653    memcpy(ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, data, <a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>);
<a name="l00654"></a>00654 
<a name="l00655"></a>00655    <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657    <span class="keywordflow">return</span> 0;
<a name="l00658"></a>00658 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5f74d5a16df9f79c01741ebd6c00988c"></a><!-- doxytag: member="event.c::ast_event_sub_append_ie_str" ref="a5f74d5a16df9f79c01741ebd6c00988c" args="(struct ast_event_sub *sub, enum ast_event_ie_type ie_type, const char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_sub_append_ie_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append a string parameter to a subscription. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>the dynamic subscription allocated with <a class="el" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the information element type for the parameter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>the string that must be present in the event to match this subscription</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00607">607</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="event__defs_8h_source.html#l00125">AST_EVENT_IE_MAX</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="strings_8h_source.html#l00856">ast_str_hash()</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="event_8c_source.html#l00110">ast_event_ie_val::hash</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, and <a class="el" href="event_8c_source.html#l00111">ast_event_ie_val::str</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00680">ast_event_subscribe()</a>, and <a class="el" href="devicestate_8c_source.html#l00646">handle_devstate_change()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00609"></a>00609 {
<a name="l00610"></a>00610    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00611"></a>00611 
<a name="l00612"></a>00612    <span class="keywordflow">if</span> (ie_type &lt; 0 || ie_type &gt; <a class="code" href="event__defs_8h.html#ad7be258e037648898cc41ff9ed733ed7">AST_EVENT_IE_MAX</a>)
<a name="l00613"></a>00613       <span class="keywordflow">return</span> -1;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615    <span class="keywordflow">if</span> (!(ie_val = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*ie_val))))
<a name="l00616"></a>00616       <span class="keywordflow">return</span> -1;
<a name="l00617"></a>00617 
<a name="l00618"></a>00618    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = <a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>;
<a name="l00619"></a>00619    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> = <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>;
<a name="l00620"></a>00620 
<a name="l00621"></a>00621    <span class="keywordflow">if</span> (!(ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>))) {
<a name="l00622"></a>00622       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ie_val);
<a name="l00623"></a>00623       <span class="keywordflow">return</span> -1;
<a name="l00624"></a>00624    }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#a11ecb029164e055f28f4123ce3748862">hash</a> = <a class="code" href="strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55" title="Compute a hash value on a string.">ast_str_hash</a>(<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628    <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630    <span class="keywordflow">return</span> 0;
<a name="l00631"></a>00631 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5e91d7d3347599d928a3384f45bda234"></a><!-- doxytag: member="event.c::ast_event_sub_append_ie_uint" ref="a5e91d7d3347599d928a3384f45bda234" args="(struct ast_event_sub *sub, enum ast_event_ie_type ie_type, uint32_t unsigned_int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_event_sub_append_ie_uint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a>&nbsp;</td>
          <td class="paramname"> <em>ie_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>uint</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Append a uint parameter to a subscription. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>the dynamic subscription allocated with <a class="el" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ie_type</em>&nbsp;</td><td>the information element type for the parameter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uint</em>&nbsp;</td><td>the value that must be present in the event to match this subscription</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00568">568</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="event__defs_8h_source.html#l00125">AST_EVENT_IE_MAX</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, and <a class="el" href="event_8c_source.html#l00108">ast_event_ie_val::uint</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00680">ast_event_subscribe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00570"></a>00570 {
<a name="l00571"></a>00571    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00572"></a>00572 
<a name="l00573"></a>00573    <span class="keywordflow">if</span> (ie_type &lt; 0 || ie_type &gt; <a class="code" href="event__defs_8h.html#ad7be258e037648898cc41ff9ed733ed7">AST_EVENT_IE_MAX</a>)
<a name="l00574"></a>00574       <span class="keywordflow">return</span> -1;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576    <span class="keywordflow">if</span> (!(ie_val = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*ie_val))))
<a name="l00577"></a>00577       <span class="keywordflow">return</span> -1;
<a name="l00578"></a>00578 
<a name="l00579"></a>00579    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a> = <a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>;
<a name="l00580"></a>00580    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a> = unsigned_int;
<a name="l00581"></a>00581    ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> = <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583    <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585    <span class="keywordflow">return</span> 0;
<a name="l00586"></a>00586 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a46f2b4218be0062cf49cfcf7b0b810f3"></a><!-- doxytag: member="event.c::ast_event_sub_destroy" ref="a46f2b4218be0062cf49cfcf7b0b810f3" args="(struct ast_event_sub *sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_event_sub_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy an allocated subscription. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sub</em>&nbsp;</td><td>the subscription to destroy</td></tr>
  </table>
  </dd>
</dl>
<p>This function should be used when a subscription is allocated with <a class="el" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new()</a>, but for some reason, you want to destroy it instead of activating it. This could be because of an error when reading in the configuration for the dynamically built subscription. </p>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00733">733</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00304">ast_event_ie_val_destroy()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00817">AST_LIST_REMOVE_HEAD</a>, and <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00743">ast_event_unsubscribe()</a>, and <a class="el" href="devicestate_8c_source.html#l00646">handle_devstate_change()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00734"></a>00734 {
<a name="l00735"></a>00735    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00736"></a>00736 
<a name="l00737"></a>00737    <span class="keywordflow">while</span> ((ie_val = <a class="code" href="linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989" title="Removes and returns the head entry from a list.">AST_LIST_REMOVE_HEAD</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>)))
<a name="l00738"></a>00738       <a class="code" href="event_8c.html#a60d50b16f7ea1bc953a3bab12bb57a53">ast_event_ie_val_destroy</a>(ie_val);
<a name="l00739"></a>00739 
<a name="l00740"></a>00740    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(sub);
<a name="l00741"></a>00741 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac88cc01ecc4f9ff19e34f9d6b2d1edc8"></a><!-- doxytag: member="event.c::ast_event_subscribe" ref="ac88cc01ecc4f9ff19e34f9d6b2d1edc8" args="(enum ast_event_type type, ast_event_cb_t cb, void *userdata,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a>* ast_event_subscribe </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a>&nbsp;</td>
          <td class="paramname"> <em>event_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="event_8h.html#adfe111a34f216524cbcc53576744cc0a">ast_event_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>userdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Subscribe to events. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event_type</em>&nbsp;</td><td>The type of events to subscribe to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb</em>&nbsp;</td><td>The function to be called with events </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>userdata</em>&nbsp;</td><td>data to be passed to the event callback</td></tr>
  </table>
  </dd>
</dl>
<p>The rest of the arguments to this function specify additional parameters for the subscription to filter which events are passed to this subscriber. The arguments must be in sets of: </p>
<div class="fragment"><pre class="fragment">    &lt;<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>&gt;, [<span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>, [<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>] ]
</pre></div><p> and must end with AST_EVENT_IE_END.</p>
<p>If the ie_type specified is *not* AST_EVENT_IE_END, then it must be followed by a valid IE payload type. If the payload type specified is AST_EVENT_IE_PLTYPE_EXISTS, then the 3rd argument should not be provided. Otherwise, a payload must also be specified.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>This returns a reference to the subscription for use with un-subscribing later. If there is a failure in creating the subscription, NULL will be returned.</dd></dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> peer-&gt;mwi_event_sub = <a class="code" href="event_8h.html#a517ac17630e7658463b66b309a6ce78f" title="Subscribe to events.">ast_event_subscribe</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa9a217b1f500680b3e458d62b048c0892">AST_EVENT_MWI</a>, <a class="code" href="chan__dahdi_8c.html#a46e4523f99409c6696dc775ed6a5e5ed">mwi_event_cb</a>, peer,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491aae6c80d8f4c6ab3cee006ed57d874710" title="Mailbox name.">AST_EVENT_IE_MAILBOX</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>, peer-&gt;mailbox,
     <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>);
</pre></div><p>This creates a subscription to AST_EVENT_MWI events that contain an information element, AST_EVENT_IE_MAILBOX, with the same string value contained in peer-&gt;mailbox. Also, the event callback will be passed a pointer to the peer. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00680">680</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event__defs_8h_source.html#l00131">AST_EVENT_IE_PLTYPE_UNKNOWN</a>, <a class="el" href="event_8c_source.html#l00660">ast_event_sub_activate()</a>, <a class="el" href="event_8c_source.html#l00588">ast_event_sub_append_ie_exists()</a>, <a class="el" href="event_8c_source.html#l00633">ast_event_sub_append_ie_raw()</a>, <a class="el" href="event_8c_source.html#l00607">ast_event_sub_append_ie_str()</a>, <a class="el" href="event_8c_source.html#l00568">ast_event_sub_append_ie_uint()</a>, <a class="el" href="event_8c_source.html#l00547">ast_event_subscribe_new()</a>, and <a class="el" href="app__jack_8c_source.html#l00142">str</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l21162">add_peer_mwi_subs()</a>, <a class="el" href="evt_8c_source.html#l00300">add_publish_event()</a>, <a class="el" href="devicestate_8c_source.html#l00823">ast_enable_distributed_devstate()</a>, <a class="el" href="chan__mgcp_8c_source.html#l03552">build_gateway()</a>, <a class="el" href="chan__iax2_8c_source.html#l11880">build_peer()</a>, <a class="el" href="chan__skinny_8c_source.html#l06906">config_line()</a>, <a class="el" href="app__queue_8c_source.html#l07220">load_module()</a>, <a class="el" href="pbx_8c_source.html#l09302">load_pbx()</a>, <a class="el" href="chan__dahdi_8c_source.html#l09990">mkintf()</a>, and <a class="el" href="app__voicemail_8c_source.html#l10395">start_poll_thread()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00682"></a>00682 {
<a name="l00683"></a>00683    va_list ap;
<a name="l00684"></a>00684    <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a> <a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>;
<a name="l00685"></a>00685    <span class="keyword">struct </span><a class="code" href="structast__event__sub.html" title="Event subscription.">ast_event_sub</a> *sub;
<a name="l00686"></a>00686 
<a name="l00687"></a>00687    <span class="keywordflow">if</span> (!(sub = <a class="code" href="event_8h.html#abbf3a2d3f2ccc44cd6a8864e5b95600c" title="Allocate a subscription, but do not activate it.">ast_event_subscribe_new</a>(<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, <a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a>, <a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>)))
<a name="l00688"></a>00688       <span class="keywordflow">return</span> NULL;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    va_start(ap, <a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>);
<a name="l00691"></a>00691    <span class="keywordflow">for</span> (ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>);
<a name="l00692"></a>00692       ie_type != <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>;
<a name="l00693"></a>00693       ie_type = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491" title="Event Information Element types.">ast_event_ie_type</a>))
<a name="l00694"></a>00694    {
<a name="l00695"></a>00695       <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a> ie_pltype;
<a name="l00696"></a>00696 
<a name="l00697"></a>00697       ie_pltype = va_arg(ap, <span class="keyword">enum</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6" title="Payload types for event information elements.">ast_event_ie_pltype</a>);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699       <span class="keywordflow">switch</span> (ie_pltype) {
<a name="l00700"></a>00700       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6aefc05976cb496dd18e686b0e62773e54">AST_EVENT_IE_PLTYPE_UNKNOWN</a>:
<a name="l00701"></a>00701          <span class="keywordflow">break</span>;
<a name="l00702"></a>00702       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>:
<a name="l00703"></a>00703       {
<a name="l00704"></a>00704          uint32_t unsigned_int = va_arg(ap, uint32_t);
<a name="l00705"></a>00705          <a class="code" href="event_8h.html#a0744d297416d70f12a4882e43df8223f" title="Append a uint parameter to a subscription.">ast_event_sub_append_ie_uint</a>(sub, ie_type, unsigned_int);
<a name="l00706"></a>00706          <span class="keywordflow">break</span>;
<a name="l00707"></a>00707       }
<a name="l00708"></a>00708       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>:
<a name="l00709"></a>00709       {
<a name="l00710"></a>00710          <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = va_arg(ap, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
<a name="l00711"></a>00711          <a class="code" href="event_8h.html#a5f74d5a16df9f79c01741ebd6c00988c" title="Append a string parameter to a subscription.">ast_event_sub_append_ie_str</a>(sub, ie_type, str);
<a name="l00712"></a>00712          <span class="keywordflow">break</span>;
<a name="l00713"></a>00713       }
<a name="l00714"></a>00714       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>:
<a name="l00715"></a>00715       {
<a name="l00716"></a>00716          <span class="keywordtype">void</span> *data = va_arg(ap, <span class="keywordtype">void</span> *);
<a name="l00717"></a>00717          <span class="keywordtype">size_t</span> data_len = va_arg(ap, <span class="keywordtype">size_t</span>);
<a name="l00718"></a>00718          <a class="code" href="event_8h.html#a46fe7c7a6d01947d0151ab8345c4f08f" title="Append a raw parameter to a subscription.">ast_event_sub_append_ie_raw</a>(sub, ie_type, data, data_len);
<a name="l00719"></a>00719          <span class="keywordflow">break</span>;
<a name="l00720"></a>00720       }
<a name="l00721"></a>00721       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>:
<a name="l00722"></a>00722          <a class="code" href="event_8h.html#a0a6b2d7c7635155d29a834ef07a4b2d6" title="Append an &amp;#39;exists&amp;#39; parameter to a subscription.">ast_event_sub_append_ie_exists</a>(sub, ie_type);
<a name="l00723"></a>00723          <span class="keywordflow">break</span>;
<a name="l00724"></a>00724       }
<a name="l00725"></a>00725    }
<a name="l00726"></a>00726    va_end(ap);
<a name="l00727"></a>00727 
<a name="l00728"></a>00728    <a class="code" href="event_8h.html#a102995befaeb86bcfce49ae115de8af7" title="Activate a dynamically built subscription.">ast_event_sub_activate</a>(sub);
<a name="l00729"></a>00729 
<a name="l00730"></a>00730    <span class="keywordflow">return</span> sub;
<a name="l00731"></a>00731 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abbf3a2d3f2ccc44cd6a8864e5b95600c"></a><!-- doxytag: member="event.c::ast_event_subscribe_new" ref="abbf3a2d3f2ccc44cd6a8864e5b95600c" args="(enum ast_event_type type, ast_event_cb_t cb, void *userdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a>* ast_event_subscribe_new </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79f">ast_event_type</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="event_8h.html#adfe111a34f216524cbcc53576744cc0a">ast_event_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>userdata</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate a subscription, but do not activate it. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>the event type to subscribe to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb</em>&nbsp;</td><td>the function to call when an event matches this subscription </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>userdata</em>&nbsp;</td><td>data to pass to the provided callback</td></tr>
  </table>
  </dd>
</dl>
<p>This function should be used when you want to dynamically build a subscription.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the allocated subscription, or NULL on failure </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00547">547</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="lock_8h_source.html#l01964">ast_atomic_fetchadd_int()</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="event_8c_source.html#l00121">ast_event_sub::cb</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>, <a class="el" href="event_8c_source.html#l00123">ast_event_sub::uniqueid</a>, and <a class="el" href="event_8c_source.html#l00122">ast_event_sub::userdata</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00680">ast_event_subscribe()</a>, and <a class="el" href="devicestate_8c_source.html#l00646">handle_devstate_change()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00549"></a>00549 {
<a name="l00550"></a>00550    <span class="keyword">struct </span><a class="code" href="structast__event__sub.html" title="Event subscription.">ast_event_sub</a> *sub;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552    <span class="keywordflow">if</span> (type &lt; 0 || type &gt;= <a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa0b077dc8f7e01b4fd4fd8a54359f0268">AST_EVENT_TOTAL</a>) {
<a name="l00553"></a>00553       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%u is an invalid type!\n&quot;</span>, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>);
<a name="l00554"></a>00554       <span class="keywordflow">return</span> NULL;
<a name="l00555"></a>00555    }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557    <span class="keywordflow">if</span> (!(sub = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*sub))))
<a name="l00558"></a>00558       <span class="keywordflow">return</span> NULL;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560    sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> = <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>;
<a name="l00561"></a>00561    sub-&gt;<a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a> = <a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a>;
<a name="l00562"></a>00562    sub-&gt;<a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a> = <a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>;
<a name="l00563"></a>00563    sub-&gt;<a class="code" href="structast__event__sub.html#a118e8a66b7de05b645dbfbb7e964024c">uniqueid</a> = <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>((<span class="keywordtype">int</span> *) &amp;<a class="code" href="event_8c.html#a44ca53b7d1ea1e5328847963d485c271">sub_uniqueid</a>, 1);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565    <span class="keywordflow">return</span> sub;
<a name="l00566"></a>00566 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad8983ddfd12f5ccc2fbae04f81fe5e93"></a><!-- doxytag: member="event.c::ast_event_unsubscribe" ref="ad8983ddfd12f5ccc2fbae04f81fe5e93" args="(struct ast_event_sub *sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a>* ast_event_unsubscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>event_sub</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Un-subscribe from events. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event_sub</em>&nbsp;</td><td>This is the reference to the subscription returned by ast_event_subscribe.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will remove a subscription and free the associated data structures.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>NULL for convenience. </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.6.1 return changed to NULL </dd></dl>

<p>Definition at line <a class="el" href="event_8c_source.html#l00743">743</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="dlinkedlists_8h_source.html#l00999">AST_DLLIST_REMOVE</a>, <a class="el" href="event_8c_source.html#l00322">ast_event_check_subscriber()</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00089">AST_EVENT_IE_EVENTTYPE</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event__defs_8h_source.html#l00083">AST_EVENT_IE_UNIQUEID</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>, <a class="el" href="event_8c_source.html#l00733">ast_event_sub_destroy()</a>, <a class="el" href="event__defs_8h_source.html#l00149">AST_EVENT_SUB_NONE</a>, <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>, <a class="el" href="event__defs_8h_source.html#l00044">AST_EVENT_UNSUB</a>, <a class="el" href="dlinkedlists_8h_source.html#l00134">AST_RWDLLIST_UNLOCK</a>, <a class="el" href="dlinkedlists_8h_source.html#l00058">AST_RWDLLIST_WRLOCK</a>, <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>, and <a class="el" href="event_8c_source.html#l00123">ast_event_sub::uniqueid</a>.</p>

<p>Referenced by <a class="el" href="chan__dahdi_8c_source.html#l03856">destroy_dahdi_pvt()</a>, <a class="el" href="chan__mgcp_8c_source.html#l03977">destroy_endpoint()</a>, <a class="el" href="chan__sip_8c_source.html#l04623">destroy_mailbox()</a>, <a class="el" href="chan__iax2_8c_source.html#l11855">peer_destructor()</a>, <a class="el" href="evt_8c_source.html#l00488">publish_event_destroy()</a>, <a class="el" href="app__voicemail_8c_source.html#l10413">stop_poll_thread()</a>, and <a class="el" href="app__queue_8c_source.html#l07170">unload_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00744"></a>00744 {
<a name="l00745"></a>00745    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event;
<a name="l00746"></a>00746 
<a name="l00747"></a>00747    <a class="code" href="dlinkedlists_8h.html#af5c1ad3d535f30eb60b432b0c8c42e0b" title="Write locks a list.">AST_RWDLLIST_WRLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>]);
<a name="l00748"></a>00748    <a class="code" href="dlinkedlists_8h.html#a5d82b4f8287736b764cddd46c2c7177e" title="Removes a specific entry from a list.">AST_DLLIST_REMOVE</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>], sub, entry);
<a name="l00749"></a>00749    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>]);
<a name="l00750"></a>00750 
<a name="l00751"></a>00751    <span class="keywordflow">if</span> (<a class="code" href="event_8h.html#aa1c7994fe2874e895ef28b615bb9aaa6" title="Check if subscribers exist.">ast_event_check_subscriber</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa2cf434566fd9444e02b7bde6e8a40770">AST_EVENT_UNSUB</a>,
<a name="l00752"></a>00752       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491adef1da9ee188613895b2bbfd05960710" title="Event type Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_EVENTTYPE</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,
<a name="l00753"></a>00753       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>) != <a class="code" href="event__defs_8h.html#ae9ce510c0a36b8589eda555712a716d5af298aea21d354fd45878d4c0769f0844">AST_EVENT_SUB_NONE</a>) {
<a name="l00754"></a>00754       
<a name="l00755"></a>00755       <span class="keyword">event</span> = <a class="code" href="event_8h.html#afb4a2a00de28bb0733037060da8c4bac" title="Create a new event.">ast_event_new</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79fa2cf434566fd9444e02b7bde6e8a40770">AST_EVENT_UNSUB</a>,
<a name="l00756"></a>00756          <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a53d47a901204e69f36bebff49196114d" title="Unique ID Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_UNIQUEID</a>,  <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, sub-&gt;<a class="code" href="structast__event__sub.html#a118e8a66b7de05b645dbfbb7e964024c">uniqueid</a>,
<a name="l00757"></a>00757          <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491adef1da9ee188613895b2bbfd05960710" title="Event type Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_EVENTTYPE</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,
<a name="l00758"></a>00758          <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>);
<a name="l00759"></a>00759 
<a name="l00760"></a>00760       <span class="keywordflow">if</span> (event)
<a name="l00761"></a>00761          <a class="code" href="event_8h.html#a4cb88202df41eff644ed6748156d6e73" title="Queue an event.">ast_event_queue</a>(event);
<a name="l00762"></a>00762    }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764    <a class="code" href="event_8h.html#a46f2b4218be0062cf49cfcf7b0b810f3" title="Destroy an allocated subscription.">ast_event_sub_destroy</a>(sub);
<a name="l00765"></a>00765 
<a name="l00766"></a>00766    <span class="keywordflow">return</span> NULL;
<a name="l00767"></a>00767 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afe66d84d6cf2a2825ca566539b959c02"></a><!-- doxytag: member="event.c::dump_cache_cb" ref="afe66d84d6cf2a2825ca566539b959c02" args="(void *obj, void *arg, int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int dump_cache_cb </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00444">444</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="event_8c_source.html#l00121">ast_event_sub::cb</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, <a class="el" href="devicestate_8c_source.html#l00195">event_sub</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>, and <a class="el" href="event_8c_source.html#l00122">ast_event_sub::userdata</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00466">ast_event_dump_cache()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00445"></a>00445 {
<a name="l00446"></a>00446    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref = obj;
<a name="l00447"></a>00447    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *<span class="keyword">event</span> = event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>;
<a name="l00448"></a>00448    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__event__sub.html" title="Event subscription.">ast_event_sub</a> *<a class="code" href="devicestate_8c.html#a513dfcfff59f0204dab3a9b22ed3c6c0">event_sub</a> = arg;
<a name="l00449"></a>00449    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val = NULL;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;event_sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l00452"></a>00452       <span class="keywordflow">if</span> (!<a class="code" href="event_8c.html#aabc6de4b84b07d34bc6da81fbff369cb">match_ie_val</a>(event, ie_val, NULL)) {
<a name="l00453"></a>00453          <span class="keywordflow">break</span>;
<a name="l00454"></a>00454       }
<a name="l00455"></a>00455    }
<a name="l00456"></a>00456 
<a name="l00457"></a>00457    <span class="keywordflow">if</span> (!ie_val) {
<a name="l00458"></a>00458       <span class="comment">/* All parameters were matched on this cache entry, so dump it */</span>
<a name="l00459"></a>00459       event_sub-&gt;<a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a>(event, event_sub-&gt;<a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>);
<a name="l00460"></a>00460    }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462    <span class="keywordflow">return</span> 0;
<a name="l00463"></a>00463 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae353ab13a10332fac23149d28efc0189"></a><!-- doxytag: member="event.c::gen_sub_event" ref="ae353ab13a10332fac23149d28efc0189" args="(struct ast_event_sub *sub)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__event.html">ast_event</a>* gen_sub_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__event__sub.html">ast_event_sub</a> *&nbsp;</td>
          <td class="paramname"> <em>sub</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00472">472</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00874">ast_event_append_ie_raw()</a>, <a class="el" href="event_8c_source.html#l00852">ast_event_append_ie_str()</a>, <a class="el" href="event_8c_source.html#l00867">ast_event_append_ie_uint()</a>, <a class="el" href="event__defs_8h_source.html#l00058">AST_EVENT_IE_END</a>, <a class="el" href="event__defs_8h_source.html#l00089">AST_EVENT_IE_EVENTTYPE</a>, <a class="el" href="event__defs_8h_source.html#l00095">AST_EVENT_IE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="event__defs_8h_source.html#l00131">AST_EVENT_IE_PLTYPE_UNKNOWN</a>, <a class="el" href="event__defs_8h_source.html#l00083">AST_EVENT_IE_UNIQUEID</a>, <a class="el" href="event_8c_source.html#l00897">ast_event_new()</a>, <a class="el" href="event__defs_8h_source.html#l00042">AST_EVENT_SUB</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00113">ast_event_ie_val::raw</a>, <a class="el" href="event_8c_source.html#l00115">ast_event_ie_val::raw_datalen</a>, <a class="el" href="event_8c_source.html#l00111">ast_event_ie_val::str</a>, <a class="el" href="event_8c_source.html#l00120">ast_event_sub::type</a>, <a class="el" href="event_8c_source.html#l00108">ast_event_ie_val::uint</a>, and <a class="el" href="event_8c_source.html#l00123">ast_event_sub::uniqueid</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00510">ast_event_report_subs()</a>, and <a class="el" href="event_8c_source.html#l00660">ast_event_sub_activate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00473"></a>00473 {
<a name="l00474"></a>00474    <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l00475"></a>00475    <span class="keyword">struct </span><a class="code" href="structast__event.html" title="An event.">ast_event</a> *event;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477    <span class="keyword">event</span> = <a class="code" href="event_8h.html#afb4a2a00de28bb0733037060da8c4bac" title="Create a new event.">ast_event_new</a>(<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faefc08b90f280fd17876d70595c2c0eda">AST_EVENT_SUB</a>,
<a name="l00478"></a>00478       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a53d47a901204e69f36bebff49196114d" title="Unique ID Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_UNIQUEID</a>,  <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, sub-&gt;<a class="code" href="structast__event__sub.html#a118e8a66b7de05b645dbfbb7e964024c">uniqueid</a>,
<a name="l00479"></a>00479       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491adef1da9ee188613895b2bbfd05960710" title="Event type Used by: AST_EVENT_SUB, AST_EVENT_UNSUB Payload type: UINT.">AST_EVENT_IE_EVENTTYPE</a>, <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>, sub-&gt;<a class="code" href="structast__event__sub.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>,
<a name="l00480"></a>00480       <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491a04c78c1362e97d548344c354001c151f">AST_EVENT_IE_END</a>);
<a name="l00481"></a>00481 
<a name="l00482"></a>00482    <span class="keywordflow">if</span> (!event)
<a name="l00483"></a>00483       <span class="keywordflow">return</span> NULL;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, entry) {
<a name="l00486"></a>00486       <span class="keywordflow">switch</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a>) {
<a name="l00487"></a>00487       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6aefc05976cb496dd18e686b0e62773e54">AST_EVENT_IE_PLTYPE_UNKNOWN</a>:
<a name="l00488"></a>00488          <span class="keywordflow">break</span>;
<a name="l00489"></a>00489       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>:
<a name="l00490"></a>00490          <a class="code" href="event_8h.html#ac426e171245008ad590d9e365066584b" title="Append an information element that has an integer payload.">ast_event_append_ie_uint</a>(&amp;event, <a class="code" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491ab5d66ab1057fdf2671f8960ea81c66ca" title="Hint that someone cares that an IE exists Used by: AST_EVENT_SUB Payload type: UINT...">AST_EVENT_IE_EXISTS</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>);
<a name="l00491"></a>00491          <span class="keywordflow">break</span>;
<a name="l00492"></a>00492       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>:
<a name="l00493"></a>00493          <a class="code" href="event_8h.html#ac426e171245008ad590d9e365066584b" title="Append an information element that has an integer payload.">ast_event_append_ie_uint</a>(&amp;event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a>);
<a name="l00494"></a>00494          <span class="keywordflow">break</span>;
<a name="l00495"></a>00495       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>:
<a name="l00496"></a>00496          <a class="code" href="event_8h.html#a5b498b3f3d2abf74ba1274064e2cd972" title="Append an information element that has a string payload.">ast_event_append_ie_str</a>(&amp;event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00497"></a>00497          <span class="keywordflow">break</span>;
<a name="l00498"></a>00498       <span class="keywordflow">case</span> <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>:
<a name="l00499"></a>00499          <a class="code" href="event_8h.html#aabc5e8aa1db613cf02136391830c5a25" title="Append an information element that has a raw payload.">ast_event_append_ie_raw</a>(&amp;event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>);
<a name="l00500"></a>00500          <span class="keywordflow">break</span>;
<a name="l00501"></a>00501       }
<a name="l00502"></a>00502       <span class="keywordflow">if</span> (!event)
<a name="l00503"></a>00503          <span class="keywordflow">break</span>;
<a name="l00504"></a>00504    }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506    <span class="keywordflow">return</span> event;
<a name="l00507"></a>00507 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a519439b120decff748c793c7ecf0c1ce"></a><!-- doxytag: member="event.c::handle_event" ref="a519439b120decff748c793c7ecf0c1ce" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_event </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l01117">1117</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>, <a class="el" href="event__defs_8h_source.html#l00033">AST_EVENT_ALL</a>, <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="dlinkedlists_8h_source.html#l00071">AST_RWDLLIST_RDLOCK</a>, <a class="el" href="dlinkedlists_8h_source.html#l00506">AST_RWDLLIST_TRAVERSE</a>, <a class="el" href="dlinkedlists_8h_source.html#l00134">AST_RWDLLIST_UNLOCK</a>, <a class="el" href="event_8c_source.html#l00121">ast_event_sub::cb</a>, <a class="el" href="event_8c_source.html#l00100">ast_event_ref::event</a>, <a class="el" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ast_event_sub::ie_vals</a>, <a class="el" href="event_8c_source.html#l00401">match_ie_val()</a>, and <a class="el" href="event_8c_source.html#l00122">ast_event_sub::userdata</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01153">ast_event_queue()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01118"></a>01118 {
<a name="l01119"></a>01119    <span class="keyword">struct </span><a class="code" href="structast__event__ref.html" title="A holder for an event.">ast_event_ref</a> *event_ref = data;
<a name="l01120"></a>01120    <span class="keyword">struct </span><a class="code" href="structast__event__sub.html" title="Event subscription.">ast_event_sub</a> *sub;
<a name="l01121"></a>01121    uint16_t host_event_type;
<a name="l01122"></a>01122 
<a name="l01123"></a>01123    host_event_type = ntohs(event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>-&gt;type);
<a name="l01124"></a>01124 
<a name="l01125"></a>01125    <span class="comment">/* Subscribers to this specific event first */</span>
<a name="l01126"></a>01126    <a class="code" href="dlinkedlists_8h.html#ac3f1fc4c00a1454e2ce161fa9ad3636c" title="Read locks a list.">AST_RWDLLIST_RDLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[host_event_type]);
<a name="l01127"></a>01127    <a class="code" href="dlinkedlists_8h.html#a192b1276ffe754b8201a72985ed5d434">AST_RWDLLIST_TRAVERSE</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[host_event_type], sub, <a class="code" href="structast__event__sub.html#abdc0ec9bc8019cdd4ec75c17a3e6abee">entry</a>) {
<a name="l01128"></a>01128       <span class="keyword">struct </span><a class="code" href="structast__event__ie__val.html">ast_event_ie_val</a> *ie_val;
<a name="l01129"></a>01129       <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;sub-&gt;<a class="code" href="structast__event__sub.html#aee7902b35c0bd9931fa6dbba1e457b5a">ie_vals</a>, ie_val, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l01130"></a>01130          <span class="keywordflow">if</span> (!<a class="code" href="event_8c.html#aabc6de4b84b07d34bc6da81fbff369cb">match_ie_val</a>(event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>, ie_val, NULL)) {
<a name="l01131"></a>01131             <span class="keywordflow">break</span>;
<a name="l01132"></a>01132          }
<a name="l01133"></a>01133       }
<a name="l01134"></a>01134       <span class="keywordflow">if</span> (ie_val) {
<a name="l01135"></a>01135          <span class="keywordflow">continue</span>;
<a name="l01136"></a>01136       }
<a name="l01137"></a>01137       sub-&gt;<a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a>(event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>, sub-&gt;<a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>);
<a name="l01138"></a>01138    }
<a name="l01139"></a>01139    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[host_event_type]);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141    <span class="comment">/* Now to subscribers to all event types */</span>
<a name="l01142"></a>01142    <a class="code" href="dlinkedlists_8h.html#ac3f1fc4c00a1454e2ce161fa9ad3636c" title="Read locks a list.">AST_RWDLLIST_RDLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faa0800b824d33fd3ff1b078a9ccd9a33b">AST_EVENT_ALL</a>]);
<a name="l01143"></a>01143    <a class="code" href="dlinkedlists_8h.html#a192b1276ffe754b8201a72985ed5d434">AST_RWDLLIST_TRAVERSE</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[<a class="code" href="event__defs_8h.html#a6fa079412d9d9c1cc539f6d71f37f79faa0800b824d33fd3ff1b078a9ccd9a33b">AST_EVENT_ALL</a>], sub, <a class="code" href="structast__event__ie__val.html#a9fabf978e76841da4fca673656ef710d">entry</a>) {
<a name="l01144"></a>01144       sub-&gt;<a class="code" href="structast__event__sub.html#a2f304abd876ea8e0384c81db3f1cf763">cb</a>(event_ref-&gt;<a class="code" href="structast__event__ref.html#a29023d239b1af1921483e7904625ec48">event</a>, sub-&gt;<a class="code" href="structast__event__sub.html#afd0ffb02780e738d4c0a10ab833b7834">userdata</a>);
<a name="l01145"></a>01145    }
<a name="l01146"></a>01146    <a class="code" href="dlinkedlists_8h.html#ab8af1d9d3e63b53b4a53e14ac0a3f4e4" title="Attempts to unlock a read/write based list.">AST_RWDLLIST_UNLOCK</a>(&amp;<a class="code" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5" title="Event subscriptions The event subscribers are indexed by which event they are subscribed...">ast_event_subs</a>[AST_EVENT_ALL]);
<a name="l01147"></a>01147 
<a name="l01148"></a>01148    <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(event_ref, -1);
<a name="l01149"></a>01149 
<a name="l01150"></a>01150    <span class="keywordflow">return</span> 0;
<a name="l01151"></a>01151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aabc6de4b84b07d34bc6da81fbff369cb"></a><!-- doxytag: member="event.c::match_ie_val" ref="aabc6de4b84b07d34bc6da81fbff369cb" args="(const struct ast_event *event, const struct ast_event_ie_val *ie_val, const struct ast_event *event2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int match_ie_val </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__event__ie__val.html">ast_event_ie_val</a> *&nbsp;</td>
          <td class="paramname"> <em>ie_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__event.html">ast_event</a> *&nbsp;</td>
          <td class="paramname"> <em>event2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00401">401</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>References <a class="el" href="event_8c_source.html#l00839">ast_event_get_ie_raw()</a>, <a class="el" href="event_8c_source.html#l00830">ast_event_get_ie_str()</a>, <a class="el" href="event_8c_source.html#l00821">ast_event_get_ie_str_hash()</a>, <a class="el" href="event_8c_source.html#l00812">ast_event_get_ie_uint()</a>, <a class="el" href="event__defs_8h_source.html#l00133">AST_EVENT_IE_PLTYPE_EXISTS</a>, <a class="el" href="event__defs_8h_source.html#l00139">AST_EVENT_IE_PLTYPE_RAW</a>, <a class="el" href="event__defs_8h_source.html#l00137">AST_EVENT_IE_PLTYPE_STR</a>, <a class="el" href="event__defs_8h_source.html#l00135">AST_EVENT_IE_PLTYPE_UINT</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, <a class="el" href="event_8c_source.html#l00110">ast_event_ie_val::hash</a>, <a class="el" href="event_8c_source.html#l00106">ast_event_ie_val::ie_pltype</a>, <a class="el" href="event_8c_source.html#l00105">ast_event_ie_val::ie_type</a>, <a class="el" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">ast_event_ie_val::payload</a>, <a class="el" href="event_8c_source.html#l00113">ast_event_ie_val::raw</a>, <a class="el" href="event_8c_source.html#l00115">ast_event_ie_val::raw_datalen</a>, <a class="el" href="event_8c_source.html#l00111">ast_event_ie_val::str</a>, <a class="el" href="app__jack_8c_source.html#l00142">str</a>, and <a class="el" href="event_8c_source.html#l00108">ast_event_ie_val::uint</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>, <a class="el" href="event_8c_source.html#l00444">dump_cache_cb()</a>, and <a class="el" href="event_8c_source.html#l01117">handle_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00403"></a>00403 {
<a name="l00404"></a>00404    <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a4647cbfacd475cb5067f9f9906107641">AST_EVENT_IE_PLTYPE_UINT</a>) {
<a name="l00405"></a>00405       uint32_t <a class="code" href="structval.html">val</a> = event2 ? <a class="code" href="event_8h.html#a317f6947b933acd0da82df6e9a4672e5" title="Get the value of an information element that has an integer payload.">ast_event_get_ie_uint</a>(event2, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>) : ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#ad62f04804f4c474715b1f16b197af07e">uint</a>;
<a name="l00406"></a>00406       <span class="keywordflow">if</span> (val == <a class="code" href="event_8h.html#a317f6947b933acd0da82df6e9a4672e5" title="Get the value of an information element that has an integer payload.">ast_event_get_ie_uint</a>(event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>))
<a name="l00407"></a>00407          <span class="keywordflow">return</span> 1;
<a name="l00408"></a>00408       <span class="keywordflow">return</span> 0;
<a name="l00409"></a>00409    }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411    <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6ab82ac16f0791be2f8f918429a73430be">AST_EVENT_IE_PLTYPE_STR</a>) {
<a name="l00412"></a>00412       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;
<a name="l00413"></a>00413       uint32_t <a class="code" href="structast__event__ie__val.html#a11ecb029164e055f28f4123ce3748862">hash</a>;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415       hash = event2 ? <a class="code" href="event_8h.html#a7fe95eea5df516edcbb7619375c90172" title="Get the hash for the string payload of an IE.">ast_event_get_ie_str_hash</a>(event2, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>) : ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.hash;
<a name="l00416"></a>00416       <span class="keywordflow">if</span> (hash != <a class="code" href="event_8h.html#a7fe95eea5df516edcbb7619375c90172" title="Get the hash for the string payload of an IE.">ast_event_get_ie_str_hash</a>(event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>)) {
<a name="l00417"></a>00417          <span class="keywordflow">return</span> 0;
<a name="l00418"></a>00418       }
<a name="l00419"></a>00419 
<a name="l00420"></a>00420       str = event2 ? <a class="code" href="event_8h.html#a0cfdd21162f4795714da583c31477151" title="Get the value of an information element that has a string payload.">ast_event_get_ie_str</a>(event2, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>) : ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.str;
<a name="l00421"></a>00421       <span class="keywordflow">if</span> (str &amp;&amp; !strcmp(str, <a class="code" href="event_8h.html#a0cfdd21162f4795714da583c31477151" title="Get the value of an information element that has a string payload.">ast_event_get_ie_str</a>(event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>))) {
<a name="l00422"></a>00422          <span class="keywordflow">return</span> 1;
<a name="l00423"></a>00423       }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425       <span class="keywordflow">return</span> 0;
<a name="l00426"></a>00426    }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428    <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a394379875c9a348a39019c67d9a294ef">AST_EVENT_IE_PLTYPE_RAW</a>) {
<a name="l00429"></a>00429       <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> = event2 ? <a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event2, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>) : ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a5709184d07b81b8e733772be0ff7453e">payload</a>.<a class="code" href="structast__event__ie__val.html#acda666fb0cc415208262a93a7e49f101">raw</a>;
<a name="l00430"></a>00430       <span class="keywordflow">if</span> (buf &amp;&amp; !memcmp(buf, <a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>), ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ab2a60183aa165d4f154c47981b067883">raw_datalen</a>))
<a name="l00431"></a>00431          <span class="keywordflow">return</span> 1;
<a name="l00432"></a>00432       <span class="keywordflow">return</span> 0;
<a name="l00433"></a>00433    }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435    <span class="keywordflow">if</span> (ie_val-&gt;<a class="code" href="structast__event__ie__val.html#a12196f10672399310058b9e15e0a3abd">ie_pltype</a> == <a class="code" href="event__defs_8h.html#a73dadfa1128d5e75107536e132e758c6a9a74c1021384e906552a3187545b5068">AST_EVENT_IE_PLTYPE_EXISTS</a>) {
<a name="l00436"></a>00436       <span class="keywordflow">if</span> (<a class="code" href="event_8h.html#acaf805e5e914c76e884a5722efd2c0da" title="Get the value of an information element that has a raw payload.">ast_event_get_ie_raw</a>(event, ie_val-&gt;<a class="code" href="structast__event__ie__val.html#ade84e0c0ea3aac6d43fab48ee43bc33d">ie_type</a>))
<a name="l00437"></a>00437          <span class="keywordflow">return</span> 1;
<a name="l00438"></a>00438       <span class="keywordflow">return</span> 0;
<a name="l00439"></a>00439    }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441    <span class="keywordflow">return</span> 0;
<a name="l00442"></a>00442 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a51c4315d37378bad0246dff9c0ebf523"></a><!-- doxytag: member="event.c::ast_event_cache" ref="a51c4315d37378bad0246dff9c0ebf523" args="[AST_EVENT_TOTAL]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   <a class="el" href="event_8c.html#a51c4315d37378bad0246dff9c0ebf523">ast_event_cache</a>[AST_EVENT_TOTAL]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Event types that are kept in the cache. </p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>, <a class="el" href="event_8c_source.html#l00466">ast_event_dump_cache()</a>, <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l01224">ast_event_hash()</a>, <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>, and <a class="el" href="event_8c_source.html#l01094">ast_event_queue_and_cache()</a>.</p>

</div>
</div>
<a class="anchor" id="a301e72880aab9fd98fcbb3f721ed0dd5"></a><!-- doxytag: member="event.c::ast_event_subs" ref="a301e72880aab9fd98fcbb3f721ed0dd5" args="[AST_EVENT_TOTAL]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__event__sub__list.html">ast_event_sub_list</a>  <a class="el" href="event_8c.html#a301e72880aab9fd98fcbb3f721ed0dd5">ast_event_subs</a>[AST_EVENT_TOTAL]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Event subscriptions The event subscribers are indexed by which event they are subscribed to. </p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00322">ast_event_check_subscriber()</a>, <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>, <a class="el" href="event_8c_source.html#l00510">ast_event_report_subs()</a>, <a class="el" href="event_8c_source.html#l00660">ast_event_sub_activate()</a>, <a class="el" href="event_8c_source.html#l00743">ast_event_unsubscribe()</a>, and <a class="el" href="event_8c_source.html#l01117">handle_event()</a>.</p>

</div>
</div>
<a class="anchor" id="aced40ae98059778f8ceecd70e552461b"></a><!-- doxytag: member="event.c::cache_args" ref="aced40ae98059778f8ceecd70e552461b" args="[MAX_CACHE_ARGS]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="event__defs_8h.html#a003673523d7fe265c6738a5a9e49c491">ast_event_ie_type</a> <a class="el" href="event_8c.html#aced40ae98059778f8ceecd70e552461b">cache_args</a>[MAX_CACHE_ARGS]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Information Elements used for caching. </p>
<p>This array is the set of information elements that will be unique among all events in the cache for this event type. When a new event gets cached, a previous event with the same <a class="el" href="structvalues.html">values</a> for these information elements will be replaced. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00168">168</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01258">ast_event_cmp()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ea220e4d14b05876af4430e9832ce47"></a><!-- doxytag: member="event.c::container" ref="a7ea220e4d14b05876af4430e9832ce47" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structao2__container.html">ao2_container</a>* <a class="el" href="event_8c.html#a7ea220e4d14b05876af4430e9832ce47">container</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Container of cached events. </p>
<p>This gets allocated in <a class="el" href="__private_8h.html#aec784d4f5e2d7d9d6115f85531f17536">ast_event_init()</a> when Asterisk starts for the event types declared as using the cache. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00157">157</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01071">ast_event_dup_and_cache()</a>, <a class="el" href="event_8c_source.html#l00991">ast_event_get_cached()</a>, <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>, and <a class="el" href="event_8c_source.html#l01094">ast_event_queue_and_cache()</a>.</p>

</div>
</div>
<a class="anchor" id="a09a2211349df9d6af32a8a88153037a1"></a><!-- doxytag: member="event.c::event_dispatcher" ref="a09a2211349df9d6af32a8a88153037a1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__taskprocessor.html">ast_taskprocessor</a>* <a class="el" href="event_8c.html#a09a2211349df9d6af32a8a88153037a1">event_dispatcher</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00042">42</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

</div>
</div>
<a class="anchor" id="af2f6a9f8a19d58bbaa46a14fbafdbf74"></a><!-- doxytag: member="event.c::event_names" ref="af2f6a9f8a19d58bbaa46a14fbafdbf74" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structevent__name.html">event_name</a>  <a class="el" href="event_8c.html#af2f6a9f8a19d58bbaa46a14fbafdbf74">event_names</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The index of each entry _must_ match the event type number! </p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00221">ast_event_get_type_name()</a>, and <a class="el" href="event_8c_source.html#l00235">ast_event_str_to_event_type()</a>.</p>

</div>
</div>
<a class="anchor" id="affe6d185cf034f97d9e746dbfc8fb11c"></a><!-- doxytag: member="event.c::hash_fn" ref="affe6d185cf034f97d9e746dbfc8fb11c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="astobj2_8h.html#ab29eb962131d79590e1ee1f07ba41818">ao2_hash_fn</a>* <a class="el" href="event_8c.html#affe6d185cf034f97d9e746dbfc8fb11c">hash_fn</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Event type specific hash function. </p>

<p>Definition at line <a class="el" href="event_8c_source.html#l00159">159</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

<p>Referenced by <a class="el" href="event_8c_source.html#l01224">ast_event_hash()</a>, and <a class="el" href="event_8c_source.html#l01289">ast_event_init()</a>.</p>

</div>
</div>
<a class="anchor" id="abb2fdc9e02fb0164e337d64990f44e31"></a><!-- doxytag: member="event.c::ie_maps" ref="abb2fdc9e02fb0164e337d64990f44e31" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structie__map.html">ie_map</a>  <a class="el" href="event_8c.html#abb2fdc9e02fb0164e337d64990f44e31">ie_maps</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The index of each entry _must_ match the event ie number! </p>

<p>Referenced by <a class="el" href="event_8c_source.html#l00265">ast_event_get_ie_pltype()</a>, <a class="el" href="event_8c_source.html#l00250">ast_event_get_ie_type_name()</a>, and <a class="el" href="event_8c_source.html#l00280">ast_event_str_to_ie_type()</a>.</p>

</div>
</div>
<a class="anchor" id="a44ca53b7d1ea1e5328847963d485c271"></a><!-- doxytag: member="event.c::sub_uniqueid" ref="a44ca53b7d1ea1e5328847963d485c271" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="event_8c.html#a44ca53b7d1ea1e5328847963d485c271">sub_uniqueid</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="event_8c_source.html#l00128">128</a> of file <a class="el" href="event_8c_source.html">event.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:22:02 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
