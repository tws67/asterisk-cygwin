<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:19:41 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>bridging_technology.h File Reference</h1>
<p>Channel Bridging API.  
<a href="#_details">More...</a></p>

<p><a href="bridging__technology_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure that is the essence of a bridge technology.  <a href="structast__bridge__technology.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#ac2da6e2d9c71311ada917906641e8f9f">ast_bridge_technology_register</a>(technology)&nbsp;&nbsp;&nbsp;__ast_bridge_technology_register(technology, <a class="el" href="structast__module__info.html">ast_module_info</a>-&gt;self)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">See <a class="el" href="bridging__technology_8h.html#a44869ba0073a0c40c4bc52526dd7a358">__ast_bridge_technology_register()</a>.  <a href="#ac2da6e2d9c71311ada917906641e8f9f"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3">ast_bridge_preference</a> { <a class="el" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3a9fa8ca7b335775af3209d19953a1e96d">AST_BRIDGE_PREFERENCE_HIGH</a> =  0, 
<a class="el" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3abb477b9bb87c94c31bec654eae14e5d4">AST_BRIDGE_PREFERENCE_MEDIUM</a>, 
<a class="el" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3a4e0cb847a5c1dde83a1ff8f484b797bd">AST_BRIDGE_PREFERENCE_LOW</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Preference for choosing the bridge technology. </p>
 <a href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#a44869ba0073a0c40c4bc52526dd7a358">__ast_bridge_technology_register</a> (struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *technology, struct <a class="el" href="structast__module.html">ast_module</a> *mod)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a bridge technology for use.  <a href="#a44869ba0073a0c40c4bc52526dd7a358"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#ab01e4cd0a5b35dda072677f415b5f32a">ast_bridge_handle_trip</a> (struct <a class="el" href="structast__bridge.html">ast_bridge</a> *bridge, struct <a class="el" href="structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, int outfd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Feed notification that a frame is waiting on a channel into the bridging core.  <a href="#ab01e4cd0a5b35dda072677f415b5f32a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#acd557b9305cf531bd1d66acbe39d12ee">ast_bridge_technology_suspend</a> (struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *technology)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Suspend a bridge technology from consideration.  <a href="#acd557b9305cf531bd1d66acbe39d12ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#ac74018e91ff4fc7374f6137dd76c40f5">ast_bridge_technology_unregister</a> (struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *technology)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister a bridge technology from use.  <a href="#ac74018e91ff4fc7374f6137dd76c40f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bridging__technology_8h.html#a24bb22d467a5f840fe8c954f9c7624d1">ast_bridge_technology_unsuspend</a> (struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *technology)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unsuspend a bridge technology.  <a href="#a24bb22d467a5f840fe8c954f9c7624d1"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Channel Bridging API. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Joshua Colp &lt;<a href="mailto:jcolp@digium.com">jcolp@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="bridging__technology_8h_source.html">bridging_technology.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ac2da6e2d9c71311ada917906641e8f9f"></a><!-- doxytag: member="bridging_technology.h::ast_bridge_technology_register" ref="ac2da6e2d9c71311ada917906641e8f9f" args="(technology)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_bridge_technology_register</td>
          <td>(</td>
          <td class="paramtype">technology&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;__ast_bridge_technology_register(technology, <a class="el" href="structast__module__info.html">ast_module_info</a>-&gt;self)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>See <a class="el" href="bridging__technology_8h.html#a44869ba0073a0c40c4bc52526dd7a358">__ast_bridge_technology_register()</a>. </p>

<p>Definition at line <a class="el" href="bridging__technology_8h_source.html#l00104">104</a> of file <a class="el" href="bridging__technology_8h_source.html">bridging_technology.h</a>.</p>

<p>Referenced by <a class="el" href="bridge__multiplexed_8c_source.html#l00395">load_module()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ab071201182764424dc1d7d367423a0e3"></a><!-- doxytag: member="bridging_technology.h::ast_bridge_preference" ref="ab071201182764424dc1d7d367423a0e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3">ast_bridge_preference</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Preference for choosing the bridge technology. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ab071201182764424dc1d7d367423a0e3a9fa8ca7b335775af3209d19953a1e96d"></a><!-- doxytag: member="AST_BRIDGE_PREFERENCE_HIGH" ref="ab071201182764424dc1d7d367423a0e3a9fa8ca7b335775af3209d19953a1e96d" args="" -->AST_BRIDGE_PREFERENCE_HIGH</em>&nbsp;</td><td>
<p>Bridge technology should have high precedence over other bridge technologies </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ab071201182764424dc1d7d367423a0e3abb477b9bb87c94c31bec654eae14e5d4"></a><!-- doxytag: member="AST_BRIDGE_PREFERENCE_MEDIUM" ref="ab071201182764424dc1d7d367423a0e3abb477b9bb87c94c31bec654eae14e5d4" args="" -->AST_BRIDGE_PREFERENCE_MEDIUM</em>&nbsp;</td><td>
<p>Bridge technology is decent, not the best but should still be considered over low </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ab071201182764424dc1d7d367423a0e3a4e0cb847a5c1dde83a1ff8f484b797bd"></a><!-- doxytag: member="AST_BRIDGE_PREFERENCE_LOW" ref="ab071201182764424dc1d7d367423a0e3a4e0cb847a5c1dde83a1ff8f484b797bd" args="" -->AST_BRIDGE_PREFERENCE_LOW</em>&nbsp;</td><td>
<p>Bridge technology is low, it should not be considered unless it is absolutely needed </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="bridging__technology_8h_source.html#l00032">32</a> of file <a class="el" href="bridging__technology_8h_source.html">bridging_technology.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00032"></a>00032                            {<span class="comment"></span>
<a name="l00033"></a>00033 <span class="comment">   /*! Bridge technology should have high precedence over other bridge technologies */</span>
<a name="l00034"></a>00034    <a class="code" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3a9fa8ca7b335775af3209d19953a1e96d">AST_BRIDGE_PREFERENCE_HIGH</a> = 0,<span class="comment"></span>
<a name="l00035"></a>00035 <span class="comment">   /*! Bridge technology is decent, not the best but should still be considered over low */</span>
<a name="l00036"></a>00036    <a class="code" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3abb477b9bb87c94c31bec654eae14e5d4">AST_BRIDGE_PREFERENCE_MEDIUM</a>,<span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">   /*! Bridge technology is low, it should not be considered unless it is absolutely needed */</span>
<a name="l00038"></a>00038    <a class="code" href="bridging__technology_8h.html#ab071201182764424dc1d7d367423a0e3a4e0cb847a5c1dde83a1ff8f484b797bd">AST_BRIDGE_PREFERENCE_LOW</a>,
<a name="l00039"></a>00039 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a44869ba0073a0c40c4bc52526dd7a358"></a><!-- doxytag: member="bridging_technology.h::__ast_bridge_technology_register" ref="a44869ba0073a0c40c4bc52526dd7a358" args="(struct ast_bridge_technology *technology, struct ast_module *mod)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __ast_bridge_technology_register </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *&nbsp;</td>
          <td class="paramname"> <em>technology</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__module.html">ast_module</a> *&nbsp;</td>
          <td class="paramname"> <em>mod</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register a bridge technology for use. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>technology</em>&nbsp;</td><td>The bridge technology to register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>module</em>&nbsp;</td><td>The module that is registering the bridge technology</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__technology_8h.html#ac2da6e2d9c71311ada917906641e8f9f" title="See __ast_bridge_technology_register().">ast_bridge_technology_register</a>(&amp;simple_bridge_tech);
</pre></div><p>This registers a bridge technology declared as the structure simple_bridge_tech with the bridging core and makes it available for use when creating bridges. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l00059">59</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="linkedlists_8h_source.html#l00725">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="bridging__technology_8h_source.html#l00048">ast_bridge_technology::capabilities</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="bridging__technology_8h_source.html#l00078">ast_bridge_technology::mod</a>, <a class="el" href="bridging__technology_8h_source.html#l00046">ast_bridge_technology::name</a>, <a class="el" href="asterisk_8c_source.html#l00174">option_verbose</a>, <a class="el" href="logger_8h_source.html#l00042">VERBOSE_PREFIX_2</a>, and <a class="el" href="structast__bridge__technology.html#ae9e71d53f73d5c415a5a15c2334ade8f">ast_bridge_technology::write</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00060"></a>00060 {
<a name="l00061"></a>00061    <span class="keyword">struct </span><a class="code" href="structast__bridge__technology.html" title="Structure that is the essence of a bridge technology.">ast_bridge_technology</a> *current = NULL;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063    <span class="comment">/* Perform a sanity check to make sure the bridge technology conforms to our needed requirements */</span>
<a name="l00064"></a>00064    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(technology-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>) || !technology-&gt;<a class="code" href="structast__bridge__technology.html#a9461ee266923070466f95a76158f65cd">capabilities</a> || !technology-&gt;<a class="code" href="structast__bridge__technology.html#ae9e71d53f73d5c415a5a15c2334ade8f">write</a>) {
<a name="l00065"></a>00065       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge technology %s failed registration sanity check.\n&quot;</span>, technology-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);
<a name="l00066"></a>00066       <span class="keywordflow">return</span> -1;
<a name="l00067"></a>00067    }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071    <span class="comment">/* Look for duplicate bridge technology already using this name, or already registered */</span>
<a name="l00072"></a>00072    <a class="code" href="linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>, current, entry) {
<a name="l00073"></a>00073       <span class="keywordflow">if</span> ((!strcasecmp(current-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, technology-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)) || (current == technology)) {
<a name="l00074"></a>00074          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;A bridge technology of %s already claims to exist in our world.\n&quot;</span>, technology-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);
<a name="l00075"></a>00075          <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>);
<a name="l00076"></a>00076          <span class="keywordflow">return</span> -1;
<a name="l00077"></a>00077       }
<a name="l00078"></a>00078    }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080    <span class="comment">/* Copy module pointer so reference counting can keep the module from unloading */</span>
<a name="l00081"></a>00081    technology-&gt;<a class="code" href="structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a> = module;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083    <span class="comment">/* Insert our new bridge technology into the list and print out a pretty message */</span>
<a name="l00084"></a>00084    <a class="code" href="linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>, technology, entry);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#gaa294d0efa6a89c1a3d162787cac4fff5">option_verbose</a> &gt; 1) {
<a name="l00089"></a>00089       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<a class="code" href="logger_8h.html#a5623b2747e49964e0eae2795057bc92e">VERBOSE_PREFIX_2</a> <span class="stringliteral">&quot;Registered bridge technology %s\n&quot;</span>, technology-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);
<a name="l00090"></a>00090    }
<a name="l00091"></a>00091 
<a name="l00092"></a>00092    <span class="keywordflow">return</span> 0;
<a name="l00093"></a>00093 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab01e4cd0a5b35dda072677f415b5f32a"></a><!-- doxytag: member="bridging_technology.h::ast_bridge_handle_trip" ref="ab01e4cd0a5b35dda072677f415b5f32a" args="(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel, struct ast_channel *chan, int outfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bridge_handle_trip </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge.html">ast_bridge</a> *&nbsp;</td>
          <td class="paramname"> <em>bridge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__channel.html">ast_bridge_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>bridge_channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outfd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Feed notification that a frame is waiting on a channel into the bridging core. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bridge</em>&nbsp;</td><td>The bridge that the notification should influence </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bridge_channel</em>&nbsp;</td><td>Bridge channel the notification was received on (if known) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel the notification was received on (if known) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outfd</em>&nbsp;</td><td>File descriptor that the notification was received on (if known)</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__technology_8h.html#ab01e4cd0a5b35dda072677f415b5f32a" title="Feed notification that a frame is waiting on a channel into the bridging core.">ast_bridge_handle_trip</a>(bridge, NULL, <a class="code" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, -1);
</pre></div><p>This tells the bridging core that a frame has been received on the channel pointed to by chan and that it should be read and handled.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This should only be used by bridging technologies. </dd></dl>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l00276">276</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="bridging_8c_source.html#l00118">ast_bridge_change_state()</a>, <a class="el" href="bridging_8h_source.html#l00090">AST_BRIDGE_CHANNEL_STATE_END</a>, <a class="el" href="frame_8h_source.html#l00298">AST_CONTROL_HANGUP</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h_source.html#l00122">AST_FRAME_DTMF_BEGIN</a>, <a class="el" href="frame_8h_source.html#l00462">ast_frfree</a>, <a class="el" href="channel_8c_source.html#l03100">ast_read()</a>, <a class="el" href="channel_8c_source.html#l03105">ast_read_noaudio()</a>, <a class="el" href="bridging_8c_source.html#l00265">bridge_drop_control_frame()</a>, <a class="el" href="bridging_8c_source.html#l00241">bridge_handle_dtmf()</a>, <a class="el" href="structast__bridge__technology.html#aa021c0c9ab12c7ca3bd62980a6aaccc9">ast_bridge_technology::fd</a>, <a class="el" href="bridging_8h_source.html#l00139">ast_bridge_channel::features</a>, <a class="el" href="bridging_8h_source.html#l00167">ast_bridge::features</a>, <a class="el" href="bridging_8c_source.html#l00204">find_bridge_channel()</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="bridging__features_8h_source.html#l00096">ast_bridge_features::mute</a>, <a class="el" href="structast__bridge__technology.html#a8e711c0bdb19529df16903d1cdf89525">ast_bridge_technology::poke</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, <a class="el" href="bridging_8h_source.html#l00161">ast_bridge::technology</a>, and <a class="el" href="structast__bridge__technology.html#ae9e71d53f73d5c415a5a15c2334ade8f">ast_bridge_technology::write</a>.</p>

<p>Referenced by <a class="el" href="bridging_8c_source.html#l00698">bridge_channel_join_multithreaded()</a>, <a class="el" href="bridging_8c_source.html#l00325">generic_thread_loop()</a>, and <a class="el" href="bridge__multiplexed_8c_source.html#l00200">multiplexed_thread_function()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00277"></a>00277 {
<a name="l00278"></a>00278    <span class="comment">/* If no bridge channel has been provided and the actual channel has been provided find it */</span>
<a name="l00279"></a>00279    <span class="keywordflow">if</span> (chan &amp;&amp; !bridge_channel) {
<a name="l00280"></a>00280       bridge_channel = <a class="code" href="bridging_8c.html#af76003eaee352a6e71c4411b99c87eb1" title="Helper function to find a bridge channel given a channel.">find_bridge_channel</a>(bridge, chan);
<a name="l00281"></a>00281    }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283    <span class="comment">/* If a bridge channel with actual channel is present read a frame and handle it */</span>
<a name="l00284"></a>00284    <span class="keywordflow">if</span> (chan &amp;&amp; bridge_channel) {
<a name="l00285"></a>00285       <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *frame = (((bridge-&gt;<a class="code" href="structast__bridge.html#aa5f7287d4bbab0f62a1bae18af89171d">features</a>.<a class="code" href="structast__bridge__features.html#aa09e22acd94cd548a204c100e11fd612">mute</a>) || (bridge_channel-&gt;<a class="code" href="structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> &amp;&amp; bridge_channel-&gt;<a class="code" href="structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="structast__bridge__features.html#aa09e22acd94cd548a204c100e11fd612">mute</a>)) ? <a class="code" href="channel_8h.html#a1950f7fe77c02d233de02d299bab8c15" title="Reads a frame, returning AST_FRAME_NULL frame if audio.">ast_read_noaudio</a>(chan) : <a class="code" href="channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1" title="Reads a frame.">ast_read</a>(chan));
<a name="l00286"></a>00286 
<a name="l00287"></a>00287       <span class="comment">/* This is pretty simple... see if they hung up */</span>
<a name="l00288"></a>00288       <span class="keywordflow">if</span> (!frame || (frame-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a> &amp;&amp; frame-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> == <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>)) {
<a name="l00289"></a>00289          <span class="comment">/* Signal the thread that is handling the bridged channel that it should be ended */</span>
<a name="l00290"></a>00290          <a class="code" href="bridging_8h.html#a03cde0e9535440a4f9f24ab921bea771" title="Change the state of a bridged channel.">ast_bridge_change_state</a>(bridge_channel, <a class="code" href="bridging_8h.html#a78f46aa0abbe1f3bf98be03c884203a7a70362e0b60c71e30a1166be6d13ac8a3">AST_BRIDGE_CHANNEL_STATE_END</a>);
<a name="l00291"></a>00291       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (frame-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a> &amp;&amp; <a class="code" href="bridging_8c.html#a3a161f839c1d924a38b385ca8f5ed28f" title="Internal function used to determine whether a control frame should be dropped or...">bridge_drop_control_frame</a>(frame-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a>)) {
<a name="l00292"></a>00292          <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Dropping control frame from bridge channel %p\n&quot;</span>, bridge_channel);
<a name="l00293"></a>00293       } <span class="keywordflow">else</span> {
<a name="l00294"></a>00294          <span class="keywordflow">if</span> (frame-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a9b350360a64b55c7590f1ec03db480be">AST_FRAME_DTMF_BEGIN</a>) {
<a name="l00295"></a>00295             frame = <a class="code" href="bridging_8c.html#a528e3f3afe8699fd772b60dd7fa91194" title="Internal function to handle DTMF from a channel.">bridge_handle_dtmf</a>(bridge, bridge_channel, frame);
<a name="l00296"></a>00296          }
<a name="l00297"></a>00297          <span class="comment">/* Simply write the frame out to the bridge technology if it still exists */</span>
<a name="l00298"></a>00298          <span class="keywordflow">if</span> (frame) {
<a name="l00299"></a>00299             bridge-&gt;<a class="code" href="structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="structast__bridge__technology.html#ae9e71d53f73d5c415a5a15c2334ade8f">write</a>(bridge, bridge_channel, frame);
<a name="l00300"></a>00300          }
<a name="l00301"></a>00301       }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303       <span class="keywordflow">if</span> (frame) {
<a name="l00304"></a>00304          <a class="code" href="frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(frame);
<a name="l00305"></a>00305       }
<a name="l00306"></a>00306       <span class="keywordflow">return</span>;
<a name="l00307"></a>00307    }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309    <span class="comment">/* If a file descriptor actually tripped pass it off to the bridge technology */</span>
<a name="l00310"></a>00310    <span class="keywordflow">if</span> (outfd &gt; -1 &amp;&amp; bridge-&gt;<a class="code" href="structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="structast__bridge__technology.html#aa021c0c9ab12c7ca3bd62980a6aaccc9">fd</a>) {
<a name="l00311"></a>00311       bridge-&gt;<a class="code" href="structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="structast__bridge__technology.html#aa021c0c9ab12c7ca3bd62980a6aaccc9">fd</a>(bridge, bridge_channel, outfd);
<a name="l00312"></a>00312       <span class="keywordflow">return</span>;
<a name="l00313"></a>00313    }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315    <span class="comment">/* If all else fails just poke the bridge */</span>
<a name="l00316"></a>00316    <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="structast__bridge__technology.html#a8e711c0bdb19529df16903d1cdf89525">poke</a> &amp;&amp; bridge_channel) {
<a name="l00317"></a>00317       bridge-&gt;<a class="code" href="structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="structast__bridge__technology.html#a8e711c0bdb19529df16903d1cdf89525">poke</a>(bridge, bridge_channel);
<a name="l00318"></a>00318       <span class="keywordflow">return</span>;
<a name="l00319"></a>00319    }
<a name="l00320"></a>00320 
<a name="l00321"></a>00321    <span class="keywordflow">return</span>;
<a name="l00322"></a>00322 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acd557b9305cf531bd1d66acbe39d12ee"></a><!-- doxytag: member="bridging_technology.h::ast_bridge_technology_suspend" ref="acd557b9305cf531bd1d66acbe39d12ee" args="(struct ast_bridge_technology *technology)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bridge_technology_suspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *&nbsp;</td>
          <td class="paramname"> <em>technology</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Suspend a bridge technology from consideration. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>technology</em>&nbsp;</td><td>The bridge technology to suspend</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__technology_8h.html#acd557b9305cf531bd1d66acbe39d12ee" title="Suspend a bridge technology from consideration.">ast_bridge_technology_suspend</a>(&amp;simple_bridge_tech);
</pre></div><p>This suspends the bridge technology simple_bridge_tech from being considered when creating a new bridge. Existing bridges using the bridge technology are not affected. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01223">1223</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="bridging__technology_8h_source.html#l00076">ast_bridge_technology::suspended</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01224"></a>01224 {
<a name="l01225"></a>01225    technology-&gt;<a class="code" href="structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a> = 1;
<a name="l01226"></a>01226    <span class="keywordflow">return</span>;
<a name="l01227"></a>01227 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac74018e91ff4fc7374f6137dd76c40f5"></a><!-- doxytag: member="bridging_technology.h::ast_bridge_technology_unregister" ref="ac74018e91ff4fc7374f6137dd76c40f5" args="(struct ast_bridge_technology *technology)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bridge_technology_unregister </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *&nbsp;</td>
          <td class="paramname"> <em>technology</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unregister a bridge technology from use. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>technology</em>&nbsp;</td><td>The bridge technology to unregister</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__technology_8h.html#ac74018e91ff4fc7374f6137dd76c40f5" title="Unregister a bridge technology from use.">ast_bridge_technology_unregister</a>(&amp;simple_bridge_tech);
</pre></div><p>This unregisters a bridge technlogy declared as the structure simple_bridge_tech with the bridging core. It will no longer be considered when creating a new bridge. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l00095">95</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00564">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00541">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00601">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="bridging__technology_8h_source.html#l00046">ast_bridge_technology::name</a>, <a class="el" href="asterisk_8c_source.html#l00174">option_verbose</a>, and <a class="el" href="logger_8h_source.html#l00042">VERBOSE_PREFIX_2</a>.</p>

<p>Referenced by <a class="el" href="bridge__multiplexed_8c_source.html#l00386">unload_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00096"></a>00096 {
<a name="l00097"></a>00097    <span class="keyword">struct </span><a class="code" href="structast__bridge__technology.html" title="Structure that is the essence of a bridge technology.">ast_bridge_technology</a> *current = NULL;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101    <span class="comment">/* Ensure the bridge technology is registered before removing it */</span>
<a name="l00102"></a>00102    <a class="code" href="linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>, current, entry) {
<a name="l00103"></a>00103       <span class="keywordflow">if</span> (current == technology) {
<a name="l00104"></a>00104          <a class="code" href="linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(entry);
<a name="l00105"></a>00105          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#gaa294d0efa6a89c1a3d162787cac4fff5">option_verbose</a> &gt; 1) {
<a name="l00106"></a>00106             <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<a class="code" href="logger_8h.html#a5623b2747e49964e0eae2795057bc92e">VERBOSE_PREFIX_2</a> <span class="stringliteral">&quot;Unregistered bridge technology %s\n&quot;</span>, technology-&gt;<a class="code" href="structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);
<a name="l00107"></a>00107          }
<a name="l00108"></a>00108          <span class="keywordflow">break</span>;
<a name="l00109"></a>00109       }
<a name="l00110"></a>00110    }
<a name="l00111"></a>00111    <a class="code" href="linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structbridge__technologies.html">bridge_technologies</a>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115    <span class="keywordflow">return</span> current ? 0 : -1;
<a name="l00116"></a>00116 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24bb22d467a5f840fe8c954f9c7624d1"></a><!-- doxytag: member="bridging_technology.h::ast_bridge_technology_unsuspend" ref="a24bb22d467a5f840fe8c954f9c7624d1" args="(struct ast_bridge_technology *technology)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bridge_technology_unsuspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__bridge__technology.html">ast_bridge_technology</a> *&nbsp;</td>
          <td class="paramname"> <em>technology</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unsuspend a bridge technology. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>technology</em>&nbsp;</td><td>The bridge technology to unsuspend</td></tr>
  </table>
  </dd>
</dl>
<p>Example usage:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="bridging__technology_8h.html#a24bb22d467a5f840fe8c954f9c7624d1" title="Unsuspend a bridge technology.">ast_bridge_technology_unsuspend</a>(&amp;simple_bridge_tech);
</pre></div><p>This makes the bridge technology simple_bridge_tech considered when creating a new bridge again. </p>

<p>Definition at line <a class="el" href="bridging_8c_source.html#l01229">1229</a> of file <a class="el" href="bridging_8c_source.html">bridging.c</a>.</p>

<p>References <a class="el" href="bridging__technology_8h_source.html#l00076">ast_bridge_technology::suspended</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01230"></a>01230 {
<a name="l01231"></a>01231    technology-&gt;<a class="code" href="structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a> = 0;
<a name="l01232"></a>01232    <span class="keywordflow">return</span>;
<a name="l01233"></a>01233 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:19:41 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
