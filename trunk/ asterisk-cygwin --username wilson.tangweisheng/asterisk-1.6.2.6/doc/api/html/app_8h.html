<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:18:53 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>app.h File Reference</h1>
<p>Application convenience functions, designed to give consistent look and feel to Asterisk <a class="el" href="structapps.html">apps</a>.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="strings_8h_source.html">asterisk/strings.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadstorage_8h_source.html">asterisk/threadstorage.h</a>&quot;</code><br/>

<p><a href="app_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__app__option.html">ast_app_option</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A structure to hold the description of an application 'option'.  <a href="structast__app__option.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__ivr__menu.html">ast_ivr_menu</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__ivr__option.html">ast_ivr_option</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)&nbsp;&nbsp;&nbsp;char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define an application argument.  <a href="#a037e9a5b28477b17e7c9acbe7ecb21d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(option, flagno)&nbsp;&nbsp;&nbsp;[option] = { .flag = flagno }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declares an application option that does not accept an argument.  <a href="#aca036489931bf5571e2472331c8ac80b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a7549377df87038be737e8cae73acaa9d">AST_APP_OPTION_ARG</a>(option, flagno, argno)&nbsp;&nbsp;&nbsp;[option] = { .flag = flagno, .arg_index = argno + 1 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declares an application option that accepts an argument.  <a href="#a7549377df87038be737e8cae73acaa9d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a520a3c6b7d57903d9a616051da1a019d">AST_APP_OPTIONS</a>(holder, options...)&nbsp;&nbsp;&nbsp;static const struct <a class="el" href="structast__app__option.html">ast_app_option</a> holder[128] = options</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declares an array of options for an application.  <a href="#a520a3c6b7d57903d9a616051da1a019d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a588ed7395623b8493efcf229024af9c5">ast_app_separate_args</a>(a, b, c, d)&nbsp;&nbsp;&nbsp;__ast_app_separate_args(a,b,1,c,d)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, arglist)&nbsp;&nbsp;&nbsp;AST_DEFINE_APP_ARGS_TYPE(, arglist) <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declare a structure to hold an application's arguments.  <a href="#a80cd3f6f786b59b742bcecfc0b3be7c2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a439373ac35099110fa9fa3d52a4628fe">AST_DEFINE_APP_ARGS_TYPE</a>(<a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, arglist)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define a structure type to hold an application's arguments.  <a href="#a439373ac35099110fa9fa3d52a4628fe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#adfb9b356a8ef9eb14a39601cf228277a">AST_IVR_DECLARE_MENU</a>(holder, title, flags, foo...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#aa592076f909040907106f25bf7a2d727">AST_IVR_FLAG_AUTORESTART</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#accfcb380df76a64251d88ef49c2dd4e3">AST_NONSTANDARD_APP_ARGS</a>(args, parse, sep)&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, sep, 1, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs the 'nonstandard' argument separation process for an application.  <a href="#accfcb380df76a64251d88ef49c2dd4e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#afc33d0723a077475b09f7285c288ed42">AST_NONSTANDARD_RAW_ARGS</a>(args, parse, sep)&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, sep, 0, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(args, parse)&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, ',', 1, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs the 'standard' argument separation process for an application.  <a href="#ac08f7eb1eb9476b30987c73e1052ada8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a1fc2af00a8197196f3fe2047297466db">AST_STANDARD_RAW_ARGS</a>(args, parse)&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, ',', 0, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ab451a4653176c211d131b899e1f91bde">BEGIN_OPTIONS</a>&nbsp;&nbsp;&nbsp;{</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a2a1890787b3e55318c417c0a3e1432c7">END_OPTIONS</a>&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a69c12aaf969284756dee28dc1fa503fa">ast_ivr_callback</a> )(struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, char *option, void *cbdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback function for IVR.  <a href="#a69c12aaf969284756dee28dc1fa503fa"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17f">ast_getdata_result</a> { <br/>
&nbsp;&nbsp;<a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa447a1a659574cde67aa71538c804206f">AST_GETDATA_FAILED</a> =  -1, 
<a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa76a0cf0f0ca1c3000e227686d7de7d9c">AST_GETDATA_COMPLETE</a> =  0, 
<a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa79554349b620ac61794e76cb70eef322">AST_GETDATA_TIMEOUT</a> =  1, 
<a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa74b94669f324ba10f5bfb979f54e636c">AST_GETDATA_INTERRUPTED</a> =  2, 
<br/>
&nbsp;&nbsp;<a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa94425459ee6ac7993c6289fde4d4ea8c">AST_GETDATA_EMPTY_END_TERMINATED</a> =  3
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5">ast_ivr_action</a> { <br/>
&nbsp;&nbsp;<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a23d56e69a479b44ce2f89034fda4ed9a">AST_ACTION_UPONE</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a9f49762cd1386370ddc2f8fc64965b88">AST_ACTION_EXIT</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a911a0be3e05292936e4e6f8646194f7f">AST_ACTION_CALLBACK</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a4bd0306ccd5256f1b150ec9b1d220f0f">AST_ACTION_PLAYBACK</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5ab738e4ae4a7e6b7cd68b13d2a58985ba">AST_ACTION_BACKGROUND</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a5a5e2a82ee86aab6a69decbb02514e68">AST_ACTION_PLAYLIST</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5adc38e521e86969765c95912988cf6e2a">AST_ACTION_MENU</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5ae951cfbea814df40816b70a1eeba65e8">AST_ACTION_REPEAT</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a53ddb6911a10ea526b86f4cde6b2ce80">AST_ACTION_RESTART</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5af34630ccb66618ee9dfef4d14423a6d0">AST_ACTION_TRANSFER</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5ac8b97828ca2347ecf4bf942478ddf0ba">AST_ACTION_WAITOPTION</a>, 
<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a9470126e5a37e3044d577f6ba1140644">AST_ACTION_NOOP</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a363ce24d1bbcbf4687e4fd21aa1ee621">AST_ACTION_BACKLIST</a>
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8c">AST_LOCK_RESULT</a> { <a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8ca37bdbc92223520af2a24d5bfd6f561bb">AST_LOCK_SUCCESS</a> =  0, 
<a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8ca9c0f41302de02bb0130a92669d17333d">AST_LOCK_TIMEOUT</a> =  -1, 
<a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8ca46f6f55c5ee9576afd8dde6376c2b01a">AST_LOCK_PATH_NOT_FOUND</a> =  -2, 
<a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8cac59129c6f641d69ad14017c1ba1f2635">AST_LOCK_FAILURE</a> =  -3
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a889fad4c6cc627add80454ae61b53241">AST_LOCK_TYPE</a> { <a class="el" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a599f18fdf355d7530bb754b8c66d6de7">AST_LOCK_TYPE_LOCKFILE</a> =  0, 
<a class="el" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a78cd7e44280d287fc0168a0c31b75e3f">AST_LOCK_TYPE_FLOCK</a> =  1
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Type of locking to use in ast_lock_path / ast_unlock_path. </p>
 <a href="app_8h.html#a889fad4c6cc627add80454ae61b53241">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a1b65265bef5e0d7110092144ba9ee4da">__ast_app_separate_args</a> (char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, char delim, int remove_chars, char **array, int arraylen)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Separate a string into arguments in an array.  <a href="#a1b65265bef5e0d7110092144ba9ee4da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#af4825b337b9cd145a059852ce85ec6cd">ast_app_dtget</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, char *collect, size_t size, int maxlen, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Present a dialtone and collect a certain length <a class="el" href="structextension.html">extension</a>.  <a href="#af4825b337b9cd145a059852ce85ec6cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#af3f76858d4dd513e59dbe5e67bc46220">ast_app_getdata</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a>, char *s, int maxlen, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Plays a stream and gets DTMF data from a channel.  <a href="#af3f76858d4dd513e59dbe5e67bc46220"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a9fc880ff0cd0b42ef6212b43deb4b98f">ast_app_getdata_full</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, char *<a class="el" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a>, char *s, int maxlen, int timeout, int audiofd, int ctrlfd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Full version with audiofd and controlfd. NOTE: returns '2' on ctrlfd available, not '1' like other full functions.  <a href="#a9fc880ff0cd0b42ef6212b43deb4b98f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#add0f96b4b815205f528f5248ccb3d515">ast_app_group_discard</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Discard all <a class="el" href="structgroup.html">group</a> counting for a channel.  <a href="#add0f96b4b815205f528f5248ccb3d515"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a026ae712c21ad8f1e8cde66467153838">ast_app_group_get_count</a> (const char *<a class="el" href="structgroup.html">group</a>, const char *category)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the current channel count of the specified <a class="el" href="structgroup.html">group</a> and category.  <a href="#a026ae712c21ad8f1e8cde66467153838"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__group__info.html">ast_group_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ae351dc6f23997a800e7a743d6411b8e7">ast_app_group_list_head</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the head of the <a class="el" href="structgroup.html">group</a> count list.  <a href="#ae351dc6f23997a800e7a743d6411b8e7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#afa354da7388ee1882ac981396f143bda">ast_app_group_list_rdlock</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read Lock the <a class="el" href="structgroup.html">group</a> count list.  <a href="#afa354da7388ee1882ac981396f143bda"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#aa3d01e65e04cddfa84781590b37732e8">ast_app_group_list_unlock</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlock the <a class="el" href="structgroup.html">group</a> count list.  <a href="#aa3d01e65e04cddfa84781590b37732e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a6d1783b818b130e529c611e710beafe9">ast_app_group_list_wrlock</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write Lock the <a class="el" href="structgroup.html">group</a> count list.  <a href="#a6d1783b818b130e529c611e710beafe9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a687e664c7fb3bb2acb4f5fa17f28d3a2">ast_app_group_match_get_count</a> (const char *groupmatch, const char *category)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the current channel count of all <a class="el" href="structgroups.html">groups</a> that match the specified pattern and category.  <a href="#a687e664c7fb3bb2acb4f5fa17f28d3a2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a6bd3fac13a76cd864600a84ffd66724e">ast_app_group_set_channel</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the <a class="el" href="structgroup.html">group</a> for a channel, splitting the provided data into <a class="el" href="structgroup.html">group</a> and category, if specified.  <a href="#a6bd3fac13a76cd864600a84ffd66724e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ab926dd29fc418cde5b67a00ba914cd2c">ast_app_group_split_group</a> (const char *data, char *<a class="el" href="structgroup.html">group</a>, int group_max, char *category, int category_max)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Split a <a class="el" href="structgroup.html">group</a> string into <a class="el" href="structgroup.html">group</a> and category, returning a default category if none is provided.  <a href="#ab926dd29fc418cde5b67a00ba914cd2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a69e90e401aa3da48a6eef5139727cbb3">ast_app_group_update</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *oldchan, struct <a class="el" href="structast__channel.html">ast_channel</a> *newchan)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update all <a class="el" href="structgroup.html">group</a> counting for a channel to a new one.  <a href="#a69e90e401aa3da48a6eef5139727cbb3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ae5953304e56862ac7efc1fed0ac6732f">ast_app_has_voicemail</a> (const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *folder)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if a given mailbox has any voicemail If folder is NULL, defaults to "INBOX". If folder is "INBOX", includes the <a class="el" href="structnumber.html" title="Number structure.">number</a> of messages in the "Urgent" folder.  <a href="#ae5953304e56862ac7efc1fed0ac6732f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a318582ad072d31085d4623e634edf46c">ast_app_inboxcount</a> (const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, int *newmsgs, int *oldmsgs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine <a class="el" href="structnumber.html" title="Number structure.">number</a> of new/old messages in a mailbox.  <a href="#a318582ad072d31085d4623e634edf46c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a6f9a8f7a54dd80f1b5363b6cadfd4939">ast_app_inboxcount2</a> (const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, int *urgentmsgs, int *newmsgs, int *oldmsgs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine <a class="el" href="structnumber.html" title="Number structure.">number</a> of urgent/new/old messages in a mailbox.  <a href="#a6f9a8f7a54dd80f1b5363b6cadfd4939"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#aa34e72e01cab2e09f4a195eb79175f95">ast_app_messagecount</a> (const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *folder)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check <a class="el" href="structnumber.html" title="Number structure.">number</a> of messages in a given context, mailbox, and folder.  <a href="#aa34e72e01cab2e09f4a195eb79175f95"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#adc36d870f1a77a726a74f4891f1365d3">ast_app_options2str64</a> (const struct <a class="el" href="structast__app__option.html">ast_app_option</a> *options, struct <a class="el" href="structast__flags64.html">ast_flags64</a> *flags, char *<a class="el" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, size_t len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a list of options array, return an option string based on passed flags.  <a href="#adc36d870f1a77a726a74f4891f1365d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a> (const struct <a class="el" href="structast__app__option.html">ast_app_option</a> *options, struct <a class="el" href="structast__flags.html">ast_flags</a> *flags, char **args, char *optstr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parses a string containing application options and sets flags/arguments.  <a href="#af40039f1c49c16d0f6fa33fe9c43a0cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#af85cb9dfd2fea9cfe820d2323c7dd471">ast_app_parse_options64</a> (const struct <a class="el" href="structast__app__option.html">ast_app_option</a> *options, struct <a class="el" href="structast__flags64.html">ast_flags64</a> *flags, char **args, char *optstr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parses a string containing application options and sets flags/arguments.  <a href="#af85cb9dfd2fea9cfe820d2323c7dd471"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a3c444cef1f29205f033db05bfeee8298">ast_app_sayname</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a mailbox and context, play that mailbox owner's name to the channel specified.  <a href="#a3c444cef1f29205f033db05bfeee8298"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#afcbfdd6dfc8c5f0f549b0a5d7e263e97">ast_close_fds_above_n</a> (int n)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Common routine for child processes, to close all fds prior to exec(2).  <a href="#afcbfdd6dfc8c5f0f549b0a5d7e263e97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a3405b1282cefdceebba734b8e756c55d">ast_control_streamfile</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *file, const char *fwd, const char *rev, const char *<a class="el" href="res__timing__pthread_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>, const char *pause, const char *restart, int <a class="el" href="app__voicemail_8c.html#a1df943a05a384a407a19cf8831b2d237">skipms</a>, long *offsetms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stream a file with fast forward, pause, reverse, restart.  <a href="#a3405b1282cefdceebba734b8e756c55d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#af20b8ac2e28e659be352bbaecdf0ab03">ast_dtmf_stream</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, struct <a class="el" href="structast__channel.html">ast_channel</a> *peer, const char *digits, int between, unsigned int duration)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send DTMF to a channel.  <a href="#af20b8ac2e28e659be352bbaecdf0ab03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a1e8f73e62b3c2243eca582ee0d8d6147">ast_get_encoded_char</a> (const char *stream, char *result, size_t *consumed)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decode an encoded control or extended ASCII character.  <a href="#a1e8f73e62b3c2243eca582ee0d8d6147"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a2fdf311701900d162bced0d30e923b92">ast_get_encoded_str</a> (const char *stream, char *result, size_t result_len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decode a stream of encoded control or extended ASCII characters.  <a href="#a2fdf311701900d162bced0d30e923b92"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a27992e5c39b818ff6b190f726a80cb50">ast_install_vm_functions</a> (int(*has_voicemail_func)(const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *folder), int(*inboxcount_func)(const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, int *newmsgs, int *oldmsgs), int(*inboxcount2_func)(const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, int *urgentmsgs, int *newmsgs, int *oldmsgs), int(*messagecount_func)(const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *folder), int(*sayname_func)(struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set voicemail function callbacks.  <a href="#a27992e5c39b818ff6b190f726a80cb50"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a855c3d16ea8884345a7b1c3fe5a16577">ast_ivr_menu_run</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__ivr__menu.html">ast_ivr_menu</a> *menu, void *cbdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Runs an IVR menu.  <a href="#a855c3d16ea8884345a7b1c3fe5a16577"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a2566e275a6e912943c68cbfc867cc60a">ast_linear_stream</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *filename, int fd, int allowoverride)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stream a filename (or file descriptor) as a generator.  <a href="#a2566e275a6e912943c68cbfc867cc60a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8c">AST_LOCK_RESULT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a74c57b5a842dcbc15cc991a31f679a13">ast_lock_path</a> (const char *path)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock a filesystem path.  <a href="#a74c57b5a842dcbc15cc991a31f679a13"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a46e323bf2b852abe8ed7490fcb6e1f6d">ast_play_and_prepend</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, char *playfile, char *recordfile, int maxtime_sec, char *fmt, int *duration, int <a class="el" href="chan__agent_8c.html#a690b549792f347bebb6a13518822bcf7">beep</a>, int <a class="el" href="chan__alsa_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>, int maxsilence_ms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Record a <a class="el" href="structmessage.html">message</a> and prepend the <a class="el" href="structmessage.html">message</a> to the given record file after playing the optional playfile (or a beep), storing the duration in 'duration' and with a maximum permitted silence time in milliseconds of 'maxsilence' under 'silencethreshold' or use '-1' for either or both parameters for defaults.  <a href="#a46e323bf2b852abe8ed7490fcb6e1f6d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a5189403102ce3cae44bd1b1644ee97a2">ast_play_and_record</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *playfile, const char *recordfile, int maxtime_sec, const char *fmt, int *duration, int <a class="el" href="chan__alsa_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>, int maxsilence_ms, const char *path)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Record a file for a max amount of time (in seconds), in a given list of <a class="el" href="structformats.html">formats</a> separated by '|', outputting the duration of the recording, and with a maximum <br/>
 permitted silence time in milliseconds of 'maxsilence' under 'silencethreshold' or use '-1' for either or both parameters for defaults. calls <a class="el" href="app_8h.html#af6428878db94a4adf8136850e6a654f5" title="Unlock a path.">ast_unlock_path()</a> on 'path' if passed.  <a href="#a5189403102ce3cae44bd1b1644ee97a2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a7f35e9e75513344d3ed7c56b22b8ea1f">ast_play_and_record_full</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *playfile, const char *recordfile, int maxtime_sec, const char *fmt, int *duration, int <a class="el" href="chan__alsa_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>, int maxsilence_ms, const char *path, const char *<a class="el" href="chan__agent_8c.html#a97629727ac11792aa963aed4457abde8">acceptdtmf</a>, const char *canceldtmf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#abbbec6ab9a303e865a1d1a261152540d">ast_play_and_wait</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *fn)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Play a stream and wait for a digit, returning the digit that was pressed.  <a href="#abbbec6ab9a303e865a1d1a261152540d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ac5aea5ca8a190e3a89d29b74a09cdb3e">ast_read_textfile</a> (const char *file)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a file into asterisk.  <a href="#ac5aea5ca8a190e3a89d29b74a09cdb3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a88b6ee77eea0c8a6cc0a315e1c1fc815">ast_record_review</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *playfile, const char *recordfile, int maxtime, const char *fmt, int *duration, const char *path)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allow to record <a class="el" href="structmessage.html">message</a> and have a review option.  <a href="#a88b6ee77eea0c8a6cc0a315e1c1fc815"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a6de8ef28c39cc39978497de1918bfd70">ast_replace_sigchld</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Replace the SIGCHLD handler.  <a href="#a6de8ef28c39cc39978497de1918bfd70"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a7a4c7e208ffc4d11a1918beb0e920ec0">ast_safe_fork</a> (int stop_reaper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Common routine to safely fork without a chance of a signal handler firing badly in the child.  <a href="#a7a4c7e208ffc4d11a1918beb0e920ec0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a1044fae6847dc8986a212af0af492a23">ast_safe_fork_cleanup</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Common routine to cleanup after fork'ed process is complete (if reaping was stopped).  <a href="#a1044fae6847dc8986a212af0af492a23"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a9fb5cf0385848033ee3e98625e5f9784">ast_safe_system</a> (const char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Safely spawn an external program while closing file descriptors.  <a href="#a9fb5cf0385848033ee3e98625e5f9784"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#aaef9c9ee6c9e05a6675201486ea2f02e">ast_set_lock_type</a> (enum <a class="el" href="app_8h.html#a889fad4c6cc627add80454ae61b53241">AST_LOCK_TYPE</a> <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the type of locks used by <a class="el" href="app_8h.html#a74c57b5a842dcbc15cc991a31f679a13" title="Lock a filesystem path.">ast_lock_path()</a>.  <a href="#aaef9c9ee6c9e05a6675201486ea2f02e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a1528703fa0e2ea11fcab7e04f8e0a6cb">ast_str_get_encoded_str</a> (struct <a class="el" href="structast__str.html">ast_str</a> **<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, int maxlen, const char *stream)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decode a stream of encoded control or extended ASCII characters.  <a href="#a1528703fa0e2ea11fcab7e04f8e0a6cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a0c13141712b0c226b6000d659024b1b8">AST_THREADSTORAGE_EXTERNAL</a> (ast_str_thread_global_buf)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#a65d1324f7632267a35a6d933fdbdc6f9">ast_uninstall_vm_functions</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#af6428878db94a4adf8136850e6a654f5">ast_unlock_path</a> (const char *path)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlock a path.  <a href="#af6428878db94a4adf8136850e6a654f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app_8h.html#ad7c2a7da4125347c06d9719580731228">ast_unreplace_sigchld</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Restore the SIGCHLD handler.  <a href="#ad7c2a7da4125347c06d9719580731228"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Application convenience functions, designed to give consistent look and feel to Asterisk <a class="el" href="structapps.html">apps</a>. </p>

<p>Definition in file <a class="el" href="app_8h_source.html">app.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a037e9a5b28477b17e7c9acbe7ecb21d5"></a><!-- doxytag: member="app.h::AST_APP_ARG" ref="a037e9a5b28477b17e7c9acbe7ecb21d5" args="(name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_APP_ARG</td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Define an application argument. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the argument </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00338">338</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l20916">acf_channel_read()</a>, <a class="el" href="func__curl_8c_source.html#l00397">acf_curl_exec()</a>, <a class="el" href="func__logic_8c_source.html#l00166">acf_if()</a>, <a class="el" href="func__logic_8c_source.html#l00226">acf_import()</a>, <a class="el" href="app__readexten_8c_source.html#l00263">acf_isexten_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00489">acf_jabberstatus_read()</a>, <a class="el" href="app__voicemail_8c_source.html#l09982">acf_mailbox_exists()</a>, <a class="el" href="app__meetme_8c_source.html#l06355">acf_meetme_info()</a>, <a class="el" href="func__odbc_8c_source.html#l00375">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c_source.html#l00203">acf_odbc_write()</a>, <a class="el" href="func__rand_8c_source.html#l00055">acf_rand_exec()</a>, <a class="el" href="func__sprintf_8c_source.html#l00063">acf_sprintf()</a>, <a class="el" href="func__strings_8c_source.html#l00838">acf_strftime()</a>, <a class="el" href="func__strings_8c_source.html#l00872">acf_strptime()</a>, <a class="el" href="res__odbc_8c_source.html#l01464">acf_transaction_read()</a>, <a class="el" href="res__odbc_8c_source.html#l01502">acf_transaction_write()</a>, <a class="el" href="func__version_8c_source.html#l00080">acf_version_exec()</a>, <a class="el" href="func__vmcount_8c_source.html#l00066">acf_vmcount_exec()</a>, <a class="el" href="manager_8c_source.html#l01904">action_status()</a>, <a class="el" href="chan__agent_8c_source.html#l00357">add_agent()</a>, <a class="el" href="app__meetme_8c_source.html#l03969">admin_exec()</a>, <a class="el" href="func__aes_8c_source.html#l00073">aes_helper()</a>, <a class="el" href="res__agi_8c_source.html#l03212">agi_exec_full()</a>, <a class="el" href="res__jabber_8c_source.html#l00548">aji_send_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00432">aji_status_exec()</a>, <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04893">aqm_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00577">array()</a>, <a class="el" href="manager_8c_source.html#l00903">astman_get_variables()</a>, <a class="el" href="app__channelredirect_8c_source.html#l00065">asyncgoto_exec()</a>, <a class="el" href="app__authenticate_8c_source.html#l00108">auth_exec()</a>, <a class="el" href="app__talkdetect_8c_source.html#l00076">background_detect_exec()</a>, <a class="el" href="features_8c_source.html#l04524">bridge_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l00583">build_profile()</a>, <a class="el" href="func__cdr_8c_source.html#l00183">cdr_read()</a>, <a class="el" href="func__cdr_8c_source.html#l00220">cdr_write()</a>, <a class="el" href="app__chanisavail_8c_source.html#l00097">chanavail_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l04151">channel_admin_exec()</a>, <a class="el" href="app__chanspy_8c_source.html#l01035">chanspy_exec()</a>, <a class="el" href="func__odbc_8c_source.html#l00978">cli_odbc_read()</a>, <a class="el" href="func__odbc_8c_source.html#l01177">cli_odbc_write()</a>, <a class="el" href="app__meetme_8c_source.html#l03696">conf_exec()</a>, <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, <a class="el" href="func__config_8c_source.html#l00064">config_function_read()</a>, <a class="el" href="app__controlplayback_8c_source.html#l00128">controlplayback_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l03650">count_exec()</a>, <a class="el" href="func__cut_8c_source.html#l00154">cut_internal()</a>, <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>, <a class="el" href="func__dialgroup_8c_source.html#l00193">dialgroup_write()</a>, <a class="el" href="app__dictate_8c_source.html#l00084">dictate_exec()</a>, <a class="el" href="app__directory_8c_source.html#l00723">directory_exec()</a>, <a class="el" href="app__disa_8c_source.html#l00143">disa_exec()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03972">dundi_query_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04045">dundi_result_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03889">dundifunc_read()</a>, <a class="el" href="app__jack_8c_source.html#l00859">enable_jack_hook()</a>, <a class="el" href="func__enum_8c_source.html#l00251">enum_query_read()</a>, <a class="el" href="func__enum_8c_source.html#l00316">enum_result_read()</a>, <a class="el" href="app__exec_8c_source.html#l00195">execif_exec()</a>, <a class="el" href="app__chanspy_8c_source.html#l01127">extenspy_exec()</a>, <a class="el" href="app__festival_8c_source.html#l00268">festival_exec()</a>, <a class="el" href="func__env_8c_source.html#l00163">file_read()</a>, <a class="el" href="func__strings_8c_source.html#l00427">filter()</a>, <a class="el" href="app__meetme_8c_source.html#l03546">find_conf()</a>, <a class="el" href="res__config__sqlite_8c_source.html#l00586">find_table_cb()</a>, <a class="el" href="app__forkcdr_8c_source.html#l00229">forkcdr_exec()</a>, <a class="el" href="chan__sip_8c_source.html#l17191">func_header_read()</a>, <a class="el" href="chan__agent_8c_source.html#l02497">function_agent()</a>, <a class="el" href="func__db_8c_source.html#l00206">function_db_delete()</a>, <a class="el" href="func__db_8c_source.html#l00169">function_db_exists()</a>, <a class="el" href="func__db_8c_source.html#l00105">function_db_read()</a>, <a class="el" href="func__db_8c_source.html#l00136">function_db_write()</a>, <a class="el" href="func__enum_8c_source.html#l00154">function_enum()</a>, <a class="el" href="func__strings_8c_source.html#l00292">function_fieldqty()</a>, <a class="el" href="func__realtime_8c_source.html#l00144">function_realtime_read()</a>, <a class="el" href="func__realtime_8c_source.html#l00357">function_realtime_readdestroy()</a>, <a class="el" href="func__realtime_8c_source.html#l00309">function_realtime_store()</a>, <a class="el" href="func__realtime_8c_source.html#l00201">function_realtime_write()</a>, <a class="el" href="func__enum_8c_source.html#l00414">function_txtcidname()</a>, <a class="el" href="app__stack_8c_source.html#l00328">gosub_exec()</a>, <a class="el" href="app__stack_8c_source.html#l00418">gosubif_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00684">hash_read()</a>, <a class="el" href="func__strings_8c_source.html#l00664">hash_write()</a>, <a class="el" href="func__devstate_8c_source.html#l00144">hint_read()</a>, <a class="el" href="func__iconv_8c_source.html#l00077">iconv_read()</a>, <a class="el" href="func__odbc_8c_source.html#l00745">init_acf_query()</a>, <a class="el" href="app__amd_8c_source.html#l00146">isAnsweringMachine()</a>, <a class="el" href="func__dialplan_8c_source.html#l00053">isexten_function_read()</a>, <a class="el" href="app__jack_8c_source.html#l00743">jack_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00331">listfilter()</a>, <a class="el" href="app__verbose_8c_source.html#l00121">log_exec()</a>, <a class="el" href="chan__agent_8c_source.html#l01981">login_exec()</a>, <a class="el" href="func__math_8c_source.html#l00097">math()</a>, <a class="el" href="chan__misdn_8c_source.html#l02394">misdn_call()</a>, <a class="el" href="chan__misdn_8c_source.html#l05663">misdn_check_l2l1()</a>, <a class="el" href="chan__misdn_8c_source.html#l05615">misdn_facility_exec()</a>, <a class="el" href="app__mixmonitor_8c_source.html#l00469">mixmonitor_exec()</a>, <a class="el" href="app__originate_8c_source.html#l00092">originate_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01255">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01657">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01335">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01503">ospnext_exec()</a>, <a class="el" href="chan__oss_8c_source.html#l00591">oss_call()</a>, <a class="el" href="chan__oss_8c_source.html#l00827">oss_request()</a>, <a class="el" href="app__page_8c_source.html#l00121">page_exec()</a>, <a class="el" href="features_8c_source.html#l03249">park_call_exec()</a>, <a class="el" href="app__parkandannounce_8c_source.html#l00088">parkandannounce_exec()</a>, <a class="el" href="pbx_8c_source.html#l08504">pbx_builtin_answer()</a>, <a class="el" href="pbx_8c_source.html#l08798">pbx_builtin_background()</a>, <a class="el" href="pbx_8c_source.html#l09104">pbx_builtin_setvar_multiple()</a>, <a class="el" href="pbx_8c_source.html#l08729">pbx_builtin_waitexten()</a>, <a class="el" href="app__stack_8c_source.html#l00516">peek_read()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00667">play_moh_exec()</a>, <a class="el" href="app__playback_8c_source.html#l00418">playback_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01131">pp_each_extension_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01088">pp_each_user_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04764">pqm_exec()</a>, <a class="el" href="app__privacy_8c_source.html#l00083">privacy_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04956">ql_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05031">queue_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05546">queue_function_memberpenalty_read()</a>, <a class="el" href="app__queue_8c_source.html#l05577">queue_function_memberpenalty_write()</a>, <a class="el" href="app__fax_8c_source.html#l00874">rcvfax_exec()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__readexten_8c_source.html#l00128">readexten_exec()</a>, <a class="el" href="func__realtime_8c_source.html#l00233">realtimefield_read()</a>, <a class="el" href="app__record_8c_source.html#l00132">record_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00508">regex()</a>, <a class="el" href="app__queue_8c_source.html#l05728">reload_single_member()</a>, <a class="el" href="app__dial_8c_source.html#l02345">retrydial_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04836">rqm_exec()</a>, <a class="el" href="app__sayunixtime_8c_source.html#l00092">sayunixtime_exec()</a>, <a class="el" href="app__senddtmf_8c_source.html#l00065">senddtmf_exec()</a>, <a class="el" href="app__sendtext_8c_source.html#l00075">sendtext_exec()</a>, <a class="el" href="app__url_8c_source.html#l00093">sendurl_exec()</a>, <a class="el" href="func__global_8c_source.html#l00128">shared_read()</a>, <a class="el" href="func__global_8c_source.html#l00176">shared_write()</a>, <a class="el" href="chan__sip_8c_source.html#l07472">sip_register()</a>, <a class="el" href="app__meetme_8c_source.html#l05808">sla_trunk_exec()</a>, <a class="el" href="res__smdi_8c_source.html#l01221">smdi_msg_read()</a>, <a class="el" href="res__smdi_8c_source.html#l01122">smdi_msg_retrieve_read()</a>, <a class="el" href="app__sms_8c_source.html#l01858">sms_exec()</a>, <a class="el" href="app__fax_8c_source.html#l00830">sndfax_exec()</a>, <a class="el" href="app__softhangup_8c_source.html#l00072">softhangup_exec()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00639">speech_background()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00511">speech_load()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00747">start_moh_exec()</a>, <a class="el" href="res__monitor_8c_source.html#l00495">start_monitor_exec()</a>, <a class="el" href="app__transfer_8c_source.html#l00077">transfer_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04800">upqm_exec()</a>, <a class="el" href="app__userevent_8c_source.html#l00059">userevent_exec()</a>, <a class="el" href="app__verbose_8c_source.html#l00075">verbose_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l09942">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c_source.html#l01050">vm_check_password_shell()</a>, <a class="el" href="app__voicemail_8c_source.html#l09810">vm_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l09099">vm_execmain()</a>, and <a class="el" href="app__zapateller_8c_source.html#l00077">zapateller_exec()</a>.</p>

</div>
</div>
<a class="anchor" id="aca036489931bf5571e2472331c8ac80b"></a><!-- doxytag: member="app.h::AST_APP_OPTION" ref="aca036489931bf5571e2472331c8ac80b" args="(option, flagno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_APP_OPTION</td>
          <td>(</td>
          <td class="paramtype">option, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flagno&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;[option] = { .flag = flagno }</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Declares an application option that does not accept an argument. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>option</em>&nbsp;</td><td>The single character representing the option </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flagno</em>&nbsp;</td><td>The flag index to be set if this option is present </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="func__devstate_8c.html#ad07af5ef010286f0378edec054160bcf">AST_APP_OPTIONS</a>, <a class="el" href="app_8c.html#af40039f1c49c16d0f6fa33fe9c43a0cb" title="Parses a string containing application options and sets flags/arguments.">ast_app_parse_options</a> </dd></dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00505">505</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7549377df87038be737e8cae73acaa9d"></a><!-- doxytag: member="app.h::AST_APP_OPTION_ARG" ref="a7549377df87038be737e8cae73acaa9d" args="(option, flagno, argno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_APP_OPTION_ARG</td>
          <td>(</td>
          <td class="paramtype">option, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flagno, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">argno&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;[option] = { .flag = flagno, .arg_index = argno + 1 }</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Declares an application option that accepts an argument. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>option</em>&nbsp;</td><td>The single character representing the option </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flagno</em>&nbsp;</td><td>The flag index to be set if this option is present </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>argno</em>&nbsp;</td><td>The index into the argument array where the argument should be placed </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="func__devstate_8c.html#ad07af5ef010286f0378edec054160bcf">AST_APP_OPTIONS</a>, <a class="el" href="app_8c.html#af40039f1c49c16d0f6fa33fe9c43a0cb" title="Parses a string containing application options and sets flags/arguments.">ast_app_parse_options</a> </dd></dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00516">516</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="a520a3c6b7d57903d9a616051da1a019d"></a><!-- doxytag: member="app.h::AST_APP_OPTIONS" ref="a520a3c6b7d57903d9a616051da1a019d" args="(holder, options...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_APP_OPTIONS</td>
          <td>(</td>
          <td class="paramtype">holder, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">options...&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;static const struct <a class="el" href="structast__app__option.html">ast_app_option</a> holder[128] = options</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Declares an array of options for an application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>holder</em>&nbsp;</td><td>The name of the array to be created </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>The actual options to be placed into the array </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="app_8c.html#af40039f1c49c16d0f6fa33fe9c43a0cb" title="Parses a string containing application options and sets flags/arguments.">ast_app_parse_options</a></dd></dl>
<p>This macro declares a 'static const' array of <code>struct</code> <code>ast_option</code> elements to hold the list of available options for an application. Each option must be declared using either the <a class="el" href="app_8h.html#aca036489931bf5571e2472331c8ac80b" title="Declares an application option that does not accept an argument.">AST_APP_OPTION()</a> or <a class="el" href="app_8h.html#a7549377df87038be737e8cae73acaa9d" title="Declares an application option that accepts an argument.">AST_APP_OPTION_ARG()</a> macros.</p>
<p>Example usage: </p>
<div class="fragment"><pre class="fragment">  <span class="keyword">enum</span> {
        OPT_JUMP = (1 &lt;&lt; 0),
        OPT_BLAH = (1 &lt;&lt; 1),
        OPT_BLORT = (1 &lt;&lt; 2),
  } my_app_option_flags;

  <span class="keyword">enum</span> {
        OPT_ARG_BLAH = 0,
        OPT_ARG_BLORT,
        !! <span class="keyword">this</span> entry tells how many possible arguments there are,
           and must be the <a class="code" href="devicestate_8c.html#a43a8def62ee15449794285cbbc0f79af">last</a> entry in the list
        <a class="code" href="app__chanspy_8c.html#a99fb83031ce9923c84392b4e92f956b5aec7326f60e7edad15d96ff935e5616d6">OPT_ARG_ARRAY_SIZE</a>,
  } my_app_option_args;

  <a class="code" href="app_8h.html#a520a3c6b7d57903d9a616051da1a019d" title="Declares an array of options for an application.">AST_APP_OPTIONS</a>(my_app_options, {
        <a class="code" href="app_8h.html#aca036489931bf5571e2472331c8ac80b" title="Declares an application option that does not accept an argument.">AST_APP_OPTION</a>(<span class="charliteral">&apos;j&apos;</span>, OPT_JUMP),
        <a class="code" href="app_8h.html#a7549377df87038be737e8cae73acaa9d" title="Declares an application option that accepts an argument.">AST_APP_OPTION_ARG</a>(<span class="charliteral">&apos;b&apos;</span>, OPT_BLAH, OPT_ARG_BLAH),
        AST_APP_OPTION_BLORT(<span class="charliteral">&apos;B&apos;</span>, OPT_BLORT, OPT_ARG_BLORT),
  });

  <span class="keyword">static</span> <span class="keywordtype">int</span> my_app_exec(<span class="keyword">struct</span> <a class="code" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> *chan, <span class="keywordtype">void</span> *data)
  {
   <span class="keywordtype">char</span> *options;
   <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> opts = { 0, };
   <span class="keywordtype">char</span> *opt_args[<a class="code" href="app__chanspy_8c.html#a99fb83031ce9923c84392b4e92f956b5aec7326f60e7edad15d96ff935e5616d6">OPT_ARG_ARRAY_SIZE</a>];

   ... <span class="keywordflow">do</span> any argument <a class="code" href="chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a> here ...

   <span class="keywordflow">if</span> (ast_parseoptions(my_app_options, &amp;opts, opt_args, options)) {
      <a class="code" href="module_8h.html#aac87725d61b6daf4ce7d7b505f1b68c9">ast_module_user_remove</a>(u);
      <span class="keywordflow">return</span> -1;
   }
  }
</pre></div> 
<p>Definition at line <a class="el" href="app_8h_source.html#l00496">496</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="a588ed7395623b8493efcf229024af9c5"></a><!-- doxytag: member="app.h::ast_app_separate_args" ref="a588ed7395623b8493efcf229024af9c5" args="(a, b, c, d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_app_separate_args</td>
          <td>(</td>
          <td class="paramtype">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">b, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">c, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">d&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;__ast_app_separate_args(a,b,1,c,d)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8h_source.html#l00423">423</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="app__chanspy_8c_source.html#l00767">common_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l02195">minivm_accmess_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l01971">minivm_greet_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l01795">minivm_mwi_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l01836">minivm_notify_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l01915">minivm_record_exec()</a>, and <a class="el" href="chan__dahdi_8c_source.html#l16040">process_echocancel()</a>.</p>

</div>
</div>
<a class="anchor" id="a80cd3f6f786b59b742bcecfc0b3be7c2"></a><!-- doxytag: member="app.h::AST_DECLARE_APP_ARGS" ref="a80cd3f6f786b59b742bcecfc0b3be7c2" args="(name, arglist)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_DECLARE_APP_ARGS</td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">arglist&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;AST_DEFINE_APP_ARGS_TYPE(, arglist) <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Declare a structure to hold an application's arguments. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>arglist</em>&nbsp;</td><td>The list of arguments, defined using AST_APP_ARG</td></tr>
  </table>
  </dd>
</dl>
<p>This macro declares a structure intended to be used in a call to <a class="el" href="app_8h.html#a588ed7395623b8493efcf229024af9c5">ast_app_separate_args()</a>. The structure includes all the arguments specified, plus an argv array that overlays them and an argc argument counter. The arguments must be declared using AST_APP_ARG, and they will all be character pointers (strings).</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The structure is <b>not</b> initialized, as the call to <a class="el" href="app_8h.html#a588ed7395623b8493efcf229024af9c5">ast_app_separate_args()</a> will perform that function before parsing the arguments. </dd></dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00355">355</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l20916">acf_channel_read()</a>, <a class="el" href="func__curl_8c_source.html#l00397">acf_curl_exec()</a>, <a class="el" href="func__logic_8c_source.html#l00166">acf_if()</a>, <a class="el" href="func__logic_8c_source.html#l00226">acf_import()</a>, <a class="el" href="app__readexten_8c_source.html#l00263">acf_isexten_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00489">acf_jabberstatus_read()</a>, <a class="el" href="app__voicemail_8c_source.html#l09982">acf_mailbox_exists()</a>, <a class="el" href="app__meetme_8c_source.html#l06355">acf_meetme_info()</a>, <a class="el" href="func__odbc_8c_source.html#l00375">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c_source.html#l00203">acf_odbc_write()</a>, <a class="el" href="func__rand_8c_source.html#l00055">acf_rand_exec()</a>, <a class="el" href="func__sprintf_8c_source.html#l00063">acf_sprintf()</a>, <a class="el" href="func__strings_8c_source.html#l00838">acf_strftime()</a>, <a class="el" href="func__strings_8c_source.html#l00872">acf_strptime()</a>, <a class="el" href="res__odbc_8c_source.html#l01464">acf_transaction_read()</a>, <a class="el" href="res__odbc_8c_source.html#l01502">acf_transaction_write()</a>, <a class="el" href="func__version_8c_source.html#l00080">acf_version_exec()</a>, <a class="el" href="func__vmcount_8c_source.html#l00066">acf_vmcount_exec()</a>, <a class="el" href="manager_8c_source.html#l01904">action_status()</a>, <a class="el" href="chan__agent_8c_source.html#l00357">add_agent()</a>, <a class="el" href="app__meetme_8c_source.html#l03969">admin_exec()</a>, <a class="el" href="func__aes_8c_source.html#l00073">aes_helper()</a>, <a class="el" href="res__agi_8c_source.html#l03212">agi_exec_full()</a>, <a class="el" href="res__jabber_8c_source.html#l00548">aji_send_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00432">aji_status_exec()</a>, <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04893">aqm_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00577">array()</a>, <a class="el" href="manager_8c_source.html#l00903">astman_get_variables()</a>, <a class="el" href="app__channelredirect_8c_source.html#l00065">asyncgoto_exec()</a>, <a class="el" href="app__authenticate_8c_source.html#l00108">auth_exec()</a>, <a class="el" href="app__talkdetect_8c_source.html#l00076">background_detect_exec()</a>, <a class="el" href="features_8c_source.html#l04524">bridge_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l00583">build_profile()</a>, <a class="el" href="func__cdr_8c_source.html#l00183">cdr_read()</a>, <a class="el" href="func__cdr_8c_source.html#l00220">cdr_write()</a>, <a class="el" href="app__chanisavail_8c_source.html#l00097">chanavail_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l04151">channel_admin_exec()</a>, <a class="el" href="app__chanspy_8c_source.html#l01035">chanspy_exec()</a>, <a class="el" href="func__odbc_8c_source.html#l00978">cli_odbc_read()</a>, <a class="el" href="func__odbc_8c_source.html#l01177">cli_odbc_write()</a>, <a class="el" href="app__meetme_8c_source.html#l03696">conf_exec()</a>, <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, <a class="el" href="func__config_8c_source.html#l00064">config_function_read()</a>, <a class="el" href="app__controlplayback_8c_source.html#l00128">controlplayback_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l03650">count_exec()</a>, <a class="el" href="func__cut_8c_source.html#l00154">cut_internal()</a>, <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>, <a class="el" href="func__dialgroup_8c_source.html#l00193">dialgroup_write()</a>, <a class="el" href="app__dictate_8c_source.html#l00084">dictate_exec()</a>, <a class="el" href="app__directory_8c_source.html#l00723">directory_exec()</a>, <a class="el" href="app__disa_8c_source.html#l00143">disa_exec()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03972">dundi_query_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04045">dundi_result_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03889">dundifunc_read()</a>, <a class="el" href="app__jack_8c_source.html#l00859">enable_jack_hook()</a>, <a class="el" href="func__enum_8c_source.html#l00251">enum_query_read()</a>, <a class="el" href="func__enum_8c_source.html#l00316">enum_result_read()</a>, <a class="el" href="app__exec_8c_source.html#l00195">execif_exec()</a>, <a class="el" href="app__chanspy_8c_source.html#l01127">extenspy_exec()</a>, <a class="el" href="app__festival_8c_source.html#l00268">festival_exec()</a>, <a class="el" href="func__env_8c_source.html#l00163">file_read()</a>, <a class="el" href="func__strings_8c_source.html#l00427">filter()</a>, <a class="el" href="app__meetme_8c_source.html#l03546">find_conf()</a>, <a class="el" href="res__config__sqlite_8c_source.html#l00586">find_table_cb()</a>, <a class="el" href="app__forkcdr_8c_source.html#l00229">forkcdr_exec()</a>, <a class="el" href="chan__sip_8c_source.html#l17191">func_header_read()</a>, <a class="el" href="chan__agent_8c_source.html#l02497">function_agent()</a>, <a class="el" href="func__db_8c_source.html#l00206">function_db_delete()</a>, <a class="el" href="func__db_8c_source.html#l00169">function_db_exists()</a>, <a class="el" href="func__db_8c_source.html#l00105">function_db_read()</a>, <a class="el" href="func__db_8c_source.html#l00136">function_db_write()</a>, <a class="el" href="func__enum_8c_source.html#l00154">function_enum()</a>, <a class="el" href="func__strings_8c_source.html#l00292">function_fieldqty()</a>, <a class="el" href="func__realtime_8c_source.html#l00144">function_realtime_read()</a>, <a class="el" href="func__realtime_8c_source.html#l00357">function_realtime_readdestroy()</a>, <a class="el" href="func__realtime_8c_source.html#l00309">function_realtime_store()</a>, <a class="el" href="func__realtime_8c_source.html#l00201">function_realtime_write()</a>, <a class="el" href="func__enum_8c_source.html#l00414">function_txtcidname()</a>, <a class="el" href="app__stack_8c_source.html#l00328">gosub_exec()</a>, <a class="el" href="app__stack_8c_source.html#l00418">gosubif_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00684">hash_read()</a>, <a class="el" href="func__strings_8c_source.html#l00664">hash_write()</a>, <a class="el" href="func__devstate_8c_source.html#l00144">hint_read()</a>, <a class="el" href="func__iconv_8c_source.html#l00077">iconv_read()</a>, <a class="el" href="func__odbc_8c_source.html#l00745">init_acf_query()</a>, <a class="el" href="app__amd_8c_source.html#l00146">isAnsweringMachine()</a>, <a class="el" href="func__dialplan_8c_source.html#l00053">isexten_function_read()</a>, <a class="el" href="app__jack_8c_source.html#l00743">jack_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00331">listfilter()</a>, <a class="el" href="app__verbose_8c_source.html#l00121">log_exec()</a>, <a class="el" href="chan__agent_8c_source.html#l01981">login_exec()</a>, <a class="el" href="func__math_8c_source.html#l00097">math()</a>, <a class="el" href="chan__misdn_8c_source.html#l02394">misdn_call()</a>, <a class="el" href="chan__misdn_8c_source.html#l05663">misdn_check_l2l1()</a>, <a class="el" href="chan__misdn_8c_source.html#l05615">misdn_facility_exec()</a>, <a class="el" href="app__mixmonitor_8c_source.html#l00469">mixmonitor_exec()</a>, <a class="el" href="app__originate_8c_source.html#l00092">originate_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01255">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01657">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01335">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01503">ospnext_exec()</a>, <a class="el" href="chan__oss_8c_source.html#l00591">oss_call()</a>, <a class="el" href="chan__oss_8c_source.html#l00827">oss_request()</a>, <a class="el" href="app__page_8c_source.html#l00121">page_exec()</a>, <a class="el" href="features_8c_source.html#l03249">park_call_exec()</a>, <a class="el" href="app__parkandannounce_8c_source.html#l00088">parkandannounce_exec()</a>, <a class="el" href="pbx_8c_source.html#l08504">pbx_builtin_answer()</a>, <a class="el" href="pbx_8c_source.html#l08798">pbx_builtin_background()</a>, <a class="el" href="pbx_8c_source.html#l09104">pbx_builtin_setvar_multiple()</a>, <a class="el" href="pbx_8c_source.html#l08729">pbx_builtin_waitexten()</a>, <a class="el" href="app__stack_8c_source.html#l00516">peek_read()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00667">play_moh_exec()</a>, <a class="el" href="app__playback_8c_source.html#l00418">playback_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01131">pp_each_extension_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01088">pp_each_user_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04764">pqm_exec()</a>, <a class="el" href="app__privacy_8c_source.html#l00083">privacy_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04956">ql_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05031">queue_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05546">queue_function_memberpenalty_read()</a>, <a class="el" href="app__queue_8c_source.html#l05577">queue_function_memberpenalty_write()</a>, <a class="el" href="app__fax_8c_source.html#l00874">rcvfax_exec()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__readexten_8c_source.html#l00128">readexten_exec()</a>, <a class="el" href="func__realtime_8c_source.html#l00233">realtimefield_read()</a>, <a class="el" href="app__record_8c_source.html#l00132">record_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00508">regex()</a>, <a class="el" href="app__queue_8c_source.html#l05728">reload_single_member()</a>, <a class="el" href="app__dial_8c_source.html#l02345">retrydial_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04836">rqm_exec()</a>, <a class="el" href="app__sayunixtime_8c_source.html#l00092">sayunixtime_exec()</a>, <a class="el" href="app__senddtmf_8c_source.html#l00065">senddtmf_exec()</a>, <a class="el" href="app__sendtext_8c_source.html#l00075">sendtext_exec()</a>, <a class="el" href="app__url_8c_source.html#l00093">sendurl_exec()</a>, <a class="el" href="func__global_8c_source.html#l00128">shared_read()</a>, <a class="el" href="func__global_8c_source.html#l00176">shared_write()</a>, <a class="el" href="chan__sip_8c_source.html#l07472">sip_register()</a>, <a class="el" href="app__meetme_8c_source.html#l05808">sla_trunk_exec()</a>, <a class="el" href="res__smdi_8c_source.html#l01221">smdi_msg_read()</a>, <a class="el" href="res__smdi_8c_source.html#l01122">smdi_msg_retrieve_read()</a>, <a class="el" href="app__sms_8c_source.html#l01858">sms_exec()</a>, <a class="el" href="app__fax_8c_source.html#l00830">sndfax_exec()</a>, <a class="el" href="app__softhangup_8c_source.html#l00072">softhangup_exec()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00639">speech_background()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00511">speech_load()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00747">start_moh_exec()</a>, <a class="el" href="res__monitor_8c_source.html#l00495">start_monitor_exec()</a>, <a class="el" href="app__transfer_8c_source.html#l00077">transfer_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04800">upqm_exec()</a>, <a class="el" href="app__userevent_8c_source.html#l00059">userevent_exec()</a>, <a class="el" href="app__verbose_8c_source.html#l00075">verbose_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l09942">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c_source.html#l01050">vm_check_password_shell()</a>, <a class="el" href="app__voicemail_8c_source.html#l09810">vm_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l09099">vm_execmain()</a>, and <a class="el" href="app__zapateller_8c_source.html#l00077">zapateller_exec()</a>.</p>

</div>
</div>
<a class="anchor" id="a439373ac35099110fa9fa3d52a4628fe"></a><!-- doxytag: member="app.h::AST_DEFINE_APP_ARGS_TYPE" ref="a439373ac35099110fa9fa3d52a4628fe" args="(type, arglist)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_DEFINE_APP_ARGS_TYPE</td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">arglist&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">struct </span><a class="code" href="chan__nbs_8c.html#abda2c6671470e62e2e93b09986c9117e">type</a> { \
      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> argc; \
      <span class="keywordtype">char</span> *argv[0]; \
      arglist \
   }
</pre></div>
<p>Define a structure type to hold an application's arguments. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>The name of the structure type </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>arglist</em>&nbsp;</td><td>The list of arguments, defined using AST_APP_ARG</td></tr>
  </table>
  </dd>
</dl>
<p>This macro defines a structure type intended to be used in a call to <a class="el" href="app_8h.html#a588ed7395623b8493efcf229024af9c5">ast_app_separate_args()</a>. The structure includes all the arguments specified, plus an argv array that overlays them and an argc argument counter. The arguments must be declared using AST_APP_ARG, and they will all be character pointers (strings).</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This defines a structure type, but does not declare an instance of the structure. That must be done separately. </dd></dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00371">371</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="adfb9b356a8ef9eb14a39601cf228277a"></a><!-- doxytag: member="app.h::AST_IVR_DECLARE_MENU" ref="adfb9b356a8ef9eb14a39601cf228277a" args="(holder, title, flags, foo...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_IVR_DECLARE_MENU</td>
          <td>(</td>
          <td class="paramtype">holder, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">title, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flags, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">foo...&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structast__ivr__option.html">ast_ivr_option</a> __options_##holder[] = foo;\
   <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structast__ivr__menu.html">ast_ivr_menu</a> holder = { <a class="code" href="structast__ivr__menu.html#af06d911bb9e05f491ef3da520d03796c">title</a>, <a class="code" href="structast__ivr__menu.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>, __options_##holder }
</pre></div>
<p>Definition at line <a class="el" href="app_8h_source.html#l00083">83</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa592076f909040907106f25bf7a2d727"></a><!-- doxytag: member="app.h::AST_IVR_FLAG_AUTORESTART" ref="aa592076f909040907106f25bf7a2d727" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_IVR_FLAG_AUTORESTART&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8h_source.html#l00081">81</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="accfcb380df76a64251d88ef49c2dd4e3"></a><!-- doxytag: member="app.h::AST_NONSTANDARD_APP_ARGS" ref="accfcb380df76a64251d88ef49c2dd4e3" args="(args, parse, sep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_NONSTANDARD_APP_ARGS</td>
          <td>(</td>
          <td class="paramtype">args, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parse, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sep&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, sep, 1, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs the 'nonstandard' argument separation process for an application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>args</em>&nbsp;</td><td>An argument structure defined using AST_DECLARE_APP_ARGS </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>parse</em>&nbsp;</td><td>A modifiable buffer containing the input to be parsed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sep</em>&nbsp;</td><td>A nonstandard separator character</td></tr>
  </table>
  </dd>
</dl>
<p>This function will separate the input string using the nonstandard argument separator character and fill in the provided structure, including the argc argument counter field. </p>

<p>Definition at line <a class="el" href="app_8h_source.html#l00402">402</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="func__logic_8c_source.html#l00166">acf_if()</a>, <a class="el" href="res__jabber_8c_source.html#l00489">acf_jabberstatus_read()</a>, <a class="el" href="app__voicemail_8c_source.html#l09982">acf_mailbox_exists()</a>, <a class="el" href="res__jabber_8c_source.html#l00432">aji_status_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l00583">build_profile()</a>, <a class="el" href="func__dialgroup_8c_source.html#l00193">dialgroup_write()</a>, <a class="el" href="app__exec_8c_source.html#l00195">execif_exec()</a>, <a class="el" href="chan__agent_8c_source.html#l02497">function_agent()</a>, <a class="el" href="func__db_8c_source.html#l00206">function_db_delete()</a>, <a class="el" href="func__db_8c_source.html#l00169">function_db_exists()</a>, <a class="el" href="func__db_8c_source.html#l00105">function_db_read()</a>, <a class="el" href="func__db_8c_source.html#l00136">function_db_write()</a>, <a class="el" href="chan__misdn_8c_source.html#l02394">misdn_call()</a>, <a class="el" href="chan__oss_8c_source.html#l00591">oss_call()</a>, <a class="el" href="chan__oss_8c_source.html#l00827">oss_request()</a>, <a class="el" href="pbx_8c_source.html#l09104">pbx_builtin_setvar_multiple()</a>, <a class="el" href="app__record_8c_source.html#l00132">record_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00508">regex()</a>, and <a class="el" href="app__voicemail_8c_source.html#l01050">vm_check_password_shell()</a>.</p>

</div>
</div>
<a class="anchor" id="afc33d0723a077475b09f7285c288ed42"></a><!-- doxytag: member="app.h::AST_NONSTANDARD_RAW_ARGS" ref="afc33d0723a077475b09f7285c288ed42" args="(args, parse, sep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_NONSTANDARD_RAW_ARGS</td>
          <td>(</td>
          <td class="paramtype">args, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parse, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sep&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, sep, 0, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8h_source.html#l00404">404</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="app__stack_8c_source.html#l00418">gosubif_exec()</a>, and <a class="el" href="chan__sip_8c_source.html#l07472">sip_register()</a>.</p>

</div>
</div>
<a class="anchor" id="ac08f7eb1eb9476b30987c73e1052ada8"></a><!-- doxytag: member="app.h::AST_STANDARD_APP_ARGS" ref="ac08f7eb1eb9476b30987c73e1052ada8" args="(args, parse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_STANDARD_APP_ARGS</td>
          <td>(</td>
          <td class="paramtype">args, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parse&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, ',', 1, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs the 'standard' argument separation process for an application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>args</em>&nbsp;</td><td>An argument structure defined using AST_DECLARE_APP_ARGS </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>parse</em>&nbsp;</td><td>A modifiable buffer containing the input to be parsed</td></tr>
  </table>
  </dd>
</dl>
<p>This function will separate the input string using the standard argument separator character ',' and fill in the provided structure, including the argc argument counter field. </p>

<p>Definition at line <a class="el" href="app_8h_source.html#l00387">387</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l20916">acf_channel_read()</a>, <a class="el" href="func__curl_8c_source.html#l00397">acf_curl_exec()</a>, <a class="el" href="func__logic_8c_source.html#l00226">acf_import()</a>, <a class="el" href="app__readexten_8c_source.html#l00263">acf_isexten_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00489">acf_jabberstatus_read()</a>, <a class="el" href="app__meetme_8c_source.html#l06355">acf_meetme_info()</a>, <a class="el" href="func__odbc_8c_source.html#l00375">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c_source.html#l00203">acf_odbc_write()</a>, <a class="el" href="func__rand_8c_source.html#l00055">acf_rand_exec()</a>, <a class="el" href="func__sprintf_8c_source.html#l00063">acf_sprintf()</a>, <a class="el" href="func__strings_8c_source.html#l00838">acf_strftime()</a>, <a class="el" href="func__strings_8c_source.html#l00872">acf_strptime()</a>, <a class="el" href="res__odbc_8c_source.html#l01464">acf_transaction_read()</a>, <a class="el" href="res__odbc_8c_source.html#l01502">acf_transaction_write()</a>, <a class="el" href="func__version_8c_source.html#l00080">acf_version_exec()</a>, <a class="el" href="func__vmcount_8c_source.html#l00066">acf_vmcount_exec()</a>, <a class="el" href="manager_8c_source.html#l01904">action_status()</a>, <a class="el" href="chan__agent_8c_source.html#l00357">add_agent()</a>, <a class="el" href="app__meetme_8c_source.html#l03969">admin_exec()</a>, <a class="el" href="func__aes_8c_source.html#l00073">aes_helper()</a>, <a class="el" href="res__agi_8c_source.html#l03212">agi_exec_full()</a>, <a class="el" href="res__jabber_8c_source.html#l00548">aji_send_exec()</a>, <a class="el" href="res__jabber_8c_source.html#l00432">aji_status_exec()</a>, <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04893">aqm_exec()</a>, <a class="el" href="func__strings_8c_source.html#l00577">array()</a>, <a class="el" href="manager_8c_source.html#l00903">astman_get_variables()</a>, <a class="el" href="app__channelredirect_8c_source.html#l00065">asyncgoto_exec()</a>, <a class="el" href="app__authenticate_8c_source.html#l00108">auth_exec()</a>, <a class="el" href="app__talkdetect_8c_source.html#l00076">background_detect_exec()</a>, <a class="el" href="features_8c_source.html#l04524">bridge_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l00583">build_profile()</a>, <a class="el" href="func__cdr_8c_source.html#l00183">cdr_read()</a>, <a class="el" href="func__cdr_8c_source.html#l00220">cdr_write()</a>, <a class="el" href="app__chanisavail_8c_source.html#l00097">chanavail_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l04151">channel_admin_exec()</a>, <a class="el" href="app__chanspy_8c_source.html#l01035">chanspy_exec()</a>, <a class="el" href="func__odbc_8c_source.html#l00978">cli_odbc_read()</a>, <a class="el" href="func__odbc_8c_source.html#l01177">cli_odbc_write()</a>, <a class="el" href="app__meetme_8c_source.html#l03696">conf_exec()</a>, <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, <a class="el" href="func__config_8c_source.html#l00064">config_function_read()</a>, <a class="el" href="app__controlplayback_8c_source.html#l00128">controlplayback_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l03650">count_exec()</a>, <a class="el" href="func__cut_8c_source.html#l00154">cut_internal()</a>, <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>, <a class="el" href="func__dialgroup_8c_source.html#l00193">dialgroup_write()</a>, <a class="el" href="app__dictate_8c_source.html#l00084">dictate_exec()</a>, <a class="el" href="app__directory_8c_source.html#l00723">directory_exec()</a>, <a class="el" href="app__disa_8c_source.html#l00143">disa_exec()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03972">dundi_query_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l04045">dundi_result_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03889">dundifunc_read()</a>, <a class="el" href="app__jack_8c_source.html#l00859">enable_jack_hook()</a>, <a class="el" href="func__enum_8c_source.html#l00251">enum_query_read()</a>, <a class="el" href="func__enum_8c_source.html#l00316">enum_result_read()</a>, <a class="el" href="app__exec_8c_source.html#l00195">execif_exec()</a>, <a class="el" href="app__chanspy_8c_source.html#l01127">extenspy_exec()</a>, <a class="el" href="app__festival_8c_source.html#l00268">festival_exec()</a>, <a class="el" href="func__env_8c_source.html#l00163">file_read()</a>, <a class="el" href="app__meetme_8c_source.html#l03546">find_conf()</a>, <a class="el" href="res__config__sqlite_8c_source.html#l00586">find_table_cb()</a>, <a class="el" href="app__forkcdr_8c_source.html#l00229">forkcdr_exec()</a>, <a class="el" href="chan__sip_8c_source.html#l17191">func_header_read()</a>, <a class="el" href="func__enum_8c_source.html#l00154">function_enum()</a>, <a class="el" href="func__strings_8c_source.html#l00292">function_fieldqty()</a>, <a class="el" href="func__realtime_8c_source.html#l00144">function_realtime_read()</a>, <a class="el" href="func__realtime_8c_source.html#l00357">function_realtime_readdestroy()</a>, <a class="el" href="func__realtime_8c_source.html#l00309">function_realtime_store()</a>, <a class="el" href="func__realtime_8c_source.html#l00201">function_realtime_write()</a>, <a class="el" href="func__enum_8c_source.html#l00414">function_txtcidname()</a>, <a class="el" href="func__strings_8c_source.html#l00684">hash_read()</a>, <a class="el" href="func__strings_8c_source.html#l00664">hash_write()</a>, <a class="el" href="func__devstate_8c_source.html#l00144">hint_read()</a>, <a class="el" href="func__iconv_8c_source.html#l00077">iconv_read()</a>, <a class="el" href="func__odbc_8c_source.html#l00745">init_acf_query()</a>, <a class="el" href="app__amd_8c_source.html#l00146">isAnsweringMachine()</a>, <a class="el" href="func__dialplan_8c_source.html#l00053">isexten_function_read()</a>, <a class="el" href="func__strings_8c_source.html#l00331">listfilter()</a>, <a class="el" href="app__verbose_8c_source.html#l00121">log_exec()</a>, <a class="el" href="chan__agent_8c_source.html#l01981">login_exec()</a>, <a class="el" href="func__math_8c_source.html#l00097">math()</a>, <a class="el" href="chan__misdn_8c_source.html#l05663">misdn_check_l2l1()</a>, <a class="el" href="chan__misdn_8c_source.html#l05615">misdn_facility_exec()</a>, <a class="el" href="app__mixmonitor_8c_source.html#l00469">mixmonitor_exec()</a>, <a class="el" href="app__originate_8c_source.html#l00092">originate_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01255">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01657">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01335">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c_source.html#l01503">ospnext_exec()</a>, <a class="el" href="app__page_8c_source.html#l00121">page_exec()</a>, <a class="el" href="features_8c_source.html#l03249">park_call_exec()</a>, <a class="el" href="app__parkandannounce_8c_source.html#l00088">parkandannounce_exec()</a>, <a class="el" href="pbx_8c_source.html#l08504">pbx_builtin_answer()</a>, <a class="el" href="pbx_8c_source.html#l08798">pbx_builtin_background()</a>, <a class="el" href="pbx_8c_source.html#l09104">pbx_builtin_setvar_multiple()</a>, <a class="el" href="pbx_8c_source.html#l08729">pbx_builtin_waitexten()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00667">play_moh_exec()</a>, <a class="el" href="app__playback_8c_source.html#l00418">playback_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01131">pp_each_extension_exec()</a>, <a class="el" href="res__phoneprov_8c_source.html#l01088">pp_each_user_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04764">pqm_exec()</a>, <a class="el" href="app__privacy_8c_source.html#l00083">privacy_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04956">ql_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05031">queue_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05546">queue_function_memberpenalty_read()</a>, <a class="el" href="app__queue_8c_source.html#l05577">queue_function_memberpenalty_write()</a>, <a class="el" href="app__fax_8c_source.html#l00874">rcvfax_exec()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__readexten_8c_source.html#l00128">readexten_exec()</a>, <a class="el" href="func__realtime_8c_source.html#l00233">realtimefield_read()</a>, <a class="el" href="app__record_8c_source.html#l00132">record_exec()</a>, <a class="el" href="app__queue_8c_source.html#l05728">reload_single_member()</a>, <a class="el" href="app__dial_8c_source.html#l02345">retrydial_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04836">rqm_exec()</a>, <a class="el" href="app__sayunixtime_8c_source.html#l00092">sayunixtime_exec()</a>, <a class="el" href="app__senddtmf_8c_source.html#l00065">senddtmf_exec()</a>, <a class="el" href="app__sendtext_8c_source.html#l00075">sendtext_exec()</a>, <a class="el" href="app__url_8c_source.html#l00093">sendurl_exec()</a>, <a class="el" href="func__global_8c_source.html#l00128">shared_read()</a>, <a class="el" href="func__global_8c_source.html#l00176">shared_write()</a>, <a class="el" href="app__meetme_8c_source.html#l05808">sla_trunk_exec()</a>, <a class="el" href="res__smdi_8c_source.html#l01221">smdi_msg_read()</a>, <a class="el" href="res__smdi_8c_source.html#l01122">smdi_msg_retrieve_read()</a>, <a class="el" href="app__sms_8c_source.html#l01858">sms_exec()</a>, <a class="el" href="app__fax_8c_source.html#l00830">sndfax_exec()</a>, <a class="el" href="app__softhangup_8c_source.html#l00072">softhangup_exec()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00639">speech_background()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00511">speech_load()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00747">start_moh_exec()</a>, <a class="el" href="res__monitor_8c_source.html#l00495">start_monitor_exec()</a>, <a class="el" href="app__transfer_8c_source.html#l00077">transfer_exec()</a>, <a class="el" href="app__queue_8c_source.html#l04800">upqm_exec()</a>, <a class="el" href="app__userevent_8c_source.html#l00059">userevent_exec()</a>, <a class="el" href="app__verbose_8c_source.html#l00075">verbose_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l09942">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c_source.html#l09810">vm_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l09099">vm_execmain()</a>, and <a class="el" href="app__zapateller_8c_source.html#l00077">zapateller_exec()</a>.</p>

</div>
</div>
<a class="anchor" id="a1fc2af00a8197196f3fe2047297466db"></a><!-- doxytag: member="app.h::AST_STANDARD_RAW_ARGS" ref="a1fc2af00a8197196f3fe2047297466db" args="(args, parse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AST_STANDARD_RAW_ARGS</td>
          <td>(</td>
          <td class="paramtype">args, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parse&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;args.argc = __ast_app_separate_args(parse, ',', 0, args.argv, ((sizeof(args) - offsetof(typeof(args), argv)) / sizeof(args.argv[0])))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8h_source.html#l00389">389</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p>Referenced by <a class="el" href="func__strings_8c_source.html#l00427">filter()</a>, <a class="el" href="app__stack_8c_source.html#l00328">gosub_exec()</a>, and <a class="el" href="app__stack_8c_source.html#l00516">peek_read()</a>.</p>

</div>
</div>
<a class="anchor" id="ab451a4653176c211d131b899e1f91bde"></a><!-- doxytag: member="app.h::BEGIN_OPTIONS" ref="ab451a4653176c211d131b899e1f91bde" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BEGIN_OPTIONS&nbsp;&nbsp;&nbsp;{</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8h_source.html#l00445">445</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2a1890787b3e55318c417c0a3e1432c7"></a><!-- doxytag: member="app.h::END_OPTIONS" ref="a2a1890787b3e55318c417c0a3e1432c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define END_OPTIONS&nbsp;&nbsp;&nbsp;}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8h_source.html#l00446">446</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a69c12aaf969284756dee28dc1fa503fa"></a><!-- doxytag: member="app.h::ast_ivr_callback" ref="a69c12aaf969284756dee28dc1fa503fa" args=")(struct ast_channel *chan, char *option, void *cbdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* <a class="el" href="app_8h.html#a69c12aaf969284756dee28dc1fa503fa">ast_ivr_callback</a>)(struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, char *option, void *cbdata)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback function for IVR. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns 0 on completion, -1 on hangup or digit if interrupted </dd></dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00042">42</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a10624bc470a4ac2634221dfa74bdb17f"></a><!-- doxytag: member="app.h::ast_getdata_result" ref="a10624bc470a4ac2634221dfa74bdb17f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17f">ast_getdata_result</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a10624bc470a4ac2634221dfa74bdb17fa447a1a659574cde67aa71538c804206f"></a><!-- doxytag: member="AST_GETDATA_FAILED" ref="a10624bc470a4ac2634221dfa74bdb17fa447a1a659574cde67aa71538c804206f" args="" -->AST_GETDATA_FAILED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a10624bc470a4ac2634221dfa74bdb17fa76a0cf0f0ca1c3000e227686d7de7d9c"></a><!-- doxytag: member="AST_GETDATA_COMPLETE" ref="a10624bc470a4ac2634221dfa74bdb17fa76a0cf0f0ca1c3000e227686d7de7d9c" args="" -->AST_GETDATA_COMPLETE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a10624bc470a4ac2634221dfa74bdb17fa79554349b620ac61794e76cb70eef322"></a><!-- doxytag: member="AST_GETDATA_TIMEOUT" ref="a10624bc470a4ac2634221dfa74bdb17fa79554349b620ac61794e76cb70eef322" args="" -->AST_GETDATA_TIMEOUT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a10624bc470a4ac2634221dfa74bdb17fa74b94669f324ba10f5bfb979f54e636c"></a><!-- doxytag: member="AST_GETDATA_INTERRUPTED" ref="a10624bc470a4ac2634221dfa74bdb17fa74b94669f324ba10f5bfb979f54e636c" args="" -->AST_GETDATA_INTERRUPTED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a10624bc470a4ac2634221dfa74bdb17fa94425459ee6ac7993c6289fde4d4ea8c"></a><!-- doxytag: member="AST_GETDATA_EMPTY_END_TERMINATED" ref="a10624bc470a4ac2634221dfa74bdb17fa94425459ee6ac7993c6289fde4d4ea8c" args="" -->AST_GETDATA_EMPTY_END_TERMINATED</em>&nbsp;</td><td>
<p>indicates a <a class="el" href="structuser.html" title="structure to hold users read from users.conf">user</a> terminated empty string rather than an empty string resulting from a timeout or other factors </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00260">260</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00260"></a>00260                         {
<a name="l00261"></a>00261    <a class="code" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa447a1a659574cde67aa71538c804206f">AST_GETDATA_FAILED</a> = -1,
<a name="l00262"></a>00262    <a class="code" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa76a0cf0f0ca1c3000e227686d7de7d9c">AST_GETDATA_COMPLETE</a> = 0,
<a name="l00263"></a>00263    <a class="code" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa79554349b620ac61794e76cb70eef322">AST_GETDATA_TIMEOUT</a> = 1,
<a name="l00264"></a>00264    <a class="code" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa74b94669f324ba10f5bfb979f54e636c">AST_GETDATA_INTERRUPTED</a> = 2,<span class="comment"></span>
<a name="l00265"></a>00265 <span class="comment">   /*! indicates a user terminated empty string rather than an empty string resulting </span>
<a name="l00266"></a>00266 <span class="comment">    * from a timeout or other factors */</span>
<a name="l00267"></a>00267    <a class="code" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa94425459ee6ac7993c6289fde4d4ea8c">AST_GETDATA_EMPTY_END_TERMINATED</a> = 3,
<a name="l00268"></a>00268 };
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5"></a><!-- doxytag: member="app.h::ast_ivr_action" ref="ad4d301d1d98ab8020c6104e3fb58e2d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5">ast_ivr_action</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a23d56e69a479b44ce2f89034fda4ed9a"></a><!-- doxytag: member="AST_ACTION_UPONE" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a23d56e69a479b44ce2f89034fda4ed9a" args="" -->AST_ACTION_UPONE</em>&nbsp;</td><td>
<p>adata is unused </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a9f49762cd1386370ddc2f8fc64965b88"></a><!-- doxytag: member="AST_ACTION_EXIT" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a9f49762cd1386370ddc2f8fc64965b88" args="" -->AST_ACTION_EXIT</em>&nbsp;</td><td>
<p>adata is the return value for ast_ivr_menu_run if channel was not hungup </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a911a0be3e05292936e4e6f8646194f7f"></a><!-- doxytag: member="AST_ACTION_CALLBACK" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a911a0be3e05292936e4e6f8646194f7f" args="" -->AST_ACTION_CALLBACK</em>&nbsp;</td><td>
<p>adata is an ast_ivr_callback </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a4bd0306ccd5256f1b150ec9b1d220f0f"></a><!-- doxytag: member="AST_ACTION_PLAYBACK" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a4bd0306ccd5256f1b150ec9b1d220f0f" args="" -->AST_ACTION_PLAYBACK</em>&nbsp;</td><td>
<p>adata is file to play </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5ab738e4ae4a7e6b7cd68b13d2a58985ba"></a><!-- doxytag: member="AST_ACTION_BACKGROUND" ref="ad4d301d1d98ab8020c6104e3fb58e2d5ab738e4ae4a7e6b7cd68b13d2a58985ba" args="" -->AST_ACTION_BACKGROUND</em>&nbsp;</td><td>
<p>adata is file to play </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a5a5e2a82ee86aab6a69decbb02514e68"></a><!-- doxytag: member="AST_ACTION_PLAYLIST" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a5a5e2a82ee86aab6a69decbb02514e68" args="" -->AST_ACTION_PLAYLIST</em>&nbsp;</td><td>
<p>adata is list of files, separated by ; to play </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5adc38e521e86969765c95912988cf6e2a"></a><!-- doxytag: member="AST_ACTION_MENU" ref="ad4d301d1d98ab8020c6104e3fb58e2d5adc38e521e86969765c95912988cf6e2a" args="" -->AST_ACTION_MENU</em>&nbsp;</td><td>
<p>adata is a pointer to an <a class="el" href="structast__ivr__menu.html">ast_ivr_menu</a> </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5ae951cfbea814df40816b70a1eeba65e8"></a><!-- doxytag: member="AST_ACTION_REPEAT" ref="ad4d301d1d98ab8020c6104e3fb58e2d5ae951cfbea814df40816b70a1eeba65e8" args="" -->AST_ACTION_REPEAT</em>&nbsp;</td><td>
<p>adata is max # of repeats, cast to a pointer </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a53ddb6911a10ea526b86f4cde6b2ce80"></a><!-- doxytag: member="AST_ACTION_RESTART" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a53ddb6911a10ea526b86f4cde6b2ce80" args="" -->AST_ACTION_RESTART</em>&nbsp;</td><td>
<p>adata is like repeat, but resets repeats to 0 </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5af34630ccb66618ee9dfef4d14423a6d0"></a><!-- doxytag: member="AST_ACTION_TRANSFER" ref="ad4d301d1d98ab8020c6104e3fb58e2d5af34630ccb66618ee9dfef4d14423a6d0" args="" -->AST_ACTION_TRANSFER</em>&nbsp;</td><td>
<p>adata is a string with exten</p>
<div class="fragment"><pre class="fragment">[@context]</pre></div> </td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5ac8b97828ca2347ecf4bf942478ddf0ba"></a><!-- doxytag: member="AST_ACTION_WAITOPTION" ref="ad4d301d1d98ab8020c6104e3fb58e2d5ac8b97828ca2347ecf4bf942478ddf0ba" args="" -->AST_ACTION_WAITOPTION</em>&nbsp;</td><td>
<p>adata is a timeout, or 0 for defaults </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a9470126e5a37e3044d577f6ba1140644"></a><!-- doxytag: member="AST_ACTION_NOOP" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a9470126e5a37e3044d577f6ba1140644" args="" -->AST_ACTION_NOOP</em>&nbsp;</td><td>
<p>adata is unused </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad4d301d1d98ab8020c6104e3fb58e2d5a363ce24d1bbcbf4687e4fd21aa1ee621"></a><!-- doxytag: member="AST_ACTION_BACKLIST" ref="ad4d301d1d98ab8020c6104e3fb58e2d5a363ce24d1bbcbf4687e4fd21aa1ee621" args="" -->AST_ACTION_BACKLIST</em>&nbsp;</td><td>
<p>adata is list of files separated by ; allows interruption </p>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00044">44</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00044"></a>00044              {
<a name="l00045"></a>00045    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a23d56e69a479b44ce2f89034fda4ed9a">AST_ACTION_UPONE</a>, <span class="comment">/*!&lt; adata is unused */</span>
<a name="l00046"></a>00046    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a9f49762cd1386370ddc2f8fc64965b88">AST_ACTION_EXIT</a>,  <span class="comment">/*!&lt; adata is the return value for ast_ivr_menu_run if channel was not hungup */</span>
<a name="l00047"></a>00047    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a911a0be3e05292936e4e6f8646194f7f">AST_ACTION_CALLBACK</a>, <span class="comment">/*!&lt; adata is an ast_ivr_callback */</span>
<a name="l00048"></a>00048    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a4bd0306ccd5256f1b150ec9b1d220f0f">AST_ACTION_PLAYBACK</a>, <span class="comment">/*!&lt; adata is file to play */</span>
<a name="l00049"></a>00049    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5ab738e4ae4a7e6b7cd68b13d2a58985ba">AST_ACTION_BACKGROUND</a>,  <span class="comment">/*!&lt; adata is file to play */</span>
<a name="l00050"></a>00050    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a5a5e2a82ee86aab6a69decbb02514e68">AST_ACTION_PLAYLIST</a>, <span class="comment">/*!&lt; adata is list of files, separated by ; to play */</span>
<a name="l00051"></a>00051    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5adc38e521e86969765c95912988cf6e2a">AST_ACTION_MENU</a>,  <span class="comment">/*!&lt; adata is a pointer to an ast_ivr_menu */</span>
<a name="l00052"></a>00052    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5ae951cfbea814df40816b70a1eeba65e8">AST_ACTION_REPEAT</a>,   <span class="comment">/*!&lt; adata is max # of repeats, cast to a pointer */</span>
<a name="l00053"></a>00053    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a53ddb6911a10ea526b86f4cde6b2ce80">AST_ACTION_RESTART</a>,  <span class="comment">/*!&lt; adata is like repeat, but resets repeats to 0 */</span>
<a name="l00054"></a>00054    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5af34630ccb66618ee9dfef4d14423a6d0">AST_ACTION_TRANSFER</a>, <span class="comment">/*!&lt; adata is a string with exten\verbatim[@context]\endverbatim */</span>
<a name="l00055"></a>00055    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5ac8b97828ca2347ecf4bf942478ddf0ba">AST_ACTION_WAITOPTION</a>,  <span class="comment">/*!&lt; adata is a timeout, or 0 for defaults */</span>
<a name="l00056"></a>00056    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a9470126e5a37e3044d577f6ba1140644">AST_ACTION_NOOP</a>,  <span class="comment">/*!&lt; adata is unused */</span>
<a name="l00057"></a>00057    <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5a363ce24d1bbcbf4687e4fd21aa1ee621">AST_ACTION_BACKLIST</a>, <span class="comment">/*!&lt; adata is list of files separated by ; allows interruption */</span>
<a name="l00058"></a>00058 } <a class="code" href="app_8h.html#ad4d301d1d98ab8020c6104e3fb58e2d5">ast_ivr_action</a>;
</pre></div></p>

</div>
</div>
<a class="anchor" id="a382bf96f47f0b7fa86ae5ed0644b3f8c"></a><!-- doxytag: member="app.h::AST_LOCK_RESULT" ref="a382bf96f47f0b7fa86ae5ed0644b3f8c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8c">AST_LOCK_RESULT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a382bf96f47f0b7fa86ae5ed0644b3f8ca37bdbc92223520af2a24d5bfd6f561bb"></a><!-- doxytag: member="AST_LOCK_SUCCESS" ref="a382bf96f47f0b7fa86ae5ed0644b3f8ca37bdbc92223520af2a24d5bfd6f561bb" args="" -->AST_LOCK_SUCCESS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a382bf96f47f0b7fa86ae5ed0644b3f8ca9c0f41302de02bb0130a92669d17333d"></a><!-- doxytag: member="AST_LOCK_TIMEOUT" ref="a382bf96f47f0b7fa86ae5ed0644b3f8ca9c0f41302de02bb0130a92669d17333d" args="" -->AST_LOCK_TIMEOUT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a382bf96f47f0b7fa86ae5ed0644b3f8ca46f6f55c5ee9576afd8dde6376c2b01a"></a><!-- doxytag: member="AST_LOCK_PATH_NOT_FOUND" ref="a382bf96f47f0b7fa86ae5ed0644b3f8ca46f6f55c5ee9576afd8dde6376c2b01a" args="" -->AST_LOCK_PATH_NOT_FOUND</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a382bf96f47f0b7fa86ae5ed0644b3f8cac59129c6f641d69ad14017c1ba1f2635"></a><!-- doxytag: member="AST_LOCK_FAILURE" ref="a382bf96f47f0b7fa86ae5ed0644b3f8cac59129c6f641d69ad14017c1ba1f2635" args="" -->AST_LOCK_FAILURE</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00270">270</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00270"></a>00270                      {
<a name="l00271"></a>00271    <a class="code" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8ca37bdbc92223520af2a24d5bfd6f561bb">AST_LOCK_SUCCESS</a> = 0,
<a name="l00272"></a>00272    <a class="code" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8ca9c0f41302de02bb0130a92669d17333d">AST_LOCK_TIMEOUT</a> = -1,
<a name="l00273"></a>00273    <a class="code" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8ca46f6f55c5ee9576afd8dde6376c2b01a">AST_LOCK_PATH_NOT_FOUND</a> = -2,
<a name="l00274"></a>00274    <a class="code" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8cac59129c6f641d69ad14017c1ba1f2635">AST_LOCK_FAILURE</a> = -3,
<a name="l00275"></a>00275 };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a889fad4c6cc627add80454ae61b53241"></a><!-- doxytag: member="app.h::AST_LOCK_TYPE" ref="a889fad4c6cc627add80454ae61b53241" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="app_8h.html#a889fad4c6cc627add80454ae61b53241">AST_LOCK_TYPE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Type of locking to use in ast_lock_path / ast_unlock_path. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a889fad4c6cc627add80454ae61b53241a599f18fdf355d7530bb754b8c66d6de7"></a><!-- doxytag: member="AST_LOCK_TYPE_LOCKFILE" ref="a889fad4c6cc627add80454ae61b53241a599f18fdf355d7530bb754b8c66d6de7" args="" -->AST_LOCK_TYPE_LOCKFILE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a889fad4c6cc627add80454ae61b53241a78cd7e44280d287fc0168a0c31b75e3f"></a><!-- doxytag: member="AST_LOCK_TYPE_FLOCK" ref="a889fad4c6cc627add80454ae61b53241a78cd7e44280d287fc0168a0c31b75e3f" args="" -->AST_LOCK_TYPE_FLOCK</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="app_8h_source.html#l00278">278</a> of file <a class="el" href="app_8h_source.html">app.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00278"></a>00278                    {
<a name="l00279"></a>00279    <a class="code" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a599f18fdf355d7530bb754b8c66d6de7">AST_LOCK_TYPE_LOCKFILE</a> = 0,
<a name="l00280"></a>00280    <a class="code" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a78cd7e44280d287fc0168a0c31b75e3f">AST_LOCK_TYPE_FLOCK</a> = 1,
<a name="l00281"></a>00281 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a1b65265bef5e0d7110092144ba9ee4da"></a><!-- doxytag: member="app.h::__ast_app_separate_args" ref="a1b65265bef5e0d7110092144ba9ee4da" args="(char *buf, char delim, int remove_chars, char **array, int arraylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int __ast_app_separate_args </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>delim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>remove_chars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>arraylen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Separate a string into arguments in an array. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>The string to be parsed (this must be a writable copy, as it will be modified) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>delim</em>&nbsp;</td><td>The character to be used to delimit arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>remove_chars</em>&nbsp;</td><td>Remove backslashes and quote characters, while parsing </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>array</em>&nbsp;</td><td>An array of 'char *' to be filled in with pointers to the found arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>arraylen</em>&nbsp;</td><td>The <a class="el" href="structnumber.html" title="Number structure.">number</a> of elements in the array (i.e. the <a class="el" href="structnumber.html" title="Number structure.">number</a> of arguments you will accept)</td></tr>
  </table>
  </dd>
</dl>
<p>Note: if there are more arguments in the string than the array will hold, the last element of the array will contain the remaining arguments, not separated.</p>
<p>The array will be completely zeroed by this function before it populates any entries.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The <a class="el" href="structnumber.html" title="Number structure.">number</a> of arguments found, or zero if the function arguments are not valid. </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01153">1153</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="ael__lex_8c_source.html#l00958">paren</a>, and <a class="el" href="app__voicemail_8c_source.html#l04039">quote()</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l01208">ast_app_separate_args()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01154"></a>01154 {
<a name="l01155"></a>01155    <span class="keywordtype">int</span> argc;
<a name="l01156"></a>01156    <span class="keywordtype">char</span> *scan, *wasdelim = NULL;
<a name="l01157"></a>01157    <span class="keywordtype">int</span> <a class="code" href="ael__lex_8c.html#a0dec70156318396f15cc8305df9918ab">paren</a> = 0, <a class="code" href="app__voicemail_8c.html#a0d851e2ec853422973f33c7d0d77035f" title="Wraps a character sequence in double quotes, escaping occurences of quotes within...">quote</a> = 0;
<a name="l01158"></a>01158 
<a name="l01159"></a>01159    <span class="keywordflow">if</span> (!<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> || !<a class="code" href="func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a> || !arraylen) {
<a name="l01160"></a>01160       <span class="keywordflow">return</span> 0;
<a name="l01161"></a>01161    }
<a name="l01162"></a>01162 
<a name="l01163"></a>01163    memset(<a class="code" href="func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>, 0, arraylen * <span class="keyword">sizeof</span>(*<a class="code" href="func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>));
<a name="l01164"></a>01164 
<a name="l01165"></a>01165    scan = <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l01166"></a>01166 
<a name="l01167"></a>01167    <span class="keywordflow">for</span> (argc = 0; *scan &amp;&amp; (argc &lt; arraylen - 1); argc++) {
<a name="l01168"></a>01168       <a class="code" href="func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>[argc] = scan;
<a name="l01169"></a>01169       <span class="keywordflow">for</span> (; *scan; scan++) {
<a name="l01170"></a>01170          <span class="keywordflow">if</span> (*scan == <span class="charliteral">&apos;(&apos;</span>) {
<a name="l01171"></a>01171             paren++;
<a name="l01172"></a>01172          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*scan == <span class="charliteral">&apos;)&apos;</span>) {
<a name="l01173"></a>01173             <span class="keywordflow">if</span> (paren) {
<a name="l01174"></a>01174                paren--;
<a name="l01175"></a>01175             }
<a name="l01176"></a>01176          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*scan == <span class="charliteral">&apos;&quot;&apos;</span> &amp;&amp; delim != <span class="charliteral">&apos;&quot;&apos;</span>) {
<a name="l01177"></a>01177             <a class="code" href="app__voicemail_8c.html#a0d851e2ec853422973f33c7d0d77035f" title="Wraps a character sequence in double quotes, escaping occurences of quotes within...">quote</a> = <a class="code" href="app__voicemail_8c.html#a0d851e2ec853422973f33c7d0d77035f" title="Wraps a character sequence in double quotes, escaping occurences of quotes within...">quote</a> ? 0 : 1;
<a name="l01178"></a>01178             <span class="keywordflow">if</span> (remove_chars) {
<a name="l01179"></a>01179                <span class="comment">/* Remove quote character from argument */</span>
<a name="l01180"></a>01180                memmove(scan, scan + 1, strlen(scan));
<a name="l01181"></a>01181                scan--;
<a name="l01182"></a>01182             }
<a name="l01183"></a>01183          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*scan == <span class="charliteral">&apos;\\&apos;</span>) {
<a name="l01184"></a>01184             <span class="keywordflow">if</span> (remove_chars) {
<a name="l01185"></a>01185                <span class="comment">/* Literal character, don&apos;t parse */</span>
<a name="l01186"></a>01186                memmove(scan, scan + 1, strlen(scan));
<a name="l01187"></a>01187             } <span class="keywordflow">else</span> {
<a name="l01188"></a>01188                scan++;
<a name="l01189"></a>01189             }
<a name="l01190"></a>01190          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*scan == delim) &amp;&amp; !paren &amp;&amp; !<a class="code" href="app__voicemail_8c.html#a0d851e2ec853422973f33c7d0d77035f" title="Wraps a character sequence in double quotes, escaping occurences of quotes within...">quote</a>) {
<a name="l01191"></a>01191             wasdelim = scan;
<a name="l01192"></a>01192             *scan++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01193"></a>01193             <span class="keywordflow">break</span>;
<a name="l01194"></a>01194          }
<a name="l01195"></a>01195       }
<a name="l01196"></a>01196    }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198    <span class="comment">/* If the last character in the original string was the delimiter, then</span>
<a name="l01199"></a>01199 <span class="comment">    * there is one additional argument. */</span>
<a name="l01200"></a>01200    <span class="keywordflow">if</span> (*scan || (scan &gt; <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a> &amp;&amp; (scan - 1) == wasdelim)) {
<a name="l01201"></a>01201       <a class="code" href="func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>[argc++] = scan;
<a name="l01202"></a>01202    }
<a name="l01203"></a>01203 
<a name="l01204"></a>01204    <span class="keywordflow">return</span> argc;
<a name="l01205"></a>01205 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af4825b337b9cd145a059852ce85ec6cd"></a><!-- doxytag: member="app.h::ast_app_dtget" ref="af4825b337b9cd145a059852ce85ec6cd" args="(struct ast_channel *chan, const char *context, char *collect, size_t size, int maxlen, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_dtget </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>collect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Present a dialtone and collect a certain length <a class="el" href="structextension.html">extension</a>. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns 1 on valid <a class="el" href="structextension.html">extension</a> entered, -1 on hangup, or 0 on invalid <a class="el" href="structextension.html">extension</a>. </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Note that if 'collect' holds digits already, new digits will be appended, so be sure it's initialized properly</dd></dl>
<p>Present a dialtone and collect a certain length <a class="el" href="structextension.html">extension</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>struct. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>collect</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxlen</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>timeout in seconds</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if <a class="el" href="structextension.html">extension</a> does not exist, 1 if <a class="el" href="structextension.html">extension</a> exists </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00076">76</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="pbx_8c_source.html#l04143">ast_exists_extension()</a>, <a class="el" href="indications_8c_source.html#l00452">ast_get_indication_tone()</a>, <a class="el" href="pbx_8c_source.html#l07267">ast_ignore_pattern()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="pbx_8c_source.html#l04163">ast_matchmore_extension()</a>, <a class="el" href="indications_8c_source.html#l00301">ast_playtones_start()</a>, <a class="el" href="indications_8c_source.html#l00390">ast_playtones_stop()</a>, <a class="el" href="indications_8h_source.html#l00223">ast_tone_zone_sound_unref()</a>, <a class="el" href="channel_8c_source.html#l02400">ast_waitfordigit()</a>, <a class="el" href="channel_8h_source.html#l00444">ast_channel::cid</a>, <a class="el" href="channel_8h_source.html#l00203">ast_callerid::cid_num</a>, <a class="el" href="indications_8h_source.html#l00051">ast_tone_zone_sound::data</a>, <a class="el" href="pbx_8h_source.html#l00145">ast_pbx::dtimeoutms</a>, <a class="el" href="logger_8h_source.html#l00141">LOG_NOTICE</a>, <a class="el" href="channel_8h_source.html#l00418">ast_channel::pbx</a>, and <a class="el" href="channel_8h_source.html#l00423">ast_channel::zone</a>.</p>

<p>Referenced by <a class="el" href="features_8c_source.html#l01396">builtin_atxfer()</a>, <a class="el" href="features_8c_source.html#l01265">builtin_blindtransfer()</a>, and <a class="el" href="bridge__builtin__features_8c_source.html#l00048">grab_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00077"></a>00077 {
<a name="l00078"></a>00078    <span class="keyword">struct </span><a class="code" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a> *ts;
<a name="l00079"></a>00079    <span class="keywordtype">int</span> res = 0, x = 0;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081    <span class="keywordflow">if</span> (maxlen &gt; size) {
<a name="l00082"></a>00082       maxlen = size;
<a name="l00083"></a>00083    }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085    <span class="keywordflow">if</span> (!timeout &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>) {
<a name="l00086"></a>00086       timeout = chan-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>-&gt;<a class="code" href="structast__pbx.html#a80a133d151de25445e8dfd09953a0872">dtimeoutms</a> / 1000.0;
<a name="l00087"></a>00087    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!timeout) {
<a name="l00088"></a>00088       timeout = 5;
<a name="l00089"></a>00089    }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091    <span class="keywordflow">if</span> ((ts = <a class="code" href="indications_8h.html#a516be2823557000dcd4be685a44d1d09" title="Locate a tone zone sound.">ast_get_indication_tone</a>(chan-&gt;<a class="code" href="structast__channel.html#a3b50931566324162ca5ebdd52fb5874c">zone</a>, <span class="stringliteral">&quot;dial&quot;</span>))) {
<a name="l00092"></a>00092       res = <a class="code" href="app__rpt_8c.html#a544e8a1dd4a986b00754103dda6a7d3b">ast_playtones_start</a>(chan, 0, ts-&gt;<a class="code" href="structast__tone__zone__sound.html#a8f64897c7ccc5c13f276d1d07c4e7095" title="Description of a tone.">data</a>, 0);
<a name="l00093"></a>00093       ts = <a class="code" href="indications_8h.html#a8b52ace68f21c0ac24414f038471647d" title="Release a reference to an ast_tone_zone_sound.">ast_tone_zone_sound_unref</a>(ts);
<a name="l00094"></a>00094    } <span class="keywordflow">else</span> {
<a name="l00095"></a>00095       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Huh....? no dial for indications?\n&quot;</span>);
<a name="l00096"></a>00096    }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098    <span class="keywordflow">for</span> (x = strlen(collect); x &lt; maxlen; ) {
<a name="l00099"></a>00099       res = <a class="code" href="channel_8h.html#a050bec9a4abc1a599b6573a6091b080c" title="Waits for a digit.">ast_waitfordigit</a>(chan, timeout);
<a name="l00100"></a>00100       <span class="keywordflow">if</span> (!<a class="code" href="pbx_8h.html#aa73d176ed4f1ce51e5db6beafba45fe3" title="Checks to see if a number should be ignored.">ast_ignore_pattern</a>(<a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, collect)) {
<a name="l00101"></a>00101          <a class="code" href="app__rpt_8c.html#a9d5be069b7060d326a213f5d60b8dc77">ast_playtones_stop</a>(chan);
<a name="l00102"></a>00102       }
<a name="l00103"></a>00103       <span class="keywordflow">if</span> (res &lt; 1) {
<a name="l00104"></a>00104          <span class="keywordflow">break</span>;
<a name="l00105"></a>00105       }
<a name="l00106"></a>00106       <span class="keywordflow">if</span> (res == <span class="charliteral">&apos;#&apos;</span>) {
<a name="l00107"></a>00107          <span class="keywordflow">break</span>;
<a name="l00108"></a>00108       }
<a name="l00109"></a>00109       collect[x++] = res;
<a name="l00110"></a>00110       <span class="keywordflow">if</span> (!<a class="code" href="pbx_8h.html#ac359af75b9494f50904583d2168a7577" title="Looks to see if adding anything to this extension might match something. (exists...">ast_matchmore_extension</a>(chan, <a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, collect, 1, chan-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>)) {
<a name="l00111"></a>00111          <span class="keywordflow">break</span>;
<a name="l00112"></a>00112       }
<a name="l00113"></a>00113    }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115    <span class="keywordflow">if</span> (res &gt;= 0) {
<a name="l00116"></a>00116       res = <a class="code" href="pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7" title="Determine whether an extension exists.">ast_exists_extension</a>(chan, <a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, collect, 1, chan-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>) ? 1 : 0;
<a name="l00117"></a>00117    }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119    <span class="keywordflow">return</span> res;
<a name="l00120"></a>00120 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af3f76858d4dd513e59dbe5e67bc46220"></a><!-- doxytag: member="app.h::ast_app_getdata" ref="af3f76858d4dd513e59dbe5e67bc46220" args="(struct ast_channel *c, const char *prompt, char *s, int maxlen, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_getdata </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>prompt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Plays a stream and gets DTMF data from a channel. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>Which channel one is interacting with </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>prompt</em>&nbsp;</td><td>File to pass to ast_streamfile (the one that you wish to play). It is also valid for this to be multiple files concatenated by "&amp;". For example, "file1&amp;file2&amp;file3". </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>The location where the DTMF data will be stored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxlen</em>&nbsp;</td><td>Max Length of the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout length waiting for data(in milliseconds). Set to 0 for standard timeout(six seconds), or -1 for no time out.</td></tr>
  </table>
  </dd>
</dl>
<p>This function was designed for application programmers for situations where they need to play a <a class="el" href="structmessage.html">message</a> and then get some DTMF data in response to the <a class="el" href="structmessage.html">message</a>. If a digit is pressed during playback, it will immediately break out of the <a class="el" href="structmessage.html">message</a> and continue execution of your code.</p>
<p>Plays a stream and gets DTMF data from a channel.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>The channel to read from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>prompt</em>&nbsp;</td><td>The file to stream to the channel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>The string to read in to. Must be at least the size of your length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxlen</em>&nbsp;</td><td>How many digits to read (maximum) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>set timeout to 0 for "standard" timeouts. Set timeout to -1 for "ludicrous time" (essentially never times out) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00130">130</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00267">AST_GETDATA_EMPTY_END_TERMINATED</a>, <a class="el" href="channel_8c_source.html#l04088">ast_readstring()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="pbx_8h_source.html#l00145">ast_pbx::dtimeoutms</a>, <a class="el" href="channel_8h_source.html#l00418">ast_channel::pbx</a>, <a class="el" href="pbx_8h_source.html#l00146">ast_pbx::rtimeoutms</a>, and <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>.</p>

<p>Referenced by <a class="el" href="app__authenticate_8c_source.html#l00108">auth_exec()</a>, <a class="el" href="app__dahdibarge_8c_source.html#l00261">conf_exec()</a>, <a class="el" href="app__dictate_8c_source.html#l00084">dictate_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l03546">find_conf()</a>, <a class="el" href="chan__agent_8c_source.html#l01981">login_exec()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__test_8c_source.html#l00146">testclient_exec()</a>, <a class="el" href="app__test_8c_source.html#l00320">testserver_exec()</a>, and <a class="el" href="app__voicemail_8c_source.html#l09810">vm_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00131"></a>00131 {
<a name="l00132"></a>00132    <span class="keywordtype">int</span> res = 0, to, fto;
<a name="l00133"></a>00133    <span class="keywordtype">char</span> *front, *filename;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135    <span class="comment">/* XXX Merge with full version? XXX */</span>
<a name="l00136"></a>00136 
<a name="l00137"></a>00137    <span class="keywordflow">if</span> (maxlen)
<a name="l00138"></a>00138       <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[0] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140    <span class="keywordflow">if</span> (!<a class="code" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a>)
<a name="l00141"></a>00141       <a class="code" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a> = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143    filename = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(<a class="code" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a>);
<a name="l00144"></a>00144    <span class="keywordflow">while</span> ((front = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;filename, <span class="stringliteral">&quot;&amp;&quot;</span>))) {
<a name="l00145"></a>00145       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(front)) {
<a name="l00146"></a>00146          res = <a class="code" href="file_8h.html#a67c7e271b4ca70aca6d48fd48d121857" title="Streams a file.">ast_streamfile</a>(c, front, c-&gt;language);
<a name="l00147"></a>00147          <span class="keywordflow">if</span> (res)
<a name="l00148"></a>00148             <span class="keywordflow">continue</span>;
<a name="l00149"></a>00149       }
<a name="l00150"></a>00150       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(filename)) {
<a name="l00151"></a>00151          <span class="comment">/* set timeouts for the last prompt */</span>
<a name="l00152"></a>00152          fto = c-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a> ? c-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>-&gt;<a class="code" href="structast__pbx.html#a765bfb11e07b0f90c235c9af9d7f46fa">rtimeoutms</a> : 6000;
<a name="l00153"></a>00153          to = c-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a> ? c-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>-&gt;<a class="code" href="structast__pbx.html#a80a133d151de25445e8dfd09953a0872">dtimeoutms</a> : 2000;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155          <span class="keywordflow">if</span> (timeout &gt; 0) {
<a name="l00156"></a>00156             fto = to = timeout;
<a name="l00157"></a>00157          }
<a name="l00158"></a>00158          <span class="keywordflow">if</span> (timeout &lt; 0) {
<a name="l00159"></a>00159             fto = to = 1000000000;
<a name="l00160"></a>00160          }
<a name="l00161"></a>00161       } <span class="keywordflow">else</span> {
<a name="l00162"></a>00162          <span class="comment">/* there is more than one prompt, so</span>
<a name="l00163"></a>00163 <span class="comment">          * get rid of the long timeout between</span>
<a name="l00164"></a>00164 <span class="comment">          * prompts, and make it 50ms */</span>
<a name="l00165"></a>00165          fto = 50;
<a name="l00166"></a>00166          to = c-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a> ? c-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>-&gt;<a class="code" href="structast__pbx.html#a80a133d151de25445e8dfd09953a0872">dtimeoutms</a> : 2000;
<a name="l00167"></a>00167       }
<a name="l00168"></a>00168       res = <a class="code" href="channel_8h.html#ae68c6e4af7aba456ec08906cb9fb3140">ast_readstring</a>(c, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, maxlen, to, fto, <span class="stringliteral">&quot;#&quot;</span>);
<a name="l00169"></a>00169       <span class="keywordflow">if</span> (res == <a class="code" href="app_8h.html#a10624bc470a4ac2634221dfa74bdb17fa94425459ee6ac7993c6289fde4d4ea8c">AST_GETDATA_EMPTY_END_TERMINATED</a>) {
<a name="l00170"></a>00170          <span class="keywordflow">return</span> res;
<a name="l00171"></a>00171       }
<a name="l00172"></a>00172       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>)) {
<a name="l00173"></a>00173          <span class="keywordflow">return</span> res;
<a name="l00174"></a>00174       }
<a name="l00175"></a>00175    }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177    <span class="keywordflow">return</span> res;
<a name="l00178"></a>00178 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9fc880ff0cd0b42ef6212b43deb4b98f"></a><!-- doxytag: member="app.h::ast_app_getdata_full" ref="a9fc880ff0cd0b42ef6212b43deb4b98f" args="(struct ast_channel *c, char *prompt, char *s, int maxlen, int timeout, int audiofd, int ctrlfd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_getdata_full </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>prompt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>audiofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ctrlfd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Full version with audiofd and controlfd. NOTE: returns '2' on ctrlfd available, not '1' like other full functions. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00183">183</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l04093">ast_readstring_full()</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, and <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l01431">handle_getdata()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00184"></a>00184 {
<a name="l00185"></a>00185    <span class="keywordtype">int</span> res, to = 2000, fto = 6000;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a>)) {
<a name="l00188"></a>00188       res = <a class="code" href="file_8h.html#a67c7e271b4ca70aca6d48fd48d121857" title="Streams a file.">ast_streamfile</a>(c, <a class="code" href="asterisk_8c.html#a299365a3d8977a6c410c6cd924e33136">prompt</a>, c-&gt;language);
<a name="l00189"></a>00189       <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l00190"></a>00190          <span class="keywordflow">return</span> res;
<a name="l00191"></a>00191       }
<a name="l00192"></a>00192    }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194    <span class="keywordflow">if</span> (timeout &gt; 0) {
<a name="l00195"></a>00195       fto = to = timeout;
<a name="l00196"></a>00196    }
<a name="l00197"></a>00197    <span class="keywordflow">if</span> (timeout &lt; 0) {
<a name="l00198"></a>00198       fto = to = 1000000000;
<a name="l00199"></a>00199    }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201    res = <a class="code" href="channel_8h.html#a1d7f4bf19db3f1b8a3524593f002fedf">ast_readstring_full</a>(c, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, maxlen, to, fto, <span class="stringliteral">&quot;#&quot;</span>, audiofd, ctrlfd);
<a name="l00202"></a>00202 
<a name="l00203"></a>00203    <span class="keywordflow">return</span> res;
<a name="l00204"></a>00204 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="add0f96b4b815205f528f5248ccb3d515"></a><!-- doxytag: member="app.h::ast_app_group_discard" ref="add0f96b4b815205f528f5248ccb3d515" args="(struct ast_channel *chan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_discard </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Discard all <a class="el" href="structgroup.html">group</a> counting for a channel. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01113">1113</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00564">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00541">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00601">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="channel_8h_source.html#l01796">ast_group_info::chan</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l01388">ast_channel_free()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01114"></a>01114 {
<a name="l01115"></a>01115    <span class="keyword">struct </span><a class="code" href="structast__group__info.html" title="channel group info">ast_group_info</a> *gi = NULL;
<a name="l01116"></a>01116 
<a name="l01117"></a>01117    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01118"></a>01118    <a class="code" href="linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="structgroups.html">groups</a>, gi, group_list) {
<a name="l01119"></a>01119       <span class="keywordflow">if</span> (gi-&gt;<a class="code" href="structast__group__info.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == chan) {
<a name="l01120"></a>01120          <a class="code" href="linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(group_list);
<a name="l01121"></a>01121          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(gi);
<a name="l01122"></a>01122       }
<a name="l01123"></a>01123    }
<a name="l01124"></a>01124    <a class="code" href="linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l01125"></a>01125    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01126"></a>01126 
<a name="l01127"></a>01127    <span class="keywordflow">return</span> 0;
<a name="l01128"></a>01128 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a026ae712c21ad8f1e8cde66467153838"></a><!-- doxytag: member="app.h::ast_app_group_get_count" ref="a026ae712c21ad8f1e8cde66467153838" args="(const char *group, const char *category)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_get_count </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>category</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the current channel count of the specified <a class="el" href="structgroup.html">group</a> and category. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01046">1046</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="channel_8h_source.html#l01797">ast_group_info::category</a>, and <a class="el" href="channel_8h_source.html#l01798">ast_group_info::group</a>.</p>

<p>Referenced by <a class="el" href="func__groupcount_8c_source.html#l00095">group_count_function_read()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01047"></a>01047 {
<a name="l01048"></a>01048    <span class="keyword">struct </span><a class="code" href="structast__group__info.html" title="channel group info">ast_group_info</a> *gi = NULL;
<a name="l01049"></a>01049    <span class="keywordtype">int</span> count = 0;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structgroup.html">group</a>)) {
<a name="l01052"></a>01052       <span class="keywordflow">return</span> 0;
<a name="l01053"></a>01053    }
<a name="l01054"></a>01054 
<a name="l01055"></a>01055    <a class="code" href="linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc" title="Read locks a list.">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01056"></a>01056    <a class="code" href="linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="structgroups.html">groups</a>, gi, group_list) {
<a name="l01057"></a>01057       <span class="keywordflow">if</span> (!strcasecmp(gi-&gt;<a class="code" href="structast__group__info.html#a443519726cbe3c4f2b2fe1d42ce2fd2f">group</a>, <a class="code" href="structgroup.html">group</a>) &amp;&amp; (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) || (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) &amp;&amp; !strcasecmp(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>, <a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>)))) {
<a name="l01058"></a>01058          count++;
<a name="l01059"></a>01059       }
<a name="l01060"></a>01060    }
<a name="l01061"></a>01061    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063    <span class="keywordflow">return</span> count;
<a name="l01064"></a>01064 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae351dc6f23997a800e7a743d6411b8e7"></a><!-- doxytag: member="app.h::ast_app_group_list_head" ref="ae351dc6f23997a800e7a743d6411b8e7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__group__info.html">ast_group_info</a>* ast_app_group_list_head </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the head of the <a class="el" href="structgroup.html">group</a> count list. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01140">1140</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00422">AST_RWLIST_FIRST</a>.</p>

<p>Referenced by <a class="el" href="func__groupcount_8c_source.html#l00095">group_count_function_read()</a>, <a class="el" href="func__groupcount_8c_source.html#l00165">group_function_read()</a>, <a class="el" href="func__groupcount_8c_source.html#l00220">group_list_function_read()</a>, and <a class="el" href="cli_8c_source.html#l01411">group_show_channels()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01141"></a>01141 {
<a name="l01142"></a>01142    <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#a64835fe6d570951b2a0404799c3d116f">AST_RWLIST_FIRST</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01143"></a>01143 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afa354da7388ee1882ac981396f143bda"></a><!-- doxytag: member="app.h::ast_app_group_list_rdlock" ref="afa354da7388ee1882ac981396f143bda" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_list_rdlock </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read Lock the <a class="el" href="structgroup.html">group</a> count list. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01135">1135</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>.</p>

<p>Referenced by <a class="el" href="func__groupcount_8c_source.html#l00095">group_count_function_read()</a>, <a class="el" href="func__groupcount_8c_source.html#l00165">group_function_read()</a>, <a class="el" href="func__groupcount_8c_source.html#l00220">group_list_function_read()</a>, and <a class="el" href="cli_8c_source.html#l01411">group_show_channels()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01136"></a>01136 {
<a name="l01137"></a>01137    <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc" title="Read locks a list.">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01138"></a>01138 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa3d01e65e04cddfa84781590b37732e8"></a><!-- doxytag: member="app.h::ast_app_group_list_unlock" ref="aa3d01e65e04cddfa84781590b37732e8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_list_unlock </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unlock the <a class="el" href="structgroup.html">group</a> count list. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01145">1145</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>.</p>

<p>Referenced by <a class="el" href="func__groupcount_8c_source.html#l00095">group_count_function_read()</a>, <a class="el" href="func__groupcount_8c_source.html#l00165">group_function_read()</a>, <a class="el" href="func__groupcount_8c_source.html#l00220">group_list_function_read()</a>, and <a class="el" href="cli_8c_source.html#l01411">group_show_channels()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01146"></a>01146 {
<a name="l01147"></a>01147    <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01148"></a>01148 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6d1783b818b130e529c611e710beafe9"></a><!-- doxytag: member="app.h::ast_app_group_list_wrlock" ref="a6d1783b818b130e529c611e710beafe9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_list_wrlock </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write Lock the <a class="el" href="structgroup.html">group</a> count list. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01130">1130</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01131"></a>01131 {
<a name="l01132"></a>01132    <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01133"></a>01133 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a687e664c7fb3bb2acb4f5fa17f28d3a2"></a><!-- doxytag: member="app.h::ast_app_group_match_get_count" ref="a687e664c7fb3bb2acb4f5fa17f28d3a2" args="(const char *groupmatch, const char *category)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_match_get_count </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>groupmatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>category</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the current channel count of all <a class="el" href="structgroups.html">groups</a> that match the specified pattern and category. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01066">1066</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="channel_8h_source.html#l01797">ast_group_info::category</a>, and <a class="el" href="channel_8h_source.html#l01798">ast_group_info::group</a>.</p>

<p>Referenced by <a class="el" href="func__groupcount_8c_source.html#l00139">group_match_count_function_read()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01067"></a>01067 {
<a name="l01068"></a>01068    <span class="keyword">struct </span><a class="code" href="structast__group__info.html" title="channel group info">ast_group_info</a> *gi = NULL;
<a name="l01069"></a>01069    regex_t regexbuf;
<a name="l01070"></a>01070    <span class="keywordtype">int</span> count = 0;
<a name="l01071"></a>01071 
<a name="l01072"></a>01072    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(groupmatch)) {
<a name="l01073"></a>01073       <span class="keywordflow">return</span> 0;
<a name="l01074"></a>01074    }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076    <span class="comment">/* if regex compilation fails, return zero matches */</span>
<a name="l01077"></a>01077    <span class="keywordflow">if</span> (regcomp(&amp;regexbuf, groupmatch, REG_EXTENDED | REG_NOSUB)) {
<a name="l01078"></a>01078       <span class="keywordflow">return</span> 0;
<a name="l01079"></a>01079    }
<a name="l01080"></a>01080 
<a name="l01081"></a>01081    <a class="code" href="linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc" title="Read locks a list.">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01082"></a>01082    <a class="code" href="linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="structgroups.html">groups</a>, gi, group_list) {
<a name="l01083"></a>01083       <span class="keywordflow">if</span> (!regexec(&amp;regexbuf, gi-&gt;<a class="code" href="structast__group__info.html#a443519726cbe3c4f2b2fe1d42ce2fd2f">group</a>, 0, NULL, 0) &amp;&amp; (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) || (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) &amp;&amp; !strcasecmp(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>, <a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>)))) {
<a name="l01084"></a>01084          count++;
<a name="l01085"></a>01085       }
<a name="l01086"></a>01086    }
<a name="l01087"></a>01087    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01088"></a>01088 
<a name="l01089"></a>01089    regfree(&amp;regexbuf);
<a name="l01090"></a>01090 
<a name="l01091"></a>01091    <span class="keywordflow">return</span> count;
<a name="l01092"></a>01092 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6bd3fac13a76cd864600a84ffd66724e"></a><!-- doxytag: member="app.h::ast_app_group_set_channel" ref="a6bd3fac13a76cd864600a84ffd66724e" args="(struct ast_channel *chan, const char *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_set_channel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the <a class="el" href="structgroup.html">group</a> for a channel, splitting the provided data into <a class="el" href="structgroup.html">group</a> and category, if specified. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00999">999</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l00972">ast_app_group_split_group()</a>, <a class="el" href="linkedlists_8h_source.html#l00725">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00564">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00541">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00601">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="astmm_8h_source.html#l00069">calloc</a>, <a class="el" href="channel_8h_source.html#l01797">ast_group_info::category</a>, <a class="el" href="channel_8h_source.html#l01796">ast_group_info::chan</a>, <a class="el" href="astmm_8h_source.html#l00084">free</a>, <a class="el" href="channel_8h_source.html#l01798">ast_group_info::group</a>, and <a class="el" href="func__strings_8c_source.html#l00821">len()</a>.</p>

<p>Referenced by <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>, and <a class="el" href="func__groupcount_8c_source.html#l00192">group_function_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01000"></a>01000 {
<a name="l01001"></a>01001    <span class="keywordtype">int</span> res = 0;
<a name="l01002"></a>01002    <span class="keywordtype">char</span> <a class="code" href="structgroup.html">group</a>[80] = <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>[80] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01003"></a>01003    <span class="keyword">struct </span><a class="code" href="structast__group__info.html" title="channel group info">ast_group_info</a> *gi = NULL;
<a name="l01004"></a>01004    <span class="keywordtype">size_t</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = 0;
<a name="l01005"></a>01005 
<a name="l01006"></a>01006    <span class="keywordflow">if</span> (<a class="code" href="app_8h.html#ab926dd29fc418cde5b67a00ba914cd2c" title="Split a group string into group and category, returning a default category if none...">ast_app_group_split_group</a>(data, group, <span class="keyword">sizeof</span>(group), <a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>, <span class="keyword">sizeof</span>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>))) {
<a name="l01007"></a>01007       <span class="keywordflow">return</span> -1;
<a name="l01008"></a>01008    }
<a name="l01009"></a>01009 
<a name="l01010"></a>01010    <span class="comment">/* Calculate memory we will need if this is new */</span>
<a name="l01011"></a>01011    len = <span class="keyword">sizeof</span>(*gi) + strlen(group) + 1;
<a name="l01012"></a>01012    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>)) {
<a name="l01013"></a>01013       len += strlen(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) + 1;
<a name="l01014"></a>01014    }
<a name="l01015"></a>01015 
<a name="l01016"></a>01016    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01017"></a>01017    <a class="code" href="linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="structgroups.html">groups</a>, gi, group_list) {
<a name="l01018"></a>01018       <span class="keywordflow">if</span> ((gi-&gt;<a class="code" href="structast__group__info.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == chan) &amp;&amp; ((<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) &amp;&amp; <a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>)) || (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>) &amp;&amp; !strcasecmp(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>, <a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>)))) {
<a name="l01019"></a>01019          <a class="code" href="linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(group_list);
<a name="l01020"></a>01020          <a class="code" href="astmm_8h.html#aa7157aa9480bb73f090dca36776419bf">free</a>(gi);
<a name="l01021"></a>01021          <span class="keywordflow">break</span>;
<a name="l01022"></a>01022       }
<a name="l01023"></a>01023    }
<a name="l01024"></a>01024    <a class="code" href="linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l01025"></a>01025 
<a name="l01026"></a>01026    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(group)) {
<a name="l01027"></a>01027       <span class="comment">/* Enable unsetting the group */</span>
<a name="l01028"></a>01028    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((gi = <a class="code" href="astmm_8h.html#a7cbb7b79af9d539af55b59dfc3598390">calloc</a>(1, len))) {
<a name="l01029"></a>01029       gi-&gt;<a class="code" href="structast__group__info.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = chan;
<a name="l01030"></a>01030       gi-&gt;<a class="code" href="structast__group__info.html#a443519726cbe3c4f2b2fe1d42ce2fd2f">group</a> = (<span class="keywordtype">char</span> *) gi + <span class="keyword">sizeof</span>(*gi);
<a name="l01031"></a>01031       strcpy(gi-&gt;<a class="code" href="structast__group__info.html#a443519726cbe3c4f2b2fe1d42ce2fd2f">group</a>, group);
<a name="l01032"></a>01032       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>)) {
<a name="l01033"></a>01033          gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a> = (<span class="keywordtype">char</span> *) gi + <span class="keyword">sizeof</span>(*gi) + strlen(group) + 1;
<a name="l01034"></a>01034          strcpy(gi-&gt;<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>, <a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>);
<a name="l01035"></a>01035       }
<a name="l01036"></a>01036       <a class="code" href="linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="structgroups.html">groups</a>, gi, group_list);
<a name="l01037"></a>01037    } <span class="keywordflow">else</span> {
<a name="l01038"></a>01038       res = -1;
<a name="l01039"></a>01039    }
<a name="l01040"></a>01040 
<a name="l01041"></a>01041    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01042"></a>01042 
<a name="l01043"></a>01043    <span class="keywordflow">return</span> res;
<a name="l01044"></a>01044 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab926dd29fc418cde5b67a00ba914cd2c"></a><!-- doxytag: member="app.h::ast_app_group_split_group" ref="ab926dd29fc418cde5b67a00ba914cd2c" args="(const char *data, char *group, int group_max, char *category, int category_max)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_split_group </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>group_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>category</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>category_max</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Split a <a class="el" href="structgroup.html">group</a> string into <a class="el" href="structgroup.html">group</a> and category, returning a default category if none is provided. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00972">972</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, and <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l00999">ast_app_group_set_channel()</a>, <a class="el" href="func__groupcount_8c_source.html#l00095">group_count_function_read()</a>, and <a class="el" href="func__groupcount_8c_source.html#l00139">group_match_count_function_read()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00973"></a>00973 {
<a name="l00974"></a>00974    <span class="keywordtype">int</span> res = 0;
<a name="l00975"></a>00975    <span class="keywordtype">char</span> tmp[256];
<a name="l00976"></a>00976    <span class="keywordtype">char</span> *grp = NULL, *cat = NULL;
<a name="l00977"></a>00977 
<a name="l00978"></a>00978    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l00979"></a>00979       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(tmp, data, <span class="keyword">sizeof</span>(tmp));
<a name="l00980"></a>00980       grp = tmp;
<a name="l00981"></a>00981       <span class="keywordflow">if</span> ((cat = strchr(tmp, <span class="charliteral">&apos;@&apos;</span>))) {
<a name="l00982"></a>00982          *cat++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00983"></a>00983       }
<a name="l00984"></a>00984    }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(grp)) {
<a name="l00987"></a>00987       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(<a class="code" href="structgroup.html">group</a>, grp, group_max);
<a name="l00988"></a>00988    } <span class="keywordflow">else</span> {
<a name="l00989"></a>00989       *<a class="code" href="structgroup.html">group</a> = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00990"></a>00990    }
<a name="l00991"></a>00991 
<a name="l00992"></a>00992    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(cat)) {
<a name="l00993"></a>00993       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(<a class="code" href="structast__group__info.html#a37188acb1b82f625d3313bc88ca82314">category</a>, cat, category_max);
<a name="l00994"></a>00994    }
<a name="l00995"></a>00995 
<a name="l00996"></a>00996    <span class="keywordflow">return</span> res;
<a name="l00997"></a>00997 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a69e90e401aa3da48a6eef5139727cbb3"></a><!-- doxytag: member="app.h::ast_app_group_update" ref="a69e90e401aa3da48a6eef5139727cbb3" args="(struct ast_channel *oldchan, struct ast_channel *newchan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_group_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>oldchan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>newchan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update all <a class="el" href="structgroup.html">group</a> counting for a channel to a new one. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01094">1094</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="linkedlists_8h_source.html#l00564">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00541">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00601">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, and <a class="el" href="channel_8h_source.html#l01796">ast_group_info::chan</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l04393">ast_do_masquerade()</a>, and <a class="el" href="chan__local_8c_source.html#l00289">check_bridge()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01095"></a>01095 {
<a name="l01096"></a>01096    <span class="keyword">struct </span><a class="code" href="structast__group__info.html" title="channel group info">ast_group_info</a> *gi = NULL;
<a name="l01097"></a>01097 
<a name="l01098"></a>01098    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01099"></a>01099    <a class="code" href="linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="structgroups.html">groups</a>, gi, group_list) {
<a name="l01100"></a>01100       <span class="keywordflow">if</span> (gi-&gt;<a class="code" href="structast__group__info.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == old) {
<a name="l01101"></a>01101          gi-&gt;<a class="code" href="structast__group__info.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <span class="keyword">new</span>;
<a name="l01102"></a>01102       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gi-&gt;<a class="code" href="structast__group__info.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == <span class="keyword">new</span>) {
<a name="l01103"></a>01103          <a class="code" href="linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(group_list);
<a name="l01104"></a>01104          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(gi);
<a name="l01105"></a>01105       }
<a name="l01106"></a>01106    }
<a name="l01107"></a>01107    <a class="code" href="linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l01108"></a>01108    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structgroups.html">groups</a>);
<a name="l01109"></a>01109 
<a name="l01110"></a>01110    <span class="keywordflow">return</span> 0;
<a name="l01111"></a>01111 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5953304e56862ac7efc1fed0ac6732f"></a><!-- doxytag: member="app.h::ast_app_has_voicemail" ref="ae5953304e56862ac7efc1fed0ac6732f" args="(const char *mailbox, const char *folder)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_has_voicemail </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mailbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>folder</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine if a given mailbox has any voicemail If folder is NULL, defaults to "INBOX". If folder is "INBOX", includes the <a class="el" href="structnumber.html" title="Number structure.">number</a> of messages in the "Urgent" folder. </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>Mailbox has voicemail </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>No new voicemail in specified mailbox </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00234">234</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a>, and <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l02529">action_mailboxstatus()</a>, <a class="el" href="chan__dahdi_8c_source.html#l03001">has_voicemail()</a>, <a class="el" href="app__voicemail_8c_source.html#l06482">notify_new_message()</a>, <a class="el" href="app__disa_8c_source.html#l00125">play_dialtone()</a>, <a class="el" href="res__smdi_8c_source.html#l00785">poll_mailbox()</a>, <a class="el" href="app__voicemail_8c_source.html#l05078">run_externnotify()</a>, <a class="el" href="chan__skinny_8c_source.html#l01813">skinny_register()</a>, and <a class="el" href="chan__unistim_8c_source.html#l04379">unistim_send_mwi_to_peer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00235"></a>00235 {
<a name="l00236"></a>00236    <span class="keyword">static</span> <span class="keywordtype">int</span> warned = 0;
<a name="l00237"></a>00237    <span class="keywordflow">if</span> (<a class="code" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a>) {
<a name="l00238"></a>00238       <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a>(<a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, folder);
<a name="l00239"></a>00239    }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241    <span class="keywordflow">if</span> (warned++ % 10 == 0) {
<a name="l00242"></a>00242       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Message check requested for mailbox %s/folder %s but voicemail not loaded.\n&quot;</span>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, folder ? folder : <span class="stringliteral">&quot;INBOX&quot;</span>);
<a name="l00243"></a>00243    }
<a name="l00244"></a>00244    <span class="keywordflow">return</span> 0;
<a name="l00245"></a>00245 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a318582ad072d31085d4623e634edf46c"></a><!-- doxytag: member="app.h::ast_app_inboxcount" ref="a318582ad072d31085d4623e634edf46c" args="(const char *mailbox, int *newmsgs, int *oldmsgs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_inboxcount </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mailbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>newmsgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>oldmsgs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine <a class="el" href="structnumber.html" title="Number structure.">number</a> of new/old messages in a mailbox. </p>
<dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mailbox</em>&nbsp;</td><td>Mailbox specification in the format mbox[][&amp;mbox2[]][...] </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>newmsgs</em>&nbsp;</td><td>Number of messages in the "INBOX" folder. Includes <a class="el" href="structnumber.html" title="Number structure.">number</a> of messages in the "Urgent" folder, if any. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>oldmsgs</em>&nbsp;</td><td>Number of messages in the "Old" folder. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>Success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00248">248</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>, and <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>.</p>

<p>Referenced by <a class="el" href="chan__sip_8c_source.html#l22279">sip_send_mwi_to_peer()</a>, and <a class="el" href="chan__iax2_8c_source.html#l08346">update_registry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00249"></a>00249 {
<a name="l00250"></a>00250    <span class="keyword">static</span> <span class="keywordtype">int</span> warned = 0;
<a name="l00251"></a>00251    <span class="keywordflow">if</span> (newmsgs) {
<a name="l00252"></a>00252       *newmsgs = 0;
<a name="l00253"></a>00253    }
<a name="l00254"></a>00254    <span class="keywordflow">if</span> (oldmsgs) {
<a name="l00255"></a>00255       *oldmsgs = 0;
<a name="l00256"></a>00256    }
<a name="l00257"></a>00257    <span class="keywordflow">if</span> (<a class="code" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>) {
<a name="l00258"></a>00258       <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>(<a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, newmsgs, oldmsgs);
<a name="l00259"></a>00259    }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261    <span class="keywordflow">if</span> (warned++ % 10 == 0) {
<a name="l00262"></a>00262       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Message count requested for mailbox %s but voicemail not loaded.\n&quot;</span>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>);
<a name="l00263"></a>00263    }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265    <span class="keywordflow">return</span> 0;
<a name="l00266"></a>00266 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6f9a8f7a54dd80f1b5363b6cadfd4939"></a><!-- doxytag: member="app.h::ast_app_inboxcount2" ref="a6f9a8f7a54dd80f1b5363b6cadfd4939" args="(const char *mailbox, int *urgentmsgs, int *newmsgs, int *oldmsgs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_inboxcount2 </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mailbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>urgentmsgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>newmsgs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>oldmsgs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine <a class="el" href="structnumber.html" title="Number structure.">number</a> of urgent/new/old messages in a mailbox. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mailbox</em>&nbsp;</td><td>the mailbox context to use </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>urgentmsgs</em>&nbsp;</td><td>the urgent <a class="el" href="structmessage.html">message</a> count </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>newmsgs</em>&nbsp;</td><td>the new <a class="el" href="structmessage.html">message</a> count </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>oldmsgs</em>&nbsp;</td><td>the old <a class="el" href="structmessage.html">message</a> count </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns 0 for success, negative upon error </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00268">268</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#a8951323b5b85c9a255e97c181286056c">ast_inboxcount2_func</a>, <a class="el" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>, and <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l02558">action_mailboxcount()</a>, <a class="el" href="app__voicemail_8c_source.html#l06482">notify_new_message()</a>, and <a class="el" href="app__voicemail_8c_source.html#l09099">vm_execmain()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00269"></a>00269 {
<a name="l00270"></a>00270    <span class="keyword">static</span> <span class="keywordtype">int</span> warned = 0;
<a name="l00271"></a>00271    <span class="keywordflow">if</span> (newmsgs) {
<a name="l00272"></a>00272       *newmsgs = 0;
<a name="l00273"></a>00273    }
<a name="l00274"></a>00274    <span class="keywordflow">if</span> (oldmsgs) {
<a name="l00275"></a>00275       *oldmsgs = 0;
<a name="l00276"></a>00276    }
<a name="l00277"></a>00277    <span class="keywordflow">if</span> (urgentmsgs) {
<a name="l00278"></a>00278       *urgentmsgs = 0;
<a name="l00279"></a>00279    }
<a name="l00280"></a>00280    <span class="keywordflow">if</span> (<a class="code" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>) {
<a name="l00281"></a>00281       <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a8951323b5b85c9a255e97c181286056c">ast_inboxcount2_func</a>(<a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, urgentmsgs, newmsgs, oldmsgs);
<a name="l00282"></a>00282    }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284    <span class="keywordflow">if</span> (warned++ % 10 == 0) {
<a name="l00285"></a>00285       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Message count requested for mailbox %s but voicemail not loaded.\n&quot;</span>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>);
<a name="l00286"></a>00286    }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288    <span class="keywordflow">return</span> 0;
<a name="l00289"></a>00289 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa34e72e01cab2e09f4a195eb79175f95"></a><!-- doxytag: member="app.h::ast_app_messagecount" ref="aa34e72e01cab2e09f4a195eb79175f95" args="(const char *context, const char *mailbox, const char *folder)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_messagecount </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mailbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>folder</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check <a class="el" href="structnumber.html" title="Number structure.">number</a> of messages in a given context, mailbox, and folder. </p>
<dl class="since"><dt><b>Since:</b></dt><dd>1.4 </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>context</em>&nbsp;</td><td>Mailbox context </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mailbox</em>&nbsp;</td><td>Mailbox <a class="el" href="structnumber.html" title="Number structure.">number</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>folder</em>&nbsp;</td><td>Mailbox folder </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Number of messages in the given context, mailbox, and folder. If folder is NULL, folder "INBOX" is assumed. If folder is "INBOX", includes <a class="el" href="structnumber.html" title="Number structure.">number</a> of messages in the "Urgent" folder. </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00299">299</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a>, and <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>.</p>

<p>Referenced by <a class="el" href="func__vmcount_8c_source.html#l00066">acf_vmcount_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00300"></a>00300 {
<a name="l00301"></a>00301    <span class="keyword">static</span> <span class="keywordtype">int</span> warned = 0;
<a name="l00302"></a>00302    <span class="keywordflow">if</span> (<a class="code" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a>) {
<a name="l00303"></a>00303       <span class="keywordflow">return</span> <a class="code" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a>(<a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, folder);
<a name="l00304"></a>00304    }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306    <span class="keywordflow">if</span> (!warned) {
<a name="l00307"></a>00307       warned++;
<a name="l00308"></a>00308       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Message count requested for mailbox %s@%s/%s but voicemail not loaded.\n&quot;</span>, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, <a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, folder);
<a name="l00309"></a>00309    }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311    <span class="keywordflow">return</span> 0;
<a name="l00312"></a>00312 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adc36d870f1a77a726a74f4891f1365d3"></a><!-- doxytag: member="app.h::ast_app_options2str64" ref="adc36d870f1a77a726a74f4891f1365d3" args="(const struct ast_app_option *options, struct ast_flags64 *flags, char *buf, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_app_options2str64 </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__app__option.html">ast_app_option</a> *&nbsp;</td>
          <td class="paramname"> <em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__flags64.html">ast_flags64</a> *&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given a list of options array, return an option string based on passed flags. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>The array of possible options declared with AST_APP_OPTIONS </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>The flags of the options that you wish to populate the buffer with </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>The buffer to fill with the string of options </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>The maximum length of buf </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01856">1856</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00118">ast_test_flag64</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01857"></a>01857 {
<a name="l01858"></a>01858    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, found = 0;
<a name="l01859"></a>01859    <span class="keywordflow">for</span> (i = 32; i &lt; 128 &amp;&amp; found &lt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; i++) {
<a name="l01860"></a>01860       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a17ef965a8317b037c32e9b58c3765b1a">ast_test_flag64</a>(flags, options[i].flag)) {
<a name="l01861"></a>01861          <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[found++] = i;
<a name="l01862"></a>01862       }
<a name="l01863"></a>01863    }
<a name="l01864"></a>01864    <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[found] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01865"></a>01865 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af40039f1c49c16d0f6fa33fe9c43a0cb"></a><!-- doxytag: member="app.h::ast_app_parse_options" ref="af40039f1c49c16d0f6fa33fe9c43a0cb" args="(const struct ast_app_option *options, struct ast_flags *flags, char **args, char *optstr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_parse_options </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__app__option.html">ast_app_option</a> *&nbsp;</td>
          <td class="paramname"> <em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__flags.html">ast_flags</a> *&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>optstr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parses a string containing application options and sets flags/arguments. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>The array of possible options declared with AST_APP_OPTIONS </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>The flag structure to have option flags set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>args</em>&nbsp;</td><td>The array of argument pointers to hold arguments found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optstr</em>&nbsp;</td><td>The string containing the options to be parsed </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>zero for success, non-zero if an error occurs </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="func__devstate_8c.html#ad07af5ef010286f0378edec054160bcf">AST_APP_OPTIONS</a> </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01776">1776</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00442">ast_app_option::arg_index</a>, <a class="el" href="utils_8h_source.html#l00075">ast_clear_flag</a>, <a class="el" href="utils_8h_source.html#l00194">AST_FLAGS_ALL</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00068">ast_set_flag</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="aesopt_8h_source.html#l00399">s</a>.</p>

<p>Referenced by <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="app__authenticate_8c_source.html#l00108">auth_exec()</a>, <a class="el" href="features_8c_source.html#l04524">bridge_exec()</a>, <a class="el" href="func__cdr_8c_source.html#l00183">cdr_read()</a>, <a class="el" href="func__cdr_8c_source.html#l00220">cdr_write()</a>, <a class="el" href="app__chanspy_8c_source.html#l01035">chanspy_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l03696">conf_exec()</a>, <a class="el" href="app__confbridge_8c_source.html#l00687">confbridge_exec()</a>, <a class="el" href="app__controlplayback_8c_source.html#l00128">controlplayback_exec()</a>, <a class="el" href="app__directory_8c_source.html#l00723">directory_exec()</a>, <a class="el" href="app__disa_8c_source.html#l00143">disa_exec()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03972">dundi_query_read()</a>, <a class="el" href="pbx__dundi_8c_source.html#l03889">dundifunc_read()</a>, <a class="el" href="app__chanspy_8c_source.html#l01127">extenspy_exec()</a>, <a class="el" href="app__forkcdr_8c_source.html#l00229">forkcdr_exec()</a>, <a class="el" href="app__jack_8c_source.html#l00692">handle_options()</a>, <a class="el" href="func__devstate_8c_source.html#l00144">hint_read()</a>, <a class="el" href="app__minivm_8c_source.html#l02195">minivm_accmess_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l01971">minivm_greet_exec()</a>, <a class="el" href="app__minivm_8c_source.html#l01915">minivm_record_exec()</a>, <a class="el" href="app__mixmonitor_8c_source.html#l00469">mixmonitor_exec()</a>, <a class="el" href="app__page_8c_source.html#l00121">page_exec()</a>, <a class="el" href="features_8c_source.html#l03249">park_call_exec()</a>, <a class="el" href="pbx_8c_source.html#l08798">pbx_builtin_background()</a>, <a class="el" href="pbx_8c_source.html#l08566">pbx_builtin_resetcdr()</a>, <a class="el" href="pbx_8c_source.html#l08729">pbx_builtin_waitexten()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__readexten_8c_source.html#l00128">readexten_exec()</a>, <a class="el" href="pbx__realtime_8c_source.html#l00138">realtime_common()</a>, <a class="el" href="app__record_8c_source.html#l00132">record_exec()</a>, <a class="el" href="app__url_8c_source.html#l00093">sendurl_exec()</a>, <a class="el" href="app__meetme_8c_source.html#l05808">sla_trunk_exec()</a>, <a class="el" href="res__smdi_8c_source.html#l01122">smdi_msg_retrieve_read()</a>, <a class="el" href="app__sms_8c_source.html#l01858">sms_exec()</a>, <a class="el" href="app__softhangup_8c_source.html#l00072">softhangup_exec()</a>, <a class="el" href="app__speech__utils_8c_source.html#l00639">speech_background()</a>, <a class="el" href="app__voicemail_8c_source.html#l09810">vm_exec()</a>, and <a class="el" href="app__voicemail_8c_source.html#l09099">vm_execmain()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01777"></a>01777 {
<a name="l01778"></a>01778    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, *arg;
<a name="l01779"></a>01779    <span class="keywordtype">int</span> curarg, res = 0;
<a name="l01780"></a>01780    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> argloc;
<a name="l01781"></a>01781 
<a name="l01782"></a>01782    <a class="code" href="utils_8h.html#a7b260320610a09017a9416398acd0a70">ast_clear_flag</a>(flags, <a class="code" href="utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a>);
<a name="l01783"></a>01783 
<a name="l01784"></a>01784    <span class="keywordflow">if</span> (!optstr) {
<a name="l01785"></a>01785       <span class="keywordflow">return</span> 0;
<a name="l01786"></a>01786    }
<a name="l01787"></a>01787 
<a name="l01788"></a>01788    s = optstr;
<a name="l01789"></a>01789    <span class="keywordflow">while</span> (*s) {
<a name="l01790"></a>01790       curarg = *s++ &amp; 0x7f;   <span class="comment">/* the array (in app.h) has 128 entries */</span>
<a name="l01791"></a>01791       argloc = options[curarg].<a class="code" href="structast__app__option.html#a7fba4686db1ab2c33d8920fb7019d916" title="The index of the entry in the arguments array that should be used for this option&amp;#39;s...">arg_index</a>;
<a name="l01792"></a>01792       <span class="keywordflow">if</span> (*s == <span class="charliteral">&apos;(&apos;</span>) {
<a name="l01793"></a>01793          <span class="comment">/* Has argument */</span>
<a name="l01794"></a>01794          arg = ++s;
<a name="l01795"></a>01795          <span class="keywordflow">if</span> ((s = strchr(s, <span class="charliteral">&apos;)&apos;</span>))) {
<a name="l01796"></a>01796             <span class="keywordflow">if</span> (argloc) {
<a name="l01797"></a>01797                args[argloc - 1] = arg;
<a name="l01798"></a>01798             }
<a name="l01799"></a>01799             *s++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01800"></a>01800          } <span class="keywordflow">else</span> {
<a name="l01801"></a>01801             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing closing parenthesis for argument &apos;%c&apos; in string &apos;%s&apos;\n&quot;</span>, curarg, arg);
<a name="l01802"></a>01802             res = -1;
<a name="l01803"></a>01803             <span class="keywordflow">break</span>;
<a name="l01804"></a>01804          }
<a name="l01805"></a>01805       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argloc) {
<a name="l01806"></a>01806          args[argloc - 1] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01807"></a>01807       }
<a name="l01808"></a>01808       <a class="code" href="utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(flags, options[curarg].flag);
<a name="l01809"></a>01809    }
<a name="l01810"></a>01810 
<a name="l01811"></a>01811    <span class="keywordflow">return</span> res;
<a name="l01812"></a>01812 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af85cb9dfd2fea9cfe820d2323c7dd471"></a><!-- doxytag: member="app.h::ast_app_parse_options64" ref="af85cb9dfd2fea9cfe820d2323c7dd471" args="(const struct ast_app_option *options, struct ast_flags64 *flags, char **args, char *optstr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_parse_options64 </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__app__option.html">ast_app_option</a> *&nbsp;</td>
          <td class="paramname"> <em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__flags64.html">ast_flags64</a> *&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>optstr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parses a string containing application options and sets flags/arguments. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>options</em>&nbsp;</td><td>The array of possible options declared with AST_APP_OPTIONS </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>The 64-bit flag structure to have option flags set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>args</em>&nbsp;</td><td>The array of argument pointers to hold arguments found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optstr</em>&nbsp;</td><td>The string containing the options to be parsed </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>zero for success, non-zero if an error occurs </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="func__devstate_8c.html#ad07af5ef010286f0378edec054160bcf">AST_APP_OPTIONS</a> </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01818">1818</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00442">ast_app_option::arg_index</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00125">ast_set_flag64</a>, <a class="el" href="utils_8h_source.html#l00205">ast_flags64::flags</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="aesopt_8h_source.html#l00399">s</a>.</p>

<p>Referenced by <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01819"></a>01819 {
<a name="l01820"></a>01820    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, *arg;
<a name="l01821"></a>01821    <span class="keywordtype">int</span> curarg, res = 0;
<a name="l01822"></a>01822    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> argloc;
<a name="l01823"></a>01823 
<a name="l01824"></a>01824    flags-&gt;<a class="code" href="structast__flags64.html#a899a76dc5f03f0d4ea3793c339e07ee9">flags</a> = 0;
<a name="l01825"></a>01825 
<a name="l01826"></a>01826    <span class="keywordflow">if</span> (!optstr) {
<a name="l01827"></a>01827       <span class="keywordflow">return</span> 0;
<a name="l01828"></a>01828    }
<a name="l01829"></a>01829 
<a name="l01830"></a>01830    s = optstr;
<a name="l01831"></a>01831    <span class="keywordflow">while</span> (*s) {
<a name="l01832"></a>01832       curarg = *s++ &amp; 0x7f;   <span class="comment">/* the array (in app.h) has 128 entries */</span>
<a name="l01833"></a>01833       <a class="code" href="utils_8h.html#ab2de736b42974f12ec7d57c41d234bf4">ast_set_flag64</a>(flags, options[curarg].flag);
<a name="l01834"></a>01834       argloc = options[curarg].<a class="code" href="structast__app__option.html#a7fba4686db1ab2c33d8920fb7019d916" title="The index of the entry in the arguments array that should be used for this option&amp;#39;s...">arg_index</a>;
<a name="l01835"></a>01835       <span class="keywordflow">if</span> (*s == <span class="charliteral">&apos;(&apos;</span>) {
<a name="l01836"></a>01836          <span class="comment">/* Has argument */</span>
<a name="l01837"></a>01837          arg = ++s;
<a name="l01838"></a>01838          <span class="keywordflow">if</span> ((s = strchr(s, <span class="charliteral">&apos;)&apos;</span>))) {
<a name="l01839"></a>01839             <span class="keywordflow">if</span> (argloc) {
<a name="l01840"></a>01840                args[argloc - 1] = arg;
<a name="l01841"></a>01841             }
<a name="l01842"></a>01842             *s++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01843"></a>01843          } <span class="keywordflow">else</span> {
<a name="l01844"></a>01844             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing closing parenthesis for argument &apos;%c&apos; in string &apos;%s&apos;\n&quot;</span>, curarg, arg);
<a name="l01845"></a>01845             res = -1;
<a name="l01846"></a>01846             <span class="keywordflow">break</span>;
<a name="l01847"></a>01847          }
<a name="l01848"></a>01848       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argloc) {
<a name="l01849"></a>01849          args[argloc - 1] = NULL;
<a name="l01850"></a>01850       }
<a name="l01851"></a>01851    }
<a name="l01852"></a>01852 
<a name="l01853"></a>01853    <span class="keywordflow">return</span> res;
<a name="l01854"></a>01854 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c444cef1f29205f033db05bfeee8298"></a><!-- doxytag: member="app.h::ast_app_sayname" ref="a3c444cef1f29205f033db05bfeee8298" args="(struct ast_channel *chan, const char *mailbox, const char *context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_app_sayname </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mailbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>context</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given a mailbox and context, play that mailbox owner's name to the channel specified. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel on which to play the name </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mailbox</em>&nbsp;</td><td>Mailbox <a class="el" href="structnumber.html" title="Number structure.">number</a> from which to retrieve the recording </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>context</em>&nbsp;</td><td>Mailbox context from which to locate the mailbox <a class="el" href="structnumber.html" title="Number structure.">number</a> </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>Name played without interruption </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dtmf</em>&nbsp;</td><td>ASCII value of the DTMF which interrupted playback. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>Unable to locate mailbox or hangup occurred. </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00291">291</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a>.</p>

<p>Referenced by <a class="el" href="app__chanspy_8c_source.html#l00767">common_exec()</a>, and <a class="el" href="app__directory_8c_source.html#l00247">play_mailbox_owner()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00292"></a>00292 {
<a name="l00293"></a>00293    <span class="keywordflow">if</span> (<a class="code" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a>) {
<a name="l00294"></a>00294       <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a>(chan, <a class="code" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, <a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>);
<a name="l00295"></a>00295    }
<a name="l00296"></a>00296    <span class="keywordflow">return</span> -1;
<a name="l00297"></a>00297 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afcbfdd6dfc8c5f0f549b0a5d7e263e97"></a><!-- doxytag: member="app.h::ast_close_fds_above_n" ref="afcbfdd6dfc8c5f0f549b0a5d7e263e97" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_close_fds_above_n </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Common routine for child processes, to close all fds prior to exec(2). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n</em>&nbsp;</td><td>starting file descriptor <a class="el" href="structnumber.html" title="Number structure.">number</a> for closing all higher file descriptors </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01982">1982</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>.</p>

<p>Referenced by <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="asterisk_8c_source.html#l01001">ast_safe_system()</a>, <a class="el" href="app__ices_8c_source.html#l00072">icesencode()</a>, <a class="el" href="res__agi_8c_source.html#l00867">launch_script()</a>, <a class="el" href="asterisk_8c_source.html#l03095">main()</a>, <a class="el" href="app__mp3_8c_source.html#l00067">mp3play()</a>, <a class="el" href="app__nbscat_8c_source.html#l00068">NBScatplay()</a>, <a class="el" href="app__festival_8c_source.html#l00127">send_waveform_to_fd()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00422">spawn_mp3()</a>, <a class="el" href="app__dahdiras_8c_source.html#l00081">spawn_ras()</a>, and <a class="el" href="app__voicemail_8c_source.html#l01050">vm_check_password_shell()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01983"></a>01983 {
<a name="l01984"></a>01984 <span class="preprocessor">#ifdef HAVE_CLOSEFROM</span>
<a name="l01985"></a>01985 <span class="preprocessor"></span>   closefrom(n + 1);
<a name="l01986"></a>01986 <span class="preprocessor">#else</span>
<a name="l01987"></a>01987 <span class="preprocessor"></span>   <span class="keywordtype">int</span> x, null;
<a name="l01988"></a>01988    <span class="keyword">struct </span>rlimit rl;
<a name="l01989"></a>01989    getrlimit(RLIMIT_NOFILE, &amp;rl);
<a name="l01990"></a>01990    null = open(<span class="stringliteral">&quot;/dev/null&quot;</span>, O_RDONLY);
<a name="l01991"></a>01991    <span class="keywordflow">for</span> (x = n + 1; x &lt; rl.rlim_cur; x++) {
<a name="l01992"></a>01992       <span class="keywordflow">if</span> (x != null) {
<a name="l01993"></a>01993          <span class="comment">/* Side effect of dup2 is that it closes any existing fd without error.</span>
<a name="l01994"></a>01994 <span class="comment">          * This prevents valgrind and other debugging tools from sending up</span>
<a name="l01995"></a>01995 <span class="comment">          * false error reports. */</span>
<a name="l01996"></a>01996          <span class="keywordflow">while</span> (dup2(null, x) &lt; 0 &amp;&amp; errno == EINTR);
<a name="l01997"></a>01997          close(x);
<a name="l01998"></a>01998       }
<a name="l01999"></a>01999    }
<a name="l02000"></a>02000    close(null);
<a name="l02001"></a>02001 <span class="preprocessor">#endif</span>
<a name="l02002"></a>02002 <span class="preprocessor"></span>}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3405b1282cefdceebba734b8e756c55d"></a><!-- doxytag: member="app.h::ast_control_streamfile" ref="a3405b1282cefdceebba734b8e756c55d" args="(struct ast_channel *chan, const char *file, const char *fwd, const char *rev, const char *stop, const char *pause, const char *restart, int skipms, long *offsetms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_control_streamfile </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>rev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>stop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>pause</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>restart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>skipms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&nbsp;</td>
          <td class="paramname"> <em>offsetms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stream a file with fast forward, pause, reverse, restart. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>filename </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fwd,rev,stop,pause,restart,skipms,offsetms</em>&nbsp;</td><td>Before calling this function, set this to be the <a class="el" href="structnumber.html" title="Number structure.">number</a> of ms to start from the beginning of the file. When the function returns, it will be the <a class="el" href="structnumber.html" title="Number structure.">number</a> of ms from the beginning where the playback stopped. Pass NULL if you don't care. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00496">496</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00469">ast_channel::_state</a>, <a class="el" href="channel_8c_source.html#l01951">ast_answer()</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="file_8c_source.html#l00862">ast_seekstream()</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, <a class="el" href="file_8c_source.html#l00122">ast_stopstream()</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, <a class="el" href="file_8c_source.html#l00872">ast_tellstream()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="channel_8c_source.html#l02400">ast_waitfordigit()</a>, <a class="el" href="file_8c_source.html#l01309">ast_waitstream_fr()</a>, and <a class="el" href="channel_8h_source.html#l00414">ast_channel::stream</a>.</p>

<p>Referenced by <a class="el" href="app__controlplayback_8c_source.html#l00128">controlplayback_exec()</a>, <a class="el" href="res__agi_8c_source.html#l01153">handle_controlstreamfile()</a>, and <a class="el" href="app__voicemail_8c_source.html#l06845">wait_file()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00500"></a>00500 {
<a name="l00501"></a>00501    <span class="keywordtype">char</span> *breaks = NULL;
<a name="l00502"></a>00502    <span class="keywordtype">char</span> *end = NULL;
<a name="l00503"></a>00503    <span class="keywordtype">int</span> blen = 2;
<a name="l00504"></a>00504    <span class="keywordtype">int</span> res;
<a name="l00505"></a>00505    <span class="keywordtype">long</span> pause_restart_point = 0;
<a name="l00506"></a>00506    <span class="keywordtype">long</span> offset = 0;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508    <span class="keywordflow">if</span> (offsetms) {
<a name="l00509"></a>00509       offset = *offsetms * 8; <span class="comment">/* XXX Assumes 8kHz */</span>
<a name="l00510"></a>00510    }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512    <span class="keywordflow">if</span> (<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>) {
<a name="l00513"></a>00513       blen += strlen(<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>);
<a name="l00514"></a>00514    }
<a name="l00515"></a>00515    <span class="keywordflow">if</span> (suspend) {
<a name="l00516"></a>00516       blen += strlen(suspend);
<a name="l00517"></a>00517    }
<a name="l00518"></a>00518    <span class="keywordflow">if</span> (restart) {
<a name="l00519"></a>00519       blen += strlen(restart);
<a name="l00520"></a>00520    }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    <span class="keywordflow">if</span> (blen &gt; 2) {
<a name="l00523"></a>00523       breaks = alloca(blen + 1);
<a name="l00524"></a>00524       breaks[0] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00525"></a>00525       <span class="keywordflow">if</span> (<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>) {
<a name="l00526"></a>00526          strcat(breaks, <a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>);
<a name="l00527"></a>00527       }
<a name="l00528"></a>00528       <span class="keywordflow">if</span> (suspend) {
<a name="l00529"></a>00529          strcat(breaks, suspend);
<a name="l00530"></a>00530       }
<a name="l00531"></a>00531       <span class="keywordflow">if</span> (restart) {
<a name="l00532"></a>00532          strcat(breaks, restart);
<a name="l00533"></a>00533       }
<a name="l00534"></a>00534    }
<a name="l00535"></a>00535    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#abc7d0b575ffea0b65ce604e0e4c99d3d">_state</a> != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {
<a name="l00536"></a>00536       res = <a class="code" href="channel_8h.html#aec583a3e25358ee552a4f3df53914cd0" title="Answer a channel.">ast_answer</a>(chan);
<a name="l00537"></a>00537    }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539    <span class="keywordflow">if</span> (file) {
<a name="l00540"></a>00540       <span class="keywordflow">if</span> ((end = strchr(file, <span class="charliteral">&apos;:&apos;</span>))) {
<a name="l00541"></a>00541          <span class="keywordflow">if</span> (!strcasecmp(end, <span class="stringliteral">&quot;:end&quot;</span>)) {
<a name="l00542"></a>00542             *end = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00543"></a>00543             end++;
<a name="l00544"></a>00544          }
<a name="l00545"></a>00545       }
<a name="l00546"></a>00546    }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548    <span class="keywordflow">for</span> (;;) {
<a name="l00549"></a>00549       <a class="code" href="file_8h.html#a3092bf11d4bba66f646562759608b1bc" title="Stops a stream.">ast_stopstream</a>(chan);
<a name="l00550"></a>00550       res = <a class="code" href="file_8h.html#a67c7e271b4ca70aca6d48fd48d121857" title="Streams a file.">ast_streamfile</a>(chan, file, chan-&gt;language);
<a name="l00551"></a>00551       <span class="keywordflow">if</span> (!res) {
<a name="l00552"></a>00552          <span class="keywordflow">if</span> (pause_restart_point) {
<a name="l00553"></a>00553             <a class="code" href="file_8h.html#a36f6bba05952162d5d1ee7fb9819bd07" title="Seeks into stream.">ast_seekstream</a>(chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>, pause_restart_point, SEEK_SET);
<a name="l00554"></a>00554             pause_restart_point = 0;
<a name="l00555"></a>00555          }
<a name="l00556"></a>00556          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (end || offset &lt; 0) {
<a name="l00557"></a>00557             <span class="keywordflow">if</span> (offset == -8) {
<a name="l00558"></a>00558                offset = 0;
<a name="l00559"></a>00559             }
<a name="l00560"></a>00560             <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;ControlPlayback seek to offset %ld from end\n&quot;</span>, offset);
<a name="l00561"></a>00561 
<a name="l00562"></a>00562             <a class="code" href="file_8h.html#a36f6bba05952162d5d1ee7fb9819bd07" title="Seeks into stream.">ast_seekstream</a>(chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>, offset, SEEK_END);
<a name="l00563"></a>00563             end = NULL;
<a name="l00564"></a>00564             offset = 0;
<a name="l00565"></a>00565          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (offset) {
<a name="l00566"></a>00566             <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;ControlPlayback seek to offset %ld\n&quot;</span>, offset);
<a name="l00567"></a>00567             <a class="code" href="file_8h.html#a36f6bba05952162d5d1ee7fb9819bd07" title="Seeks into stream.">ast_seekstream</a>(chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>, offset, SEEK_SET);
<a name="l00568"></a>00568             offset = 0;
<a name="l00569"></a>00569          }
<a name="l00570"></a>00570          res = <a class="code" href="file_8h.html#a5ce837632e3746a3af17f8311060e510" title="Same as waitstream but allows stream to be forwarded or rewound.">ast_waitstream_fr</a>(chan, breaks, fwd, rev, <a class="code" href="app__voicemail_8c.html#a1df943a05a384a407a19cf8831b2d237">skipms</a>);
<a name="l00571"></a>00571       }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573       <span class="keywordflow">if</span> (res &lt; 1) {
<a name="l00574"></a>00574          <span class="keywordflow">break</span>;
<a name="l00575"></a>00575       }
<a name="l00576"></a>00576 
<a name="l00577"></a>00577       <span class="comment">/* We go at next loop if we got the restart char */</span>
<a name="l00578"></a>00578       <span class="keywordflow">if</span> (restart &amp;&amp; strchr(restart, res)) {
<a name="l00579"></a>00579          <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;we&apos;ll restart the stream here at next loop\n&quot;</span>);
<a name="l00580"></a>00580          pause_restart_point = 0;
<a name="l00581"></a>00581          <span class="keywordflow">continue</span>;
<a name="l00582"></a>00582       }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584       <span class="keywordflow">if</span> (suspend &amp;&amp; strchr(suspend, res)) {
<a name="l00585"></a>00585          pause_restart_point = <a class="code" href="file_8h.html#a01771a318e7adea51499040f27b4278a" title="Tell where we are in a stream.">ast_tellstream</a>(chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>);
<a name="l00586"></a>00586          <span class="keywordflow">for</span> (;;) {
<a name="l00587"></a>00587             <a class="code" href="file_8h.html#a3092bf11d4bba66f646562759608b1bc" title="Stops a stream.">ast_stopstream</a>(chan);
<a name="l00588"></a>00588             <span class="keywordflow">if</span> (!(res = <a class="code" href="channel_8h.html#a050bec9a4abc1a599b6573a6091b080c" title="Waits for a digit.">ast_waitfordigit</a>(chan, 1000))) {
<a name="l00589"></a>00589                <span class="keywordflow">continue</span>;
<a name="l00590"></a>00590             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == -1 || strchr(suspend, res) || (<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a> &amp;&amp; strchr(<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>, res))) {
<a name="l00591"></a>00591                <span class="keywordflow">break</span>;
<a name="l00592"></a>00592             }
<a name="l00593"></a>00593          }
<a name="l00594"></a>00594          <span class="keywordflow">if</span> (res == *suspend) {
<a name="l00595"></a>00595             res = 0;
<a name="l00596"></a>00596             <span class="keywordflow">continue</span>;
<a name="l00597"></a>00597          }
<a name="l00598"></a>00598       }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600       <span class="keywordflow">if</span> (res == -1) {
<a name="l00601"></a>00601          <span class="keywordflow">break</span>;
<a name="l00602"></a>00602       }
<a name="l00603"></a>00603 
<a name="l00604"></a>00604       <span class="comment">/* if we get one of our stop chars, return it to the calling function */</span>
<a name="l00605"></a>00605       <span class="keywordflow">if</span> (<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a> &amp;&amp; strchr(<a class="code" href="res__ais_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>, res)) {
<a name="l00606"></a>00606          <span class="keywordflow">break</span>;
<a name="l00607"></a>00607       }
<a name="l00608"></a>00608    }
<a name="l00609"></a>00609 
<a name="l00610"></a>00610    <span class="keywordflow">if</span> (pause_restart_point) {
<a name="l00611"></a>00611       offset = pause_restart_point;
<a name="l00612"></a>00612    } <span class="keywordflow">else</span> {
<a name="l00613"></a>00613       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>) {
<a name="l00614"></a>00614          offset = <a class="code" href="file_8h.html#a01771a318e7adea51499040f27b4278a" title="Tell where we are in a stream.">ast_tellstream</a>(chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>);
<a name="l00615"></a>00615       } <span class="keywordflow">else</span> {
<a name="l00616"></a>00616          offset = -8;  <span class="comment">/* indicate end of file */</span>
<a name="l00617"></a>00617       }
<a name="l00618"></a>00618    }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620    <span class="keywordflow">if</span> (offsetms) {
<a name="l00621"></a>00621       *offsetms = offset / 8; <span class="comment">/* samples --&gt; ms ... XXX Assumes 8 kHz */</span>
<a name="l00622"></a>00622    }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624    <span class="comment">/* If we are returning a digit cast it as char */</span>
<a name="l00625"></a>00625    <span class="keywordflow">if</span> (res &gt; 0 || chan-&gt;<a class="code" href="structast__channel.html#a016ccfa2a88444ffde0ad0168a0f231d">stream</a>) {
<a name="l00626"></a>00626       res = (char)res;
<a name="l00627"></a>00627    }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629    <a class="code" href="file_8h.html#a3092bf11d4bba66f646562759608b1bc" title="Stops a stream.">ast_stopstream</a>(chan);
<a name="l00630"></a>00630 
<a name="l00631"></a>00631    <span class="keywordflow">return</span> res;
<a name="l00632"></a>00632 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af20b8ac2e28e659be352bbaecdf0ab03"></a><!-- doxytag: member="app.h::ast_dtmf_stream" ref="af20b8ac2e28e659be352bbaecdf0ab03" args="(struct ast_channel *chan, struct ast_channel *peer, const char *digits, int between, unsigned int duration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_dtmf_stream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>peer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>digits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>between</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>duration</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send DTMF to a channel. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel that will receive the DTMF frames </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>peer</em>&nbsp;</td><td>(optional) Peer channel that will be autoserviced while the primary channel is receiving DTMF </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>digits</em>&nbsp;</td><td>This is a string of characters representing the DTMF digits to be sent to the channel. Valid characters are "0123456789*#abcdABCD". Note: You can pass arguments 'f' or 'F', if you want to Flash the channel (if supported by the channel), or 'w' to add a 500 millisecond pause to the DTMF sequence. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>between</em>&nbsp;</td><td>This is the <a class="el" href="structnumber.html" title="Number structure.">number</a> of milliseconds to wait in between each DTMF digit. If zero milliseconds is specified, then the default value of 100 will be used. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>duration</em>&nbsp;</td><td>This is the duration that each DTMF digit should have. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00314">314</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="autoservice_8c_source.html#l00192">ast_autoservice_start()</a>, <a class="el" href="autoservice_8c_source.html#l00251">ast_autoservice_stop()</a>, <a class="el" href="channel_8c_source.html#l05640">ast_channel_start_silence_generator()</a>, <a class="el" href="channel_8c_source.html#l05663">ast_channel_stop_silence_generator()</a>, <a class="el" href="frame_8h_source.html#l00306">AST_CONTROL_FLASH</a>, <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="options_8h_source.html#l00114">ast_opt_transmit_silence</a>, <a class="el" href="channel_8c_source.html#l01367">ast_safe_sleep()</a>, <a class="el" href="channel_8c_source.html#l03373">ast_senddigit()</a>, <a class="el" href="channel_8c_source.html#l02389">ast_waitfor()</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="features_8c_source.html#l02441">ast_bridge_call()</a>, <a class="el" href="bridging_8c_source.html#l00844">bridge_channel_dtmf_stream()</a>, <a class="el" href="app__dial_8c_source.html#l01515">dial_exec_full()</a>, <a class="el" href="chan__misdn_8c_source.html#l01763">handle_cli_misdn_send_digit()</a>, <a class="el" href="app__senddtmf_8c_source.html#l00065">senddtmf_exec()</a>, <a class="el" href="app__test_8c_source.html#l00146">testclient_exec()</a>, and <a class="el" href="app__test_8c_source.html#l00320">testserver_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00315"></a>00315 {
<a name="l00316"></a>00316    <span class="keyword">const</span> <span class="keywordtype">char</span> *ptr;
<a name="l00317"></a>00317    <span class="keywordtype">int</span> res = 0;
<a name="l00318"></a>00318    <span class="keyword">struct </span><a class="code" href="structast__silence__generator.html">ast_silence_generator</a> *silgen = NULL;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320    <span class="keywordflow">if</span> (!between) {
<a name="l00321"></a>00321       between = 100;
<a name="l00322"></a>00322    }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324    <span class="keywordflow">if</span> (peer) {
<a name="l00325"></a>00325       res = <a class="code" href="channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9" title="Automatically service a channel for us...">ast_autoservice_start</a>(peer);
<a name="l00326"></a>00326    }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328    <span class="keywordflow">if</span> (!res) {
<a name="l00329"></a>00329       res = <a class="code" href="channel_8h.html#a60e0bcaed001e8d5ed1ba0eb2644b3cc" title="Wait for input on a channel.">ast_waitfor</a>(chan, 100);
<a name="l00330"></a>00330    }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332    <span class="comment">/* ast_waitfor will return the number of remaining ms on success */</span>
<a name="l00333"></a>00333    <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l00334"></a>00334       <span class="keywordflow">if</span> (peer) {
<a name="l00335"></a>00335          <a class="code" href="channel_8h.html#a08bde7d8cf72457fc8c519a4443b413b" title="Stop servicing a channel for us...">ast_autoservice_stop</a>(peer);
<a name="l00336"></a>00336       }
<a name="l00337"></a>00337       <span class="keywordflow">return</span> res;
<a name="l00338"></a>00338    }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340    <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#afe8795c4ec744506a9300700fc0813dc">ast_opt_transmit_silence</a>) {
<a name="l00341"></a>00341       silgen = <a class="code" href="channel_8h.html#a2a2e0ff24c57491a877cac39cb670024" title="Starts a silence generator on the given channel.">ast_channel_start_silence_generator</a>(chan);
<a name="l00342"></a>00342    }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344    <span class="keywordflow">for</span> (ptr = digits; *ptr; ptr++) {
<a name="l00345"></a>00345       <span class="keywordflow">if</span> (*ptr == <span class="charliteral">&apos;w&apos;</span>) {
<a name="l00346"></a>00346          <span class="comment">/* &apos;w&apos; -- wait half a second */</span>
<a name="l00347"></a>00347          <span class="keywordflow">if</span> ((res = <a class="code" href="channel_8h.html#af10e3bd01602095e1908d3926afc3b76" title="Wait for a specified amount of time, looking for hangups.">ast_safe_sleep</a>(chan, 500))) {
<a name="l00348"></a>00348             <span class="keywordflow">break</span>;
<a name="l00349"></a>00349          }
<a name="l00350"></a>00350       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;0123456789*#abcdfABCDF&quot;</span>, *ptr)) {
<a name="l00351"></a>00351          <span class="comment">/* Character represents valid DTMF */</span>
<a name="l00352"></a>00352          <span class="keywordflow">if</span> (*ptr == <span class="charliteral">&apos;f&apos;</span> || *ptr == <span class="charliteral">&apos;F&apos;</span>) {
<a name="l00353"></a>00353             <span class="comment">/* ignore return values if not supported by channel */</span>
<a name="l00354"></a>00354             <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a>);
<a name="l00355"></a>00355          } <span class="keywordflow">else</span> {
<a name="l00356"></a>00356             <a class="code" href="channel_8h.html#a48a8b376caf908979e96af8641591c92" title="Send a DTMF digit to a channel Send a DTMF digit to a channel.">ast_senddigit</a>(chan, *ptr, duration);
<a name="l00357"></a>00357          }
<a name="l00358"></a>00358          <span class="comment">/* pause between digits */</span>
<a name="l00359"></a>00359          <span class="keywordflow">if</span> ((res = <a class="code" href="channel_8h.html#af10e3bd01602095e1908d3926afc3b76" title="Wait for a specified amount of time, looking for hangups.">ast_safe_sleep</a>(chan, between))) {
<a name="l00360"></a>00360             <span class="keywordflow">break</span>;
<a name="l00361"></a>00361          }
<a name="l00362"></a>00362       } <span class="keywordflow">else</span> {
<a name="l00363"></a>00363          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Illegal DTMF character &apos;%c&apos; in string. (0-9*#aAbBcCdD allowed)\n&quot;</span>, *ptr);
<a name="l00364"></a>00364       }
<a name="l00365"></a>00365    }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367    <span class="keywordflow">if</span> (peer) {
<a name="l00368"></a>00368       <span class="comment">/* Stop autoservice on the peer channel, but don&apos;t overwrite any error condition</span>
<a name="l00369"></a>00369 <span class="comment">         that has occurred previously while acting on the primary channel */</span>
<a name="l00370"></a>00370       <span class="keywordflow">if</span> (<a class="code" href="channel_8h.html#a08bde7d8cf72457fc8c519a4443b413b" title="Stop servicing a channel for us...">ast_autoservice_stop</a>(peer) &amp;&amp; !res) {
<a name="l00371"></a>00371          res = -1;
<a name="l00372"></a>00372       }
<a name="l00373"></a>00373    }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375    <span class="keywordflow">if</span> (silgen) {
<a name="l00376"></a>00376       <a class="code" href="channel_8h.html#a6643cbe766a051d2d06750ab5b3e933d" title="Stops a previously-started silence generator on the given channel.">ast_channel_stop_silence_generator</a>(chan, silgen);
<a name="l00377"></a>00377    }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379    <span class="keywordflow">return</span> res;
<a name="l00380"></a>00380 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1e8f73e62b3c2243eca582ee0d8d6147"></a><!-- doxytag: member="app.h::ast_get_encoded_char" ref="a1e8f73e62b3c2243eca582ee0d8d6147" args="(const char *stream, char *result, size_t *consumed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_get_encoded_char </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&nbsp;</td>
          <td class="paramname"> <em>consumed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decode an encoded control or extended ASCII character. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns a pointer to the result string </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01867">1867</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l01942">ast_get_encoded_str()</a>, <a class="el" href="app_8c_source.html#l01955">ast_str_get_encoded_str()</a>, <a class="el" href="func__cut_8c_source.html#l00154">cut_internal()</a>, <a class="el" href="func__strings_8c_source.html#l00427">filter()</a>, and <a class="el" href="func__strings_8c_source.html#l00292">function_fieldqty()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01868"></a>01868 {
<a name="l01869"></a>01869    <span class="keywordtype">int</span> i;
<a name="l01870"></a>01870    *consumed = 1;
<a name="l01871"></a>01871    *result = 0;
<a name="l01872"></a>01872    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(stream)) {
<a name="l01873"></a>01873       *consumed = 0;
<a name="l01874"></a>01874       <span class="keywordflow">return</span> -1;
<a name="l01875"></a>01875    }
<a name="l01876"></a>01876 
<a name="l01877"></a>01877    <span class="keywordflow">if</span> (*stream == <span class="charliteral">&apos;\\&apos;</span>) {
<a name="l01878"></a>01878       *consumed = 2;
<a name="l01879"></a>01879       <span class="keywordflow">switch</span> (*(stream + 1)) {
<a name="l01880"></a>01880       <span class="keywordflow">case</span> <span class="charliteral">&apos;n&apos;</span>:
<a name="l01881"></a>01881          *result = <span class="charliteral">&apos;\n&apos;</span>;
<a name="l01882"></a>01882          <span class="keywordflow">break</span>;
<a name="l01883"></a>01883       <span class="keywordflow">case</span> <span class="charliteral">&apos;r&apos;</span>:
<a name="l01884"></a>01884          *result = <span class="charliteral">&apos;\r&apos;</span>;
<a name="l01885"></a>01885          <span class="keywordflow">break</span>;
<a name="l01886"></a>01886       <span class="keywordflow">case</span> <span class="charliteral">&apos;t&apos;</span>:
<a name="l01887"></a>01887          *result = <span class="charliteral">&apos;\t&apos;</span>;
<a name="l01888"></a>01888          <span class="keywordflow">break</span>;
<a name="l01889"></a>01889       <span class="keywordflow">case</span> <span class="charliteral">&apos;x&apos;</span>:
<a name="l01890"></a>01890          <span class="comment">/* Hexadecimal */</span>
<a name="l01891"></a>01891          <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;0123456789ABCDEFabcdef&quot;</span>, *(stream + 2)) &amp;&amp; *(stream + 2) != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l01892"></a>01892             *consumed = 3;
<a name="l01893"></a>01893             <span class="keywordflow">if</span> (*(stream + 2) &lt;= <span class="charliteral">&apos;9&apos;</span>) {
<a name="l01894"></a>01894                *result = *(stream + 2) - <span class="charliteral">&apos;0&apos;</span>;
<a name="l01895"></a>01895             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(stream + 2) &lt;= <span class="charliteral">&apos;F&apos;</span>) {
<a name="l01896"></a>01896                *result = *(stream + 2) - <span class="charliteral">&apos;A&apos;</span> + 10;
<a name="l01897"></a>01897             } <span class="keywordflow">else</span> {
<a name="l01898"></a>01898                *result = *(stream + 2) - <span class="charliteral">&apos;a&apos;</span> + 10;
<a name="l01899"></a>01899             }
<a name="l01900"></a>01900          } <span class="keywordflow">else</span> {
<a name="l01901"></a>01901             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Illegal character &apos;%c&apos; in hexadecimal string\n&quot;</span>, *(stream + 2));
<a name="l01902"></a>01902             <span class="keywordflow">return</span> -1;
<a name="l01903"></a>01903          }
<a name="l01904"></a>01904 
<a name="l01905"></a>01905          <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;0123456789ABCDEFabcdef&quot;</span>, *(stream + 3)) &amp;&amp; *(stream + 3) != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l01906"></a>01906             *consumed = 4;
<a name="l01907"></a>01907             *result &lt;&lt;= 4;
<a name="l01908"></a>01908             <span class="keywordflow">if</span> (*(stream + 3) &lt;= <span class="charliteral">&apos;9&apos;</span>) {
<a name="l01909"></a>01909                *result += *(stream + 3) - <span class="charliteral">&apos;0&apos;</span>;
<a name="l01910"></a>01910             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(stream + 3) &lt;= <span class="charliteral">&apos;F&apos;</span>) {
<a name="l01911"></a>01911                *result += *(stream + 3) - <span class="charliteral">&apos;A&apos;</span> + 10;
<a name="l01912"></a>01912             } <span class="keywordflow">else</span> {
<a name="l01913"></a>01913                *result += *(stream + 3) - <span class="charliteral">&apos;a&apos;</span> + 10;
<a name="l01914"></a>01914             }
<a name="l01915"></a>01915          }
<a name="l01916"></a>01916          <span class="keywordflow">break</span>;
<a name="l01917"></a>01917       <span class="keywordflow">case</span> <span class="charliteral">&apos;0&apos;</span>:
<a name="l01918"></a>01918          <span class="comment">/* Octal */</span>
<a name="l01919"></a>01919          *consumed = 2;
<a name="l01920"></a>01920          <span class="keywordflow">for</span> (i = 2; ; i++) {
<a name="l01921"></a>01921             <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;01234567&quot;</span>, *(stream + i)) &amp;&amp; *(stream + i) != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l01922"></a>01922                (*consumed)++;
<a name="l01923"></a>01923                <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(5, <span class="stringliteral">&quot;result was %d, &quot;</span>, *result);
<a name="l01924"></a>01924                *result &lt;&lt;= 3;
<a name="l01925"></a>01925                *result += *(stream + i) - <span class="charliteral">&apos;0&apos;</span>;
<a name="l01926"></a>01926                <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(5, <span class="stringliteral">&quot;is now %d\n&quot;</span>, *result);
<a name="l01927"></a>01927             } <span class="keywordflow">else</span> {
<a name="l01928"></a>01928                <span class="keywordflow">break</span>;
<a name="l01929"></a>01929             }
<a name="l01930"></a>01930          }
<a name="l01931"></a>01931          <span class="keywordflow">break</span>;
<a name="l01932"></a>01932       <span class="keywordflow">default</span>:
<a name="l01933"></a>01933          *result = *(stream + 1);
<a name="l01934"></a>01934       }
<a name="l01935"></a>01935    } <span class="keywordflow">else</span> {
<a name="l01936"></a>01936       *result = *stream;
<a name="l01937"></a>01937       *consumed = 1;
<a name="l01938"></a>01938    }
<a name="l01939"></a>01939    <span class="keywordflow">return</span> 0;
<a name="l01940"></a>01940 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2fdf311701900d162bced0d30e923b92"></a><!-- doxytag: member="app.h::ast_get_encoded_str" ref="a2fdf311701900d162bced0d30e923b92" args="(const char *stream, char *result, size_t result_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_get_encoded_str </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>result_len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decode a stream of encoded control or extended ASCII characters. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01942">1942</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l01867">ast_get_encoded_char()</a>.</p>

<p>Referenced by <a class="el" href="func__strings_8c_source.html#l00331">listfilter()</a>, <a class="el" href="chan__sip_8c_source.html#l25438">sip_addheader()</a>, and <a class="el" href="chan__sip_8c_source.html#l06599">sip_new()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01943"></a>01943 {
<a name="l01944"></a>01944    <span class="keywordtype">char</span> *cur = result;
<a name="l01945"></a>01945    <span class="keywordtype">size_t</span> consumed;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947    <span class="keywordflow">while</span> (cur &lt; result + result_size - 1 &amp;&amp; !<a class="code" href="app_8h.html#a1e8f73e62b3c2243eca582ee0d8d6147" title="Decode an encoded control or extended ASCII character.">ast_get_encoded_char</a>(stream, cur, &amp;consumed)) {
<a name="l01948"></a>01948       cur++;
<a name="l01949"></a>01949       stream += consumed;
<a name="l01950"></a>01950    }
<a name="l01951"></a>01951    *cur = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01952"></a>01952    <span class="keywordflow">return</span> result;
<a name="l01953"></a>01953 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a27992e5c39b818ff6b190f726a80cb50"></a><!-- doxytag: member="app.h::ast_install_vm_functions" ref="a27992e5c39b818ff6b190f726a80cb50" args="(int(*has_voicemail_func)(const char *mailbox, const char *folder), int(*inboxcount_func)(const char *mailbox, int *newmsgs, int *oldmsgs), int(*inboxcount2_func)(const char *mailbox, int *urgentmsgs, int *newmsgs, int *oldmsgs), int(*messagecount_func)(const char *context, const char *mailbox, const char *folder), int(*sayname_func)(struct ast_channel *chan, const char *mailbox, const char *context))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_install_vm_functions </td>
          <td>(</td>
          <td class="paramtype">int(*)(const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *folder)&nbsp;</td>
          <td class="paramname"> <em>has_voicemail_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, int *newmsgs, int *oldmsgs)&nbsp;</td>
          <td class="paramname"> <em>inboxcount_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, int *urgentmsgs, int *newmsgs, int *oldmsgs)&nbsp;</td>
          <td class="paramname"> <em>inboxcount2_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *folder)&nbsp;</td>
          <td class="paramname"> <em>messagecount_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *<a class="el" href="chan__mgcp_8c.html#ac81f44f4f22dee90de5975cf8fa4641b">mailbox</a>, const char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>)&nbsp;</td>
          <td class="paramname"> <em>sayname_func</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set voicemail function callbacks. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>inboxcount2_func</em>&nbsp;</td><td>set function pointer </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sayname_func</em>&nbsp;</td><td>set function pointer </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>inboxcount_func</em>&nbsp;</td><td>set function pointer </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>messagecount_func</em>&nbsp;</td><td>set function pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.6.1 Added inboxcount2_func, sayname_func </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l00212">212</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a>, <a class="el" href="app_8c.html#a8951323b5b85c9a255e97c181286056c">ast_inboxcount2_func</a>, <a class="el" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>, <a class="el" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a>, and <a class="el" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a>.</p>

<p>Referenced by <a class="el" href="app__voicemail_8c_source.html#l11306">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 {
<a name="l00218"></a>00218    <a class="code" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a> = has_voicemail_func;
<a name="l00219"></a>00219    <a class="code" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a> = inboxcount_func;
<a name="l00220"></a>00220    <a class="code" href="app_8c.html#a8951323b5b85c9a255e97c181286056c">ast_inboxcount2_func</a> = inboxcount2_func;
<a name="l00221"></a>00221    <a class="code" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a> = messagecount_func;
<a name="l00222"></a>00222    <a class="code" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a> = sayname_func;
<a name="l00223"></a>00223 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a855c3d16ea8884345a7b1c3fe5a16577"></a><!-- doxytag: member="app.h::ast_ivr_menu_run" ref="a855c3d16ea8884345a7b1c3fe5a16577" args="(struct ast_channel *c, struct ast_ivr_menu *menu, void *cbdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_ivr_menu_run </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__ivr__menu.html">ast_ivr_menu</a> *&nbsp;</td>
          <td class="paramname"> <em>menu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>cbdata</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Runs an IVR menu. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>returns 0 on successful completion, -1 on hangup, or -2 on <a class="el" href="structuser.html" title="structure to hold users read from users.conf">user</a> error in menu </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01735">1735</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l01650">ast_ivr_menu_run_internal()</a>.</p>

<p>Referenced by <a class="el" href="app__ivrdemo_8c_source.html#l00097">skel_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01736"></a>01736 {
<a name="l01737"></a>01737    <span class="keywordtype">int</span> res = <a class="code" href="app_8c.html#a09ef1fec8abab2315272f9300705ef04">ast_ivr_menu_run_internal</a>(<a class="code" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, menu, cbdata);
<a name="l01738"></a>01738    <span class="comment">/* Hide internal coding */</span>
<a name="l01739"></a>01739    <span class="keywordflow">return</span> res &gt; 0 ? 0 : res;
<a name="l01740"></a>01740 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2566e275a6e912943c68cbfc867cc60a"></a><!-- doxytag: member="app.h::ast_linear_stream" ref="a2566e275a6e912943c68cbfc867cc60a" args="(struct ast_channel *chan, const char *filename, int fd, int allowoverride)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_linear_stream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>allowoverride</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stream a filename (or file descriptor) as a generator. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00466">466</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l00385">linear_state::allowoverride</a>, <a class="el" href="channel_8c_source.html#l02001">ast_activate_generator()</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="asterisk_8c_source.html#l00254">ast_config_AST_DATA_DIR</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="app_8c_source.html#l00384">linear_state::autoclose</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="app_8c_source.html#l00383">linear_state::fd</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00467"></a>00467 {
<a name="l00468"></a>00468    <span class="keyword">struct </span><a class="code" href="structlinear__state.html">linear_state</a> *lin;
<a name="l00469"></a>00469    <span class="keywordtype">char</span> tmpf[256];
<a name="l00470"></a>00470    <span class="keywordtype">int</span> res = -1;
<a name="l00471"></a>00471    <span class="keywordtype">int</span> <a class="code" href="structlinear__state.html#a766c6d52861f6f0ddb14b6d579ecb331">autoclose</a> = 0;
<a name="l00472"></a>00472    <span class="keywordflow">if</span> (<a class="code" href="structlinear__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a> &lt; 0) {
<a name="l00473"></a>00473       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(filename)) {
<a name="l00474"></a>00474          <span class="keywordflow">return</span> -1;
<a name="l00475"></a>00475       }
<a name="l00476"></a>00476       autoclose = 1;
<a name="l00477"></a>00477       <span class="keywordflow">if</span> (filename[0] == <span class="charliteral">&apos;/&apos;</span>) {
<a name="l00478"></a>00478          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(tmpf, filename, <span class="keyword">sizeof</span>(tmpf));
<a name="l00479"></a>00479       } <span class="keywordflow">else</span> {
<a name="l00480"></a>00480          snprintf(tmpf, <span class="keyword">sizeof</span>(tmpf), <span class="stringliteral">&quot;%s/%s/%s&quot;</span>, <a class="code" href="paths_8h.html#a63af4213b5b83f717398d8d62008a50d">ast_config_AST_DATA_DIR</a>, <span class="stringliteral">&quot;sounds&quot;</span>, filename);
<a name="l00481"></a>00481       }
<a name="l00482"></a>00482       <span class="keywordflow">if</span> ((<a class="code" href="structlinear__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = open(tmpf, O_RDONLY)) &lt; 0) {
<a name="l00483"></a>00483          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open file &apos;%s&apos;: %s\n&quot;</span>, tmpf, strerror(errno));
<a name="l00484"></a>00484          <span class="keywordflow">return</span> -1;
<a name="l00485"></a>00485       }
<a name="l00486"></a>00486    }
<a name="l00487"></a>00487    <span class="keywordflow">if</span> ((lin = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*lin)))) {
<a name="l00488"></a>00488       lin-&gt;<a class="code" href="structlinear__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = <a class="code" href="structlinear__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a>;
<a name="l00489"></a>00489       lin-&gt;<a class="code" href="structlinear__state.html#ab6d0ae4f4fba3a46c253a118a8d1bf72">allowoverride</a> = <a class="code" href="structlinear__state.html#ab6d0ae4f4fba3a46c253a118a8d1bf72">allowoverride</a>;
<a name="l00490"></a>00490       lin-&gt;<a class="code" href="structlinear__state.html#a766c6d52861f6f0ddb14b6d579ecb331">autoclose</a> = autoclose;
<a name="l00491"></a>00491       res = <a class="code" href="channel_8h.html#a12a58dda74a19f383f6b77cf7fa88b54">ast_activate_generator</a>(chan, &amp;<a class="code" href="app_8c.html#a50b7bd92df6d7d96811b86030c0265b1">linearstream</a>, lin);
<a name="l00492"></a>00492    }
<a name="l00493"></a>00493    <span class="keywordflow">return</span> res;
<a name="l00494"></a>00494 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74c57b5a842dcbc15cc991a31f679a13"></a><!-- doxytag: member="app.h::ast_lock_path" ref="a74c57b5a842dcbc15cc991a31f679a13" args="(const char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8c">AST_LOCK_RESULT</a> ast_lock_path </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock a filesystem path. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>path</em>&nbsp;</td><td>the path to be locked </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>one of <a class="el" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8c">AST_LOCK_RESULT</a> <a class="el" href="structvalues.html">values</a> </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01407">1407</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00274">AST_LOCK_FAILURE</a>, <a class="el" href="app_8c_source.html#l01287">ast_lock_path_flock()</a>, <a class="el" href="app_8c_source.html#l01213">ast_lock_path_lockfile()</a>, <a class="el" href="app_8h_source.html#l00280">AST_LOCK_TYPE_FLOCK</a>, and <a class="el" href="app_8h_source.html#l00279">AST_LOCK_TYPE_LOCKFILE</a>.</p>

<p>Referenced by <a class="el" href="app__minivm_8c_source.html#l03019">vm_lock_path()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01408"></a>01408 {
<a name="l01409"></a>01409    <span class="keyword">enum</span> <a class="code" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8c">AST_LOCK_RESULT</a> r = <a class="code" href="app_8h.html#a382bf96f47f0b7fa86ae5ed0644b3f8cac59129c6f641d69ad14017c1ba1f2635">AST_LOCK_FAILURE</a>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411    <span class="keywordflow">switch</span> (<a class="code" href="app_8c.html#a6bcfb001b39f6049c25a2635de1dc17f">ast_lock_type</a>) {
<a name="l01412"></a>01412    <span class="keywordflow">case</span> <a class="code" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a599f18fdf355d7530bb754b8c66d6de7">AST_LOCK_TYPE_LOCKFILE</a>:
<a name="l01413"></a>01413       r = <a class="code" href="app_8c.html#a5e3efda31e8018f394246681664d447c">ast_lock_path_lockfile</a>(path);
<a name="l01414"></a>01414       <span class="keywordflow">break</span>;
<a name="l01415"></a>01415    <span class="keywordflow">case</span> <a class="code" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a78cd7e44280d287fc0168a0c31b75e3f">AST_LOCK_TYPE_FLOCK</a>:
<a name="l01416"></a>01416       r = <a class="code" href="app_8c.html#a631aa3756c80daa3b4c825189cfc183c">ast_lock_path_flock</a>(path);
<a name="l01417"></a>01417       <span class="keywordflow">break</span>;
<a name="l01418"></a>01418    }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420    <span class="keywordflow">return</span> r;
<a name="l01421"></a>01421 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a46e323bf2b852abe8ed7490fcb6e1f6d"></a><!-- doxytag: member="app.h::ast_play_and_prepend" ref="a46e323bf2b852abe8ed7490fcb6e1f6d" args="(struct ast_channel *chan, char *playfile, char *recordfile, int maxtime_sec, char *fmt, int *duration, int beep, int silencethreshold, int maxsilence_ms)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_play_and_prepend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>playfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>recordfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxtime_sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>beep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>silencethreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxsilence_ms</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Record a <a class="el" href="structmessage.html">message</a> and prepend the <a class="el" href="structmessage.html">message</a> to the given record file after playing the optional playfile (or a beep), storing the duration in 'duration' and with a maximum permitted silence time in milliseconds of 'maxsilence' under 'silencethreshold' or use '-1' for either or both parameters for defaults. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00965">965</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l00668">__ast_play_and_record()</a>.</p>

<p>Referenced by <a class="el" href="app__voicemail_8c_source.html#l06307">vm_forwardoptions()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00966"></a>00966 {
<a name="l00967"></a>00967    <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a3a2d88b2b8c4964fac4255816f9dedcf">__ast_play_and_record</a>(chan, playfile, recordfile, maxtime, fmt, duration, <a class="code" href="chan__agent_8c.html#a690b549792f347bebb6a13518822bcf7">beep</a>, <a class="code" href="app__voicemail_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>, <a class="code" href="app__voicemail_8c.html#ad87fa9ba37f50714bc922335b3b7ea91">maxsilence</a>, NULL, 1, <a class="code" href="app_8c.html#aa4d81f9babb2bb33d249f998a4918577">default_acceptdtmf</a>, <a class="code" href="app_8c.html#ad32d8b985e0bbce48b30bcaeb7d0968a">default_canceldtmf</a>);
<a name="l00968"></a>00968 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5189403102ce3cae44bd1b1644ee97a2"></a><!-- doxytag: member="app.h::ast_play_and_record" ref="a5189403102ce3cae44bd1b1644ee97a2" args="(struct ast_channel *chan, const char *playfile, const char *recordfile, int maxtime_sec, const char *fmt, int *duration, int silencethreshold, int maxsilence_ms, const char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_play_and_record </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>playfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>recordfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxtime_sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>silencethreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxsilence_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Record a file for a max amount of time (in seconds), in a given list of <a class="el" href="structformats.html">formats</a> separated by '|', outputting the duration of the recording, and with a maximum <br/>
 permitted silence time in milliseconds of 'maxsilence' under 'silencethreshold' or use '-1' for either or both parameters for defaults. calls <a class="el" href="app_8h.html#af6428878db94a4adf8136850e6a654f5" title="Unlock a path.">ast_unlock_path()</a> on 'path' if passed. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00960">960</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l00668">__ast_play_and_record()</a>.</p>

<p>Referenced by <a class="el" href="app__followme_8c_source.html#l01003">app_exec()</a>, <a class="el" href="app_8c_source.html#l01439">ast_record_review()</a>, <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>, and <a class="el" href="app__dial_8c_source.html#l01385">setup_privacy_args()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00961"></a>00961 {
<a name="l00962"></a>00962    <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a3a2d88b2b8c4964fac4255816f9dedcf">__ast_play_and_record</a>(chan, playfile, recordfile, maxtime, fmt, duration, 0, <a class="code" href="app__voicemail_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>, <a class="code" href="app__voicemail_8c.html#ad87fa9ba37f50714bc922335b3b7ea91">maxsilence</a>, path, 0, <a class="code" href="app_8c.html#aa4d81f9babb2bb33d249f998a4918577">default_acceptdtmf</a>, <a class="code" href="app_8c.html#ad32d8b985e0bbce48b30bcaeb7d0968a">default_canceldtmf</a>);
<a name="l00963"></a>00963 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7f35e9e75513344d3ed7c56b22b8ea1f"></a><!-- doxytag: member="app.h::ast_play_and_record_full" ref="a7f35e9e75513344d3ed7c56b22b8ea1f" args="(struct ast_channel *chan, const char *playfile, const char *recordfile, int maxtime_sec, const char *fmt, int *duration, int silencethreshold, int maxsilence_ms, const char *path, const char *acceptdtmf, const char *canceldtmf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_play_and_record_full </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>playfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>recordfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxtime_sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>silencethreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxsilence_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>acceptdtmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>canceldtmf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8c_source.html#l00955">955</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l00668">__ast_play_and_record()</a>, and <a class="el" href="strings_8h_source.html#l00072">S_OR</a>.</p>

<p>Referenced by <a class="el" href="app__minivm_8c_source.html#l01378">play_record_review()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00956"></a>00956 {
<a name="l00957"></a>00957    <span class="keywordflow">return</span> <a class="code" href="app_8c.html#a3a2d88b2b8c4964fac4255816f9dedcf">__ast_play_and_record</a>(chan, playfile, recordfile, maxtime, fmt, duration, 0, <a class="code" href="app__voicemail_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>, <a class="code" href="app__voicemail_8c.html#ad87fa9ba37f50714bc922335b3b7ea91">maxsilence</a>, path, 0, <a class="code" href="strings_8h.html#a2faaa16929951bfd2802b7829a100ba2" title="returns the equivalent of logic or for strings: first one if not empty, otherwise...">S_OR</a>(<a class="code" href="chan__agent_8c.html#a97629727ac11792aa963aed4457abde8">acceptdtmf</a>, <a class="code" href="app_8c.html#aa4d81f9babb2bb33d249f998a4918577">default_acceptdtmf</a>), <a class="code" href="strings_8h.html#a2faaa16929951bfd2802b7829a100ba2" title="returns the equivalent of logic or for strings: first one if not empty, otherwise...">S_OR</a>(canceldtmf, <a class="code" href="app_8c.html#ad32d8b985e0bbce48b30bcaeb7d0968a">default_canceldtmf</a>));
<a name="l00958"></a>00958 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abbbec6ab9a303e865a1d1a261152540d"></a><!-- doxytag: member="app.h::ast_play_and_wait" ref="abbbec6ab9a303e865a1d1a261152540d" args="(struct ast_channel *chan, const char *fn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_play_and_wait </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Play a stream and wait for a digit, returning the digit that was pressed. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l00634">634</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="file_8h_source.html#l00047">AST_DIGIT_ANY</a>, <a class="el" href="file_8c_source.html#l00122">ast_stopstream()</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, and <a class="el" href="file_8c_source.html#l01315">ast_waitstream()</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l00668">__ast_play_and_record()</a>, <a class="el" href="app__voicemail_8c_source.html#l11416">advanced_options()</a>, <a class="el" href="app_8c_source.html#l01439">ast_record_review()</a>, <a class="el" href="say_8c_source.html#l07913">ast_say_counted_adjective()</a>, <a class="el" href="say_8c_source.html#l07871">ast_say_counted_noun()</a>, <a class="el" href="app__voicemail_8c_source.html#l11344">dialout()</a>, <a class="el" href="app__voicemail_8c_source.html#l06582">forward_message()</a>, <a class="el" href="app__voicemail_8c_source.html#l06238">get_folder()</a>, <a class="el" href="app__voicemail_8c_source.html#l06279">get_folder2()</a>, <a class="el" href="app__voicemail_8c_source.html#l05141">leave_voicemail()</a>, <a class="el" href="app__minivm_8c_source.html#l01971">minivm_greet_exec()</a>, <a class="el" href="app__voicemail_8c_source.html#l06850">play_message_category()</a>, <a class="el" href="app__voicemail_8c_source.html#l07001">play_message_duration()</a>, <a class="el" href="app__minivm_8c_source.html#l01378">play_record_review()</a>, <a class="el" href="app__voicemail_8c_source.html#l08999">vm_authenticate()</a>, <a class="el" href="app__voicemail_8c_source.html#l08843">vm_browse_messages_en()</a>, <a class="el" href="app__voicemail_8c_source.html#l08897">vm_browse_messages_es()</a>, <a class="el" href="app__voicemail_8c_source.html#l08791">vm_browse_messages_gr()</a>, <a class="el" href="app__voicemail_8c_source.html#l08819">vm_browse_messages_he()</a>, <a class="el" href="app__voicemail_8c_source.html#l08871">vm_browse_messages_it()</a>, <a class="el" href="app__voicemail_8c_source.html#l08923">vm_browse_messages_pt()</a>, <a class="el" href="app__voicemail_8c_source.html#l08949">vm_browse_messages_zh()</a>, <a class="el" href="app__voicemail_8c_source.html#l09099">vm_execmain()</a>, <a class="el" href="app__voicemail_8c_source.html#l06307">vm_forwardoptions()</a>, <a class="el" href="app__voicemail_8c_source.html#l08382">vm_instructions_en()</a>, <a class="el" href="app__voicemail_8c_source.html#l08459">vm_instructions_zh()</a>, <a class="el" href="app__voicemail_8c_source.html#l08323">vm_intro()</a>, <a class="el" href="app__voicemail_8c_source.html#l08224">vm_intro_cs()</a>, <a class="el" href="app__voicemail_8c_source.html#l07920">vm_intro_de()</a>, <a class="el" href="app__voicemail_8c_source.html#l07669">vm_intro_en()</a>, <a class="el" href="app__voicemail_8c_source.html#l07969">vm_intro_es()</a>, <a class="el" href="app__voicemail_8c_source.html#l08067">vm_intro_fr()</a>, <a class="el" href="app__voicemail_8c_source.html#l07468">vm_intro_gr()</a>, <a class="el" href="app__voicemail_8c_source.html#l07602">vm_intro_he()</a>, <a class="el" href="app__voicemail_8c_source.html#l07726">vm_intro_it()</a>, <a class="el" href="app__voicemail_8c_source.html#l07562">vm_intro_multilang()</a>, <a class="el" href="app__voicemail_8c_source.html#l08110">vm_intro_nl()</a>, <a class="el" href="app__voicemail_8c_source.html#l07876">vm_intro_no()</a>, <a class="el" href="app__voicemail_8c_source.html#l07761">vm_intro_pl()</a>, <a class="el" href="app__voicemail_8c_source.html#l08161">vm_intro_pt()</a>, <a class="el" href="app__voicemail_8c_source.html#l08022">vm_intro_pt_BR()</a>, <a class="el" href="app__voicemail_8c_source.html#l07832">vm_intro_se()</a>, <a class="el" href="app__voicemail_8c_source.html#l08285">vm_intro_zh()</a>, <a class="el" href="app__voicemail_8c_source.html#l08493">vm_newuser()</a>, <a class="el" href="app__voicemail_8c_source.html#l08588">vm_options()</a>, <a class="el" href="app__voicemail_8c_source.html#l07433">vm_play_folder_name()</a>, <a class="el" href="app__voicemail_8c_source.html#l07386">vm_play_folder_name_gr()</a>, <a class="el" href="app__voicemail_8c_source.html#l07404">vm_play_folder_name_pl()</a>, <a class="el" href="app__voicemail_8c_source.html#l07420">vm_play_folder_name_ua()</a>, <a class="el" href="app__voicemail_8c_source.html#l08725">vm_tempgreeting()</a>, and <a class="el" href="app__voicemail_8c_source.html#l10006">vmauthenticate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00635"></a>00635 {
<a name="l00636"></a>00636    <span class="keywordtype">int</span> d = 0;
<a name="l00637"></a>00637 
<a name="l00638"></a>00638    <span class="keywordflow">if</span> ((d = <a class="code" href="file_8h.html#a67c7e271b4ca70aca6d48fd48d121857" title="Streams a file.">ast_streamfile</a>(chan, fn, chan-&gt;language))) {
<a name="l00639"></a>00639       <span class="keywordflow">return</span> d;
<a name="l00640"></a>00640    }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642    d = <a class="code" href="file_8h.html#affc21cb57c6bf72a2cb7ec8a379b2137" title="Waits for a stream to stop or digit to be pressed.">ast_waitstream</a>(chan, <a class="code" href="file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>);
<a name="l00643"></a>00643 
<a name="l00644"></a>00644    <a class="code" href="file_8h.html#a3092bf11d4bba66f646562759608b1bc" title="Stops a stream.">ast_stopstream</a>(chan);
<a name="l00645"></a>00645 
<a name="l00646"></a>00646    <span class="keywordflow">return</span> d;
<a name="l00647"></a>00647 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac5aea5ca8a190e3a89d29b74a09cdb3e"></a><!-- doxytag: member="app.h::ast_read_textfile" ref="ac5aea5ca8a190e3a89d29b74a09cdb3e" args="(const char *file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_read_textfile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>file</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a file into asterisk. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01742">1742</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="astmm_8h_source.html#l00081">ast_malloc</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="app_8c_source.html#l01270">path_lock::fd</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="func__env_8c_source.html#l00163">file_read()</a>, and <a class="el" href="app__readfile_8c_source.html#l00070">readfile_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01743"></a>01743 {
<a name="l01744"></a>01744    <span class="keywordtype">int</span> <a class="code" href="structlinear__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, count = 0, res;
<a name="l01745"></a>01745    <span class="keywordtype">char</span> *output = NULL;
<a name="l01746"></a>01746    <span class="keyword">struct </span>stat filesize;
<a name="l01747"></a>01747 
<a name="l01748"></a>01748    <span class="keywordflow">if</span> (stat(filename, &amp;filesize) == -1) {
<a name="l01749"></a>01749       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error can&apos;t stat %s\n&quot;</span>, filename);
<a name="l01750"></a>01750       <span class="keywordflow">return</span> NULL;
<a name="l01751"></a>01751    }
<a name="l01752"></a>01752 
<a name="l01753"></a>01753    count = filesize.st_size + 1;
<a name="l01754"></a>01754 
<a name="l01755"></a>01755    <span class="keywordflow">if</span> ((fd = open(filename, O_RDONLY)) &lt; 0) {
<a name="l01756"></a>01756       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot open file &apos;%s&apos; for reading: %s\n&quot;</span>, filename, strerror(errno));
<a name="l01757"></a>01757       <span class="keywordflow">return</span> NULL;
<a name="l01758"></a>01758    }
<a name="l01759"></a>01759 
<a name="l01760"></a>01760    <span class="keywordflow">if</span> ((output = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(count))) {
<a name="l01761"></a>01761       res = read(fd, output, count - 1);
<a name="l01762"></a>01762       <span class="keywordflow">if</span> (res == count - 1) {
<a name="l01763"></a>01763          output[res] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01764"></a>01764       } <span class="keywordflow">else</span> {
<a name="l01765"></a>01765          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Short read of %s (%d of %d): %s\n&quot;</span>, filename, res, count - 1, strerror(errno));
<a name="l01766"></a>01766          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(output);
<a name="l01767"></a>01767          output = NULL;
<a name="l01768"></a>01768       }
<a name="l01769"></a>01769    }
<a name="l01770"></a>01770 
<a name="l01771"></a>01771    close(fd);
<a name="l01772"></a>01772 
<a name="l01773"></a>01773    <span class="keywordflow">return</span> output;
<a name="l01774"></a>01774 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a88b6ee77eea0c8a6cc0a315e1c1fc815"></a><!-- doxytag: member="app.h::ast_record_review" ref="a88b6ee77eea0c8a6cc0a315e1c1fc815" args="(struct ast_channel *chan, const char *playfile, const char *recordfile, int maxtime, const char *fmt, int *duration, const char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_record_review </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>playfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>recordfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxtime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allow to record <a class="el" href="structmessage.html">message</a> and have a review option. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01439">1439</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="file_8h_source.html#l00047">AST_DIGIT_ANY</a>, <a class="el" href="dsp_8c_source.html#l01707">ast_dsp_get_threshold_from_settings()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="app_8c_source.html#l00960">ast_play_and_record()</a>, <a class="el" href="app_8c_source.html#l00634">ast_play_and_wait()</a>, <a class="el" href="file_8c_source.html#l01342">ast_stream_and_wait()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="channel_8c_source.html#l02400">ast_waitfordigit()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="app__voicemail_8c_source.html#l00715">maxsilence</a>, <a class="el" href="app__voicemail_8c_source.html#l00718">silencethreshold</a>, and <a class="el" href="dsp_8h_source.html#l00064">THRESHOLD_SILENCE</a>.</p>

<p>Referenced by <a class="el" href="app__meetme_8c_source.html#l01998">conf_run()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01440"></a>01440 {
<a name="l01441"></a>01441    <span class="keywordtype">int</span> <a class="code" href="app__voicemail_8c.html#abebd9f51e7ff2f4d68f3952210219b4e">silencethreshold</a>;
<a name="l01442"></a>01442    <span class="keywordtype">int</span> <a class="code" href="app__voicemail_8c.html#ad87fa9ba37f50714bc922335b3b7ea91">maxsilence</a> = 0;
<a name="l01443"></a>01443    <span class="keywordtype">int</span> res = 0;
<a name="l01444"></a>01444    <span class="keywordtype">int</span> cmd = 0;
<a name="l01445"></a>01445    <span class="keywordtype">int</span> max_attempts = 3;
<a name="l01446"></a>01446    <span class="keywordtype">int</span> attempts = 0;
<a name="l01447"></a>01447    <span class="keywordtype">int</span> recorded = 0;
<a name="l01448"></a>01448    <span class="keywordtype">int</span> message_exists = 0;
<a name="l01449"></a>01449    <span class="comment">/* Note that urgent and private are for flagging messages as such in the future */</span>
<a name="l01450"></a>01450 
<a name="l01451"></a>01451    <span class="comment">/* barf if no pointer passed to store duration in */</span>
<a name="l01452"></a>01452    <span class="keywordflow">if</span> (!duration) {
<a name="l01453"></a>01453       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error ast_record_review called without duration pointer\n&quot;</span>);
<a name="l01454"></a>01454       <span class="keywordflow">return</span> -1;
<a name="l01455"></a>01455    }
<a name="l01456"></a>01456 
<a name="l01457"></a>01457    cmd = <span class="charliteral">&apos;3&apos;</span>;   <span class="comment">/* Want to start by recording */</span>
<a name="l01458"></a>01458 
<a name="l01459"></a>01459    silencethreshold = <a class="code" href="dsp_8h.html#aab28c68838eaed4e0c89460a4e554cca" title="Get silence threshold from dsp.conf.">ast_dsp_get_threshold_from_settings</a>(<a class="code" href="dsp_8h.html#a11a8ce2b7eba2230cab37aad708d9abfa40278495f8621707b864e57e1110d20f">THRESHOLD_SILENCE</a>);
<a name="l01460"></a>01460 
<a name="l01461"></a>01461    <span class="keywordflow">while</span> ((cmd &gt;= 0) &amp;&amp; (cmd != <span class="charliteral">&apos;t&apos;</span>)) {
<a name="l01462"></a>01462       <span class="keywordflow">switch</span> (cmd) {
<a name="l01463"></a>01463       <span class="keywordflow">case</span> <span class="charliteral">&apos;1&apos;</span>:
<a name="l01464"></a>01464          <span class="keywordflow">if</span> (!message_exists) {
<a name="l01465"></a>01465             <span class="comment">/* In this case, 1 is to record a message */</span>
<a name="l01466"></a>01466             cmd = <span class="charliteral">&apos;3&apos;</span>;
<a name="l01467"></a>01467             <span class="keywordflow">break</span>;
<a name="l01468"></a>01468          } <span class="keywordflow">else</span> {
<a name="l01469"></a>01469             <a class="code" href="file_8h.html#a95b94a020720147325a486e210b36775" title="stream file until digit If the file name is non-empty, try to play it.">ast_stream_and_wait</a>(chan, <span class="stringliteral">&quot;vm-msgsaved&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01470"></a>01470             cmd = <span class="charliteral">&apos;t&apos;</span>;
<a name="l01471"></a>01471             <span class="keywordflow">return</span> res;
<a name="l01472"></a>01472          }
<a name="l01473"></a>01473       <span class="keywordflow">case</span> <span class="charliteral">&apos;2&apos;</span>:
<a name="l01474"></a>01474          <span class="comment">/* Review */</span>
<a name="l01475"></a>01475          <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Reviewing the recording\n&quot;</span>);
<a name="l01476"></a>01476          cmd = <a class="code" href="file_8h.html#a95b94a020720147325a486e210b36775" title="stream file until digit If the file name is non-empty, try to play it.">ast_stream_and_wait</a>(chan, recordfile, <a class="code" href="file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>);
<a name="l01477"></a>01477          <span class="keywordflow">break</span>;
<a name="l01478"></a>01478       <span class="keywordflow">case</span> <span class="charliteral">&apos;3&apos;</span>:
<a name="l01479"></a>01479          message_exists = 0;
<a name="l01480"></a>01480          <span class="comment">/* Record */</span>
<a name="l01481"></a>01481          <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;R%secording\n&quot;</span>, recorded == 1 ? <span class="stringliteral">&quot;e-r&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l01482"></a>01482          recorded = 1;
<a name="l01483"></a>01483          <span class="keywordflow">if</span> ((cmd = <a class="code" href="app_8h.html#a5189403102ce3cae44bd1b1644ee97a2" title="Record a file for a max amount of time (in seconds), in a given list of formats separated...">ast_play_and_record</a>(chan, playfile, recordfile, maxtime, fmt, duration, silencethreshold, maxsilence, path)) == -1) {
<a name="l01484"></a>01484             <span class="comment">/* User has hung up, no options to give */</span>
<a name="l01485"></a>01485             <span class="keywordflow">return</span> cmd;
<a name="l01486"></a>01486          }
<a name="l01487"></a>01487          <span class="keywordflow">if</span> (cmd == <span class="charliteral">&apos;0&apos;</span>) {
<a name="l01488"></a>01488             <span class="keywordflow">break</span>;
<a name="l01489"></a>01489          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <span class="charliteral">&apos;*&apos;</span>) {
<a name="l01490"></a>01490             <span class="keywordflow">break</span>;
<a name="l01491"></a>01491          } <span class="keywordflow">else</span> {
<a name="l01492"></a>01492             <span class="comment">/* If all is well, a message exists */</span>
<a name="l01493"></a>01493             message_exists = 1;
<a name="l01494"></a>01494             cmd = 0;
<a name="l01495"></a>01495          }
<a name="l01496"></a>01496          <span class="keywordflow">break</span>;
<a name="l01497"></a>01497       <span class="keywordflow">case</span> <span class="charliteral">&apos;4&apos;</span>:
<a name="l01498"></a>01498       <span class="keywordflow">case</span> <span class="charliteral">&apos;5&apos;</span>:
<a name="l01499"></a>01499       <span class="keywordflow">case</span> <span class="charliteral">&apos;6&apos;</span>:
<a name="l01500"></a>01500       <span class="keywordflow">case</span> <span class="charliteral">&apos;7&apos;</span>:
<a name="l01501"></a>01501       <span class="keywordflow">case</span> <span class="charliteral">&apos;8&apos;</span>:
<a name="l01502"></a>01502       <span class="keywordflow">case</span> <span class="charliteral">&apos;9&apos;</span>:
<a name="l01503"></a>01503       <span class="keywordflow">case</span> <span class="charliteral">&apos;*&apos;</span>:
<a name="l01504"></a>01504       <span class="keywordflow">case</span> <span class="charliteral">&apos;#&apos;</span>:
<a name="l01505"></a>01505          cmd = <a class="code" href="app_8h.html#abbbec6ab9a303e865a1d1a261152540d" title="Play a stream and wait for a digit, returning the digit that was pressed.">ast_play_and_wait</a>(chan, <span class="stringliteral">&quot;vm-sorry&quot;</span>);
<a name="l01506"></a>01506          <span class="keywordflow">break</span>;
<a name="l01507"></a>01507       <span class="keywordflow">default</span>:
<a name="l01508"></a>01508          <span class="keywordflow">if</span> (message_exists) {
<a name="l01509"></a>01509             cmd = <a class="code" href="app_8h.html#abbbec6ab9a303e865a1d1a261152540d" title="Play a stream and wait for a digit, returning the digit that was pressed.">ast_play_and_wait</a>(chan, <span class="stringliteral">&quot;vm-review&quot;</span>);
<a name="l01510"></a>01510          } <span class="keywordflow">else</span> {
<a name="l01511"></a>01511             <span class="keywordflow">if</span> (!(cmd = <a class="code" href="app_8h.html#abbbec6ab9a303e865a1d1a261152540d" title="Play a stream and wait for a digit, returning the digit that was pressed.">ast_play_and_wait</a>(chan, <span class="stringliteral">&quot;vm-torerecord&quot;</span>))) {
<a name="l01512"></a>01512                cmd = <a class="code" href="channel_8h.html#a050bec9a4abc1a599b6573a6091b080c" title="Waits for a digit.">ast_waitfordigit</a>(chan, 600);
<a name="l01513"></a>01513             }
<a name="l01514"></a>01514          }
<a name="l01515"></a>01515 
<a name="l01516"></a>01516          <span class="keywordflow">if</span> (!cmd) {
<a name="l01517"></a>01517             cmd = <a class="code" href="channel_8h.html#a050bec9a4abc1a599b6573a6091b080c" title="Waits for a digit.">ast_waitfordigit</a>(chan, 6000);
<a name="l01518"></a>01518          }
<a name="l01519"></a>01519          <span class="keywordflow">if</span> (!cmd) {
<a name="l01520"></a>01520             attempts++;
<a name="l01521"></a>01521          }
<a name="l01522"></a>01522          <span class="keywordflow">if</span> (attempts &gt; max_attempts) {
<a name="l01523"></a>01523             cmd = <span class="charliteral">&apos;t&apos;</span>;
<a name="l01524"></a>01524          }
<a name="l01525"></a>01525       }
<a name="l01526"></a>01526    }
<a name="l01527"></a>01527    <span class="keywordflow">if</span> (cmd == <span class="charliteral">&apos;t&apos;</span>) {
<a name="l01528"></a>01528       cmd = 0;
<a name="l01529"></a>01529    }
<a name="l01530"></a>01530    <span class="keywordflow">return</span> cmd;
<a name="l01531"></a>01531 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6de8ef28c39cc39978497de1918bfd70"></a><!-- doxytag: member="app.h::ast_replace_sigchld" ref="a6de8ef28c39cc39978497de1918bfd70" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_replace_sigchld </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Replace the SIGCHLD handler. </p>
<p>Normally, Asterisk has a SIGCHLD handler that is cleaning up all zombie processes from forking elsewhere in Asterisk. However, if you want to wait*() on the process to retrieve information about it's exit status, then this signal handler needs to be temporarily replaced.</p>
<p>Code that executes this function *must* call <a class="el" href="app_8h.html#ad7c2a7da4125347c06d9719580731228" title="Restore the SIGCHLD handler.">ast_unreplace_sigchld()</a> after it is finished doing the wait*(). </p>

<p>Definition at line <a class="el" href="asterisk_8c_source.html#l00973">973</a> of file <a class="el" href="asterisk_8c_source.html">asterisk.c</a>.</p>

<p>References <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="asterisk_8c_source.html#l00962">null_sig_handler()</a>, <a class="el" href="asterisk_8c_source.html#l00970">safe_system_level</a>, <a class="el" href="asterisk_8c_source.html#l00967">safe_system_lock</a>, and <a class="el" href="asterisk_8c_source.html#l00971">safe_system_prev_handler</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l02004">ast_safe_fork()</a>, and <a class="el" href="asterisk_8c_source.html#l01001">ast_safe_system()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00974"></a>00974 {
<a name="l00975"></a>00975    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> level;
<a name="l00976"></a>00976 
<a name="l00977"></a>00977    <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;<a class="code" href="asterisk_8c.html#a9c7c59d291f21aa5325e793a912d9c26">safe_system_lock</a>);
<a name="l00978"></a>00978    level = <a class="code" href="asterisk_8c.html#a36152b6805cc14c6a2a41c2d283b422a" title="Keep track of how many threads are currently trying to wait*() on a child process...">safe_system_level</a>++;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980    <span class="comment">/* only replace the handler if it has not already been done */</span>
<a name="l00981"></a>00981    <span class="keywordflow">if</span> (level == 0)
<a name="l00982"></a>00982       <a class="code" href="asterisk_8c.html#a52058b1d88250497f05cb29ee52c5d4d">safe_system_prev_handler</a> = signal(SIGCHLD, <a class="code" href="asterisk_8c.html#a95f3142d76995634e7f13cf69fbb4543" title="NULL handler so we can collect the child exit status.">null_sig_handler</a>);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;<a class="code" href="asterisk_8c.html#a9c7c59d291f21aa5325e793a912d9c26">safe_system_lock</a>);
<a name="l00985"></a>00985 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7a4c7e208ffc4d11a1918beb0e920ec0"></a><!-- doxytag: member="app.h::ast_safe_fork" ref="a7a4c7e208ffc4d11a1918beb0e920ec0" args="(int stop_reaper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_safe_fork </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stop_reaper</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Common routine to safely fork without a chance of a signal handler firing badly in the child. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stop_reaper</em>&nbsp;</td><td>flag to determine if sigchld handler is replaced or not </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l02004">2004</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="asterisk_8c_source.html#l00973">ast_replace_sigchld()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="app__externalivr_8c_source.html#l00314">app_exec()</a>, <a class="el" href="app__ices_8c_source.html#l00072">icesencode()</a>, <a class="el" href="res__agi_8c_source.html#l00867">launch_script()</a>, <a class="el" href="app__mp3_8c_source.html#l00067">mp3play()</a>, <a class="el" href="app__nbscat_8c_source.html#l00068">NBScatplay()</a>, <a class="el" href="app__festival_8c_source.html#l00127">send_waveform_to_fd()</a>, <a class="el" href="res__musiconhold_8c_source.html#l00422">spawn_mp3()</a>, <a class="el" href="app__dahdiras_8c_source.html#l00081">spawn_ras()</a>, <a class="el" href="app__rpt_8c_source.html#l01949">statpost()</a>, and <a class="el" href="app__voicemail_8c_source.html#l01050">vm_check_password_shell()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02005"></a>02005 {
<a name="l02006"></a>02006    sigset_t signal_set, old_set;
<a name="l02007"></a>02007    <span class="keywordtype">int</span> pid;
<a name="l02008"></a>02008 
<a name="l02009"></a>02009    <span class="comment">/* Don&apos;t let the default signal handler for children reap our status */</span>
<a name="l02010"></a>02010    <span class="keywordflow">if</span> (stop_reaper) {
<a name="l02011"></a>02011       <a class="code" href="app_8h.html#a6de8ef28c39cc39978497de1918bfd70" title="Replace the SIGCHLD handler.">ast_replace_sigchld</a>();
<a name="l02012"></a>02012    }
<a name="l02013"></a>02013 
<a name="l02014"></a>02014    sigfillset(&amp;signal_set);
<a name="l02015"></a>02015    pthread_sigmask(SIG_BLOCK, &amp;signal_set, &amp;old_set);
<a name="l02016"></a>02016 
<a name="l02017"></a>02017    pid = fork();
<a name="l02018"></a>02018 
<a name="l02019"></a>02019    <span class="keywordflow">if</span> (pid != 0) {
<a name="l02020"></a>02020       <span class="comment">/* Fork failed or parent */</span>
<a name="l02021"></a>02021       pthread_sigmask(SIG_SETMASK, &amp;old_set, NULL);
<a name="l02022"></a>02022       <span class="keywordflow">return</span> pid;
<a name="l02023"></a>02023    } <span class="keywordflow">else</span> {
<a name="l02024"></a>02024       <span class="comment">/* Child */</span>
<a name="l02025"></a>02025 <span class="preprocessor">#ifdef HAVE_CAP</span>
<a name="l02026"></a>02026 <span class="preprocessor"></span>      cap_t cap = cap_from_text(<span class="stringliteral">&quot;cap_net_admin-eip&quot;</span>);
<a name="l02027"></a>02027 
<a name="l02028"></a>02028       <span class="keywordflow">if</span> (cap_set_proc(cap)) {
<a name="l02029"></a>02029          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to remove capabilities.\n&quot;</span>);
<a name="l02030"></a>02030       }
<a name="l02031"></a>02031       cap_free(cap);
<a name="l02032"></a>02032 <span class="preprocessor">#endif</span>
<a name="l02033"></a>02033 <span class="preprocessor"></span>
<a name="l02034"></a>02034       <span class="comment">/* Before we unblock our signals, return our trapped signals back to the defaults */</span>
<a name="l02035"></a>02035       signal(SIGHUP, SIG_DFL);
<a name="l02036"></a>02036       signal(SIGCHLD, SIG_DFL);
<a name="l02037"></a>02037       signal(SIGINT, SIG_DFL);
<a name="l02038"></a>02038       signal(SIGURG, SIG_DFL);
<a name="l02039"></a>02039       signal(SIGTERM, SIG_DFL);
<a name="l02040"></a>02040       signal(SIGPIPE, SIG_DFL);
<a name="l02041"></a>02041       signal(SIGXFSZ, SIG_DFL);
<a name="l02042"></a>02042 
<a name="l02043"></a>02043       <span class="comment">/* unblock important signal handlers */</span>
<a name="l02044"></a>02044       <span class="keywordflow">if</span> (pthread_sigmask(SIG_UNBLOCK, &amp;signal_set, NULL)) {
<a name="l02045"></a>02045          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;unable to unblock signals: %s\n&quot;</span>, strerror(errno));
<a name="l02046"></a>02046          _exit(1);
<a name="l02047"></a>02047       }
<a name="l02048"></a>02048 
<a name="l02049"></a>02049       <span class="keywordflow">return</span> pid;
<a name="l02050"></a>02050    }
<a name="l02051"></a>02051 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1044fae6847dc8986a212af0af492a23"></a><!-- doxytag: member="app.h::ast_safe_fork_cleanup" ref="a1044fae6847dc8986a212af0af492a23" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_safe_fork_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Common routine to cleanup after fork'ed process is complete (if reaping was stopped). </p>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l02053">2053</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="asterisk_8c_source.html#l00987">ast_unreplace_sigchld()</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l03212">agi_exec_full()</a>, and <a class="el" href="app__dahdiras_8c_source.html#l00132">run_ras()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02054"></a>02054 {
<a name="l02055"></a>02055    <a class="code" href="app_8h.html#ad7c2a7da4125347c06d9719580731228" title="Restore the SIGCHLD handler.">ast_unreplace_sigchld</a>();
<a name="l02056"></a>02056 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9fb5cf0385848033ee3e98625e5f9784"></a><!-- doxytag: member="app.h::ast_safe_system" ref="a9fb5cf0385848033ee3e98625e5f9784" args="(const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_safe_system </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Safely spawn an external program while closing file descriptors. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This replaces the <b>system</b> call in all Asterisk modules </dd></dl>

<p>Definition at line <a class="el" href="asterisk_8c_source.html#l01001">1001</a> of file <a class="el" href="asterisk_8c_source.html">asterisk.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l01982">ast_close_fds_above_n()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="options_8h_source.html#l00102">ast_opt_high_priority</a>, <a class="el" href="asterisk_8c_source.html#l00973">ast_replace_sigchld()</a>, <a class="el" href="asterisk_8c_source.html#l01504">ast_set_priority()</a>, <a class="el" href="asterisk_8c_source.html#l00987">ast_unreplace_sigchld()</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="app__jack_8c_source.html#l00141">status</a>, <a class="el" href="private_8h_source.html#l00108">WEXITSTATUS</a>, and <a class="el" href="private_8h_source.html#l00105">WIFEXITED</a>.</p>

<p>Referenced by <a class="el" href="app__voicemail_8c_source.html#l04432">add_email_attachment()</a>, <a class="el" href="app__alarmreceiver_8c_source.html#l00567">alarmreceiver_exec()</a>, <a class="el" href="res__monitor_8c_source.html#l00291">ast_monitor_stop()</a>, <a class="el" href="asterisk_8c_source.html#l01728">consolehandler()</a>, <a class="el" href="file_8c_source.html#l00290">filestream_destructor()</a>, <a class="el" href="app__mixmonitor_8c_source.html#l00280">mixmonitor_thread()</a>, <a class="el" href="chan__dahdi_8c_source.html#l02940">notify_message()</a>, <a class="el" href="config_8c_source.html#l00922">process_text_line()</a>, <a class="el" href="asterisk_8c_source.html#l01746">remoteconsolehandler()</a>, <a class="el" href="logger_8c_source.html#l00500">rotate_file()</a>, <a class="el" href="app__minivm_8c_source.html#l01510">run_externnotify()</a>, <a class="el" href="app__minivm_8c_source.html#l01027">sendmail()</a>, <a class="el" href="app__voicemail_8c_source.html#l04513">sendpage()</a>, <a class="el" href="app__system_8c_source.html#l00103">system_exec_helper()</a>, and <a class="el" href="app__voicemail_8c_source.html#l01427">vm_change_password_shell()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01002"></a>01002 {
<a name="l01003"></a>01003    pid_t pid;
<a name="l01004"></a>01004    <span class="keywordtype">int</span> res;
<a name="l01005"></a>01005    <span class="keyword">struct </span>rusage rusage;
<a name="l01006"></a>01006    <span class="keywordtype">int</span> <a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 <span class="preprocessor">#if defined(HAVE_WORKING_FORK) || defined(HAVE_WORKING_VFORK)</span>
<a name="l01009"></a>01009 <span class="preprocessor"></span>   <a class="code" href="app_8h.html#a6de8ef28c39cc39978497de1918bfd70" title="Replace the SIGCHLD handler.">ast_replace_sigchld</a>();
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 <span class="preprocessor">#ifdef HAVE_WORKING_FORK</span>
<a name="l01012"></a>01012 <span class="preprocessor"></span>   pid = fork();
<a name="l01013"></a>01013 <span class="preprocessor">#else</span>
<a name="l01014"></a>01014 <span class="preprocessor"></span>   pid = vfork();
<a name="l01015"></a>01015 <span class="preprocessor">#endif   </span>
<a name="l01016"></a>01016 <span class="preprocessor"></span>
<a name="l01017"></a>01017    <span class="keywordflow">if</span> (pid == 0) {
<a name="l01018"></a>01018 <span class="preprocessor">#ifdef HAVE_CAP</span>
<a name="l01019"></a>01019 <span class="preprocessor"></span>      cap_t cap = cap_from_text(<span class="stringliteral">&quot;cap_net_admin-eip&quot;</span>);
<a name="l01020"></a>01020 
<a name="l01021"></a>01021       <span class="keywordflow">if</span> (cap_set_proc(cap)) {
<a name="l01022"></a>01022          <span class="comment">/* Careful with order! Logging cannot happen after we close FDs */</span>
<a name="l01023"></a>01023          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to remove capabilities.\n&quot;</span>);
<a name="l01024"></a>01024       }
<a name="l01025"></a>01025       cap_free(cap);
<a name="l01026"></a>01026 <span class="preprocessor">#endif</span>
<a name="l01027"></a>01027 <span class="preprocessor"></span><span class="preprocessor">#ifdef HAVE_WORKING_FORK</span>
<a name="l01028"></a>01028 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#a8445b47cb18dde73b1b233358a25ed68">ast_opt_high_priority</a>)
<a name="l01029"></a>01029          <a class="code" href="asterisk_8h.html#ad649acedd512a45c748a440e78a281c9" title="We set ourselves to a high priority, that we might pre-empt everything else. If your...">ast_set_priority</a>(0);
<a name="l01030"></a>01030       <span class="comment">/* Close file descriptors and launch system command */</span>
<a name="l01031"></a>01031       <a class="code" href="app_8h.html#afcbfdd6dfc8c5f0f549b0a5d7e263e97" title="Common routine for child processes, to close all fds prior to exec(2).">ast_close_fds_above_n</a>(STDERR_FILENO);
<a name="l01032"></a>01032 <span class="preprocessor">#endif</span>
<a name="l01033"></a>01033 <span class="preprocessor"></span>      execl(<span class="stringliteral">&quot;/bin/sh&quot;</span>, <span class="stringliteral">&quot;/bin/sh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, (<span class="keywordtype">char</span> *) NULL);
<a name="l01034"></a>01034       _exit(1);
<a name="l01035"></a>01035    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid &gt; 0) {
<a name="l01036"></a>01036       <span class="keywordflow">for</span> (;;) {
<a name="l01037"></a>01037          res = wait4(pid, &amp;status, 0, &amp;rusage);
<a name="l01038"></a>01038          <span class="keywordflow">if</span> (res &gt; -1) {
<a name="l01039"></a>01039             res = <a class="code" href="private_8h.html#aa5fda3caf01a15f80a9f2542ccc67b94">WIFEXITED</a>(status) ? <a class="code" href="private_8h.html#a77f17ed4771a558a0f16e5f3aecee222">WEXITSTATUS</a>(status) : -1;
<a name="l01040"></a>01040             <span class="keywordflow">break</span>;
<a name="l01041"></a>01041          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno != EINTR) 
<a name="l01042"></a>01042             <span class="keywordflow">break</span>;
<a name="l01043"></a>01043       }
<a name="l01044"></a>01044    } <span class="keywordflow">else</span> {
<a name="l01045"></a>01045       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Fork failed: %s\n&quot;</span>, strerror(errno));
<a name="l01046"></a>01046       res = -1;
<a name="l01047"></a>01047    }
<a name="l01048"></a>01048 
<a name="l01049"></a>01049    <a class="code" href="app_8h.html#ad7c2a7da4125347c06d9719580731228" title="Restore the SIGCHLD handler.">ast_unreplace_sigchld</a>();
<a name="l01050"></a>01050 <span class="preprocessor">#else </span><span class="comment">/* !defined(HAVE_WORKING_FORK) &amp;&amp; !defined(HAVE_WORKING_VFORK) */</span>
<a name="l01051"></a>01051    res = -1;
<a name="l01052"></a>01052 <span class="preprocessor">#endif</span>
<a name="l01053"></a>01053 <span class="preprocessor"></span>
<a name="l01054"></a>01054    <span class="keywordflow">return</span> res;
<a name="l01055"></a>01055 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaef9c9ee6c9e05a6675201486ea2f02e"></a><!-- doxytag: member="app.h::ast_set_lock_type" ref="aaef9c9ee6c9e05a6675201486ea2f02e" args="(enum AST_LOCK_TYPE type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_set_lock_type </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="app_8h.html#a889fad4c6cc627add80454ae61b53241">AST_LOCK_TYPE</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the type of locks used by <a class="el" href="app_8h.html#a74c57b5a842dcbc15cc991a31f679a13" title="Lock a filesystem path.">ast_lock_path()</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>the locking type to use </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app_8c_source.html#l01402">1402</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>Referenced by <a class="el" href="asterisk_8c_source.html#l02784">ast_readconfig()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01403"></a>01403 {
<a name="l01404"></a>01404    <a class="code" href="app_8c.html#a6bcfb001b39f6049c25a2635de1dc17f">ast_lock_type</a> = <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>;
<a name="l01405"></a>01405 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1528703fa0e2ea11fcab7e04f8e0a6cb"></a><!-- doxytag: member="app.h::ast_str_get_encoded_str" ref="a1528703fa0e2ea11fcab7e04f8e0a6cb" args="(struct ast_str **str, int maxlen, const char *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_str_get_encoded_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__str.html">ast_str</a> **&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>stream</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decode a stream of encoded control or extended ASCII characters. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01955">1955</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l01867">ast_get_encoded_char()</a>, <a class="el" href="strings_8h_source.html#l00488">ast_str_buffer()</a>, <a class="el" href="strings_8h_source.html#l00573">ast_str_make_space()</a>, <a class="el" href="strings_8h_source.html#l00825">ast_str_set()</a>, <a class="el" href="strings_8h_source.html#l00477">ast_str_size()</a>, <a class="el" href="strings_8h_source.html#l00441">ast_str_update()</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, and <a class="el" href="app_8c_source.html#l01269">path_lock::next</a>.</p>

<p>Referenced by <a class="el" href="app__system_8c_source.html#l00103">system_exec_helper()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01956"></a>01956 {
<a name="l01957"></a>01957    <span class="keywordtype">char</span> next, *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l01958"></a>01958    <span class="keywordtype">size_t</span> offset = 0;
<a name="l01959"></a>01959    <span class="keywordtype">size_t</span> consumed;
<a name="l01960"></a>01960 
<a name="l01961"></a>01961    <span class="keywordflow">if</span> (strchr(stream, <span class="charliteral">&apos;\\&apos;</span>)) {
<a name="l01962"></a>01962       <span class="keywordflow">while</span> (!<a class="code" href="app_8h.html#a1e8f73e62b3c2243eca582ee0d8d6147" title="Decode an encoded control or extended ASCII character.">ast_get_encoded_char</a>(stream, &amp;next, &amp;consumed)) {
<a name="l01963"></a>01963          <span class="keywordflow">if</span> (offset + 2 &gt; <a class="code" href="strings_8h.html#ab9726d03e7f9f4746876d71bea28de33" title="Returns the current maximum length (without reallocation) of the current buffer.">ast_str_size</a>(*str) &amp;&amp; maxlen &gt; -1) {
<a name="l01964"></a>01964             <a class="code" href="strings_8h.html#a7f20a4560b028f55b5d723f02f5830cb">ast_str_make_space</a>(str, maxlen &gt; 0 ? maxlen : (<a class="code" href="strings_8h.html#ab9726d03e7f9f4746876d71bea28de33" title="Returns the current maximum length (without reallocation) of the current buffer.">ast_str_size</a>(*str) + 48) * 2 - 48);
<a name="l01965"></a>01965          }
<a name="l01966"></a>01966          <span class="keywordflow">if</span> (offset + 2 &gt; <a class="code" href="strings_8h.html#ab9726d03e7f9f4746876d71bea28de33" title="Returns the current maximum length (without reallocation) of the current buffer.">ast_str_size</a>(*str)) {
<a name="l01967"></a>01967             <span class="keywordflow">break</span>;
<a name="l01968"></a>01968          }
<a name="l01969"></a>01969          buf = <a class="code" href="strings_8h.html#a053bdfc229997a75f112bdd7b995e00b" title="Returns the string buffer within the ast_str buf.">ast_str_buffer</a>(*str);
<a name="l01970"></a>01970          buf[offset++] = next;
<a name="l01971"></a>01971          stream += consumed;
<a name="l01972"></a>01972       }
<a name="l01973"></a>01973       buf = <a class="code" href="strings_8h.html#a053bdfc229997a75f112bdd7b995e00b" title="Returns the string buffer within the ast_str buf.">ast_str_buffer</a>(*str);
<a name="l01974"></a>01974       buf[offset++] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01975"></a>01975       <a class="code" href="strings_8h.html#a8887fcac1220a7528e88efc16f751415" title="Update the length of the buffer, after using ast_str merely as a buffer.">ast_str_update</a>(*str);
<a name="l01976"></a>01976    } <span class="keywordflow">else</span> {
<a name="l01977"></a>01977       <a class="code" href="strings_8h.html#a4a3222f04f84c80a1d70f51e2dff00ea" title="Set a dynamic string using variable arguments.">ast_str_set</a>(str, maxlen, <span class="stringliteral">&quot;%s&quot;</span>, stream);
<a name="l01978"></a>01978    }
<a name="l01979"></a>01979    <span class="keywordflow">return</span> 0;
<a name="l01980"></a>01980 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0c13141712b0c226b6000d659024b1b8"></a><!-- doxytag: member="app.h::AST_THREADSTORAGE_EXTERNAL" ref="a0c13141712b0c226b6000d659024b1b8" args="(ast_str_thread_global_buf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_THREADSTORAGE_EXTERNAL </td>
          <td>(</td>
          <td class="paramtype">ast_str_thread_global_buf&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a65d1324f7632267a35a6d933fdbdc6f9"></a><!-- doxytag: member="app.h::ast_uninstall_vm_functions" ref="a65d1324f7632267a35a6d933fdbdc6f9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_uninstall_vm_functions </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="app_8c_source.html#l00225">225</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a>, <a class="el" href="app_8c.html#a8951323b5b85c9a255e97c181286056c">ast_inboxcount2_func</a>, <a class="el" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a>, <a class="el" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a>, and <a class="el" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a>.</p>

<p>Referenced by <a class="el" href="app__voicemail_8c_source.html#l11280">unload_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00226"></a>00226 {
<a name="l00227"></a>00227    <a class="code" href="app_8c.html#a5fe433cbd1421c19f6bd997fb74778d8">ast_has_voicemail_func</a> = NULL;
<a name="l00228"></a>00228    <a class="code" href="app_8c.html#a2923cea3347f03b8a7cb4779b1962fd2">ast_inboxcount_func</a> = NULL;
<a name="l00229"></a>00229    <a class="code" href="app_8c.html#a8951323b5b85c9a255e97c181286056c">ast_inboxcount2_func</a> = NULL;
<a name="l00230"></a>00230    <a class="code" href="app_8c.html#afed3b3e5f05182892712ca3064c9b7ed">ast_messagecount_func</a> = NULL;
<a name="l00231"></a>00231    <a class="code" href="app_8c.html#a826d29acb5b5a2bcf5a03b04bf841559">ast_sayname_func</a> = NULL;
<a name="l00232"></a>00232 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af6428878db94a4adf8136850e6a654f5"></a><!-- doxytag: member="app.h::ast_unlock_path" ref="af6428878db94a4adf8136850e6a654f5" args="(const char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_unlock_path </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unlock a path. </p>

<p>Definition at line <a class="el" href="app_8c_source.html#l01423">1423</a> of file <a class="el" href="app_8c_source.html">app.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00280">AST_LOCK_TYPE_FLOCK</a>, <a class="el" href="app_8h_source.html#l00279">AST_LOCK_TYPE_LOCKFILE</a>, <a class="el" href="app_8c_source.html#l01372">ast_unlock_path_flock()</a>, and <a class="el" href="app_8c_source.html#l01250">ast_unlock_path_lockfile()</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l00668">__ast_play_and_record()</a>, <a class="el" href="app__minivm_8c_source.html#l03036">access_counter_file()</a>, <a class="el" href="app__voicemail_8c_source.html#l07296">close_mailbox()</a>, <a class="el" href="app__voicemail_8c_source.html#l04884">copy_message()</a>, <a class="el" href="app__voicemail_8c_source.html#l03627">count_messages()</a>, <a class="el" href="app__voicemail_8c_source.html#l05141">leave_voicemail()</a>, <a class="el" href="app__voicemail_8c_source.html#l07253">open_mailbox()</a>, and <a class="el" href="app__voicemail_8c_source.html#l05665">save_to_folder()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01424"></a>01424 {
<a name="l01425"></a>01425    <span class="keywordtype">int</span> r = 0;
<a name="l01426"></a>01426 
<a name="l01427"></a>01427    <span class="keywordflow">switch</span> (<a class="code" href="app_8c.html#a6bcfb001b39f6049c25a2635de1dc17f">ast_lock_type</a>) {
<a name="l01428"></a>01428    <span class="keywordflow">case</span> <a class="code" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a599f18fdf355d7530bb754b8c66d6de7">AST_LOCK_TYPE_LOCKFILE</a>:
<a name="l01429"></a>01429       r = <a class="code" href="app_8c.html#a41764988af00a30b8de64b8a37e8228d">ast_unlock_path_lockfile</a>(path);
<a name="l01430"></a>01430       <span class="keywordflow">break</span>;
<a name="l01431"></a>01431    <span class="keywordflow">case</span> <a class="code" href="app_8h.html#a889fad4c6cc627add80454ae61b53241a78cd7e44280d287fc0168a0c31b75e3f">AST_LOCK_TYPE_FLOCK</a>:
<a name="l01432"></a>01432       r = <a class="code" href="app_8c.html#a195e5dc48a8d508fb6d85597ce9df398">ast_unlock_path_flock</a>(path);
<a name="l01433"></a>01433       <span class="keywordflow">break</span>;
<a name="l01434"></a>01434    }
<a name="l01435"></a>01435 
<a name="l01436"></a>01436    <span class="keywordflow">return</span> r;
<a name="l01437"></a>01437 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad7c2a7da4125347c06d9719580731228"></a><!-- doxytag: member="app.h::ast_unreplace_sigchld" ref="ad7c2a7da4125347c06d9719580731228" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_unreplace_sigchld </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Restore the SIGCHLD handler. </p>
<p>This function is called after a call to ast_replace_sigchld. It restores the SIGCHLD handler that cleans up any zombie processes. </p>

<p>Definition at line <a class="el" href="asterisk_8c_source.html#l00987">987</a> of file <a class="el" href="asterisk_8c_source.html">asterisk.c</a>.</p>

<p>References <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="asterisk_8c_source.html#l00970">safe_system_level</a>, <a class="el" href="asterisk_8c_source.html#l00967">safe_system_lock</a>, and <a class="el" href="asterisk_8c_source.html#l00971">safe_system_prev_handler</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l02053">ast_safe_fork_cleanup()</a>, and <a class="el" href="asterisk_8c_source.html#l01001">ast_safe_system()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00988"></a>00988 {
<a name="l00989"></a>00989    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> level;
<a name="l00990"></a>00990 
<a name="l00991"></a>00991    <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;<a class="code" href="asterisk_8c.html#a9c7c59d291f21aa5325e793a912d9c26">safe_system_lock</a>);
<a name="l00992"></a>00992    level = --<a class="code" href="asterisk_8c.html#a36152b6805cc14c6a2a41c2d283b422a" title="Keep track of how many threads are currently trying to wait*() on a child process...">safe_system_level</a>;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994    <span class="comment">/* only restore the handler if we are the last one */</span>
<a name="l00995"></a>00995    <span class="keywordflow">if</span> (level == 0)
<a name="l00996"></a>00996       signal(SIGCHLD, <a class="code" href="asterisk_8c.html#a52058b1d88250497f05cb29ee52c5d4d">safe_system_prev_handler</a>);
<a name="l00997"></a>00997 
<a name="l00998"></a>00998    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;<a class="code" href="asterisk_8c.html#a9c7c59d291f21aa5325e793a912d9c26">safe_system_lock</a>);
<a name="l00999"></a>00999 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:18:53 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
