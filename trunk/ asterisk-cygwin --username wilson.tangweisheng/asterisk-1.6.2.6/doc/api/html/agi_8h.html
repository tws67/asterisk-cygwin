<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:18:51 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>agi.h File Reference</h1>
<p>AGI Extension interfaces - Asterisk Gateway Interface.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="xmldoc_8h_source.html">asterisk/xmldoc.h</a>&quot;</code><br/>

<p><a href="agi_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structagi__command.html">agi_command</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structagi__state.html">agi_state</a></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structagi__state.html">agi_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="agi_8h.html#a39b22d4db1429ead3b34f15168814ce8">AGI</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="agi_8h.html#afe81c085edf65781e742c210d04faee7">ast_agi_register</a> (struct <a class="el" href="structast__module.html">ast_module</a> *mod, <a class="el" href="structagi__command.html">agi_command</a> *cmd) attribute_weak</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registers an AGI command.  <a href="#afe81c085edf65781e742c210d04faee7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="agi_8h.html#a8025b9327d8a870c7455a29355222b9c">ast_agi_register_multiple</a> (struct <a class="el" href="structast__module.html">ast_module</a> *mod, struct <a class="el" href="structagi__command.html">agi_command</a> *cmd, unsigned int len) attribute_weak</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registers a <a class="el" href="structgroup.html">group</a> of AGI commands, provided as an array of struct <a class="el" href="structagi__command.html">agi_command</a> entries.  <a href="#a8025b9327d8a870c7455a29355222b9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="agi_8h.html#a122c100fa81c2500a6d69afa642c2495">ast_agi_send</a> (int fd, struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, char *fmt,...) attribute_weak</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a string of text to an application connected via AGI.  <a href="#a122c100fa81c2500a6d69afa642c2495"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="agi_8h.html#a5c58e70045d4c8668cefc91a29578901">ast_agi_unregister</a> (struct <a class="el" href="structast__module.html">ast_module</a> *mod, <a class="el" href="structagi__command.html">agi_command</a> *cmd) attribute_weak</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregisters an AGI command.  <a href="#a5c58e70045d4c8668cefc91a29578901"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="agi_8h.html#ae36ca908f67e1d7daff5b42c29107ab8">ast_agi_unregister_multiple</a> (struct <a class="el" href="structast__module.html">ast_module</a> *mod, struct <a class="el" href="structagi__command.html">agi_command</a> *cmd, unsigned int len) attribute_weak</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregisters a <a class="el" href="structgroup.html">group</a> of AGI commands, provided as an array of struct <a class="el" href="structagi__command.html">agi_command</a> entries.  <a href="#ae36ca908f67e1d7daff5b42c29107ab8"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>AGI Extension interfaces - Asterisk Gateway Interface. </p>

<p>Definition in file <a class="el" href="agi_8h_source.html">agi.h</a>.</p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a39b22d4db1429ead3b34f15168814ce8"></a><!-- doxytag: member="agi.h::AGI" ref="a39b22d4db1429ead3b34f15168814ce8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structagi__state.html">agi_state</a>  <a class="el" href="structagi__state.html">AGI</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="afe81c085edf65781e742c210d04faee7"></a><!-- doxytag: member="agi.h::ast_agi_register" ref="afe81c085edf65781e742c210d04faee7" args="(struct ast_module *mod, agi_command *cmd) attribute_weak" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_agi_register </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__module.html">ast_module</a> *&nbsp;</td>
          <td class="paramname"> <em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structagi__command.html">agi_command</a> *&nbsp;</td>
          <td class="paramname"> <em>cmd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Registers an AGI command. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mod</em>&nbsp;</td><td>Pointer to the module_info structure for the module that is registering the command </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>Pointer to the descriptor for the command </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 on success, 0 if the command is already registered </dd></dl>

<p>Definition at line <a class="el" href="res__agi_8c_source.html#l02556">2556</a> of file <a class="el" href="res__agi_8c_source.html">res_agi.c</a>.</p>

<p>References <a class="el" href="utils_8c_source.html#l01451">ast_join()</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="loader_8c_source.html#l01163">ast_module_ref()</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8h_source.html#l00079">AST_STATIC_DOC</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="pbx_8h_source.html#l00078">AST_XML_DOC</a>, <a class="el" href="xmldoc_8c_source.html#l01745">ast_xmldoc_build_description()</a>, <a class="el" href="xmldoc_8c_source.html#l01318">ast_xmldoc_build_seealso()</a>, <a class="el" href="xmldoc_8c_source.html#l01740">ast_xmldoc_build_synopsis()</a>, <a class="el" href="xmldoc_8c_source.html#l01020">ast_xmldoc_build_syntax()</a>, <a class="el" href="agi_8h_source.html#l00042">agi_command::cmda</a>, <a class="el" href="agi_8h_source.html#l00057">agi_command::docsrc</a>, <a class="el" href="res__agi_8c_source.html#l02676">find_command()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="res__agi_8c_source.html#l00318">MAX_CMD_LEN</a>, <a class="el" href="agi_8h_source.html#l00059">agi_command::mod</a>, <a class="el" href="agi_8h_source.html#l00055">agi_command::seealso</a>, <a class="el" href="agi_8h_source.html#l00047">agi_command::summary</a>, <a class="el" href="agi_8h_source.html#l00053">agi_command::syntax</a>, and <a class="el" href="agi_8h_source.html#l00049">agi_command::usage</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l02630">ast_agi_register_multiple()</a>, and <a class="el" href="app__stack_8c_source.html#l00669">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02557"></a>02557 {
<a name="l02558"></a>02558    <span class="keywordtype">char</span> fullcmd[<a class="code" href="res__agi_8c.html#a1eb73c104b484cf18752169509cebfe2">MAX_CMD_LEN</a>];
<a name="l02559"></a>02559 
<a name="l02560"></a>02560    <a class="code" href="strings_8h.html#a0c9c27a9e6b4a6d1e2b868525ae3d0c1">ast_join</a>(fullcmd, <span class="keyword">sizeof</span>(fullcmd), cmd-&gt;<a class="code" href="structagi__command.html#a2039373e5e61dcdef31216c7ae2b7153">cmda</a>);
<a name="l02561"></a>02561 
<a name="l02562"></a>02562    <span class="keywordflow">if</span> (!<a class="code" href="res__agi_8c.html#ace45cfd0b2306ec060fa4a788b976125">find_command</a>(cmd-&gt;<a class="code" href="structagi__command.html#a2039373e5e61dcdef31216c7ae2b7153">cmda</a>,1)) {
<a name="l02563"></a>02563       cmd-&gt;<a class="code" href="structagi__command.html#aa871ca3c361d229d4e37edf3c6016cc1">docsrc</a> = <a class="code" href="pbx_8h.html#a8717a951656993c40bd851ebf50f58e3a7273ed64a1fd4a93692986eac376124a">AST_STATIC_DOC</a>;
<a name="l02564"></a>02564       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(cmd-&gt;<a class="code" href="structagi__command.html#a322a4c1fa51c3fb9a98f2d329a90ecfa">summary</a>) &amp;&amp; <a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(cmd-&gt;<a class="code" href="structagi__command.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a>)) {
<a name="l02565"></a>02565 <span class="preprocessor">#ifdef AST_XML_DOCS</span>
<a name="l02566"></a>02566 <span class="preprocessor"></span>         *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#a322a4c1fa51c3fb9a98f2d329a90ecfa">summary</a>) = <a class="code" href="xmldoc_8h.html#a92ab99fc2fa8a31c591531b36d391e3f" title="Generate synopsis documentation from XML.">ast_xmldoc_build_synopsis</a>(<span class="stringliteral">&quot;agi&quot;</span>, fullcmd);
<a name="l02567"></a>02567          *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a>) = <a class="code" href="xmldoc_8h.html#a7e6109ee5ae553d1fb3b6e7a7c4617f9" title="Generate description documentation from XML.">ast_xmldoc_build_description</a>(<span class="stringliteral">&quot;agi&quot;</span>, fullcmd);
<a name="l02568"></a>02568          *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#affcabda568112959a0d397995e46eff0">syntax</a>) = <a class="code" href="xmldoc_8h.html#a54a5b2e3ff1b6b6f06d9bab70e70c924" title="Get the syntax for a specified application or function.">ast_xmldoc_build_syntax</a>(<span class="stringliteral">&quot;agi&quot;</span>, fullcmd);
<a name="l02569"></a>02569          *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#a569b4bafa00f6a7b717316233cbb8f0d">seealso</a>) = <a class="code" href="xmldoc_8h.html#a51987b5bfa995cc9b76c81dd1a1d6ad4" title="Parse the &amp;lt;see-also&amp;gt; node content.">ast_xmldoc_build_seealso</a>(<span class="stringliteral">&quot;agi&quot;</span>, fullcmd);
<a name="l02570"></a>02570          *((<span class="keyword">enum</span> <a class="code" href="pbx_8h.html#a8717a951656993c40bd851ebf50f58e3" title="From where the documentation come from.">ast_doc_src</a> *) &amp;cmd-&gt;<a class="code" href="structagi__command.html#aa871ca3c361d229d4e37edf3c6016cc1">docsrc</a>) = <a class="code" href="pbx_8h.html#a8717a951656993c40bd851ebf50f58e3a24212840b7b1b0e9c1eebc8cfd89ab3e">AST_XML_DOC</a>;
<a name="l02571"></a>02571 <span class="preprocessor">#elif (!defined(HAVE_NULLSAFE_PRINTF))</span>
<a name="l02572"></a>02572 <span class="preprocessor"></span>         *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#a322a4c1fa51c3fb9a98f2d329a90ecfa">summary</a>) = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l02573"></a>02573          *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a>) = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l02574"></a>02574          *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#affcabda568112959a0d397995e46eff0">syntax</a>) = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l02575"></a>02575          *((<span class="keywordtype">char</span> **) &amp;cmd-&gt;<a class="code" href="structagi__command.html#a569b4bafa00f6a7b717316233cbb8f0d">seealso</a>) = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l02576"></a>02576 <span class="preprocessor">#endif</span>
<a name="l02577"></a>02577 <span class="preprocessor"></span>      }
<a name="l02578"></a>02578 
<a name="l02579"></a>02579       cmd-&gt;<a class="code" href="structagi__command.html#a782aff512368932b8d71b3633f88cb04">mod</a> = mod;
<a name="l02580"></a>02580       <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structagi__commands.html">agi_commands</a>);
<a name="l02581"></a>02581       <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="structagi__commands.html">agi_commands</a>, cmd, list);
<a name="l02582"></a>02582       <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structagi__commands.html">agi_commands</a>);
<a name="l02583"></a>02583       <span class="keywordflow">if</span> (mod != <a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self)
<a name="l02584"></a>02584          <a class="code" href="module_8h.html#aa08fcee0b390e15532dd03803c8728c4">ast_module_ref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l02585"></a>02585       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;AGI Command &apos;%s&apos; registered\n&quot;</span>,fullcmd);
<a name="l02586"></a>02586       <span class="keywordflow">return</span> 1;
<a name="l02587"></a>02587    } <span class="keywordflow">else</span> {
<a name="l02588"></a>02588       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Command already registered!\n&quot;</span>);
<a name="l02589"></a>02589       <span class="keywordflow">return</span> 0;
<a name="l02590"></a>02590    }
<a name="l02591"></a>02591 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8025b9327d8a870c7455a29355222b9c"></a><!-- doxytag: member="agi.h::ast_agi_register_multiple" ref="a8025b9327d8a870c7455a29355222b9c" args="(struct ast_module *mod, struct agi_command *cmd, unsigned int len) attribute_weak" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_agi_register_multiple </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__module.html">ast_module</a> *&nbsp;</td>
          <td class="paramname"> <em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structagi__command.html">agi_command</a> *&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Registers a <a class="el" href="structgroup.html">group</a> of AGI commands, provided as an array of struct <a class="el" href="structagi__command.html">agi_command</a> entries. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mod</em>&nbsp;</td><td>Pointer to the module_info structure for the module that is registering the commands </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>Pointer to the first entry in the array of command descriptors </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Length of the array (use the ARRAY_LEN macro to determine this easily) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 on failure</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If any command fails to register, all commands previously registered during the operation will be unregistered. In other words, this function registers all the provided commands, or none of them. </dd></dl>

<p>Definition at line <a class="el" href="res__agi_8c_source.html#l02630">2630</a> of file <a class="el" href="res__agi_8c_source.html">res_agi.c</a>.</p>

<p>References <a class="el" href="res__agi_8c_source.html#l02556">ast_agi_register()</a>, and <a class="el" href="res__agi_8c_source.html#l02593">ast_agi_unregister()</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l03335">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02631"></a>02631 {
<a name="l02632"></a>02632    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, x = 0;
<a name="l02633"></a>02633 
<a name="l02634"></a>02634    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; i++) {
<a name="l02635"></a>02635       <span class="keywordflow">if</span> (<a class="code" href="agi_8h.html#afe81c085edf65781e742c210d04faee7" title="Registers an AGI command.">ast_agi_register</a>(mod, cmd + i) == 1) {
<a name="l02636"></a>02636          x++;
<a name="l02637"></a>02637          <span class="keywordflow">continue</span>;
<a name="l02638"></a>02638       }
<a name="l02639"></a>02639 
<a name="l02640"></a>02640       <span class="comment">/* registration failed, unregister everything</span>
<a name="l02641"></a>02641 <span class="comment">         that had been registered up to that point</span>
<a name="l02642"></a>02642 <span class="comment">      */</span>
<a name="l02643"></a>02643       <span class="keywordflow">for</span> (; x &gt; 0; x--) {
<a name="l02644"></a>02644          <span class="comment">/* we are intentionally ignoring the</span>
<a name="l02645"></a>02645 <span class="comment">            result of ast_agi_unregister() here,</span>
<a name="l02646"></a>02646 <span class="comment">            but it should be safe to do so since</span>
<a name="l02647"></a>02647 <span class="comment">            we just registered these commands and</span>
<a name="l02648"></a>02648 <span class="comment">            the only possible way for unregistration</span>
<a name="l02649"></a>02649 <span class="comment">            to fail is if the command is not</span>
<a name="l02650"></a>02650 <span class="comment">            registered</span>
<a name="l02651"></a>02651 <span class="comment">         */</span>
<a name="l02652"></a>02652          (void) <a class="code" href="agi_8h.html#a5c58e70045d4c8668cefc91a29578901" title="Unregisters an AGI command.">ast_agi_unregister</a>(mod, cmd + x - 1);
<a name="l02653"></a>02653       }
<a name="l02654"></a>02654       <span class="keywordflow">return</span> -1;
<a name="l02655"></a>02655    }
<a name="l02656"></a>02656 
<a name="l02657"></a>02657    <span class="keywordflow">return</span> 0;
<a name="l02658"></a>02658 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a122c100fa81c2500a6d69afa642c2495"></a><!-- doxytag: member="agi.h::ast_agi_send" ref="a122c100fa81c2500a6d69afa642c2495" args="(int fd, struct ast_channel *chan, char *fmt,...) attribute_weak" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_agi_send </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends a string of text to an application connected via AGI. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>The file descriptor for the AGI session (from struct <a class="el" href="structagi__state.html">agi_state</a>) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Pointer to an associated Asterisk channel, if any </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fmt</em>&nbsp;</td><td>printf-style format string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 for success, -1 for failure </dd></dl>

<p>Definition at line <a class="el" href="res__agi_8c_source.html#l00375">375</a> of file <a class="el" href="res__agi_8c_source.html">res_agi.c</a>.</p>

<p>References <a class="el" href="res__agi_8c_source.html#l00372">agi_buf</a>, <a class="el" href="res__agi_8c_source.html#l00373">AGI_BUF_INITSIZE</a>, <a class="el" href="utils_8c_source.html#l01113">ast_carefulwrite()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="strings_8h_source.html#l00488">ast_str_buffer()</a>, <a class="el" href="strings_8h_source.html#l00754">ast_str_set_va()</a>, <a class="el" href="strings_8h_source.html#l00466">ast_str_strlen()</a>, <a class="el" href="strings_8h_source.html#l00637">ast_str_thread_get()</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, and <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l02777">agi_handle_command()</a>, <a class="el" href="res__agi_8c_source.html#l01023">handle_answer()</a>, <a class="el" href="res__agi_8c_source.html#l01035">handle_asyncagi_break()</a>, <a class="el" href="res__agi_8c_source.html#l01671">handle_autohangup()</a>, <a class="el" href="res__agi_8c_source.html#l01786">handle_channelstatus()</a>, <a class="el" href="res__agi_8c_source.html#l01153">handle_controlstreamfile()</a>, <a class="el" href="res__agi_8c_source.html#l01925">handle_dbdel()</a>, <a class="el" href="res__agi_8c_source.html#l01936">handle_dbdeltree()</a>, <a class="el" href="res__agi_8c_source.html#l01881">handle_dbget()</a>, <a class="el" href="res__agi_8c_source.html#l01914">handle_dbput()</a>, <a class="el" href="res__agi_8c_source.html#l01718">handle_exec()</a>, <a class="el" href="res__agi_8c_source.html#l01431">handle_getdata()</a>, <a class="el" href="res__agi_8c_source.html#l01239">handle_getoption()</a>, <a class="el" href="res__agi_8c_source.html#l01818">handle_getvariable()</a>, <a class="el" href="res__agi_8c_source.html#l01841">handle_getvariablefull()</a>, <a class="el" href="app__stack_8c_source.html#l00550">handle_gosub()</a>, <a class="el" href="res__agi_8c_source.html#l01691">handle_hangup()</a>, <a class="el" href="res__agi_8c_source.html#l01980">handle_noop()</a>, <a class="el" href="res__agi_8c_source.html#l01494">handle_recordfile()</a>, <a class="el" href="res__agi_8c_source.html#l01073">handle_recvchar()</a>, <a class="el" href="res__agi_8c_source.html#l01093">handle_recvtext()</a>, <a class="el" href="res__agi_8c_source.html#l01339">handle_sayalpha()</a>, <a class="el" href="res__agi_8c_source.html#l01353">handle_saydate()</a>, <a class="el" href="res__agi_8c_source.html#l01383">handle_saydatetime()</a>, <a class="el" href="res__agi_8c_source.html#l01323">handle_saydigits()</a>, <a class="el" href="res__agi_8c_source.html#l01308">handle_saynumber()</a>, <a class="el" href="res__agi_8c_source.html#l01417">handle_sayphonetic()</a>, <a class="el" href="res__agi_8c_source.html#l01368">handle_saytime()</a>, <a class="el" href="res__agi_8c_source.html#l01137">handle_sendimage()</a>, <a class="el" href="res__agi_8c_source.html#l01054">handle_sendtext()</a>, <a class="el" href="res__agi_8c_source.html#l01765">handle_setcallerid()</a>, <a class="el" href="res__agi_8c_source.html#l01458">handle_setcontext()</a>, <a class="el" href="res__agi_8c_source.html#l01468">handle_setextension()</a>, <a class="el" href="res__agi_8c_source.html#l01986">handle_setmusic()</a>, <a class="el" href="res__agi_8c_source.html#l01477">handle_setpriority()</a>, <a class="el" href="res__agi_8c_source.html#l01809">handle_setvariable()</a>, <a class="el" href="res__agi_8c_source.html#l02082">handle_speechactivategrammar()</a>, <a class="el" href="res__agi_8c_source.html#l01999">handle_speechcreate()</a>, <a class="el" href="res__agi_8c_source.html#l02100">handle_speechdeactivategrammar()</a>, <a class="el" href="res__agi_8c_source.html#l02033">handle_speechdestroy()</a>, <a class="el" href="res__agi_8c_source.html#l02046">handle_speechloadgrammar()</a>, <a class="el" href="res__agi_8c_source.html#l02137">handle_speechrecognize()</a>, <a class="el" href="res__agi_8c_source.html#l02015">handle_speechset()</a>, <a class="el" href="res__agi_8c_source.html#l02064">handle_speechunloadgrammar()</a>, <a class="el" href="res__agi_8c_source.html#l01189">handle_streamfile()</a>, <a class="el" href="res__agi_8c_source.html#l01110">handle_tddmode()</a>, <a class="el" href="res__agi_8c_source.html#l01864">handle_verbose()</a>, <a class="el" href="res__agi_8c_source.html#l01041">handle_waitfordigit()</a>, <a class="el" href="res__agi_8c_source.html#l00779">launch_netscript()</a>, and <a class="el" href="res__agi_8c_source.html#l00981">setup_env()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00376"></a>00376 {
<a name="l00377"></a>00377    <span class="keywordtype">int</span> res = 0;
<a name="l00378"></a>00378    va_list ap;
<a name="l00379"></a>00379    <span class="keyword">struct </span><a class="code" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381    <span class="keywordflow">if</span> (!(buf = <a class="code" href="strings_8h.html#affe8ca3cf8ee9ab07fe29d11bc824ac4" title="Retrieve a thread locally stored dynamic string.">ast_str_thread_get</a>(&amp;<a class="code" href="res__agi_8c.html#a80c30395a4c4fa9d8164ebc3608010e6">agi_buf</a>, <a class="code" href="res__agi_8c.html#aac3502538abd25c04158ea6d06c182d6">AGI_BUF_INITSIZE</a>)))
<a name="l00382"></a>00382       <span class="keywordflow">return</span> -1;
<a name="l00383"></a>00383 
<a name="l00384"></a>00384    va_start(ap, fmt);
<a name="l00385"></a>00385    res = <a class="code" href="strings_8h.html#a7ce3f97dd6d3f76f92304c1f5066c77b" title="Set a dynamic string from a va_list.">ast_str_set_va</a>(&amp;buf, 0, fmt, ap);
<a name="l00386"></a>00386    va_end(ap);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388    <span class="keywordflow">if</span> (res == -1) {
<a name="l00389"></a>00389       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of memory\n&quot;</span>);
<a name="l00390"></a>00390       <span class="keywordflow">return</span> -1;
<a name="l00391"></a>00391    }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393    <span class="keywordflow">if</span> (<a class="code" href="res__agi_8c.html#a9e4d6534e259785ec604fa072e049325">agidebug</a>) {
<a name="l00394"></a>00394       <span class="keywordflow">if</span> (chan) {
<a name="l00395"></a>00395          <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot;&lt;%s&gt;AGI Tx &gt;&gt; %s&quot;</span>, chan-&gt;name, <a class="code" href="strings_8h.html#a053bdfc229997a75f112bdd7b995e00b" title="Returns the string buffer within the ast_str buf.">ast_str_buffer</a>(buf));
<a name="l00396"></a>00396       } <span class="keywordflow">else</span> {
<a name="l00397"></a>00397          <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot;AGI Tx &gt;&gt; %s&quot;</span>, <a class="code" href="strings_8h.html#a053bdfc229997a75f112bdd7b995e00b" title="Returns the string buffer within the ast_str buf.">ast_str_buffer</a>(buf));
<a name="l00398"></a>00398       }
<a name="l00399"></a>00399    }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401    <span class="keywordflow">return</span> <a class="code" href="utils_8h.html#a38faf2987c375335b2773964aabf69b3" title="Try to write string, but wait no more than ms milliseconds before timing out.">ast_carefulwrite</a>(fd, <a class="code" href="strings_8h.html#a053bdfc229997a75f112bdd7b995e00b" title="Returns the string buffer within the ast_str buf.">ast_str_buffer</a>(buf), <a class="code" href="strings_8h.html#a99409c17a1d20e1c3dc00039b7925a2d" title="Returns the current length of the string stored within buf.">ast_str_strlen</a>(buf), 100);
<a name="l00402"></a>00402 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5c58e70045d4c8668cefc91a29578901"></a><!-- doxytag: member="agi.h::ast_agi_unregister" ref="a5c58e70045d4c8668cefc91a29578901" args="(struct ast_module *mod, agi_command *cmd) attribute_weak" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_agi_unregister </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__module.html">ast_module</a> *&nbsp;</td>
          <td class="paramname"> <em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structagi__command.html">agi_command</a> *&nbsp;</td>
          <td class="paramname"> <em>cmd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unregisters an AGI command. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mod</em>&nbsp;</td><td>Pointer to the module_info structure for the module that is unregistering the command </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>Pointer to the descriptor for the command </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 on success, 0 if the command was not already registered </dd></dl>

<p>Definition at line <a class="el" href="res__agi_8c_source.html#l02593">2593</a> of file <a class="el" href="res__agi_8c_source.html">res_agi.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="utils_8c_source.html#l01451">ast_join()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="loader_8c_source.html#l01171">ast_module_unref()</a>, <a class="el" href="linkedlists_8h_source.html#l00564">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00541">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00601">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="pbx_8h_source.html#l00078">AST_XML_DOC</a>, <a class="el" href="agi_8h_source.html#l00042">agi_command::cmda</a>, <a class="el" href="agi_8h_source.html#l00057">agi_command::docsrc</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="res__agi_8c_source.html#l00318">MAX_CMD_LEN</a>, <a class="el" href="agi_8h_source.html#l00055">agi_command::seealso</a>, <a class="el" href="agi_8h_source.html#l00047">agi_command::summary</a>, <a class="el" href="agi_8h_source.html#l00053">agi_command::syntax</a>, and <a class="el" href="agi_8h_source.html#l00049">agi_command::usage</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l02630">ast_agi_register_multiple()</a>, <a class="el" href="res__agi_8c_source.html#l02660">ast_agi_unregister_multiple()</a>, and <a class="el" href="app__stack_8c_source.html#l00653">unload_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02594"></a>02594 {
<a name="l02595"></a>02595    <span class="keyword">struct </span><a class="code" href="structagi__command.html">agi_command</a> *e;
<a name="l02596"></a>02596    <span class="keywordtype">int</span> unregistered = 0;
<a name="l02597"></a>02597    <span class="keywordtype">char</span> fullcmd[<a class="code" href="res__agi_8c.html#a1eb73c104b484cf18752169509cebfe2">MAX_CMD_LEN</a>];
<a name="l02598"></a>02598 
<a name="l02599"></a>02599    <a class="code" href="strings_8h.html#a0c9c27a9e6b4a6d1e2b868525ae3d0c1">ast_join</a>(fullcmd, <span class="keyword">sizeof</span>(fullcmd), cmd-&gt;<a class="code" href="structagi__command.html#a2039373e5e61dcdef31216c7ae2b7153">cmda</a>);
<a name="l02600"></a>02600 
<a name="l02601"></a>02601    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structagi__commands.html">agi_commands</a>);
<a name="l02602"></a>02602    <a class="code" href="linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="structagi__commands.html">agi_commands</a>, e, list) {
<a name="l02603"></a>02603       <span class="keywordflow">if</span> (cmd == e) {
<a name="l02604"></a>02604          <a class="code" href="linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(list);
<a name="l02605"></a>02605          <span class="keywordflow">if</span> (mod != <a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self)
<a name="l02606"></a>02606             <a class="code" href="module_8h.html#ac65fa15b16dbc563a2424af744ab003d">ast_module_unref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l02607"></a>02607 <span class="preprocessor">#ifdef AST_XML_DOCS</span>
<a name="l02608"></a>02608 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structagi__command.html#aa871ca3c361d229d4e37edf3c6016cc1">docsrc</a> == <a class="code" href="pbx_8h.html#a8717a951656993c40bd851ebf50f58e3a24212840b7b1b0e9c1eebc8cfd89ab3e">AST_XML_DOC</a>) {
<a name="l02609"></a>02609             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(e-&gt;<a class="code" href="structagi__command.html#a322a4c1fa51c3fb9a98f2d329a90ecfa">summary</a>);
<a name="l02610"></a>02610             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(e-&gt;<a class="code" href="structagi__command.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a>);
<a name="l02611"></a>02611             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(e-&gt;<a class="code" href="structagi__command.html#affcabda568112959a0d397995e46eff0">syntax</a>);
<a name="l02612"></a>02612             <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(e-&gt;<a class="code" href="structagi__command.html#a569b4bafa00f6a7b717316233cbb8f0d">seealso</a>);
<a name="l02613"></a>02613             e-&gt;<a class="code" href="structagi__command.html#a322a4c1fa51c3fb9a98f2d329a90ecfa">summary</a> = NULL, e-&gt;<a class="code" href="structagi__command.html#aadebe2487a2c5240ab6cd02c83add0bf">usage</a> = NULL;
<a name="l02614"></a>02614             e-&gt;<a class="code" href="structagi__command.html#affcabda568112959a0d397995e46eff0">syntax</a> = NULL, e-&gt;<a class="code" href="structagi__command.html#a569b4bafa00f6a7b717316233cbb8f0d">seealso</a> = NULL;
<a name="l02615"></a>02615          }
<a name="l02616"></a>02616 <span class="preprocessor">#endif</span>
<a name="l02617"></a>02617 <span class="preprocessor"></span>         unregistered=1;
<a name="l02618"></a>02618          <span class="keywordflow">break</span>;
<a name="l02619"></a>02619       }
<a name="l02620"></a>02620    }
<a name="l02621"></a>02621    <a class="code" href="linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l02622"></a>02622    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structagi__commands.html">agi_commands</a>);
<a name="l02623"></a>02623    <span class="keywordflow">if</span> (unregistered)
<a name="l02624"></a>02624       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;AGI Command &apos;%s&apos; unregistered\n&quot;</span>,fullcmd);
<a name="l02625"></a>02625    <span class="keywordflow">else</span>
<a name="l02626"></a>02626       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to unregister command: &apos;%s&apos;!\n&quot;</span>,fullcmd);
<a name="l02627"></a>02627    <span class="keywordflow">return</span> unregistered;
<a name="l02628"></a>02628 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae36ca908f67e1d7daff5b42c29107ab8"></a><!-- doxytag: member="agi.h::ast_agi_unregister_multiple" ref="ae36ca908f67e1d7daff5b42c29107ab8" args="(struct ast_module *mod, struct agi_command *cmd, unsigned int len) attribute_weak" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_agi_unregister_multiple </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__module.html">ast_module</a> *&nbsp;</td>
          <td class="paramname"> <em>mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structagi__command.html">agi_command</a> *&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unregisters a <a class="el" href="structgroup.html">group</a> of AGI commands, provided as an array of struct <a class="el" href="structagi__command.html">agi_command</a> entries. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mod</em>&nbsp;</td><td>Pointer to the module_info structure for the module that is unregistering the commands </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>Pointer to the first entry in the array of command descriptors </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Length of the array (use the ARRAY_LEN macro to determine this easily) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 on failure</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If any command fails to unregister, this function will continue to unregister the remaining commands in the array; it will not reregister the already-unregistered commands. </dd></dl>

<p>Definition at line <a class="el" href="res__agi_8c_source.html#l02660">2660</a> of file <a class="el" href="res__agi_8c_source.html">res_agi.c</a>.</p>

<p>References <a class="el" href="res__agi_8c_source.html#l02593">ast_agi_unregister()</a>.</p>

<p>Referenced by <a class="el" href="res__agi_8c_source.html#l03322">unload_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02661"></a>02661 {
<a name="l02662"></a>02662    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
<a name="l02663"></a>02663    <span class="keywordtype">int</span> res = 0;
<a name="l02664"></a>02664 
<a name="l02665"></a>02665    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; i++) {
<a name="l02666"></a>02666       <span class="comment">/* remember whether any of the unregistration</span>
<a name="l02667"></a>02667 <span class="comment">         attempts failed... there is no recourse if</span>
<a name="l02668"></a>02668 <span class="comment">         any of them do</span>
<a name="l02669"></a>02669 <span class="comment">      */</span>
<a name="l02670"></a>02670       res |= <a class="code" href="agi_8h.html#a5c58e70045d4c8668cefc91a29578901" title="Unregisters an AGI command.">ast_agi_unregister</a>(mod, cmd + i);
<a name="l02671"></a>02671    }
<a name="l02672"></a>02672 
<a name="l02673"></a>02673    <span class="keywordflow">return</span> res;
<a name="l02674"></a>02674 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:18:52 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
