<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:23:09 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_318a70d4e812a718d9ecaeea98fff199.html">res</a>
  </div>
</div>
<div class="contents">
<h1>res_clioriginate.c File Reference</h1>
<p>Originate calls via the CLI.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="module_8h_source.html">asterisk/module.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="frame_8h_source.html">asterisk/frame.h</a>&quot;</code><br/>

<p><a href="res__clioriginate_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a45ba202b05caf39795aeca91b0ae547e">TIMEOUT</a>&nbsp;&nbsp;&nbsp;30</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a099e55fe08cdb97a2a99cf4df6f2c54b">ASTERISK_FILE_VERSION</a> (__FILE__,&quot;$Revision: 163828 $&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a29319dcf2b8b77da098d5e4152cbe64f">handle_orig</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle for orgination app or exten.  <a href="#a29319dcf2b8b77da098d5e4152cbe64f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#af044bd740030fc7b465bcdcb84882ca1">handle_redirect</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a43a0f8620063b769ae5efae11a8377e4">orig_app</a> (int fd, const char *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *<a class="el" href="res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *appdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">orginate a call from the CLI  <a href="#a43a0f8620063b769ae5efae11a8377e4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a2bc6249fad4d4be874fb52cb420b6106">orig_exten</a> (int fd, const char *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, const char *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">orginate from <a class="el" href="structextension.html">extension</a>  <a href="#a2bc6249fad4d4be874fb52cb420b6106"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__module__info.html">ast_module_info</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = AST_MODULE, .flags = AST_MODFLAG_DEFAULT , .<a class="el" href="callerid_8c.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = &quot;Call origination and redirection from the CLI&quot; , .key = &quot;This paragraph is copyright (c) 2006 by Digium, Inc. \In order for your module to load, it must return this \key via a function called \&quot;key\&quot;. Any code which \includes this paragraph must be licensed under the GNU \General Public License <a class="el" href="res__config__pgsql_8c.html#aad880fc4455c253781e8968f2239d56f">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;aefddfaffd51bc118c14a748e96eb9a0&quot; , .load = load_module, .unload = unload_module, }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__module__info.html">ast_module_info</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#ae25b9f3970870610911f8850897e8ead">ast_module_info</a> = &amp;<a class="el" href="res__timing__timerfd_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__clioriginate_8c.html#a8799d195f3e000d0a2d6af6664b22ead">cli_cliorig</a> []</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Originate calls via the CLI. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Russell Bryant &lt;<a href="mailto:russell@digium.com">russell@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a45ba202b05caf39795aeca91b0ae547e"></a><!-- doxytag: member="res_clioriginate.c::TIMEOUT" ref="a45ba202b05caf39795aeca91b0ae547e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIMEOUT&nbsp;&nbsp;&nbsp;30</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The timeout for originated calls, in seconds </p>

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00039">39</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>Referenced by <a class="el" href="res__clioriginate_8c_source.html#l00050">orig_app()</a>, <a class="el" href="res__clioriginate_8c_source.html#l00080">orig_exten()</a>, <a class="el" href="app__rpt_8c_source.html#l10730">rpt()</a>, and <a class="el" href="app__rpt_8c_source.html#l03937">rpt_tele_thread()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a88b7c88fed6b80fd18f34f97757dfc04"></a><!-- doxytag: member="res_clioriginate.c::__reg_module" ref="a88b7c88fed6b80fd18f34f97757dfc04" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00240">240</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

</div>
</div>
<a class="anchor" id="afeab1257bd17282b95875499393a147a"></a><!-- doxytag: member="res_clioriginate.c::__unreg_module" ref="afeab1257bd17282b95875499393a147a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00240">240</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

</div>
</div>
<a class="anchor" id="a099e55fe08cdb97a2a99cf4df6f2c54b"></a><!-- doxytag: member="res_clioriginate.c::ASTERISK_FILE_VERSION" ref="a099e55fe08cdb97a2a99cf4df6f2c54b" args="(__FILE__,&quot;$Revision: 163828 $&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ASTERISK_FILE_VERSION </td>
          <td>(</td>
          <td class="paramtype">__FILE__&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;$Revision: 163828 $&quot;&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a29319dcf2b8b77da098d5e4152cbe64f"></a><!-- doxytag: member="res_clioriginate.c::handle_orig" ref="a29319dcf2b8b77da098d5e4152cbe64f" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* handle_orig </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>handle for orgination app or exten. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>pointer to the CLI structure to initialize </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>operation to execute </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>a</em>&nbsp;</td><td>structure that contains either application or <a class="el" href="structextension.html">extension</a> arguments </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CLI_SUCCESS</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CLI_SHOWUSAGE</em>&nbsp;</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00119">119</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l01378">ast_cli_complete()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="loader_8c_source.html#l01163">ast_module_ref()</a>, <a class="el" href="loader_8c_source.html#l01171">ast_module_unref()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="cli_8h_source.html#l00145">ast_cli_args::n</a>, <a class="el" href="res__clioriginate_8c_source.html#l00050">orig_app()</a>, <a class="el" href="res__clioriginate_8c_source.html#l00080">orig_exten()</a>, <a class="el" href="cli_8h_source.html#l00144">ast_cli_args::pos</a>, <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h_source.html#l00143">ast_cli_args::word</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00120"></a>00120 {
<a name="l00121"></a>00121    <span class="keyword">static</span> <span class="keywordtype">char</span> *choices[] = { <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;extension&quot;</span>, NULL };
<a name="l00122"></a>00122    <span class="keywordtype">char</span> *res;
<a name="l00123"></a>00123    <span class="keywordflow">switch</span> (cmd) {
<a name="l00124"></a>00124    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00125"></a>00125       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;channel originate&quot;</span>;
<a name="l00126"></a>00126       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = 
<a name="l00127"></a>00127          <span class="stringliteral">&quot;  There are two ways to use this command. A call can be originated between a\n&quot;</span>
<a name="l00128"></a>00128          <span class="stringliteral">&quot;channel and a specific application, or between a channel and an extension in\n&quot;</span>
<a name="l00129"></a>00129          <span class="stringliteral">&quot;the dialplan. This is similar to call files or the manager originate action.\n&quot;</span>
<a name="l00130"></a>00130          <span class="stringliteral">&quot;Calls originated with this command are given a timeout of 30 seconds.\n\n&quot;</span>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132          <span class="stringliteral">&quot;Usage1: channel originate &lt;tech/data&gt; application &lt;appname&gt; [appdata]\n&quot;</span>
<a name="l00133"></a>00133          <span class="stringliteral">&quot;  This will originate a call between the specified channel tech/data and the\n&quot;</span>
<a name="l00134"></a>00134          <span class="stringliteral">&quot;given application. Arguments to the application are optional. If the given\n&quot;</span>
<a name="l00135"></a>00135          <span class="stringliteral">&quot;arguments to the application include spaces, all of the arguments to the\n&quot;</span>
<a name="l00136"></a>00136          <span class="stringliteral">&quot;application need to be placed in quotation marks.\n\n&quot;</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138          <span class="stringliteral">&quot;Usage2: channel originate &lt;tech/data&gt; extension [exten@][context]\n&quot;</span>
<a name="l00139"></a>00139          <span class="stringliteral">&quot;  This will originate a call between the specified channel tech/data and the\n&quot;</span>
<a name="l00140"></a>00140          <span class="stringliteral">&quot;given extension. If no context is specified, the &apos;default&apos; context will be\n&quot;</span>
<a name="l00141"></a>00141          <span class="stringliteral">&quot;used. If no extension is given, the &apos;s&apos; extension will be used.\n&quot;</span>;
<a name="l00142"></a>00142       <span class="keywordflow">return</span> NULL;
<a name="l00143"></a>00143    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00144"></a>00144       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#a1910d262855b71da353ed0d07a6c7823">pos</a> != 3)
<a name="l00145"></a>00145          <span class="keywordflow">return</span> NULL;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147       <span class="comment">/* ugly, can be removed when CLI entries have ast_module pointers */</span>
<a name="l00148"></a>00148       <a class="code" href="module_8h.html#aa08fcee0b390e15532dd03803c8728c4">ast_module_ref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l00149"></a>00149       res = <a class="code" href="cli_8h.html#a7d198ac45b2d75bb30eb773582caf89f">ast_cli_complete</a>(a-&gt;<a class="code" href="structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, choices, a-&gt;<a class="code" href="structast__cli__args.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>);
<a name="l00150"></a>00150       <a class="code" href="module_8h.html#ac65fa15b16dbc563a2424af744ab003d">ast_module_unref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152       <span class="keywordflow">return</span> res;
<a name="l00153"></a>00153    }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2]) || <a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3]))
<a name="l00156"></a>00156       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00157"></a>00157 
<a name="l00158"></a>00158    <span class="comment">/* ugly, can be removed when CLI entries have ast_module pointers */</span>
<a name="l00159"></a>00159    <a class="code" href="module_8h.html#aa08fcee0b390e15532dd03803c8728c4">ast_module_ref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161    <span class="keywordflow">if</span> (!strcasecmp(<span class="stringliteral">&quot;application&quot;</span>, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3])) {
<a name="l00162"></a>00162       res = <a class="code" href="res__clioriginate_8c.html#a43a0f8620063b769ae5efae11a8377e4" title="orginate a call from the CLI">orig_app</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2], a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4], a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[5]);  
<a name="l00163"></a>00163    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<span class="stringliteral">&quot;extension&quot;</span>, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3])) {
<a name="l00164"></a>00164       res = <a class="code" href="res__clioriginate_8c.html#a2bc6249fad4d4be874fb52cb420b6106" title="orginate from extension">orig_exten</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2], a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[4]);
<a name="l00165"></a>00165    } <span class="keywordflow">else</span> {
<a name="l00166"></a>00166       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;else&quot;</span>);
<a name="l00167"></a>00167       res = <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00168"></a>00168    }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170    <a class="code" href="module_8h.html#ac65fa15b16dbc563a2424af744ab003d">ast_module_unref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l00171"></a>00171 
<a name="l00172"></a>00172    <span class="keywordflow">return</span> res;
<a name="l00173"></a>00173 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af044bd740030fc7b465bcdcb84882ca1"></a><!-- doxytag: member="res_clioriginate.c::handle_redirect" ref="af044bd740030fc7b465bcdcb84882ca1" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* handle_redirect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000083">Todo:</a></b></dt><dd>It would be nice to be able to redirect 2 <a class="el" href="structchannels.html" title="the list of channels we have. Note that the lock for this list is used for both the...">channels</a> at the same time like you can with AMI redirect. However, it is not possible to acquire two <a class="el" href="structchannels.html" title="the list of channels we have. Note that the lock for this list is used for both the...">channels</a> without the potential for a deadlock with how <a class="el" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> structs are managed today. Once <a class="el" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> is a refcounted object, this command will be able to support that. </dd></dl>
</p>

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00175">175</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="pbx_8c_source.html#l09638">ast_async_parseable_goto()</a>, <a class="el" href="lock_8h_source.html#l02034">ast_channel_unlock</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="cli_8c_source.html#l01390">ast_complete_channels()</a>, <a class="el" href="channel_8c_source.html#l01278">ast_get_channel_by_name_locked()</a>, <a class="el" href="adsistub_8c_source.html#l00049">chan</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="cli_8h_source.html#l00142">ast_cli_args::line</a>, <a class="el" href="cli_8h_source.html#l00145">ast_cli_args::n</a>, <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>, <a class="el" href="cli_8h_source.html#l00144">ast_cli_args::pos</a>, <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h_source.html#l00143">ast_cli_args::word</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00176"></a>00176 {
<a name="l00177"></a>00177    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, *dest;
<a name="l00178"></a>00178    <span class="keyword">struct </span><a class="code" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> *<a class="code" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>;
<a name="l00179"></a>00179    <span class="keywordtype">int</span> res;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181    <span class="keywordflow">switch</span> (cmd) {
<a name="l00182"></a>00182    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00183"></a>00183       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;channel redirect&quot;</span>;
<a name="l00184"></a>00184       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = <span class="stringliteral">&quot;&quot;</span>
<a name="l00185"></a>00185       <span class="stringliteral">&quot;Usage: channel redirect &lt;channel&gt; &lt;[[context,]exten,]priority&gt;\n&quot;</span>
<a name="l00186"></a>00186       <span class="stringliteral">&quot;    Redirect an active channel to a specified extension.\n&quot;</span>;<span class="comment"></span>
<a name="l00187"></a>00187 <span class="comment">      /*! \todo It would be nice to be able to redirect 2 channels at the same</span>
<a name="l00188"></a>00188 <span class="comment">       *  time like you can with AMI redirect.  However, it is not possible to acquire</span>
<a name="l00189"></a>00189 <span class="comment">       *  two channels without the potential for a deadlock with how ast_channel structs</span>
<a name="l00190"></a>00190 <span class="comment">       *  are managed today.  Once ast_channel is a refcounted object, this command</span>
<a name="l00191"></a>00191 <span class="comment">       *  will be able to support that. */</span>
<a name="l00192"></a>00192       <span class="keywordflow">return</span> NULL;
<a name="l00193"></a>00193    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00194"></a>00194       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a3a116acde8f18aa530e5b4a6df420273" title="Command completion for the list of active channels.">ast_complete_channels</a>(a-&gt;<a class="code" href="structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="structast__cli__args.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, a-&gt;<a class="code" href="structast__cli__args.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, 2);
<a name="l00195"></a>00195    }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> + 2) {
<a name="l00198"></a>00198       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00199"></a>00199    }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201    name = a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2];
<a name="l00202"></a>00202    dest = a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3];
<a name="l00203"></a>00203 
<a name="l00204"></a>00204    chan = <a class="code" href="channel_8h.html#a03e8287876c59ddc00f5567064b2b9ca" title="Get channel by name or uniqueid (locks channel).">ast_get_channel_by_name_locked</a>(name);
<a name="l00205"></a>00205    <span class="keywordflow">if</span> (!chan) {
<a name="l00206"></a>00206       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Channel &apos;%s&apos; not found\n&quot;</span>, name);
<a name="l00207"></a>00207       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l00208"></a>00208    }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210    res = <a class="code" href="pbx_8h.html#aa2caee9cd93973d6f2bc806b34f564d6">ast_async_parseable_goto</a>(chan, dest);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212    <a class="code" href="lock_8h.html#a853c07107a1385c83c5d2a0ab7e01d79" title="Unlock a channel. If DEBUG_CHANNEL_LOCKS is defined in the Makefile, print relevant...">ast_channel_unlock</a>(chan);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214    <span class="keywordflow">if</span> (!res) {
<a name="l00215"></a>00215       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Channel &apos;%s&apos; successfully redirected to %s\n&quot;</span>, name, dest);
<a name="l00216"></a>00216    } <span class="keywordflow">else</span> {
<a name="l00217"></a>00217       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Channel &apos;%s&apos; failed to be redirected to %s\n&quot;</span>, name, dest);
<a name="l00218"></a>00218    }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220    <span class="keywordflow">return</span> res ? <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a> : <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00221"></a>00221 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac3382bf6da54c56b37069bd76bbdf4f9"></a><!-- doxytag: member="res_clioriginate.c::load_module" ref="ac3382bf6da54c56b37069bd76bbdf4f9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00233">233</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="cli_8c_source.html#l01927">ast_cli_register_multiple()</a>, <a class="el" href="module_8h_source.html#l00062">AST_MODULE_LOAD_DECLINE</a>, and <a class="el" href="module_8h_source.html#l00061">AST_MODULE_LOAD_SUCCESS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00234"></a>00234 {
<a name="l00235"></a>00235    <span class="keywordtype">int</span> res;
<a name="l00236"></a>00236    res = <a class="code" href="cli_8h.html#aadeef34f3106bb78aeb3414032ad7fb7" title="Register multiple commands.">ast_cli_register_multiple</a>(<a class="code" href="res__clioriginate_8c.html#a8799d195f3e000d0a2d6af6664b22ead">cli_cliorig</a>, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="res__clioriginate_8c.html#a8799d195f3e000d0a2d6af6664b22ead">cli_cliorig</a>));
<a name="l00237"></a>00237    <span class="keywordflow">return</span> res ? <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a> : <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;
<a name="l00238"></a>00238 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a43a0f8620063b769ae5efae11a8377e4"></a><!-- doxytag: member="res_clioriginate.c::orig_app" ref="a43a0f8620063b769ae5efae11a8377e4" args="(int fd, const char *chan, const char *app, const char *appdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* orig_app </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>appdata</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>orginate a call from the CLI </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>file descriptor for cli </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to create type/data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>application you want to run </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>appdata</em>&nbsp;</td><td>data for application </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CLI_SUCCESS</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CLI_SHOWUSAGE</em>&nbsp;</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00050">50</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>References <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="pbx_8c_source.html#l08106">ast_pbx_outgoing_app()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>, and <a class="el" href="res__clioriginate_8c_source.html#l00039">TIMEOUT</a>.</p>

<p>Referenced by <a class="el" href="res__clioriginate_8c_source.html#l00119">handle_orig()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00051"></a>00051 {
<a name="l00052"></a>00052    <span class="keywordtype">char</span> *chantech;
<a name="l00053"></a>00053    <span class="keywordtype">char</span> *chandata;
<a name="l00054"></a>00054    <span class="keywordtype">int</span> reason = 0;
<a name="l00055"></a>00055    
<a name="l00056"></a>00056    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="adsistub_8c.html#ad194d73de26c0d836555e029d245493d">app</a>))
<a name="l00057"></a>00057       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a>00059    chandata = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(<a class="code" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>);
<a name="l00060"></a>00060    
<a name="l00061"></a>00061    chantech = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;chandata, <span class="stringliteral">&quot;/&quot;</span>);
<a name="l00062"></a>00062    <span class="keywordflow">if</span> (!chandata) {
<a name="l00063"></a>00063       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(fd, <span class="stringliteral">&quot;*** No data provided after channel type! ***\n&quot;</span>);
<a name="l00064"></a>00064       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00065"></a>00065    }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067    <a class="code" href="pbx_8h.html#ade584ae5e3eafb878535626ebe79e26d">ast_pbx_outgoing_app</a>(chantech, <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>, chandata, <a class="code" href="res__clioriginate_8c.html#a45ba202b05caf39795aeca91b0ae547e">TIMEOUT</a> * 1000, <a class="code" href="adsistub_8c.html#ad194d73de26c0d836555e029d245493d">app</a>, appdata, &amp;reason, 0, NULL, NULL, NULL, NULL, NULL);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00070"></a>00070 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2bc6249fad4d4be874fb52cb420b6106"></a><!-- doxytag: member="res_clioriginate.c::orig_exten" ref="a2bc6249fad4d4be874fb52cb420b6106" args="(int fd, const char *chan, const char *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* orig_exten </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>orginate from <a class="el" href="structextension.html">extension</a> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fd</em>&nbsp;</td><td>file descriptor for cli </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to create type/data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>contains exten@context </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CLI_SUCCESS</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CLI_SHOWUSAGE</em>&nbsp;</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00080">80</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>References <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="pbx_8c_source.html#l07940">ast_pbx_outgoing_exten()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="chan__alsa_8c_source.html#l00105">context</a>, <a class="el" href="chan__alsa_8c_source.html#l00107">exten</a>, <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>, and <a class="el" href="res__clioriginate_8c_source.html#l00039">TIMEOUT</a>.</p>

<p>Referenced by <a class="el" href="res__clioriginate_8c_source.html#l00119">handle_orig()</a>, and <a class="el" href="features_8c_source.html#l03249">park_call_exec()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081 {
<a name="l00082"></a>00082    <span class="keywordtype">char</span> *chantech;
<a name="l00083"></a>00083    <span class="keywordtype">char</span> *chandata;
<a name="l00084"></a>00084    <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = NULL;
<a name="l00085"></a>00085    <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = NULL;
<a name="l00086"></a>00086    <span class="keywordtype">int</span> reason = 0;
<a name="l00087"></a>00087 
<a name="l00088"></a>00088    chandata = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(<a class="code" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>);
<a name="l00089"></a>00089    
<a name="l00090"></a>00090    chantech = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;chandata, <span class="stringliteral">&quot;/&quot;</span>);
<a name="l00091"></a>00091    <span class="keywordflow">if</span> (!chandata) {
<a name="l00092"></a>00092       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(fd, <span class="stringliteral">&quot;*** No data provided after channel type! ***\n&quot;</span>);
<a name="l00093"></a>00093       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00094"></a>00094    }
<a name="l00095"></a>00095 
<a name="l00096"></a>00096    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>)) {
<a name="l00097"></a>00097       context = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(<a class="code" href="structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>);
<a name="l00098"></a>00098       exten = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;context, <span class="stringliteral">&quot;@&quot;</span>);
<a name="l00099"></a>00099    }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(exten))
<a name="l00102"></a>00102       exten = <span class="stringliteral">&quot;s&quot;</span>;
<a name="l00103"></a>00103    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(context))
<a name="l00104"></a>00104       context = <span class="stringliteral">&quot;default&quot;</span>;
<a name="l00105"></a>00105    
<a name="l00106"></a>00106    <a class="code" href="pbx_8h.html#a7705e0c38bd69f8dceb03861f7527b60">ast_pbx_outgoing_exten</a>(chantech, <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>, chandata, <a class="code" href="res__clioriginate_8c.html#a45ba202b05caf39795aeca91b0ae547e">TIMEOUT</a> * 1000, context, exten, 1, &amp;reason, 0, NULL, NULL, NULL, NULL, NULL);
<a name="l00107"></a>00107 
<a name="l00108"></a>00108    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00109"></a>00109 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad09fa931f468002152a3cc2d5ce25eae"></a><!-- doxytag: member="res_clioriginate.c::unload_module" ref="ad09fa931f468002152a3cc2d5ce25eae" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00228">228</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, and <a class="el" href="cli_8c_source.html#l01937">ast_cli_unregister_multiple()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00229"></a>00229 {
<a name="l00230"></a>00230    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09" title="Unregister multiple commands.">ast_cli_unregister_multiple</a>(<a class="code" href="res__clioriginate_8c.html#a8799d195f3e000d0a2d6af6664b22ead">cli_cliorig</a>, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="res__clioriginate_8c.html#a8799d195f3e000d0a2d6af6664b22ead">cli_cliorig</a>));
<a name="l00231"></a>00231 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ab22f32016155f7f403e7178767163d7d"></a><!-- doxytag: member="res_clioriginate.c::__mod_info" ref="ab22f32016155f7f403e7178767163d7d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__module__info.html">ast_module_info</a> <a class="el" href="res__timing__timerfd_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = AST_MODULE, .flags = AST_MODFLAG_DEFAULT , .<a class="el" href="callerid_8c.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = &quot;Call origination and redirection from the CLI&quot; , .key = &quot;This paragraph is copyright (c) 2006 by Digium, Inc. \In order for your module to load, it must return this \key via a function called \&quot;key\&quot;. Any code which \includes this paragraph must be licensed under the GNU \General Public License <a class="el" href="res__config__pgsql_8c.html#aad880fc4455c253781e8968f2239d56f">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;aefddfaffd51bc118c14a748e96eb9a0&quot; , .load = load_module, .unload = unload_module, }<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00240">240</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae25b9f3970870610911f8850897e8ead"></a><!-- doxytag: member="res_clioriginate.c::ast_module_info" ref="ae25b9f3970870610911f8850897e8ead" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__module__info.html">ast_module_info</a>* <a class="el" href="structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="res__timing__timerfd_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00240">240</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8799d195f3e000d0a2d6af6664b22ead"></a><!-- doxytag: member="res_clioriginate.c::cli_cliorig" ref="a8799d195f3e000d0a2d6af6664b22ead" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="res__clioriginate_8c.html#a8799d195f3e000d0a2d6af6664b22ead">cli_cliorig</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
   <a class="code" href="cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="res__clioriginate_8c.html#a29319dcf2b8b77da098d5e4152cbe64f" title="handle for orgination app or exten.">handle_orig</a>, <span class="stringliteral">&quot;Originate a call&quot;</span>),
   <a class="code" href="cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="res__clioriginate_8c.html#af044bd740030fc7b465bcdcb84882ca1">handle_redirect</a>, <span class="stringliteral">&quot;Redirect a call&quot;</span>),
}
</pre></div>
<p>Definition at line <a class="el" href="res__clioriginate_8c_source.html#l00223">223</a> of file <a class="el" href="res__clioriginate_8c_source.html">res_clioriginate.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:23:09 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
