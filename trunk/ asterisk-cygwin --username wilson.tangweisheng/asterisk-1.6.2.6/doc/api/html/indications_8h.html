<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:22:13 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1ab815038f534adda65c8b4ae4993449.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_16d825f1fa9ecca2e70b1a8d9256d0e6.html">asterisk</a>
  </div>
</div>
<div class="contents">
<h1>indications.h File Reference</h1>
<p>Tone Indication Support.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br/>

<p><a href="indications_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__tone__zone.html">ast_tone_zone</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A set of tones for a given locale.  <a href="structast__tone__zone.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__tone__zone__part.html">ast_tone_zone_part</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A description of a part of a tone.  <a href="structast__tone__zone__part.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Description of a tone.  <a href="structast__tone__zone__sound.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#ac768d4d31096a4abddf19dc71a003a6a">ast_tone_zone_lock</a>(tz)&nbsp;&nbsp;&nbsp;ao2_lock(tz)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>.  <a href="#ac768d4d31096a4abddf19dc71a003a6a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a1e1560d9ae74f3383c4e9af78d2d3c25">ast_tone_zone_trylock</a>(tz)&nbsp;&nbsp;&nbsp;ao2_trylock(tz)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Trylock an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>.  <a href="#a1e1560d9ae74f3383c4e9af78d2d3c25"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a4b9c1d78e34f81223ace1970d6e637ca">ast_tone_zone_unlock</a>(tz)&nbsp;&nbsp;&nbsp;ao2_unlock(tz)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlock an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>.  <a href="#a4b9c1d78e34f81223ace1970d6e637ca"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a516be2823557000dcd4be685a44d1d09">ast_get_indication_tone</a> (const struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *zone, const char *indication)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Locate a tone zone <a class="el" href="structsound.html">sound</a>.  <a href="#a516be2823557000dcd4be685a44d1d09"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a52513ad3507d90dc2baf7cfec7b201a7">ast_get_indication_zone</a> (const char *<a class="el" href="pbx__dundi_8c.html#a03e72b5f331070bc01418a74af199eb9">country</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">locate <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>  <a href="#a52513ad3507d90dc2baf7cfec7b201a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a544e8a1dd4a986b00754103dda6a7d3b">ast_playtones_start</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, int vol, const char *tonelist, int interruptible)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start playing a list of tones on a channel.  <a href="#a544e8a1dd4a986b00754103dda6a7d3b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a9d5be069b7060d326a213f5d60b8dc77">ast_playtones_stop</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop playing tones on a channel.  <a href="#a9d5be069b7060d326a213f5d60b8dc77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#af516935cd24f632741b3035ff975a467">ast_tone_zone_count</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the <a class="el" href="structnumber.html" title="Number structure.">number</a> of registered tone zones.  <a href="#af516935cd24f632741b3035ff975a467"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structao2__iterator.html">ao2_iterator</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a64531a0af4012b426e13299d838feb40">ast_tone_zone_iterator_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an iterator for the available tone zones.  <a href="#a64531a0af4012b426e13299d838feb40"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a5bd91799d8e718f389e20acc253c5158">ast_tone_zone_part_parse</a> (const char *s, struct <a class="el" href="structast__tone__zone__part.html">ast_tone_zone_part</a> *tone_data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse a tone part.  <a href="#a5bd91799d8e718f389e20acc253c5158"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a715d653d22c0151528bfd4a6aaaa3a36">ast_tone_zone_ref</a> (struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *tz)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Increase the reference count on an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>.  <a href="#a715d653d22c0151528bfd4a6aaaa3a36"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a67c962c84267ed322ecf41a4d45af8c7">ast_tone_zone_sound_ref</a> (struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *ts)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Increase the reference count on an <a class="el" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a>.  <a href="#a67c962c84267ed322ecf41a4d45af8c7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#a8b52ace68f21c0ac24414f038471647d">ast_tone_zone_sound_unref</a> (struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *ts)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release a reference to an <a class="el" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a>.  <a href="#a8b52ace68f21c0ac24414f038471647d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="indications_8h.html#ae4e735983064b7fe22ffc0fc046d700e">ast_tone_zone_unref</a> (struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *tz)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release a reference to an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>.  <a href="#ae4e735983064b7fe22ffc0fc046d700e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Tone Indication Support. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Pauline Middelink &lt;<a href="mailto:middelink@polyware.nl">middelink@polyware.nl</a>&gt; </dd>
<dd>
Russell Bryant &lt;<a href="mailto:russell@digium.com">russell@digium.com</a>&gt; </dd></dl>

<p>Definition in file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ac768d4d31096a4abddf19dc71a003a6a"></a><!-- doxytag: member="indications.h::ast_tone_zone_lock" ref="ac768d4d31096a4abddf19dc71a003a6a" args="(tz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_tone_zone_lock</td>
          <td>(</td>
          <td class="paramtype">tz&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;ao2_lock(tz)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>. </p>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00184">184</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

<p>Referenced by <a class="el" href="indications_8c_source.html#l00452">ast_get_indication_tone()</a>, <a class="el" href="indications_8c_source.html#l00600">ast_unregister_indication()</a>, <a class="el" href="agent_8c_source.html#l00684">ast_var_indications_table()</a>, <a class="el" href="indications_8c_source.html#l00712">complete_indications()</a>, <a class="el" href="indications_8c_source.html#l00651">handle_cli_indication_add()</a>, <a class="el" href="indications_8c_source.html#l00793">handle_cli_indication_show()</a>, <a class="el" href="indications_8c_source.html#l00873">is_valid_tone_zone()</a>, <a class="el" href="indications_8c_source.html#l00943">parse_tone_zone()</a>, <a class="el" href="indications_8c_source.html#l01009">prune_tone_zone()</a>, <a class="el" href="indications_8c_source.html#l00928">reset_tone_zone()</a>, and <a class="el" href="indications_8c_source.html#l00987">tone_zone_mark()</a>.</p>

</div>
</div>
<a class="anchor" id="a1e1560d9ae74f3383c4e9af78d2d3c25"></a><!-- doxytag: member="indications.h::ast_tone_zone_trylock" ref="a1e1560d9ae74f3383c4e9af78d2d3c25" args="(tz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_tone_zone_trylock</td>
          <td>(</td>
          <td class="paramtype">tz&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;ao2_trylock(tz)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Trylock an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>. </p>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00194">194</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4b9c1d78e34f81223ace1970d6e637ca"></a><!-- doxytag: member="indications.h::ast_tone_zone_unlock" ref="a4b9c1d78e34f81223ace1970d6e637ca" args="(tz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_tone_zone_unlock</td>
          <td>(</td>
          <td class="paramtype">tz&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;ao2_unlock(tz)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unlock an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>. </p>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00189">189</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

<p>Referenced by <a class="el" href="indications_8c_source.html#l00452">ast_get_indication_tone()</a>, <a class="el" href="indications_8c_source.html#l00600">ast_unregister_indication()</a>, <a class="el" href="agent_8c_source.html#l00684">ast_var_indications_table()</a>, <a class="el" href="indications_8c_source.html#l00712">complete_indications()</a>, <a class="el" href="indications_8c_source.html#l00651">handle_cli_indication_add()</a>, <a class="el" href="indications_8c_source.html#l00793">handle_cli_indication_show()</a>, <a class="el" href="indications_8c_source.html#l00873">is_valid_tone_zone()</a>, <a class="el" href="indications_8c_source.html#l00943">parse_tone_zone()</a>, <a class="el" href="indications_8c_source.html#l01009">prune_tone_zone()</a>, <a class="el" href="indications_8c_source.html#l00928">reset_tone_zone()</a>, and <a class="el" href="indications_8c_source.html#l00987">tone_zone_mark()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a516be2823557000dcd4be685a44d1d09"></a><!-- doxytag: member="indications.h::ast_get_indication_tone" ref="a516be2823557000dcd4be685a44d1d09" args="(const struct ast_tone_zone *zone, const char *indication)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a>* ast_get_indication_tone </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *&nbsp;</td>
          <td class="paramname"> <em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>indication</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Locate a tone zone <a class="el" href="structsound.html">sound</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>zone</em>&nbsp;</td><td>Zone to look in for a <a class="el" href="structsound.html">sound</a>, if NULL, the default will be used </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>indication</em>&nbsp;</td><td>Sound to look for, such as "busy"</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a reference to the specified <a class="el" href="structsound.html">sound</a> if it exists, NULL if not </dd></dl>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00452">452</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="astobj2_8c_source.html#l00147">ao2_lock()</a>, <a class="el" href="astobj2_8c_source.html#l00169">ao2_unlock()</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="indications_8h_source.html#l00184">ast_tone_zone_lock</a>, <a class="el" href="indications_8h_source.html#l00212">ast_tone_zone_ref()</a>, <a class="el" href="indications_8h_source.html#l00234">ast_tone_zone_sound_ref()</a>, <a class="el" href="indications_8h_source.html#l00189">ast_tone_zone_unlock</a>, and <a class="el" href="indications_8h_source.html#l00036">ast_tone_zone_sound::name</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l00076">ast_app_dtget()</a>, <a class="el" href="channel_8c_source.html#l03150">ast_indicate_data()</a>, <a class="el" href="chan__misdn_8c_source.html#l03330">dialtone_indicate()</a>, <a class="el" href="app__playtones_8c_source.html#l00075">handle_playtones()</a>, <a class="el" href="chan__unistim_8c_source.html#l04060">in_band_indication()</a>, <a class="el" href="pbx_8c_source.html#l08729">pbx_builtin_waitexten()</a>, <a class="el" href="app__disa_8c_source.html#l00125">play_dialtone()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__readexten_8c_source.html#l00128">readexten_exec()</a>, and <a class="el" href="chan__skinny_8c_source.html#l04102">skinny_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00453"></a>00453 {
<a name="l00454"></a>00454    <span class="keyword">struct </span><a class="code" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a> *ts = NULL;
<a name="l00455"></a>00455    <span class="comment">/* _zone is const to the users of the API */</span>
<a name="l00456"></a>00456    <span class="keyword">struct </span><a class="code" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a> *zone = (<span class="keyword">struct </span><a class="code" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a> *) _zone;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458    <span class="comment">/* If no zone is specified, use the default */</span>
<a name="l00459"></a>00459    <span class="keywordflow">if</span> (!zone) {
<a name="l00460"></a>00460       <a class="code" href="astobj2_8h.html#a3077056d07f6f9e348a54a743769bad5" title="Lock an object.">ao2_lock</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>);
<a name="l00461"></a>00461       <span class="keywordflow">if</span> (<a class="code" href="indications_8c.html#aefb7a6fa949bf2cd8df728537d5e9ae2">default_tone_zone</a>) {
<a name="l00462"></a>00462          zone = <a class="code" href="indications_8h.html#a715d653d22c0151528bfd4a6aaaa3a36" title="Increase the reference count on an ast_tone_zone.">ast_tone_zone_ref</a>(<a class="code" href="indications_8c.html#aefb7a6fa949bf2cd8df728537d5e9ae2">default_tone_zone</a>);
<a name="l00463"></a>00463       }
<a name="l00464"></a>00464       <a class="code" href="astobj2_8h.html#a379cc936a320f2179f7beb422dc15230" title="Unlock an object.">ao2_unlock</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>);
<a name="l00465"></a>00465 
<a name="l00466"></a>00466       <span class="keywordflow">if</span> (!zone) {
<a name="l00467"></a>00467          <span class="keywordflow">return</span> NULL;
<a name="l00468"></a>00468       }
<a name="l00469"></a>00469    }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471    <a class="code" href="indications_8h.html#ac768d4d31096a4abddf19dc71a003a6a" title="Lock an ast_tone_zone.">ast_tone_zone_lock</a>(zone);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473    <span class="comment">/* Look through list of tones in the zone searching for the right one */</span>
<a name="l00474"></a>00474    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;zone-&gt;tones, ts, entry) {
<a name="l00475"></a>00475       <span class="keywordflow">if</span> (!strcasecmp(ts-&gt;<a class="code" href="structast__tone__zone__sound.html#a8f8f80d37794cde9472343e4487ba3eb" title="Name of the tone. For example, &amp;quot;busy&amp;quot;.">name</a>, indication)) {
<a name="l00476"></a>00476          <span class="comment">/* Increase ref count for the reference we will return */</span>
<a name="l00477"></a>00477          ts = <a class="code" href="indications_8h.html#a67c962c84267ed322ecf41a4d45af8c7" title="Increase the reference count on an ast_tone_zone_sound.">ast_tone_zone_sound_ref</a>(ts);
<a name="l00478"></a>00478          <span class="keywordflow">break</span>;
<a name="l00479"></a>00479       }
<a name="l00480"></a>00480    }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482    <a class="code" href="indications_8h.html#a4b9c1d78e34f81223ace1970d6e637ca" title="Unlock an ast_tone_zone.">ast_tone_zone_unlock</a>(zone);
<a name="l00483"></a>00483 
<a name="l00484"></a>00484    <span class="keywordflow">return</span> ts;
<a name="l00485"></a>00485 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a52513ad3507d90dc2baf7cfec7b201a7"></a><!-- doxytag: member="indications.h::ast_get_indication_zone" ref="a52513ad3507d90dc2baf7cfec7b201a7" args="(const char *country)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a>* ast_get_indication_zone </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>country</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>locate <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>country</em>&nbsp;</td><td>country to find. If NULL is provided, get the default.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a reference to the specified country if found or NULL if not found </dd></dl>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00430">430</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00968">ao2_find</a>, <a class="el" href="astobj2_8c_source.html#l00147">ao2_lock()</a>, <a class="el" href="astobj2_8c_source.html#l00169">ao2_unlock()</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="indications_8h_source.html#l00212">ast_tone_zone_ref()</a>, <a class="el" href="indications_8h_source.html#l00073">ast_tone_zone::country</a>, <a class="el" href="indications_8h_source.html#l00081">ast_tone_zone::nrringcadence</a>, and <a class="el" href="astobj2_8h_source.html#l00678">OBJ_POINTER</a>.</p>

<p>Referenced by <a class="el" href="indications_8c_source.html#l00406">ast_set_indication_country()</a>, <a class="el" href="agent_8c_source.html#l00643">ast_var_indications()</a>, <a class="el" href="chan__unistim_8c_source.html#l04998">build_device()</a>, <a class="el" href="func__channel_8c_source.html#l00280">func_channel_write()</a>, <a class="el" href="indications_8c_source.html#l00651">handle_cli_indication_add()</a>, and <a class="el" href="indications_8c_source.html#l00744">handle_cli_indication_remove()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00431"></a>00431 {
<a name="l00432"></a>00432    <span class="keyword">struct </span><a class="code" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a> *tz = NULL;
<a name="l00433"></a>00433    <span class="keyword">struct </span><a class="code" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a> zone_arg = {
<a name="l00434"></a>00434       .nrringcadence = 0,
<a name="l00435"></a>00435    };
<a name="l00436"></a>00436 
<a name="l00437"></a>00437    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="pbx__dundi_8c.html#a03e72b5f331070bc01418a74af199eb9">country</a>)) {
<a name="l00438"></a>00438       <a class="code" href="astobj2_8h.html#a3077056d07f6f9e348a54a743769bad5" title="Lock an object.">ao2_lock</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>);
<a name="l00439"></a>00439       <span class="keywordflow">if</span> (<a class="code" href="indications_8c.html#aefb7a6fa949bf2cd8df728537d5e9ae2">default_tone_zone</a>) {
<a name="l00440"></a>00440          tz = <a class="code" href="indications_8h.html#a715d653d22c0151528bfd4a6aaaa3a36" title="Increase the reference count on an ast_tone_zone.">ast_tone_zone_ref</a>(<a class="code" href="indications_8c.html#aefb7a6fa949bf2cd8df728537d5e9ae2">default_tone_zone</a>);
<a name="l00441"></a>00441       }
<a name="l00442"></a>00442       <a class="code" href="astobj2_8h.html#a379cc936a320f2179f7beb422dc15230" title="Unlock an object.">ao2_unlock</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>);
<a name="l00443"></a>00443 
<a name="l00444"></a>00444       <span class="keywordflow">return</span> tz;
<a name="l00445"></a>00445    }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447    <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(zone_arg.<a class="code" href="structast__tone__zone.html#ae971c8bd695c8378ac49d0d396708172" title="Country code that this set of tones is for.">country</a>, <a class="code" href="pbx__dundi_8c.html#a03e72b5f331070bc01418a74af199eb9">country</a>, <span class="keyword">sizeof</span>(zone_arg.<a class="code" href="structast__tone__zone.html#ae971c8bd695c8378ac49d0d396708172" title="Country code that this set of tones is for.">country</a>));
<a name="l00448"></a>00448 
<a name="l00449"></a>00449    <span class="keywordflow">return</span> <a class="code" href="astobj2_8h.html#a618587b42226725315b96db394b13673">ao2_find</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>, &amp;zone_arg, <a class="code" href="astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca32d49976aaebc093266f0b080f9c9a73">OBJ_POINTER</a>);
<a name="l00450"></a>00450 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a544e8a1dd4a986b00754103dda6a7d3b"></a><!-- doxytag: member="indications.h::ast_playtones_start" ref="a544e8a1dd4a986b00754103dda6a7d3b" args="(struct ast_channel *chan, int vol, const char *tonelist, int interruptible)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_playtones_start </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>tonelist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interruptible</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start playing a list of tones on a channel. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>the channel to play tones on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vol</em>&nbsp;</td><td><a class="el" href="structvolume.html">volume</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tonelist</em>&nbsp;</td><td>the list of tones to play, comma separated </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>interruptible</em>&nbsp;</td><td>whether or not this tone can be interrupted</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00301">301</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l02001">ast_activate_generator()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="astmm_8h_source.html#l00093">ast_realloc</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00150">ast_strip()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="indications_8c_source.html#l00244">ast_tone_zone_part_parse()</a>, <a class="el" href="chan__h323_8c_source.html#l00144">cos</a>, <a class="el" href="indications_8c_source.html#l00080">playtones_item::duration</a>, <a class="el" href="indications_8c_source.html#l00073">playtones_item::fac1</a>, <a class="el" href="indications_8c_source.html#l00076">playtones_item::fac2</a>, <a class="el" href="indications_8h_source.html#l00107">ast_tone_zone_part::freq1</a>, <a class="el" href="indications_8h_source.html#l00108">ast_tone_zone_part::freq2</a>, <a class="el" href="indications_8c_source.html#l00074">playtones_item::init_v2_1</a>, <a class="el" href="indications_8c_source.html#l00077">playtones_item::init_v2_2</a>, <a class="el" href="indications_8c_source.html#l00075">playtones_item::init_v3_1</a>, <a class="el" href="indications_8c_source.html#l00078">playtones_item::init_v3_2</a>, <a class="el" href="indications_8c_source.html#l00087">playtones_def::interruptible</a>, <a class="el" href="indications_8c_source.html#l00088">playtones_def::items</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="indications_8h_source.html#l00111">ast_tone_zone_part::midinote</a>, <a class="el" href="indications_8h_source.html#l00110">ast_tone_zone_part::modulate</a>, <a class="el" href="indications_8c_source.html#l00079">playtones_item::modulate</a>, <a class="el" href="indications_8c_source.html#l00086">playtones_def::nitems</a>, <a class="el" href="indications_8c_source.html#l00085">playtones_def::reppos</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>, <a class="el" href="indications_8h_source.html#l00109">ast_tone_zone_part::time</a>, and <a class="el" href="indications_8c_source.html#l00084">playtones_def::vol</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00302"></a>00302 {
<a name="l00303"></a>00303    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, *data = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(playlst);
<a name="l00304"></a>00304    <span class="keyword">struct </span><a class="code" href="structplaytones__def.html">playtones_def</a> d = { <a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a>, -1, 0, 1, NULL };
<a name="l00305"></a>00305    <span class="keywordtype">char</span> *stringp;
<a name="l00306"></a>00306    <span class="keywordtype">char</span> *separator;
<a name="l00307"></a>00307    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> sample_rate = 8000.0;
<a name="l00308"></a>00308    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> max_sample_val = 32768.0;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    <span class="keywordflow">if</span> (<a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a> &lt; 1) {
<a name="l00311"></a>00311       d.<a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a> = 7219; <span class="comment">/* Default to -8db */</span>
<a name="l00312"></a>00312    }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314    d.<a class="code" href="structplaytones__def.html#acfcb863f464d247c6ae8b106a11a47fb">interruptible</a> = <a class="code" href="structplaytones__def.html#acfcb863f464d247c6ae8b106a11a47fb">interruptible</a>;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316    stringp = data;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318    <span class="comment">/* check if the data is separated with &apos;|&apos; or with &apos;,&apos; by default */</span>
<a name="l00319"></a>00319    <span class="keywordflow">if</span> (strchr(stringp,<span class="charliteral">&apos;|&apos;</span>)) {
<a name="l00320"></a>00320       separator = <span class="stringliteral">&quot;|&quot;</span>;
<a name="l00321"></a>00321    } <span class="keywordflow">else</span> {
<a name="l00322"></a>00322       separator = <span class="stringliteral">&quot;,&quot;</span>;
<a name="l00323"></a>00323    }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325    <span class="keywordflow">while</span> ((s = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;stringp, separator)) &amp;&amp; !<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(s)) {
<a name="l00326"></a>00326       <span class="keyword">struct </span><a class="code" href="structast__tone__zone__part.html" title="A description of a part of a tone.">ast_tone_zone_part</a> tone_data = {
<a name="l00327"></a>00327          .time = 0,
<a name="l00328"></a>00328       };
<a name="l00329"></a>00329 
<a name="l00330"></a>00330       s = <a class="code" href="strings_8h.html#aeb1c54e6e100c63176d8e22b0d5ca865" title="Strip leading/trailing whitespace from a string.">ast_strip</a>(s);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332       <span class="keywordflow">if</span> (s[0]==<span class="charliteral">&apos;!&apos;</span>) {
<a name="l00333"></a>00333          s++;
<a name="l00334"></a>00334       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d.<a class="code" href="structplaytones__def.html#aee9495d9d68b34db471c61c3120859f6">reppos</a> == -1) {
<a name="l00335"></a>00335          d.<a class="code" href="structplaytones__def.html#aee9495d9d68b34db471c61c3120859f6">reppos</a> = d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>;
<a name="l00336"></a>00336       }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338       <span class="keywordflow">if</span> (<a class="code" href="indications_8h.html#a5bd91799d8e718f389e20acc253c5158" title="Parse a tone part.">ast_tone_zone_part_parse</a>(s, &amp;tone_data)) {
<a name="l00339"></a>00339          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to parse tone part &apos;%s&apos;\n&quot;</span>, s);
<a name="l00340"></a>00340          <span class="keywordflow">continue</span>;
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343       <span class="keywordflow">if</span> (tone_data.<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a>) {
<a name="l00344"></a>00344          <span class="comment">/* midi notes must be between 0 and 127 */</span>
<a name="l00345"></a>00345 
<a name="l00346"></a>00346          <span class="keywordflow">if</span> (tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> &gt;= 0 &amp;&amp; tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> &lt;= 127) {
<a name="l00347"></a>00347             tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> = <a class="code" href="indications_8c.html#aa45ccbd7cb4699b841833563d0ebad7f">midi_tohz</a>[tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>];
<a name="l00348"></a>00348          } <span class="keywordflow">else</span> {
<a name="l00349"></a>00349             tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> = 0;
<a name="l00350"></a>00350          }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352          <span class="keywordflow">if</span> (tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> &gt;= 0 &amp;&amp; tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> &lt;= 127) {
<a name="l00353"></a>00353             tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> = <a class="code" href="indications_8c.html#aa45ccbd7cb4699b841833563d0ebad7f">midi_tohz</a>[tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>];
<a name="l00354"></a>00354          } <span class="keywordflow">else</span> {
<a name="l00355"></a>00355             tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> = 0;
<a name="l00356"></a>00356          }
<a name="l00357"></a>00357       }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359       <span class="keywordflow">if</span> (!(d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a> = <a class="code" href="astmm_8h.html#aa852314efa0cfeecee97ffc51b649734">ast_realloc</a>(d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>, (d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a> + 1) * <span class="keyword">sizeof</span>(*d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>)))) {
<a name="l00360"></a>00360          <span class="keywordflow">return</span> -1;
<a name="l00361"></a>00361       }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#a78be16714343e05c92280423d7b8c049">fac1</a> = 2.0 * <a class="code" href="chan__h323_8c.html#ae91dad65f553f7afebe4af507803bc7f">cos</a>(2.0 * M_PI * (tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> / sample_rate)) * max_sample_val;
<a name="l00364"></a>00364       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#a6b21294622e7b60e21b8fa83706787f3">init_v2_1</a> = sin(-4.0 * M_PI * (tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> / sample_rate)) * d.<a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a>;
<a name="l00365"></a>00365       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#a1be69db6096bdf61c5e5717f18946633">init_v3_1</a> = sin(-2.0 * M_PI * (tone_data.<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a> / sample_rate)) * d.<a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a>;
<a name="l00366"></a>00366 
<a name="l00367"></a>00367       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#a346af58f2d4bbe53004ec9ef0cdabfa4">fac2</a> = 2.0 * <a class="code" href="chan__h323_8c.html#ae91dad65f553f7afebe4af507803bc7f">cos</a>(2.0 * M_PI * (tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> / sample_rate)) * max_sample_val;
<a name="l00368"></a>00368       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#a61814cbbf3fa281eec5c3f1b7030e48e">init_v2_2</a> = sin(-4.0 * M_PI * (tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> / sample_rate)) * d.<a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a>;
<a name="l00369"></a>00369       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#a1da3ae088409ecf65b54fe42b7de4e27">init_v3_2</a> = sin(-2.0 * M_PI * (tone_data.<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> / sample_rate)) * d.<a class="code" href="structplaytones__def.html#a0865f919827121ede94c816e460e4857">vol</a>;
<a name="l00370"></a>00370 
<a name="l00371"></a>00371       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = tone_data.<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>;
<a name="l00372"></a>00372       d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>[d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>].<a class="code" href="structplaytones__item.html#ac1c4127983f79b8c09b4f1610d1c1021">modulate</a> = tone_data.<a class="code" href="structast__tone__zone__part.html#a12d9bacf98f740680b8a829b29ecdde4">modulate</a>;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374       d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>++;
<a name="l00375"></a>00375    }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377    <span class="keywordflow">if</span> (!d.<a class="code" href="structplaytones__def.html#a1a693ed191d60c301334b79fa390f5c7">nitems</a>) {
<a name="l00378"></a>00378       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;No valid tone parts\n&quot;</span>);
<a name="l00379"></a>00379       <span class="keywordflow">return</span> -1;
<a name="l00380"></a>00380    }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382    <span class="keywordflow">if</span> (<a class="code" href="channel_8h.html#a12a58dda74a19f383f6b77cf7fa88b54">ast_activate_generator</a>(chan, &amp;<a class="code" href="indications_8c.html#ac031eceb608cf061a9b6f77ef00c389a">playtones</a>, &amp;d)) {
<a name="l00383"></a>00383       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(d.<a class="code" href="structplaytones__def.html#af084fc332deeaf9228b914aa34568b3b">items</a>);
<a name="l00384"></a>00384       <span class="keywordflow">return</span> -1;
<a name="l00385"></a>00385    }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387    <span class="keywordflow">return</span> 0;
<a name="l00388"></a>00388 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9d5be069b7060d326a213f5d60b8dc77"></a><!-- doxytag: member="indications.h::ast_playtones_stop" ref="a9d5be069b7060d326a213f5d60b8dc77" args="(struct ast_channel *chan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_playtones_stop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stop playing tones on a channel. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>the channel to stop tones on</td></tr>
  </table>
  </dd>
</dl>
<p>Stop the tones from playing </p>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00390">390</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l01956">ast_deactivate_generator()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00391"></a>00391 {
<a name="l00392"></a>00392    <a class="code" href="channel_8h.html#a7160355005776732fba88cc020f4a45b">ast_deactivate_generator</a>(chan);
<a name="l00393"></a>00393 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af516935cd24f632741b3035ff975a467"></a><!-- doxytag: member="indications.h::ast_tone_zone_count" ref="af516935cd24f632741b3035ff975a467" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_tone_zone_count </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the <a class="el" href="structnumber.html" title="Number structure.">number</a> of registered tone zones. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the total <a class="el" href="structnumber.html" title="Number structure.">number</a> of registered tone zones </dd></dl>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00395">395</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="astobj2_8c_source.html#l00474">ao2_container_count()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00396"></a>00396 {
<a name="l00397"></a>00397    <span class="keywordflow">return</span> <a class="code" href="astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd" title="Returns the number of elements in a container.">ao2_container_count</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>);
<a name="l00398"></a>00398 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a64531a0af4012b426e13299d838feb40"></a><!-- doxytag: member="indications.h::ast_tone_zone_iterator_init" ref="a64531a0af4012b426e13299d838feb40" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structao2__iterator.html">ao2_iterator</a> ast_tone_zone_iterator_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an iterator for the available tone zones. </p>
<p>Use <a class="el" href="astobj2_8h.html#a1cf2fe1aafd3cb9e613eb48535a37ad5">ao2_iterator_next()</a> to iterate the tone zones.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>an initialized iterator </dd></dl>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00400">400</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="astobj2_8c_source.html#l00780">ao2_iterator_init()</a>.</p>

<p>Referenced by <a class="el" href="agent_8c_source.html#l00643">ast_var_indications()</a>, <a class="el" href="agent_8c_source.html#l00684">ast_var_indications_table()</a>, and <a class="el" href="indications_8c_source.html#l00793">handle_cli_indication_show()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00401"></a>00401 {
<a name="l00402"></a>00402    <span class="keywordflow">return</span> <a class="code" href="astobj2_8h.html#a288075de687152d297308ea1ea963edb" title="Create an iterator for a container.">ao2_iterator_init</a>(<a class="code" href="indications_8c.html#aa9af3b8f87bfc214ab7feed61fe8e898">ast_tone_zones</a>, 0);
<a name="l00403"></a>00403 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5bd91799d8e718f389e20acc253c5158"></a><!-- doxytag: member="indications.h::ast_tone_zone_part_parse" ref="a5bd91799d8e718f389e20acc253c5158" args="(const char *s, struct ast_tone_zone_part *tone_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_tone_zone_part_parse </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__tone__zone__part.html">ast_tone_zone_part</a> *&nbsp;</td>
          <td class="paramname"> <em>tone_data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parse a tone part. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>The part of a tone to parse. This should be in the form described for the data part of <a class="el" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a>. '!' should be removed if present. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tone_data</em>&nbsp;</td><td>An output parameter that contains the result of the parsing.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure, and the contents of tone_data are undefined </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="indications_8c_source.html#l00244">244</a> of file <a class="el" href="indications_8c_source.html">indications.c</a>.</p>

<p>References <a class="el" href="indications_8h_source.html#l00107">ast_tone_zone_part::freq1</a>, <a class="el" href="indications_8h_source.html#l00108">ast_tone_zone_part::freq2</a>, <a class="el" href="indications_8h_source.html#l00111">ast_tone_zone_part::midinote</a>, <a class="el" href="indications_8h_source.html#l00110">ast_tone_zone_part::modulate</a>, and <a class="el" href="indications_8h_source.html#l00109">ast_tone_zone_part::time</a>.</p>

<p>Referenced by <a class="el" href="indications_8c_source.html#l00301">ast_playtones_start()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00245"></a>00245 {
<a name="l00246"></a>00246    <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30u+%30u/%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>, 
<a name="l00247"></a>00247          &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>) == 3) {
<a name="l00248"></a>00248       <span class="comment">/* f1+f2/time format */</span>
<a name="l00249"></a>00249    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30u+%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>) == 2) {
<a name="l00250"></a>00250       <span class="comment">/* f1+f2 format */</span>
<a name="l00251"></a>00251       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a> = 0;
<a name="l00252"></a>00252    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30u*%30u/%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>, 
<a name="l00253"></a>00253          &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>) == 3) {
<a name="l00254"></a>00254       <span class="comment">/* f1*f2/time format */</span>
<a name="l00255"></a>00255       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a12d9bacf98f740680b8a829b29ecdde4">modulate</a> = 1;
<a name="l00256"></a>00256    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30u*%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>) == 2) {
<a name="l00257"></a>00257       <span class="comment">/* f1*f2 format */</span>
<a name="l00258"></a>00258       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a> = 0;
<a name="l00259"></a>00259       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a12d9bacf98f740680b8a829b29ecdde4">modulate</a> = 1;
<a name="l00260"></a>00260    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30u/%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>) == 2) {
<a name="l00261"></a>00261       <span class="comment">/* f1/time format */</span>
<a name="l00262"></a>00262       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> = 0;
<a name="l00263"></a>00263    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>) == 1) {
<a name="l00264"></a>00264       <span class="comment">/* f1 format */</span>
<a name="l00265"></a>00265       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> = 0;
<a name="l00266"></a>00266       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a> = 0;
<a name="l00267"></a>00267    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;M%30u+M%30u/%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>, 
<a name="l00268"></a>00268          &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>) == 3) {
<a name="l00269"></a>00269       <span class="comment">/* Mf1+Mf2/time format */</span>
<a name="l00270"></a>00270       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a> = 1;
<a name="l00271"></a>00271    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;M%30u+M%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>) == 2) {
<a name="l00272"></a>00272       <span class="comment">/* Mf1+Mf2 format */</span>
<a name="l00273"></a>00273       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a> = 0;
<a name="l00274"></a>00274       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a> = 1;
<a name="l00275"></a>00275    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;M%30u*M%30u/%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>, 
<a name="l00276"></a>00276          &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>) == 3) {
<a name="l00277"></a>00277       <span class="comment">/* Mf1*Mf2/time format */</span>
<a name="l00278"></a>00278       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a12d9bacf98f740680b8a829b29ecdde4">modulate</a> = 1;
<a name="l00279"></a>00279       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a> = 1;
<a name="l00280"></a>00280    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;M%30u*M%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a>) == 2) {
<a name="l00281"></a>00281       <span class="comment">/* Mf1*Mf2 format */</span>
<a name="l00282"></a>00282       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a> = 0;
<a name="l00283"></a>00283       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a12d9bacf98f740680b8a829b29ecdde4">modulate</a> = 1;
<a name="l00284"></a>00284       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a> = 1;
<a name="l00285"></a>00285    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;M%30u/%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a>) == 2) {
<a name="l00286"></a>00286       <span class="comment">/* Mf1/time format */</span>
<a name="l00287"></a>00287       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> = -1;
<a name="l00288"></a>00288       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a> = 1;
<a name="l00289"></a>00289    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;M%30u&quot;</span>, &amp;tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#afcc3b9b0ca817ffad0deffe043cbb2b2">freq1</a>) == 1) {
<a name="l00290"></a>00290       <span class="comment">/* Mf1 format */</span>
<a name="l00291"></a>00291       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a2caf338cfc4f9537f35d90025cf3a94d">freq2</a> = -1;
<a name="l00292"></a>00292       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#a83e57ce9bd59cfa0995c2e2c8589c274">time</a> = 0;
<a name="l00293"></a>00293       tone_data-&gt;<a class="code" href="structast__tone__zone__part.html#ae8ad47355699ed05a1397cfaadf5acb4">midinote</a> = 1;
<a name="l00294"></a>00294    } <span class="keywordflow">else</span> {
<a name="l00295"></a>00295       <span class="keywordflow">return</span> -1;
<a name="l00296"></a>00296    }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298    <span class="keywordflow">return</span> 0;
<a name="l00299"></a>00299 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a715d653d22c0151528bfd4a6aaaa3a36"></a><!-- doxytag: member="indications.h::ast_tone_zone_ref" ref="a715d653d22c0151528bfd4a6aaaa3a36" args="(struct ast_tone_zone *tz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a>* ast_tone_zone_ref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *&nbsp;</td>
          <td class="paramname"> <em>tz</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increase the reference count on an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The tone zone provided as an argument </dd></dl>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00212">212</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>.</p>

<p>Referenced by <a class="el" href="indications_8c_source.html#l00452">ast_get_indication_tone()</a>, <a class="el" href="indications_8c_source.html#l00430">ast_get_indication_zone()</a>, <a class="el" href="indications_8c_source.html#l00520">ast_register_indication_country()</a>, <a class="el" href="indications_8c_source.html#l00406">ast_set_indication_country()</a>, and <a class="el" href="func__channel_8c_source.html#l00280">func_channel_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00213"></a>00213 {
<a name="l00214"></a>00214    <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tz, +1);
<a name="l00215"></a>00215    <span class="keywordflow">return</span> tz;
<a name="l00216"></a>00216 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a67c962c84267ed322ecf41a4d45af8c7"></a><!-- doxytag: member="indications.h::ast_tone_zone_sound_ref" ref="a67c962c84267ed322ecf41a4d45af8c7" args="(struct ast_tone_zone_sound *ts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a>* ast_tone_zone_sound_ref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *&nbsp;</td>
          <td class="paramname"> <em>ts</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increase the reference count on an <a class="el" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a>. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The tone zone <a class="el" href="structsound.html">sound</a> provided as an argument </dd></dl>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00234">234</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>.</p>

<p>Referenced by <a class="el" href="indications_8c_source.html#l00452">ast_get_indication_tone()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00235"></a>00235 {
<a name="l00236"></a>00236    <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(ts, +1);
<a name="l00237"></a>00237    <span class="keywordflow">return</span> ts;
<a name="l00238"></a>00238 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8b52ace68f21c0ac24414f038471647d"></a><!-- doxytag: member="indications.h::ast_tone_zone_sound_unref" ref="a8b52ace68f21c0ac24414f038471647d" args="(struct ast_tone_zone_sound *ts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a>* ast_tone_zone_sound_unref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tone__zone__sound.html">ast_tone_zone_sound</a> *&nbsp;</td>
          <td class="paramname"> <em>ts</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release a reference to an <a class="el" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a>. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>NULL </dd></dl>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00223">223</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>.</p>

<p>Referenced by <a class="el" href="app_8c_source.html#l00076">ast_app_dtget()</a>, <a class="el" href="channel_8c_source.html#l03150">ast_indicate_data()</a>, <a class="el" href="indications_8c_source.html#l00567">ast_register_indication()</a>, <a class="el" href="indications_8c_source.html#l00504">ast_tone_zone_destructor()</a>, <a class="el" href="indications_8c_source.html#l00600">ast_unregister_indication()</a>, <a class="el" href="app__playtones_8c_source.html#l00075">handle_playtones()</a>, <a class="el" href="chan__unistim_8c_source.html#l04060">in_band_indication()</a>, <a class="el" href="pbx_8c_source.html#l08729">pbx_builtin_waitexten()</a>, <a class="el" href="app__disa_8c_source.html#l00125">play_dialtone()</a>, <a class="el" href="indications_8c_source.html#l01009">prune_tone_zone()</a>, <a class="el" href="app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="app__readexten_8c_source.html#l00128">readexten_exec()</a>, <a class="el" href="chan__skinny_8c_source.html#l04102">skinny_transfer()</a>, and <a class="el" href="chan__misdn_8c_source.html#l03366">stop_indicate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00224"></a>00224 {
<a name="l00225"></a>00225    <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(ts, -1);
<a name="l00226"></a>00226    <span class="keywordflow">return</span> NULL;
<a name="l00227"></a>00227 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4e735983064b7fe22ffc0fc046d700e"></a><!-- doxytag: member="indications.h::ast_tone_zone_unref" ref="ae4e735983064b7fe22ffc0fc046d700e" args="(struct ast_tone_zone *tz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a>* ast_tone_zone_unref </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tone__zone.html">ast_tone_zone</a> *&nbsp;</td>
          <td class="paramname"> <em>tz</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release a reference to an <a class="el" href="structast__tone__zone.html" title="A set of tones for a given locale.">ast_tone_zone</a>. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>NULL </dd></dl>

<p>Definition at line <a class="el" href="indications_8h_source.html#l00201">201</a> of file <a class="el" href="indications_8h_source.html">indications.h</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>.</p>

<p>Referenced by <a class="el" href="channel_8c_source.html#l01388">ast_channel_free()</a>, <a class="el" href="indications_8c_source.html#l00406">ast_set_indication_country()</a>, <a class="el" href="indications_8c_source.html#l00536">ast_unregister_indication_country()</a>, <a class="el" href="agent_8c_source.html#l00643">ast_var_indications()</a>, <a class="el" href="agent_8c_source.html#l00684">ast_var_indications_table()</a>, <a class="el" href="chan__unistim_8c_source.html#l04998">build_device()</a>, <a class="el" href="indications_8c_source.html#l00627">complete_country()</a>, <a class="el" href="indications_8c_source.html#l00712">complete_indications()</a>, <a class="el" href="func__channel_8c_source.html#l00280">func_channel_write()</a>, <a class="el" href="indications_8c_source.html#l00651">handle_cli_indication_add()</a>, <a class="el" href="indications_8c_source.html#l00744">handle_cli_indication_remove()</a>, <a class="el" href="indications_8c_source.html#l00793">handle_cli_indication_show()</a>, <a class="el" href="indications_8c_source.html#l00943">parse_tone_zone()</a>, and <a class="el" href="chan__unistim_8c_source.html#l05293">reload_config()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 {
<a name="l00203"></a>00203    <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tz, -1);
<a name="l00204"></a>00204    <span class="keywordflow">return</span> NULL;
<a name="l00205"></a>00205 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:22:13 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
