<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:20:24 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_0ca6ff3bf6b340411b2c6edd15b1a34d.html">channels</a>
  </div>
</div>
<div class="contents">
<h1>chan_oss.c File Reference</h1>
<p>Channel driver for OSS <a class="el" href="structsound.html">sound</a> cards.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;sys/ioctl.h&gt;</code><br/>
<code>#include &lt;soundcard.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="file_8h_source.html">asterisk/file.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="module_8h_source.html">asterisk/module.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="causes_8h_source.html">asterisk/causes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="musiconhold_8h_source.html">asterisk/musiconhold.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app_8h_source.html">asterisk/app.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="console__video_8h_source.html">console_video.h</a>&quot;</code><br/>

<p><a href="chan__oss_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">descriptor for one of our <a class="el" href="structchannels.html" title="the list of channels we have. Note that the lock for this list is used for both the...">channels</a>.  <a href="structchan__oss__pvt.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>&nbsp;&nbsp;&nbsp;40</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a7b687e61ed66e74f77982bc22fd0c446">BOOST_SCALE</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;9)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a6be84301906dae965d8f760e7779161a">DEV_DSP</a>&nbsp;&nbsp;&nbsp;&quot;/dev/dsp&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a44f658797e1982f579580823c8fcf8f8">FRAGS</a>&nbsp;&nbsp;&nbsp;( ( (6 * 5) &lt;&lt; 16 ) | 0x6 )</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#af9b1b2ba12857a4bf11289dac8c5462d">FRAME_SIZE</a>&nbsp;&nbsp;&nbsp;160</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a9d6bb64b7e9ca3602a00db074a84103d">O_CLOSE</a>&nbsp;&nbsp;&nbsp;0x444</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a142810068f1b99cd93d3fc9f0e160e02">QUEUE_SIZE</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#afb6f36d91ffbf947cfa3f1114ca79764">TEXT_SIZE</a>&nbsp;&nbsp;&nbsp;256</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a422b43626fc2d780dad3ca0280b79225">WARN_frag</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a93bf0c7c887e8b899663f17882cf5b40">WARN_speed</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a11aaf77355342e1ba8feee89c4d66e51">WARN_used_blocks</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a0f44101ca5201079b78743aefadf5066">ast_ext_ctx</a> (const char *src, char **<a class="el" href="res__phoneprov_8c.html#a71ac783a3ca66bd546dc964f1dd0e0f0">ext</a>, char **ctx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a3e6658947915311fa7cf769e5ebcdbd8">AST_MODULE_INFO_STANDARD</a> (ASTERISK_GPL_KEY,&quot;OSS Console Channel Driver&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a00804379ae74e1b93cd8423a3339fd0d">console_active</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a55ba77a51995e97d474335b6bdf3a91f">console_answer</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">answer command from the <a class="el" href="structconsole.html">console</a>  <a href="#a55ba77a51995e97d474335b6bdf3a91f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a87689806923f4dee4f881d5feeae8890">console_autoanswer</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a7a67c1431e82f1aef2a469acaec24e83">console_boost</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a886dc7bd4ea37a2679329faa3e35cd9a">console_cmd</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a643ab48c2c5d59def5576f4b4920d1b2">console_dial</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a7f2b1c7280aa3d53f6f4ba491133b595">console_do_answer</a> (int fd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">helper function for the answer key/cli command  <a href="#a7f2b1c7280aa3d53f6f4ba491133b595"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#acac1ff49331792a79142e02a92d13af4">console_flash</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a96bff27db51b05b64eb2e87335790e7a">console_hangup</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#ab5138fd6e43a32eeed7f7439cdf15ddb">console_mute</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#ad732532ff0daadd7b2499aa08eac29b2">console_sendtext</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Console send text CLI command.  <a href="#ad732532ff0daadd7b2499aa08eac29b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#ae7138dfcb66f8fc5be57d1dd035083f6">console_transfer</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72">find_desc</a> (char *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">returns a pointer to the descriptor with the given name  <a href="#a1258323075e6f065208634313f361d72"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct video_desc *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a9efa542d6b1bda9e31a607c40e5d826a">get_video_desc</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the pointer to the video descriptor  <a href="#a9efa542d6b1bda9e31a607c40e5d826a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#ae982fbbf697d63f020cf7e0e08872bba">oss_answer</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">remote side answered the phone  <a href="#ae982fbbf697d63f020cf7e0e08872bba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a56d9dc237611f126fc6790f938a9aca7">oss_call</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, char *dest, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handler for incoming calls. Either autoanswer, or start ringing  <a href="#a56d9dc237611f126fc6790f938a9aca7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a1f8c964c9b16fbc2da64b7950c7e0053">oss_digit_begin</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, char digit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a4af09e58b6893b0d8696b89ae6d6da65">oss_digit_end</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, char digit, unsigned int duration)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a666c20b8e1a1f4c72d9542ea546a8d53">oss_fixup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *oldchan, struct <a class="el" href="structast__channel.html">ast_channel</a> *newchan)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a7605b6fd579dbecb9af474fb824bcce5">oss_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a16dd74031edf2500a412285237010a62">oss_indicate</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, int <a class="el" href="res__timing__pthread_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, const void *data, size_t datalen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a2ac8539acc7a1fdfc33592b8f822cdce">oss_new</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, char *<a class="el" href="res__phoneprov_8c.html#a71ac783a3ca66bd546dc964f1dd0e0f0">ext</a>, char *ctx, int <a class="el" href="structstate.html">state</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">allocate a new channel.  <a href="#a2ac8539acc7a1fdfc33592b8f822cdce"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a3a57cda405686ea2b49440e85e2308eb">oss_read</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#aa050fb51e60829a7bee767bf07c36186">oss_request</a> (const char *<a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, int <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, void *data, int *<a class="el" href="channel_8c.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a24e02bf3a54ce9faac294cd2e13d425a">oss_text</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a05474cf14eae6989d1bbb685221401b0">oss_write</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">used for data coming from the network  <a href="#a05474cf14eae6989d1bbb685221401b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a846ca28a12888dffef1ceaa0145fc9e5">setformat</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, int mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#acedc91aa257e17f0d04f4b6cdd587fec">soundcard_writeframe</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, short *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a84654a000b40dc9279c90ebe4f0cec8d">store_boost</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, const char *s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">store the boost factor  <a href="#a84654a000b40dc9279c90ebe4f0cec8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#af61d034633d0712785e391e59e0a62ed">store_callerid</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, const char *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a0c9e9a2c27099a98cad529efa81b63ed">store_config</a> (struct <a class="el" href="structast__config.html">ast_config</a> *cfg, char *ctg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a5aaad0a97630adacb1072ec67727d221">store_config_core</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, const char *var, const char *value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a26239196e7baece3ba160c70995afcef">store_mixer</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o, const char *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a2b350571365a38d4c829a611e6625d83">used_blocks</a> (struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *o)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the <a class="el" href="structnumber.html" title="Number structure.">number</a> of blocks used in the audio output channel.  <a href="#a2b350571365a38d4c829a611e6625d83"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a657fc1119d2a6e1a4678fbbbe73b18f9">cli_oss</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = &quot;oss.conf&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__jb__conf.html">ast_jb_conf</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a2d8d5920e90ccbad7832926becdadb29">default_jbconf</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__jb__conf.html">ast_jb_conf</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a55655e6e4f992661feb99f55a1589539">oss_debug</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="chan__oss_8c.html#a206197bcdc50090e511e22b33a2166a9">tdesc</a> [] = &quot;OSS Console Channel Driver&quot;</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Channel driver for OSS <a class="el" href="structsound.html">sound</a> cards. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Mark Spencer &lt;<a href="mailto:markster@digium.com">markster@digium.com</a>&gt; </dd>
<dd>
Luigi Rizzo</dd></dl>
<dl class="user"><dt><b>See also</b></dt><dd><ul>
<li><a class="el" href="Config_oss.html">OSS configuration</a> </li>
</ul>
</dd></dl>

<p>Definition in file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a54f5d9a8e570842ff9e4aac3157907c0"></a><!-- doxytag: member="chan_oss.c::BOOST_MAX" ref="a54f5d9a8e570842ff9e4aac3157907c0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOST_MAX&nbsp;&nbsp;&nbsp;40</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>slightly less than 7 bits </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00273">273</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01233">store_boost()</a>.</p>

</div>
</div>
<a class="anchor" id="a7b687e61ed66e74f77982bc22fd0c446"></a><!-- doxytag: member="chan_oss.c::BOOST_SCALE" ref="a7b687e61ed66e74f77982bc22fd0c446" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOST_SCALE&nbsp;&nbsp;&nbsp;(1&lt;&lt;9)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>boost support. BOOST_SCALE * 10 ^(BOOST_MAX/20) must be representable in 16 bits to avoid overflows. </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00272">272</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01252">console_boost()</a>, <a class="el" href="chan__oss_8c_source.html#l00692">oss_read()</a>, <a class="el" href="chan__oss_8c_source.html#l01233">store_boost()</a>, and <a class="el" href="chan__usbradio_8c_source.html#l01796">usbradio_read()</a>.</p>

</div>
</div>
<a class="anchor" id="a6be84301906dae965d8f760e7779161a"></a><!-- doxytag: member="chan_oss.c::DEV_DSP" ref="a6be84301906dae965d8f760e7779161a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEV_DSP&nbsp;&nbsp;&nbsp;&quot;/dev/dsp&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00230">230</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01348">store_config()</a>.</p>

</div>
</div>
<a class="anchor" id="a44f658797e1982f579580823c8fcf8f8"></a><!-- doxytag: member="chan_oss.c::FRAGS" ref="a44f658797e1982f579580823c8fcf8f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAGS&nbsp;&nbsp;&nbsp;( ( (6 * 5) &lt;&lt; 16 ) | 0x6 )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00213">213</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="af9b1b2ba12857a4bf11289dac8c5462d"></a><!-- doxytag: member="chan_oss.c::FRAME_SIZE" ref="af9b1b2ba12857a4bf11289dac8c5462d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAME_SIZE&nbsp;&nbsp;&nbsp;160</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00207">207</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9d6bb64b7e9ca3602a00db074a84103d"></a><!-- doxytag: member="chan_oss.c::O_CLOSE" ref="a9d6bb64b7e9ca3602a00db074a84103d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define O_CLOSE&nbsp;&nbsp;&nbsp;0x444</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00225">225</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01018">console_hangup()</a>, <a class="el" href="chan__oss_8c_source.html#l00641">oss_hangup()</a>, <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>, and <a class="el" href="chan__usbradio_8c_source.html#l01724">usbradio_hangup()</a>.</p>

</div>
</div>
<a class="anchor" id="a142810068f1b99cd93d3fc9f0e160e02"></a><!-- doxytag: member="chan_oss.c::QUEUE_SIZE" ref="a142810068f1b99cd93d3fc9f0e160e02" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUEUE_SIZE&nbsp;&nbsp;&nbsp;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00208">208</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="afb6f36d91ffbf947cfa3f1114ca79764"></a><!-- doxytag: member="chan_oss.c::TEXT_SIZE" ref="afb6f36d91ffbf947cfa3f1114ca79764" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEXT_SIZE&nbsp;&nbsp;&nbsp;256</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00220">220</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a422b43626fc2d780dad3ca0280b79225"></a><!-- doxytag: member="chan_oss.c::WARN_frag" ref="a422b43626fc2d780dad3ca0280b79225" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WARN_frag&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00262">262</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>.</p>

</div>
</div>
<a class="anchor" id="a93bf0c7c887e8b899663f17882cf5b40"></a><!-- doxytag: member="chan_oss.c::WARN_speed" ref="a93bf0c7c887e8b899663f17882cf5b40" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WARN_speed&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00261">261</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>.</p>

</div>
</div>
<a class="anchor" id="a11aaf77355342e1ba8feee89c4d66e51"></a><!-- doxytag: member="chan_oss.c::WARN_used_blocks" ref="a11aaf77355342e1ba8feee89c4d66e51" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WARN_used_blocks&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00260">260</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00418">used_blocks()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0f44101ca5201079b78743aefadf5066"></a><!-- doxytag: member="chan_oss.c::ast_ext_ctx" ref="a0f44101ca5201079b78743aefadf5066" args="(const char *src, char **ext, char **ctx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* ast_ext_ctx </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ctx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00390">390</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, and <a class="el" href="chan__oss_8c_source.html#l00266">chan_oss_pvt::overridecontext</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01070">console_dial()</a>, and <a class="el" href="chan__oss_8c_source.html#l01153">console_transfer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00391"></a>00391 {
<a name="l00392"></a>00392    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394    <span class="keywordflow">if</span> (<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a> == NULL || <a class="code" href="structchan__oss__pvt.html#a02d0db19ebec1fa1e0d29bda775c1096">ctx</a> == NULL)
<a name="l00395"></a>00395       <span class="keywordflow">return</span> NULL;         <span class="comment">/* error */</span>
<a name="l00396"></a>00396 
<a name="l00397"></a>00397    *<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a> = *<a class="code" href="structchan__oss__pvt.html#a02d0db19ebec1fa1e0d29bda775c1096">ctx</a> = NULL;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399    <span class="keywordflow">if</span> (src &amp;&amp; *src != <span class="charliteral">&apos;\0&apos;</span>)
<a name="l00400"></a>00400       *<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(src);
<a name="l00401"></a>00401 
<a name="l00402"></a>00402    <span class="keywordflow">if</span> (*<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a> == NULL)
<a name="l00403"></a>00403       <span class="keywordflow">return</span> NULL;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405    <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structchan__oss__pvt.html#a4eedfe56e88e9cb9777a619c022fe6a8">overridecontext</a>) {
<a name="l00406"></a>00406       <span class="comment">/* parse from the right */</span>
<a name="l00407"></a>00407       *<a class="code" href="structchan__oss__pvt.html#a02d0db19ebec1fa1e0d29bda775c1096">ctx</a> = strrchr(*<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>, <span class="charliteral">&apos;@&apos;</span>);
<a name="l00408"></a>00408       <span class="keywordflow">if</span> (*<a class="code" href="structchan__oss__pvt.html#a02d0db19ebec1fa1e0d29bda775c1096">ctx</a>)
<a name="l00409"></a>00409          *(*ctx)++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00410"></a>00410    }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412    <span class="keywordflow">return</span> *<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>;
<a name="l00413"></a>00413 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3e6658947915311fa7cf769e5ebcdbd8"></a><!-- doxytag: member="chan_oss.c::AST_MODULE_INFO_STANDARD" ref="a3e6658947915311fa7cf769e5ebcdbd8" args="(ASTERISK_GPL_KEY,&quot;OSS Console Channel Driver&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_MODULE_INFO_STANDARD </td>
          <td>(</td>
          <td class="paramtype">ASTERISK_GPL_KEY&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;OSS Console Channel Driver&quot;&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a00804379ae74e1b93cd8423a3339fd0d"></a><!-- doxytag: member="chan_oss.c::console_active" ref="a00804379ae74e1b93cd8423a3339fd0d" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_active </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01195">1195</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00248">chan_oss_pvt::name</a>, <a class="el" href="chan__oss_8c_source.html#l00246">chan_oss_pvt::next</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01196"></a>01196 {
<a name="l01197"></a>01197    <span class="keywordflow">switch</span> (cmd) {
<a name="l01198"></a>01198    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l01199"></a>01199       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console {set|show} active [&lt;device&gt;]&quot;</span>;
<a name="l01200"></a>01200       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01201"></a>01201          <span class="stringliteral">&quot;Usage: console active [device]\n&quot;</span>
<a name="l01202"></a>01202          <span class="stringliteral">&quot;       If used without a parameter, displays which device is the current\n&quot;</span>
<a name="l01203"></a>01203          <span class="stringliteral">&quot;       console.  If a device is specified, the console sound device is changed to\n&quot;</span>
<a name="l01204"></a>01204          <span class="stringliteral">&quot;       the device specified.\n&quot;</span>;
<a name="l01205"></a>01205       <span class="keywordflow">return</span> NULL;
<a name="l01206"></a>01206    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l01207"></a>01207       <span class="keywordflow">return</span> NULL;
<a name="l01208"></a>01208    }
<a name="l01209"></a>01209 
<a name="l01210"></a>01210    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3)
<a name="l01211"></a>01211       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;active console is [%s]\n&quot;</span>, <a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01212"></a>01212    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != 4)
<a name="l01213"></a>01213       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01214"></a>01214    <span class="keywordflow">else</span> {
<a name="l01215"></a>01215       <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o;
<a name="l01216"></a>01216       <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3], <span class="stringliteral">&quot;show&quot;</span>) == 0) {
<a name="l01217"></a>01217          <span class="keywordflow">for</span> (o = <a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>.<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>; o; o = o-&gt;<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>)
<a name="l01218"></a>01218             <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;device [%s] exists\n&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l01219"></a>01219          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01220"></a>01220       }
<a name="l01221"></a>01221       o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3]);
<a name="l01222"></a>01222       <span class="keywordflow">if</span> (o == NULL)
<a name="l01223"></a>01223          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;No device [%s] exists\n&quot;</span>, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[3]);
<a name="l01224"></a>01224       <span class="keywordflow">else</span>
<a name="l01225"></a>01225          <a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a> = o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a>;
<a name="l01226"></a>01226    }
<a name="l01227"></a>01227    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01228"></a>01228 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a55ba77a51995e97d474335b6bdf3a91f"></a><!-- doxytag: member="chan_oss.c::console_answer" ref="a55ba77a51995e97d474335b6bdf3a91f" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_answer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>answer command from the <a class="el" href="structconsole.html">console</a> </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00960">960</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="chan__oss_8c_source.html#l00943">console_do_answer()</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00961"></a>00961 {
<a name="l00962"></a>00962    <span class="keywordflow">switch</span> (cmd) {
<a name="l00963"></a>00963    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00964"></a>00964       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console answer&quot;</span>;
<a name="l00965"></a>00965       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l00966"></a>00966          <span class="stringliteral">&quot;Usage: console answer\n&quot;</span>
<a name="l00967"></a>00967          <span class="stringliteral">&quot;       Answers an incoming call on the console (OSS) channel.\n&quot;</span>;
<a name="l00968"></a>00968       <span class="keywordflow">return</span> NULL;
<a name="l00969"></a>00969 
<a name="l00970"></a>00970    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00971"></a>00971       <span class="keywordflow">return</span> NULL;   <span class="comment">/* no completion */</span>
<a name="l00972"></a>00972    }
<a name="l00973"></a>00973    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>)
<a name="l00974"></a>00974       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00975"></a>00975    <span class="keywordflow">return</span> <a class="code" href="chan__oss_8c.html#a7f2b1c7280aa3d53f6f4ba491133b595" title="helper function for the answer key/cli command">console_do_answer</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>);
<a name="l00976"></a>00976 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a87689806923f4dee4f881d5feeae8890"></a><!-- doxytag: member="chan_oss.c::console_autoanswer" ref="a87689806923f4dee4f881d5feeae8890" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_autoanswer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00904">904</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="chan__oss_8c_source.html#l00252">chan_oss_pvt::autoanswer</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00905"></a>00905 {
<a name="l00906"></a>00906    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00907"></a>00907 
<a name="l00908"></a>00908    <span class="keywordflow">switch</span> (cmd) {
<a name="l00909"></a>00909    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00910"></a>00910       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console {set|show} autoanswer [on|off]&quot;</span>;
<a name="l00911"></a>00911       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l00912"></a>00912          <span class="stringliteral">&quot;Usage: console {set|show} autoanswer [on|off]\n&quot;</span>
<a name="l00913"></a>00913          <span class="stringliteral">&quot;       Enables or disables autoanswer feature.  If used without\n&quot;</span>
<a name="l00914"></a>00914          <span class="stringliteral">&quot;       argument, displays the current on/off status of autoanswer.\n&quot;</span>
<a name="l00915"></a>00915          <span class="stringliteral">&quot;       The default value of autoanswer is in &apos;oss.conf&apos;.\n&quot;</span>;
<a name="l00916"></a>00916       <span class="keywordflow">return</span> NULL;
<a name="l00917"></a>00917 
<a name="l00918"></a>00918    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00919"></a>00919       <span class="keywordflow">return</span> NULL;
<a name="l00920"></a>00920    }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> - 1) {
<a name="l00923"></a>00923       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Auto answer is %s.\n&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#aa682db27c8180700165db1398964b3c8">autoanswer</a> ? <span class="stringliteral">&quot;on&quot;</span> : <span class="stringliteral">&quot;off&quot;</span>);
<a name="l00924"></a>00924       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00925"></a>00925    }
<a name="l00926"></a>00926    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>)
<a name="l00927"></a>00927       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00928"></a>00928    <span class="keywordflow">if</span> (o == NULL) {
<a name="l00929"></a>00929       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot find device %s (should not happen!)\n&quot;</span>,
<a name="l00930"></a>00930           <a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00931"></a>00931       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l00932"></a>00932    }
<a name="l00933"></a>00933    <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>-1], <span class="stringliteral">&quot;on&quot;</span>))
<a name="l00934"></a>00934       o-&gt;<a class="code" href="structchan__oss__pvt.html#aa682db27c8180700165db1398964b3c8">autoanswer</a> = 1;
<a name="l00935"></a>00935    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> - 1], <span class="stringliteral">&quot;off&quot;</span>))
<a name="l00936"></a>00936       o-&gt;<a class="code" href="structchan__oss__pvt.html#aa682db27c8180700165db1398964b3c8">autoanswer</a> = 0;
<a name="l00937"></a>00937    <span class="keywordflow">else</span>
<a name="l00938"></a>00938       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00939"></a>00939    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00940"></a>00940 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7a67c1431e82f1aef2a469acaec24e83"></a><!-- doxytag: member="chan_oss.c::console_boost" ref="a7a67c1431e82f1aef2a469acaec24e83" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_boost </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01252">1252</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="chan__oss_8c_source.html#l00274">chan_oss_pvt::boost</a>, <a class="el" href="chan__oss_8c_source.html#l00272">BOOST_SCALE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l01233">store_boost()</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01253"></a>01253 {
<a name="l01254"></a>01254    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01255"></a>01255 
<a name="l01256"></a>01256    <span class="keywordflow">switch</span> (cmd) {
<a name="l01257"></a>01257    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l01258"></a>01258       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console boost&quot;</span>;
<a name="l01259"></a>01259       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01260"></a>01260          <span class="stringliteral">&quot;Usage: console boost [boost in dB]\n&quot;</span>
<a name="l01261"></a>01261          <span class="stringliteral">&quot;       Sets or display mic boost in dB\n&quot;</span>;
<a name="l01262"></a>01262       <span class="keywordflow">return</span> NULL;
<a name="l01263"></a>01263    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l01264"></a>01264       <span class="keywordflow">return</span> NULL;
<a name="l01265"></a>01265    }
<a name="l01266"></a>01266 
<a name="l01267"></a>01267    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 2)
<a name="l01268"></a>01268       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;boost currently %5.1f\n&quot;</span>, 20 * log10(((<span class="keywordtype">double</span>) o-&gt;<a class="code" href="structchan__oss__pvt.html#acd32205748f53b345085531047aefa00">boost</a> / (<span class="keywordtype">double</span>) <a class="code" href="chan__oss_8c.html#a7b687e61ed66e74f77982bc22fd0c446">BOOST_SCALE</a>)));
<a name="l01269"></a>01269    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == 3)
<a name="l01270"></a>01270       <a class="code" href="chan__oss_8c.html#a84654a000b40dc9279c90ebe4f0cec8d" title="store the boost factor">store_boost</a>(o, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2]);
<a name="l01271"></a>01271    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01272"></a>01272 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a886dc7bd4ea37a2679329faa3e35cd9a"></a><!-- doxytag: member="chan_oss.c::console_cmd" ref="a886dc7bd4ea37a2679329faa3e35cd9a" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_cmd </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generic <a class="el" href="structconsole.html">console</a> command handler. Basically a wrapper for a subset of config file options which are also available from the CLI </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00868">868</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="console__video_8c_source.html#l00121">console_video_cli()</a>, <a class="el" href="console__video_8h_source.html#l00027">CONSOLE_VIDEO_CMDS</a>, <a class="el" href="chan__oss_8c_source.html#l00275">chan_oss_pvt::device</a>, <a class="el" href="chan__oss_8c_source.html#l00281">chan_oss_pvt::env</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l01317">store_config_core()</a>, <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>, and <a class="el" href="ast__expr2f_8c_source.html#l00613">var</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00869"></a>00869 {
<a name="l00870"></a>00870    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00871"></a>00871    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, *value;
<a name="l00872"></a>00872    <span class="keywordflow">switch</span> (cmd) {
<a name="l00873"></a>00873    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l00874"></a>00874       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <a class="code" href="console__video_8h.html#a7e4ff3e7d3955ff6aee682af9097cac4">CONSOLE_VIDEO_CMDS</a>;
<a name="l00875"></a>00875       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = 
<a name="l00876"></a>00876          <span class="stringliteral">&quot;Usage: &quot;</span> <a class="code" href="console__video_8h.html#a7e4ff3e7d3955ff6aee682af9097cac4">CONSOLE_VIDEO_CMDS</a> <span class="stringliteral">&quot;...\n&quot;</span>
<a name="l00877"></a>00877          <span class="stringliteral">&quot;       Generic handler for console commands.\n&quot;</span>;
<a name="l00878"></a>00878       <span class="keywordflow">return</span> NULL;
<a name="l00879"></a>00879 
<a name="l00880"></a>00880    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l00881"></a>00881       <span class="keywordflow">return</span> NULL;
<a name="l00882"></a>00882    }
<a name="l00883"></a>00883 
<a name="l00884"></a>00884    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &lt; e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>)
<a name="l00885"></a>00885       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l00886"></a>00886    <span class="keywordflow">if</span> (o == NULL) {
<a name="l00887"></a>00887       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot find device %s (should not happen!)\n&quot;</span>,
<a name="l00888"></a>00888          <a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00889"></a>00889       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l00890"></a>00890    }
<a name="l00891"></a>00891    var = a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>-1];
<a name="l00892"></a>00892    value = a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &gt; e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> ? a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>] : NULL;
<a name="l00893"></a>00893    <span class="keywordflow">if</span> (value)      <span class="comment">/* handle setting */</span>
<a name="l00894"></a>00894       <a class="code" href="chan__oss_8c.html#a5aaad0a97630adacb1072ec67727d221">store_config_core</a>(o, var, value);
<a name="l00895"></a>00895    <span class="keywordflow">if</span> (!<a class="code" href="console__video_8c.html#aa299d688ef19ce0558b1de25427c6694">console_video_cli</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a53a1ea8614142fc091720c64f0209ac4">env</a>, var, a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>))  <span class="comment">/* print video-related values */</span>
<a name="l00896"></a>00896       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00897"></a>00897    <span class="comment">/* handle other values */</span>
<a name="l00898"></a>00898    <span class="keywordflow">if</span> (!strcasecmp(var, <span class="stringliteral">&quot;device&quot;</span>)) {
<a name="l00899"></a>00899       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;device is [%s]\n&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>);
<a name="l00900"></a>00900    }
<a name="l00901"></a>00901    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00902"></a>00902 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a643ab48c2c5d59def5576f4b4920d1b2"></a><!-- doxytag: member="chan_oss.c::console_dial" ref="a643ab48c2c5d59def5576f4b4920d1b2" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_dial </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01070">1070</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="pbx_8c_source.html#l04143">ast_exists_extension()</a>, <a class="el" href="chan__oss_8c_source.html#l00390">ast_ext_ctx()</a>, <a class="el" href="frame_8h_source.html#l00124">AST_FRAME_DTMF</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="channel_8c_source.html#l01080">ast_queue_frame()</a>, <a class="el" href="channel_8h_source.html#l00364">AST_STATE_RINGING</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="chan__oss_8c_source.html#l00284">chan_oss_pvt::ctx</a>, <a class="el" href="chan__oss_8c_source.html#l00283">chan_oss_pvt::ext</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, <a class="el" href="chan__oss_8c_source.html#l00784">oss_new()</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01071"></a>01071 {
<a name="l01072"></a>01072    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> = NULL, *mye = NULL, *myc = NULL;
<a name="l01073"></a>01073    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01074"></a>01074 
<a name="l01075"></a>01075    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>) {
<a name="l01076"></a>01076       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console dial&quot;</span>;
<a name="l01077"></a>01077       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01078"></a>01078          <span class="stringliteral">&quot;Usage: console dial [extension[@context]]\n&quot;</span>
<a name="l01079"></a>01079          <span class="stringliteral">&quot;       Dials a given extension (and context if specified)\n&quot;</span>;
<a name="l01080"></a>01080       <span class="keywordflow">return</span> NULL;
<a name="l01081"></a>01081    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>)
<a name="l01082"></a>01082       <span class="keywordflow">return</span> NULL;
<a name="l01083"></a>01083 
<a name="l01084"></a>01084    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &gt; e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> + 1)
<a name="l01085"></a>01085       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01086"></a>01086    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {   <span class="comment">/* already in a call */</span>
<a name="l01087"></a>01087       <span class="keywordtype">int</span> i;
<a name="l01088"></a>01088       <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> <a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a> = { <a class="code" href="frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>, 0 };
<a name="l01089"></a>01089 
<a name="l01090"></a>01090       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>) {  <span class="comment">/* argument is mandatory here */</span>
<a name="l01091"></a>01091          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Already in a call. You can only dial digits until you hangup.\n&quot;</span>);
<a name="l01092"></a>01092          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l01093"></a>01093       }
<a name="l01094"></a>01094       s = a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>];
<a name="l01095"></a>01095       <span class="comment">/* send the string one char at a time */</span>
<a name="l01096"></a>01096       <span class="keywordflow">for</span> (i = 0; i &lt; strlen(s); i++) {
<a name="l01097"></a>01097          f.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = s[i];
<a name="l01098"></a>01098          <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, &amp;f);
<a name="l01099"></a>01099       }
<a name="l01100"></a>01100       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01101"></a>01101    }
<a name="l01102"></a>01102    <span class="comment">/* if we have an argument split it into extension and context */</span>
<a name="l01103"></a>01103    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> + 1)
<a name="l01104"></a>01104       s = <a class="code" href="chan__oss_8c.html#a0f44101ca5201079b78743aefadf5066">ast_ext_ctx</a>(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>], &amp;mye, &amp;myc);
<a name="l01105"></a>01105    <span class="comment">/* supply default values if needed */</span>
<a name="l01106"></a>01106    <span class="keywordflow">if</span> (mye == NULL)
<a name="l01107"></a>01107       mye = o-&gt;<a class="code" href="structchan__oss__pvt.html#a1ad093b5bae14543eb7fe9f409d9c83b">ext</a>;
<a name="l01108"></a>01108    <span class="keywordflow">if</span> (myc == NULL)
<a name="l01109"></a>01109       myc = o-&gt;<a class="code" href="structchan__oss__pvt.html#a02d0db19ebec1fa1e0d29bda775c1096">ctx</a>;
<a name="l01110"></a>01110    <span class="keywordflow">if</span> (<a class="code" href="pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7" title="Determine whether an extension exists.">ast_exists_extension</a>(NULL, myc, mye, 1, NULL)) {
<a name="l01111"></a>01111       o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 1;
<a name="l01112"></a>01112       <a class="code" href="chan__oss_8c.html#a2ac8539acc7a1fdfc33592b8f822cdce" title="allocate a new channel.">oss_new</a>(o, mye, myc, <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660a5bf03bd84f434acaeefdacb0096e1baa">AST_STATE_RINGING</a>);
<a name="l01113"></a>01113    } <span class="keywordflow">else</span>
<a name="l01114"></a>01114       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;No such extension &apos;%s&apos; in context &apos;%s&apos;\n&quot;</span>, mye, myc);
<a name="l01115"></a>01115    <span class="keywordflow">if</span> (s)
<a name="l01116"></a>01116       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(s);
<a name="l01117"></a>01117    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01118"></a>01118 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7f2b1c7280aa3d53f6f4ba491133b595"></a><!-- doxytag: member="chan_oss.c::console_do_answer" ref="a7f2b1c7280aa3d53f6f4ba491133b595" args="(int fd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_do_answer </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>helper function for the answer key/cli command </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00943">943</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8h_source.html#l00301">AST_CONTROL_ANSWER</a>, <a class="el" href="frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="channel_8c_source.html#l01080">ast_queue_frame()</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, and <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00960">console_answer()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00944"></a>00944 {
<a name="l00945"></a>00945    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> <a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a> = { <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a> };
<a name="l00946"></a>00946    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00947"></a>00947    <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {
<a name="l00948"></a>00948       <span class="keywordflow">if</span> (fd &gt; -1)
<a name="l00949"></a>00949          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(fd, <span class="stringliteral">&quot;No one is calling us\n&quot;</span>);
<a name="l00950"></a>00950       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l00951"></a>00951    }
<a name="l00952"></a>00952    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 1;
<a name="l00953"></a>00953    <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, &amp;f);
<a name="l00954"></a>00954    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l00955"></a>00955 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acac1ff49331792a79142e02a92d13af4"></a><!-- doxytag: member="chan_oss.c::console_flash" ref="acac1ff49331792a79142e02a92d13af4" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_flash </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01044">1044</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8h_source.html#l00306">AST_CONTROL_FLASH</a>, <a class="el" href="frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="channel_8c_source.html#l01080">ast_queue_frame()</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01045"></a>01045 {
<a name="l01046"></a>01046    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> <a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a> = { <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a> };
<a name="l01047"></a>01047    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01048"></a>01048 
<a name="l01049"></a>01049    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>) {
<a name="l01050"></a>01050       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console flash&quot;</span>;
<a name="l01051"></a>01051       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01052"></a>01052          <span class="stringliteral">&quot;Usage: console flash\n&quot;</span>
<a name="l01053"></a>01053          <span class="stringliteral">&quot;       Flashes the call currently placed on the console.\n&quot;</span>;
<a name="l01054"></a>01054       <span class="keywordflow">return</span> NULL;
<a name="l01055"></a>01055    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>)
<a name="l01056"></a>01056       <span class="keywordflow">return</span> NULL;
<a name="l01057"></a>01057 
<a name="l01058"></a>01058    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>)
<a name="l01059"></a>01059       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01060"></a>01060    <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {        <span class="comment">/* XXX maybe !o-&gt;hookstate too ? */</span>
<a name="l01061"></a>01061       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;No call to flash\n&quot;</span>);
<a name="l01062"></a>01062       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l01063"></a>01063    }
<a name="l01064"></a>01064    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 0;
<a name="l01065"></a>01065    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)
<a name="l01066"></a>01066       <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, &amp;f);
<a name="l01067"></a>01067    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01068"></a>01068 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96bff27db51b05b64eb2e87335790e7a"></a><!-- doxytag: member="chan_oss.c::console_hangup" ref="a96bff27db51b05b64eb2e87335790e7a" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_hangup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01018">1018</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="causes_8h_source.html#l00102">AST_CAUSE_NORMAL_CLEARING</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="channel_8c_source.html#l01103">ast_queue_hangup_with_cause()</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, <a class="el" href="chan__oss_8c_source.html#l00225">O_CLOSE</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01019"></a>01019 {
<a name="l01020"></a>01020    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01021"></a>01021 
<a name="l01022"></a>01022    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>) {
<a name="l01023"></a>01023       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console hangup&quot;</span>;
<a name="l01024"></a>01024       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01025"></a>01025          <span class="stringliteral">&quot;Usage: console hangup\n&quot;</span>
<a name="l01026"></a>01026          <span class="stringliteral">&quot;       Hangs up any call currently placed on the console.\n&quot;</span>;
<a name="l01027"></a>01027       <span class="keywordflow">return</span> NULL;
<a name="l01028"></a>01028    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>)
<a name="l01029"></a>01029       <span class="keywordflow">return</span> NULL;
<a name="l01030"></a>01030 
<a name="l01031"></a>01031    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>)
<a name="l01032"></a>01032       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01033"></a>01033    <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> &amp;&amp; !o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a>) { <span class="comment">/* XXX maybe only one ? */</span>
<a name="l01034"></a>01034       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;No call to hang up\n&quot;</span>);
<a name="l01035"></a>01035       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l01036"></a>01036    }
<a name="l01037"></a>01037    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 0;
<a name="l01038"></a>01038    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)
<a name="l01039"></a>01039       <a class="code" href="channel_8h.html#a91e78b15da3244307ffd749fa85f4db7" title="Queue a hangup frame with hangupcause set.">ast_queue_hangup_with_cause</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);
<a name="l01040"></a>01040    <a class="code" href="chan__oss_8c.html#a846ca28a12888dffef1ceaa0145fc9e5">setformat</a>(o, <a class="code" href="chan__oss_8c.html#a9d6bb64b7e9ca3602a00db074a84103d">O_CLOSE</a>);
<a name="l01041"></a>01041    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01042"></a>01042 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab5138fd6e43a32eeed7f7439cdf15ddb"></a><!-- doxytag: member="chan_oss.c::console_mute" ref="ab5138fd6e43a32eeed7f7439cdf15ddb" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_mute </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01120">1120</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00267">chan_oss_pvt::mute</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01121"></a>01121 {
<a name="l01122"></a>01122    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01123"></a>01123    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l01124"></a>01124    <span class="keywordtype">int</span> toggle = 0;
<a name="l01125"></a>01125    
<a name="l01126"></a>01126    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>) {
<a name="l01127"></a>01127       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console {mute|unmute} [toggle]&quot;</span>;
<a name="l01128"></a>01128       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01129"></a>01129          <span class="stringliteral">&quot;Usage: console {mute|unmute} [toggle]\n&quot;</span>
<a name="l01130"></a>01130          <span class="stringliteral">&quot;       Mute/unmute the microphone.\n&quot;</span>;
<a name="l01131"></a>01131       <span class="keywordflow">return</span> NULL;
<a name="l01132"></a>01132    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>)
<a name="l01133"></a>01133       <span class="keywordflow">return</span> NULL;
<a name="l01134"></a>01134 
<a name="l01135"></a>01135    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &gt; e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>)
<a name="l01136"></a>01136       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01137"></a>01137    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>) {
<a name="l01138"></a>01138       <span class="keywordflow">if</span> (strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>-1], <span class="stringliteral">&quot;toggle&quot;</span>))
<a name="l01139"></a>01139          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01140"></a>01140       toggle = 1;
<a name="l01141"></a>01141    }
<a name="l01142"></a>01142    s = a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>-2];
<a name="l01143"></a>01143    <span class="keywordflow">if</span> (!strcasecmp(s, <span class="stringliteral">&quot;mute&quot;</span>))
<a name="l01144"></a>01144       o-&gt;<a class="code" href="structchan__oss__pvt.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> = toggle ? !o-&gt;<a class="code" href="structchan__oss__pvt.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> : 1;
<a name="l01145"></a>01145    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(s, <span class="stringliteral">&quot;unmute&quot;</span>))
<a name="l01146"></a>01146       o-&gt;<a class="code" href="structchan__oss__pvt.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> = toggle ? !o-&gt;<a class="code" href="structchan__oss__pvt.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> : 0;
<a name="l01147"></a>01147    <span class="keywordflow">else</span>
<a name="l01148"></a>01148       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01149"></a>01149    <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Console mic is %s\n&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a> ? <span class="stringliteral">&quot;off&quot;</span> : <span class="stringliteral">&quot;on&quot;</span>);
<a name="l01150"></a>01150    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01151"></a>01151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad732532ff0daadd7b2499aa08eac29b2"></a><!-- doxytag: member="chan_oss.c::console_sendtext" ref="ad732532ff0daadd7b2499aa08eac29b2" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_sendtext </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Console send text CLI command. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>concatenate all arguments into a single string. argv is NULL-terminated so we can use it right away </dd></dl>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00984">984</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00167">ast_cli_entry::args</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="frame_8h_source.html#l00111">AST_FRAME_TEXT</a>, <a class="el" href="utils_8c_source.html#l01451">ast_join()</a>, <a class="el" href="channel_8c_source.html#l01080">ast_queue_frame()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, <a class="el" href="chan__console_8c_source.html#l00102">TEXT_SIZE</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00985"></a>00985 {
<a name="l00986"></a>00986    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00987"></a>00987    <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[<a class="code" href="chan__console_8c.html#afb6f36d91ffbf947cfa3f1114ca79764" title="Maximum text message length.">TEXT_SIZE</a>];
<a name="l00988"></a>00988 
<a name="l00989"></a>00989    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>) {
<a name="l00990"></a>00990       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console send text&quot;</span>;
<a name="l00991"></a>00991       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l00992"></a>00992          <span class="stringliteral">&quot;Usage: console send text &lt;message&gt;\n&quot;</span>
<a name="l00993"></a>00993          <span class="stringliteral">&quot;       Sends a text message for display on the remote terminal.\n&quot;</span>;
<a name="l00994"></a>00994       <span class="keywordflow">return</span> NULL;
<a name="l00995"></a>00995    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>)
<a name="l00996"></a>00996       <span class="keywordflow">return</span> NULL;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> &lt; e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a> + 1)
<a name="l00999"></a>00999       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01000"></a>01000    <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {
<a name="l01001"></a>01001       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Not in a call\n&quot;</span>);
<a name="l01002"></a>01002       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l01003"></a>01003    }
<a name="l01004"></a>01004    <a class="code" href="strings_8h.html#a0c9c27a9e6b4a6d1e2b868525ae3d0c1">ast_join</a>(buf, <span class="keyword">sizeof</span>(buf) - 1, a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a> + e-&gt;<a class="code" href="structast__cli__entry.html#a1bd7a8575ca2650132d636d65dcda2f6" title="This gets set in ast_cli_register().">args</a>);
<a name="l01005"></a>01005    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(buf)) {
<a name="l01006"></a>01006       <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> <a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a> = { 0, };
<a name="l01007"></a>01007       <span class="keywordtype">int</span> i = strlen(buf);
<a name="l01008"></a>01008       buf[i] = <span class="charliteral">&apos;\n&apos;</span>;
<a name="l01009"></a>01009       f.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0af7728b18670d3cd075f63d67f8867078">AST_FRAME_TEXT</a>;
<a name="l01010"></a>01010       f.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = 0;
<a name="l01011"></a>01011       f.<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = buf;
<a name="l01012"></a>01012       f.<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = i + 1;
<a name="l01013"></a>01013       <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, &amp;f);
<a name="l01014"></a>01014    }
<a name="l01015"></a>01015    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01016"></a>01016 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae7138dfcb66f8fc5be57d1dd035083f6"></a><!-- doxytag: member="chan_oss.c::console_transfer" ref="ae7138dfcb66f8fc5be57d1dd035083f6" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char* console_transfer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="paramname"> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01153">1153</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="cli_8h_source.html#l00140">ast_cli_args::argc</a>, <a class="el" href="cli_8h_source.html#l00141">ast_cli_args::argv</a>, <a class="el" href="pbx_8c_source.html#l07344">ast_async_goto()</a>, <a class="el" href="channel_8c_source.html#l04733">ast_bridged_channel()</a>, <a class="el" href="cli_8c_source.html#l00100">ast_cli()</a>, <a class="el" href="pbx_8c_source.html#l04143">ast_exists_extension()</a>, <a class="el" href="chan__oss_8c_source.html#l00390">ast_ext_ctx()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="channel_8h_source.html#l00444">ast_channel::cid</a>, <a class="el" href="channel_8h_source.html#l00203">ast_callerid::cid_num</a>, <a class="el" href="cli_8h_source.html#l00045">CLI_FAILURE</a>, <a class="el" href="cli_8h_source.html#l00133">CLI_GENERATE</a>, <a class="el" href="cli_8h_source.html#l00132">CLI_INIT</a>, <a class="el" href="cli_8h_source.html#l00044">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h_source.html#l00043">CLI_SUCCESS</a>, <a class="el" href="cli_8h_source.html#l00168">ast_cli_entry::command</a>, <a class="el" href="channel_8h_source.html#l00503">ast_channel::context</a>, <a class="el" href="http_8c_source.html#l00097">ext</a>, <a class="el" href="cli_8h_source.html#l00139">ast_cli_args::fd</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, and <a class="el" href="cli_8h_source.html#l00159">ast_cli_entry::usage</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01154"></a>01154 {
<a name="l01155"></a>01155    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01156"></a>01156    <span class="keyword">struct </span><a class="code" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> *b = NULL;
<a name="l01157"></a>01157    <span class="keywordtype">char</span> *tmp, *<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>, *ctx;
<a name="l01158"></a>01158 
<a name="l01159"></a>01159    <span class="keywordflow">switch</span> (cmd) {
<a name="l01160"></a>01160    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:
<a name="l01161"></a>01161       e-&gt;<a class="code" href="structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;console transfer&quot;</span>;
<a name="l01162"></a>01162       e-&gt;<a class="code" href="structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =
<a name="l01163"></a>01163          <span class="stringliteral">&quot;Usage: console transfer &lt;extension&gt;[@context]\n&quot;</span>
<a name="l01164"></a>01164          <span class="stringliteral">&quot;       Transfers the currently connected call to the given extension (and\n&quot;</span>
<a name="l01165"></a>01165          <span class="stringliteral">&quot;       context if specified)\n&quot;</span>;
<a name="l01166"></a>01166       <span class="keywordflow">return</span> NULL;
<a name="l01167"></a>01167    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#a1c31538430e3fbd1b13483cec8d38feea76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:
<a name="l01168"></a>01168       <span class="keywordflow">return</span> NULL;
<a name="l01169"></a>01169    }
<a name="l01170"></a>01170 
<a name="l01171"></a>01171    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#ad1447518f4372828b8435ae82e48499e">argc</a> != 3)
<a name="l01172"></a>01172       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;
<a name="l01173"></a>01173    <span class="keywordflow">if</span> (o == NULL)
<a name="l01174"></a>01174       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;
<a name="l01175"></a>01175    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> == NULL || (b = <a class="code" href="channel_8h.html#a3f52a5e35d47d8986ccaa66a86018e3a" title="Find bridged channel.">ast_bridged_channel</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)) == NULL) {
<a name="l01176"></a>01176       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;There is no call to transfer\n&quot;</span>);
<a name="l01177"></a>01177       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01178"></a>01178    }
<a name="l01179"></a>01179 
<a name="l01180"></a>01180    tmp = <a class="code" href="chan__oss_8c.html#a0f44101ca5201079b78743aefadf5066">ast_ext_ctx</a>(a-&gt;<a class="code" href="structast__cli__args.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[2], &amp;ext, &amp;ctx);
<a name="l01181"></a>01181    <span class="keywordflow">if</span> (ctx == NULL)        <span class="comment">/* supply default context if needed */</span>
<a name="l01182"></a>01182       ctx = o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;
<a name="l01183"></a>01183    <span class="keywordflow">if</span> (!<a class="code" href="pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7" title="Determine whether an extension exists.">ast_exists_extension</a>(b, ctx, ext, 1, b-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>))
<a name="l01184"></a>01184       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;No such extension exists\n&quot;</span>);
<a name="l01185"></a>01185    <span class="keywordflow">else</span> {
<a name="l01186"></a>01186       <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Whee, transferring %s to %s@%s.\n&quot;</span>, b-&gt;name, ext, ctx);
<a name="l01187"></a>01187       <span class="keywordflow">if</span> (<a class="code" href="pbx_8h.html#ae0ba2eb966a9e3376de61d30513f7302" title="Set the channel to next execute the specified dialplan location.">ast_async_goto</a>(b, ctx, ext, 1))
<a name="l01188"></a>01188          <a class="code" href="cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;Failed to transfer :(\n&quot;</span>);
<a name="l01189"></a>01189    }
<a name="l01190"></a>01190    <span class="keywordflow">if</span> (tmp)
<a name="l01191"></a>01191       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmp);
<a name="l01192"></a>01192    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;
<a name="l01193"></a>01193 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1258323075e6f065208634313f361d72"></a><!-- doxytag: member="chan_oss.c::find_desc" ref="a1258323075e6f065208634313f361d72" args="(char *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> * find_desc </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>dev</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns a pointer to the descriptor with the given name </p>
<p>forward declaration </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00364">364</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l00248">chan_oss_pvt::name</a>, and <a class="el" href="chan__oss_8c_source.html#l00246">chan_oss_pvt::next</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00390">ast_ext_ctx()</a>, <a class="el" href="chan__oss_8c_source.html#l01195">console_active()</a>, <a class="el" href="chan__oss_8c_source.html#l00904">console_autoanswer()</a>, <a class="el" href="chan__oss_8c_source.html#l01252">console_boost()</a>, <a class="el" href="chan__oss_8c_source.html#l00868">console_cmd()</a>, <a class="el" href="chan__oss_8c_source.html#l01070">console_dial()</a>, <a class="el" href="chan__oss_8c_source.html#l00943">console_do_answer()</a>, <a class="el" href="chan__oss_8c_source.html#l01044">console_flash()</a>, <a class="el" href="chan__oss_8c_source.html#l01018">console_hangup()</a>, <a class="el" href="chan__oss_8c_source.html#l01120">console_mute()</a>, <a class="el" href="chan__oss_8c_source.html#l00984">console_sendtext()</a>, <a class="el" href="chan__oss_8c_source.html#l01153">console_transfer()</a>, <a class="el" href="chan__oss_8c_source.html#l00307">get_video_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l01425">load_module()</a>, and <a class="el" href="chan__oss_8c_source.html#l00827">oss_request()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00365"></a>00365 {
<a name="l00366"></a>00366    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = NULL;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368    <span class="keywordflow">if</span> (!dev)
<a name="l00369"></a>00369       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;null dev\n&quot;</span>);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371    <span class="keywordflow">for</span> (o = <a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>.<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>; o &amp;&amp; o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a> &amp;&amp; dev &amp;&amp; strcmp(o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a>, dev) != 0; o = o-&gt;<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373    <span class="keywordflow">if</span> (!o)
<a name="l00374"></a>00374       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;could not find &lt;%s&gt;\n&quot;</span>, dev ? dev : <span class="stringliteral">&quot;--no-device--&quot;</span>);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376    <span class="keywordflow">return</span> o;
<a name="l00377"></a>00377 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9efa542d6b1bda9e31a607c40e5d826a"></a><!-- doxytag: member="chan_oss.c::get_video_desc" ref="a9efa542d6b1bda9e31a607c40e5d826a" args="(struct ast_channel *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct video_desc* get_video_desc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>return the pointer to the video descriptor </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00307">307</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="chan__oss_8c_source.html#l00281">chan_oss_pvt::env</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00784">oss_new()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00308"></a>00308 {
<a name="l00309"></a>00309    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c ? c-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a> : <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l00310"></a>00310    <span class="keywordflow">return</span> o ? o-&gt;<a class="code" href="structchan__oss__pvt.html#a53a1ea8614142fc091720c64f0209ac4">env</a> : NULL;
<a name="l00311"></a>00311 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac3382bf6da54c56b37069bd76bbdf4f9"></a><!-- doxytag: member="chan_oss.c::load_module" ref="ac3382bf6da54c56b37069bd76bbdf4f9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01425">1425</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="config_8c_source.html#l00613">ast_category_browse()</a>, <a class="el" href="channel_8c_source.html#l00557">ast_channel_register()</a>, <a class="el" href="cli_8c_source.html#l01927">ast_cli_register_multiple()</a>, <a class="el" href="config_8c_source.html#l00827">ast_config_destroy()</a>, <a class="el" href="config_8h_source.html#l00139">ast_config_load</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="module_8h_source.html#l00062">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="module_8h_source.html#l00065">AST_MODULE_LOAD_FAILURE</a>, <a class="el" href="module_8h_source.html#l00061">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="channel_8h_source.html#l00229">ast_channel_tech::capabilities</a>, <a class="el" href="config_8h_source.html#l00050">CONFIG_STATUS_FILEINVALID</a>, <a class="el" href="console__video_8c_source.html#l00145">console_video_formats</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00077">global_jbconf</a>, <a class="el" href="logger_8h_source.html#l00163">LOG_ERROR</a>, <a class="el" href="logger_8h_source.html#l00141">LOG_NOTICE</a>, and <a class="el" href="chan__oss_8c_source.html#l01348">store_config()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01426"></a>01426 {
<a name="l01427"></a>01427    <span class="keyword">struct </span><a class="code" href="structast__config.html">ast_config</a> *cfg = NULL;
<a name="l01428"></a>01428    <span class="keywordtype">char</span> *ctg = NULL;
<a name="l01429"></a>01429    <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> <a class="code" href="app__rpt_8c.html#a1f57f20c1f46890828791a4827fe8752">config_flags</a> = { 0 };
<a name="l01430"></a>01430 
<a name="l01431"></a>01431    <span class="comment">/* Copy the default jb config over global_jbconf */</span>
<a name="l01432"></a>01432    memcpy(&amp;<a class="code" href="chan__oss_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>, &amp;<a class="code" href="chan__oss_8c.html#a2d8d5920e90ccbad7832926becdadb29">default_jbconf</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__jb__conf.html" title="General jitterbuffer configuration.">ast_jb_conf</a>));
<a name="l01433"></a>01433 
<a name="l01434"></a>01434    <span class="comment">/* load config file */</span>
<a name="l01435"></a>01435    <span class="keywordflow">if</span> (!(cfg = <a class="code" href="config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(<a class="code" href="chan__oss_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, config_flags))) {
<a name="l01436"></a>01436       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Unable to load config %s\n&quot;</span>, <a class="code" href="chan__oss_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>);
<a name="l01437"></a>01437       <span class="keywordflow">return</span> <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;
<a name="l01438"></a>01438    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {
<a name="l01439"></a>01439       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Config file %s is in an invalid format.  Aborting.\n&quot;</span>, <a class="code" href="chan__oss_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>);
<a name="l01440"></a>01440       <span class="keywordflow">return</span> <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;
<a name="l01441"></a>01441    }
<a name="l01442"></a>01442 
<a name="l01443"></a>01443    <span class="keywordflow">do</span> {
<a name="l01444"></a>01444       <a class="code" href="chan__oss_8c.html#a0c9e9a2c27099a98cad529efa81b63ed">store_config</a>(cfg, ctg);
<a name="l01445"></a>01445    } <span class="keywordflow">while</span> ( (ctg = <a class="code" href="config_8h.html#a611776300f941a63266cb220ac62b4db" title="Goes through categories.">ast_category_browse</a>(cfg, ctg)) != NULL);
<a name="l01446"></a>01446 
<a name="l01447"></a>01447    <a class="code" href="config_8h.html#a710f0b2a897849572b77dd0854b8dc03" title="Destroys a config.">ast_config_destroy</a>(cfg);
<a name="l01448"></a>01448 
<a name="l01449"></a>01449    <span class="keywordflow">if</span> (<a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(<a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>) == NULL) {
<a name="l01450"></a>01450       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Device %s not found\n&quot;</span>, <a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a>);
<a name="l01451"></a>01451       <span class="comment">/* XXX we could default to &apos;dsp&apos; perhaps ? */</span>
<a name="l01452"></a>01452       <span class="comment">/* XXX should cleanup allocated memory etc. */</span>
<a name="l01453"></a>01453       <span class="keywordflow">return</span> <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a>;
<a name="l01454"></a>01454    }
<a name="l01455"></a>01455 
<a name="l01456"></a>01456    <a class="code" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a>.<a class="code" href="structast__channel__tech.html#a9461ee266923070466f95a76158f65cd">capabilities</a> |= <a class="code" href="console__video_8c.html#aae03070b9c626a4d430fd81787752a80">console_video_formats</a>;
<a name="l01457"></a>01457 
<a name="l01458"></a>01458    <span class="keywordflow">if</span> (<a class="code" href="channel_8h.html#ab5f3776fda943e52820ceeee5835c1b4" title="Register a channel technology (a new channel driver) Called by a channel module to...">ast_channel_register</a>(&amp;<a class="code" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a>)) {
<a name="l01459"></a>01459       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to register channel type &apos;OSS&apos;\n&quot;</span>);
<a name="l01460"></a>01460       <span class="keywordflow">return</span> <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a>;
<a name="l01461"></a>01461    }
<a name="l01462"></a>01462 
<a name="l01463"></a>01463    <a class="code" href="cli_8h.html#aadeef34f3106bb78aeb3414032ad7fb7" title="Register multiple commands.">ast_cli_register_multiple</a>(<a class="code" href="chan__oss_8c.html#a657fc1119d2a6e1a4678fbbbe73b18f9">cli_oss</a>, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="chan__oss_8c.html#a657fc1119d2a6e1a4678fbbbe73b18f9">cli_oss</a>));
<a name="l01464"></a>01464 
<a name="l01465"></a>01465    <span class="keywordflow">return</span> <a class="code" href="module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;
<a name="l01466"></a>01466 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae982fbbf697d63f020cf7e0e08872bba"></a><!-- doxytag: member="chan_oss.c::oss_answer" ref="ae982fbbf697d63f020cf7e0e08872bba" args="(struct ast_channel *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_answer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>remote side answered the phone </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00632">632</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l04695">ast_setstate()</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00633"></a>00633 {
<a name="l00634"></a>00634    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>;
<a name="l00635"></a>00635    <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Console call has been answered &gt;&gt; \n&quot;</span>);
<a name="l00636"></a>00636    <a class="code" href="channel_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448" title="Change the state of a channel.">ast_setstate</a>(c, <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>);
<a name="l00637"></a>00637    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 1;
<a name="l00638"></a>00638    <span class="keywordflow">return</span> 0;
<a name="l00639"></a>00639 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56d9dc237611f126fc6790f938a9aca7"></a><!-- doxytag: member="chan_oss.c::oss_call" ref="a56d9dc237611f126fc6790f938a9aca7" args="(struct ast_channel *c, char *dest, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_call </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>handler for incoming calls. Either autoanswer, or start ringing </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00591">591</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00338">AST_APP_ARG</a>, <a class="el" href="frame_8h_source.html#l00301">AST_CONTROL_ANSWER</a>, <a class="el" href="frame_8h_source.html#l00300">AST_CONTROL_RINGING</a>, <a class="el" href="app_8h_source.html#l00355">AST_DECLARE_APP_ARGS</a>, <a class="el" href="frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>, <a class="el" href="app_8h_source.html#l00402">AST_NONSTANDARD_APP_ARGS</a>, <a class="el" href="channel_8c_source.html#l01080">ast_queue_frame()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="chan__oss_8c_source.html#l00252">chan_oss_pvt::autoanswer</a>, <a class="el" href="channel_8h_source.html#l00444">ast_channel::cid</a>, <a class="el" href="channel_8h_source.html#l00202">ast_callerid::cid_dnid</a>, <a class="el" href="channel_8h_source.html#l00204">ast_callerid::cid_name</a>, <a class="el" href="channel_8h_source.html#l00203">ast_callerid::cid_num</a>, <a class="el" href="channel_8h_source.html#l00206">ast_callerid::cid_rdnis</a>, <a class="el" href="frame_8h_source.html#l00165">ast_frame::flags</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>, <a class="el" href="chan__mgcp_8c_source.html#l01737">parse()</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00592"></a>00592 {
<a name="l00593"></a>00593    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>;
<a name="l00594"></a>00594    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> <a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a> = { 0, };
<a name="l00595"></a>00595    <a class="code" href="app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2" title="Declare a structure to hold an application&amp;#39;s arguments.">AST_DECLARE_APP_ARGS</a>(args,
<a name="l00596"></a>00596       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00597"></a>00597       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(<a class="code" href="structast__frame.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>);
<a name="l00598"></a>00598    );
<a name="l00599"></a>00599    <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a> = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(dest);
<a name="l00600"></a>00600 
<a name="l00601"></a>00601    <a class="code" href="app_8h.html#accfcb380df76a64251d88ef49c2dd4e3" title="Performs the &amp;#39;nonstandard&amp;#39; argument separation process for an application...">AST_NONSTANDARD_APP_ARGS</a>(args, parse, <span class="charliteral">&apos;/&apos;</span>);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603    <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Call to device &apos;%s&apos; dnid &apos;%s&apos; rdnis &apos;%s&apos; on console from &apos;%s&apos; &lt;%s&gt; &gt;&gt;\n&quot;</span>, dest, c-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#aa54ab157f47ac529034d524781e2a7e2">cid_dnid</a>, c-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#a4791c5f3aedc8782678867a1741f4131">cid_rdnis</a>, c-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ab2461abe6e234fe4f763b0a2179184b5">cid_name</a>, c-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>);
<a name="l00604"></a>00604    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(args.flags) &amp;&amp; strcasecmp(args.flags, <span class="stringliteral">&quot;answer&quot;</span>) == 0) {
<a name="l00605"></a>00605       f.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>;
<a name="l00606"></a>00606       f.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>;
<a name="l00607"></a>00607       <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(c, &amp;f);
<a name="l00608"></a>00608    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(args.flags) &amp;&amp; strcasecmp(args.flags, <span class="stringliteral">&quot;noanswer&quot;</span>) == 0) {
<a name="l00609"></a>00609       f.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>;
<a name="l00610"></a>00610       f.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>;
<a name="l00611"></a>00611       <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(c, &amp;f);
<a name="l00612"></a>00612       <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(c, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);
<a name="l00613"></a>00613    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#aa682db27c8180700165db1398964b3c8">autoanswer</a>) {
<a name="l00614"></a>00614       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Auto-answered &gt;&gt; \n&quot;</span>);
<a name="l00615"></a>00615       f.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>;
<a name="l00616"></a>00616       f.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>;
<a name="l00617"></a>00617       <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(c, &amp;f);
<a name="l00618"></a>00618       o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 1;
<a name="l00619"></a>00619    } <span class="keywordflow">else</span> {
<a name="l00620"></a>00620       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot;&lt;&lt; Type &apos;answer&apos; to answer, or use &apos;autoanswer&apos; for future calls &gt;&gt; \n&quot;</span>);
<a name="l00621"></a>00621       f.<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>;
<a name="l00622"></a>00622       f.<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>;
<a name="l00623"></a>00623       <a class="code" href="channel_8h.html#a6cbcba5661d55216968cde8fdf913c89" title="Queue one or more frames to a channel&amp;#39;s frame queue.">ast_queue_frame</a>(c, &amp;f);
<a name="l00624"></a>00624       <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(c, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);
<a name="l00625"></a>00625    }
<a name="l00626"></a>00626    <span class="keywordflow">return</span> 0;
<a name="l00627"></a>00627 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1f8c964c9b16fbc2da64b7950c7e0053"></a><!-- doxytag: member="chan_oss.c::oss_digit_begin" ref="a1f8c964c9b16fbc2da64b7950c7e0053" args="(struct ast_channel *c, char digit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_digit_begin </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>digit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00568">568</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00569"></a>00569 {
<a name="l00570"></a>00570    <span class="keywordflow">return</span> 0;
<a name="l00571"></a>00571 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4af09e58b6893b0d8696b89ae6d6da65"></a><!-- doxytag: member="chan_oss.c::oss_digit_end" ref="a4af09e58b6893b0d8696b89ae6d6da65" args="(struct ast_channel *c, char digit, unsigned int duration)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_digit_end </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>digit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>duration</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00573">573</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00574"></a>00574 {
<a name="l00575"></a>00575    <span class="comment">/* no better use for received digits than print them */</span>
<a name="l00576"></a>00576    <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Console Received digit %c of duration %u ms &gt;&gt; \n&quot;</span>, 
<a name="l00577"></a>00577       digit, duration);
<a name="l00578"></a>00578    <span class="keywordflow">return</span> 0;
<a name="l00579"></a>00579 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a666c20b8e1a1f4c72d9542ea546a8d53"></a><!-- doxytag: member="chan_oss.c::oss_fixup" ref="a666c20b8e1a1f4c72d9542ea546a8d53" args="(struct ast_channel *oldchan, struct ast_channel *newchan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_fixup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>oldchan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>newchan</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00741">741</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00742"></a>00742 {
<a name="l00743"></a>00743    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = newchan-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>;
<a name="l00744"></a>00744    o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> = newchan;
<a name="l00745"></a>00745    <span class="keywordflow">return</span> 0;
<a name="l00746"></a>00746 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7605b6fd579dbecb9af474fb824bcce5"></a><!-- doxytag: member="chan_oss.c::oss_hangup" ref="a7605b6fd579dbecb9af474fb824bcce5" args="(struct ast_channel *c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_hangup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00641">641</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="loader_8c_source.html#l01171">ast_module_unref()</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="chan__oss_8c_source.html#l00252">chan_oss_pvt::autoanswer</a>, <a class="el" href="chan__oss_8c_source.html#l00253">chan_oss_pvt::autohangup</a>, <a class="el" href="console__video_8c_source.html#l00136">console_video_uninit()</a>, <a class="el" href="chan__oss_8c_source.html#l00281">chan_oss_pvt::env</a>, <a class="el" href="chan__oss_8c_source.html#l00254">chan_oss_pvt::hookstate</a>, <a class="el" href="chan__oss_8c_source.html#l00225">O_CLOSE</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00642"></a>00642 {
<a name="l00643"></a>00643    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>;
<a name="l00644"></a>00644 
<a name="l00645"></a>00645    c-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a> = NULL;
<a name="l00646"></a>00646    o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> = NULL;
<a name="l00647"></a>00647    <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Hangup on console &gt;&gt; \n&quot;</span>);
<a name="l00648"></a>00648    <a class="code" href="console__video_8c.html#a14310c3e6ff6769f5d68cdb514c53fd9">console_video_uninit</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a53a1ea8614142fc091720c64f0209ac4">env</a>);
<a name="l00649"></a>00649    <a class="code" href="module_8h.html#ac65fa15b16dbc563a2424af744ab003d">ast_module_unref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l00650"></a>00650    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a>) {
<a name="l00651"></a>00651       <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#aa682db27c8180700165db1398964b3c8">autoanswer</a> || o-&gt;<a class="code" href="structchan__oss__pvt.html#a56c3f16f4a1c55d1d95c6a9523cd65ca">autohangup</a>) {
<a name="l00652"></a>00652          <span class="comment">/* Assume auto-hangup too */</span>
<a name="l00653"></a>00653          o-&gt;<a class="code" href="structchan__oss__pvt.html#a6ec03f2e1f4b9ef754003a0019a410a2">hookstate</a> = 0;
<a name="l00654"></a>00654          <a class="code" href="chan__oss_8c.html#a846ca28a12888dffef1ceaa0145fc9e5">setformat</a>(o, <a class="code" href="chan__oss_8c.html#a9d6bb64b7e9ca3602a00db074a84103d">O_CLOSE</a>);
<a name="l00655"></a>00655       }
<a name="l00656"></a>00656    }
<a name="l00657"></a>00657    <span class="keywordflow">return</span> 0;
<a name="l00658"></a>00658 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a16dd74031edf2500a412285237010a62"></a><!-- doxytag: member="chan_oss.c::oss_indicate" ref="a16dd74031edf2500a412285237010a62" args="(struct ast_channel *chan, int cond, const void *data, size_t datalen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_indicate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>datalen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00748">748</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00302">AST_CONTROL_BUSY</a>, <a class="el" href="frame_8h_source.html#l00305">AST_CONTROL_CONGESTION</a>, <a class="el" href="frame_8h_source.html#l00313">AST_CONTROL_HOLD</a>, <a class="el" href="frame_8h_source.html#l00312">AST_CONTROL_PROCEEDING</a>, <a class="el" href="frame_8h_source.html#l00311">AST_CONTROL_PROGRESS</a>, <a class="el" href="frame_8h_source.html#l00300">AST_CONTROL_RINGING</a>, <a class="el" href="frame_8h_source.html#l00317">AST_CONTROL_SRCUPDATE</a>, <a class="el" href="frame_8h_source.html#l00314">AST_CONTROL_UNHOLD</a>, <a class="el" href="frame_8h_source.html#l00315">AST_CONTROL_VIDUPDATE</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="channel_8c_source.html#l05538">ast_moh_start()</a>, <a class="el" href="channel_8c_source.html#l05549">ast_moh_stop()</a>, <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l00288">chan_oss_pvt::mohinterpret</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00749"></a>00749 {
<a name="l00750"></a>00750    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c-&gt;tech_pvt;
<a name="l00751"></a>00751    <span class="keywordtype">int</span> res = 0;
<a name="l00752"></a>00752 
<a name="l00753"></a>00753    <span class="keywordflow">switch</span> (<a class="code" href="app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>) {
<a name="l00754"></a>00754    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:
<a name="l00755"></a>00755    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:
<a name="l00756"></a>00756    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:
<a name="l00757"></a>00757    <span class="keywordflow">case</span> -1:
<a name="l00758"></a>00758       res = -1;
<a name="l00759"></a>00759       <span class="keywordflow">break</span>;
<a name="l00760"></a>00760    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a1a461c5e737ed6ed7c8cb0f78557a6fd">AST_CONTROL_PROGRESS</a>:
<a name="l00761"></a>00761    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a50b7fe33bba67b74dd7b746539e81000">AST_CONTROL_PROCEEDING</a>:
<a name="l00762"></a>00762    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>:
<a name="l00763"></a>00763    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4">AST_CONTROL_SRCUPDATE</a>:
<a name="l00764"></a>00764       <span class="keywordflow">break</span>;
<a name="l00765"></a>00765    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a>:
<a name="l00766"></a>00766       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Console Has Been Placed on Hold &gt;&gt; \n&quot;</span>);
<a name="l00767"></a>00767       <a class="code" href="musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7" title="Turn on music on hold on a given channel.">ast_moh_start</a>(c, data, o-&gt;<a class="code" href="structchan__oss__pvt.html#af689da2b77d1265192a78a5b0994a1d5">mohinterpret</a>);
<a name="l00768"></a>00768       <span class="keywordflow">break</span>;
<a name="l00769"></a>00769    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a>:
<a name="l00770"></a>00770       <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Console Has Been Retrieved from Hold &gt;&gt; \n&quot;</span>);
<a name="l00771"></a>00771       <a class="code" href="musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149" title="Turn off music on hold on a given channel.">ast_moh_stop</a>(c);
<a name="l00772"></a>00772       <span class="keywordflow">break</span>;
<a name="l00773"></a>00773    <span class="keywordflow">default</span>:
<a name="l00774"></a>00774       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Don&apos;t know how to display condition %d on %s\n&quot;</span>, <a class="code" href="app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, c-&gt;name);
<a name="l00775"></a>00775       <span class="keywordflow">return</span> -1;
<a name="l00776"></a>00776    }
<a name="l00777"></a>00777 
<a name="l00778"></a>00778    <span class="keywordflow">return</span> res;
<a name="l00779"></a>00779 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2ac8539acc7a1fdfc33592b8f822cdce"></a><!-- doxytag: member="chan_oss.c::oss_new" ref="a2ac8539acc7a1fdfc33592b8f822cdce" args="(struct chan_oss_pvt *o, char *ext, char *ctx, int state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__channel.html">ast_channel</a>* oss_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>state</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>allocate a new channel. </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00784">784</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00730">ast_channel_alloc</a>, <a class="el" href="channel_8c_source.html#l01576">ast_channel_set_fd()</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="channel_8c_source.html#l01690">ast_hangup()</a>, <a class="el" href="abstract__jb_8c_source.html#l00610">ast_jb_configure()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="loader_8c_source.html#l01163">ast_module_ref()</a>, <a class="el" href="pbx_8c_source.html#l04559">ast_pbx_start()</a>, <a class="el" href="channel_8h_source.html#l00359">AST_STATE_DOWN</a>, <a class="el" href="channel_8h_source.html#l00364">AST_STATE_RINGING</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="stringfields_8h_source.html#l00285">ast_string_field_set</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="channel_8h_source.html#l00444">ast_channel::cid</a>, <a class="el" href="channel_8h_source.html#l00205">ast_callerid::cid_ani</a>, <a class="el" href="channel_8h_source.html#l00202">ast_callerid::cid_dnid</a>, <a class="el" href="chan__oss_8c_source.html#l00286">chan_oss_pvt::cid_name</a>, <a class="el" href="chan__oss_8c_source.html#l00287">chan_oss_pvt::cid_num</a>, <a class="el" href="console__video_8c_source.html#l00145">console_video_formats</a>, <a class="el" href="console__video_8c_source.html#l00131">console_video_start()</a>, <a class="el" href="chan__oss_8c_source.html#l00275">chan_oss_pvt::device</a>, <a class="el" href="chan__oss_8c_source.html#l00307">get_video_desc()</a>, <a class="el" href="chan__oss_8c_source.html#l00077">global_jbconf</a>, <a class="el" href="chan__alsa_8c_source.html#l00106">language</a>, <a class="el" href="chan__oss_8c_source.html#l00285">chan_oss_pvt::language</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="channel_8h_source.html#l00482">ast_channel::nativeformats</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, <a class="el" href="channel_8h_source.html#l00483">ast_channel::readformat</a>, <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>, <a class="el" href="chan__oss_8c_source.html#l00250">chan_oss_pvt::sounddev</a>, <a class="el" href="channel_8h_source.html#l00400">ast_channel::tech</a>, <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>, and <a class="el" href="channel_8h_source.html#l00484">ast_channel::writeformat</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01070">console_dial()</a>, and <a class="el" href="chan__oss_8c_source.html#l00827">oss_request()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00785"></a>00785 {
<a name="l00786"></a>00786    <span class="keyword">struct </span><a class="code" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> *c;
<a name="l00787"></a>00787 
<a name="l00788"></a>00788    c = <a class="code" href="channel_8h.html#adfbceb39821586c0f9be0c47496a4e18">ast_channel_alloc</a>(1, <a class="code" href="structstate.html">state</a>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a557b0d5a633c0a98162e973793689380">cid_num</a>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a2916929201e1417f4ea335e9276aa382">cid_name</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>, ctx, 0, <span class="stringliteral">&quot;Console/%s&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a> + 5);
<a name="l00789"></a>00789    <span class="keywordflow">if</span> (c == NULL)
<a name="l00790"></a>00790       <span class="keywordflow">return</span> NULL;
<a name="l00791"></a>00791    c-&gt;<a class="code" href="structast__channel.html#a0716a334727b22adf0290792bd80de10">tech</a> = &amp;<a class="code" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a>;
<a name="l00792"></a>00792    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a> &lt; 0)
<a name="l00793"></a>00793       <a class="code" href="chan__oss_8c.html#a846ca28a12888dffef1ceaa0145fc9e5">setformat</a>(o, O_RDWR);
<a name="l00794"></a>00794    <a class="code" href="channel_8h.html#aca37ca2f3d55a223d26617329ed48a3e">ast_channel_set_fd</a>(c, 0, o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>); <span class="comment">/* -1 if device closed, override later */</span>
<a name="l00795"></a>00795    c-&gt;<a class="code" href="structast__channel.html#a7be3e8823c2f7e6fe3fc48847ba9bdac">nativeformats</a> = <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>;
<a name="l00796"></a>00796    <span class="comment">/* if the console makes the call, add video to the offer */</span>
<a name="l00797"></a>00797    <span class="keywordflow">if</span> (<a class="code" href="structstate.html">state</a> == <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660a5bf03bd84f434acaeefdacb0096e1baa">AST_STATE_RINGING</a>)
<a name="l00798"></a>00798       c-&gt;<a class="code" href="structast__channel.html#a7be3e8823c2f7e6fe3fc48847ba9bdac">nativeformats</a> |= <a class="code" href="console__video_8c.html#aae03070b9c626a4d430fd81787752a80">console_video_formats</a>;
<a name="l00799"></a>00799 
<a name="l00800"></a>00800    c-&gt;<a class="code" href="structast__channel.html#ab7786a0f5b9a9ebf83daed87be4f3868">readformat</a> = <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>;
<a name="l00801"></a>00801    c-&gt;<a class="code" href="structast__channel.html#a00f5ce2ad53ff8523f8e46ea5aceba48">writeformat</a> = <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>;
<a name="l00802"></a>00802    c-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a> = o;
<a name="l00803"></a>00803 
<a name="l00804"></a>00804    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#adf416dc058363e2fd5750c77e2d78bee">language</a>))
<a name="l00805"></a>00805       <a class="code" href="stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d" title="Set a field to a simple string value.">ast_string_field_set</a>(c, <a class="code" href="chan__alsa_8c.html#adf416dc058363e2fd5750c77e2d78bee">language</a>, o-&gt;<a class="code" href="structchan__oss__pvt.html#adf416dc058363e2fd5750c77e2d78bee">language</a>);
<a name="l00806"></a>00806    <span class="comment">/* Don&apos;t use ast_set_callerid() here because it will</span>
<a name="l00807"></a>00807 <span class="comment">    * generate a needless NewCallerID event */</span>
<a name="l00808"></a>00808    c-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#a7bb8ad258e687da69d6933ab48320df7">cid_ani</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a557b0d5a633c0a98162e973793689380">cid_num</a>);
<a name="l00809"></a>00809    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>))
<a name="l00810"></a>00810       c-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#aa54ab157f47ac529034d524781e2a7e2">cid_dnid</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<a class="code" href="http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>);
<a name="l00811"></a>00811 
<a name="l00812"></a>00812    o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> = c;
<a name="l00813"></a>00813    <a class="code" href="module_8h.html#aa08fcee0b390e15532dd03803c8728c4">ast_module_ref</a>(<a class="code" href="structast__module__info.html">ast_module_info</a>-&gt;self);
<a name="l00814"></a>00814    <a class="code" href="abstract__jb_8h.html#a0981c84ac90dd79bc2a0fdd90aa6efba" title="Configures a jitterbuffer on a channel.">ast_jb_configure</a>(c, &amp;<a class="code" href="chan__oss_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>);
<a name="l00815"></a>00815    <span class="keywordflow">if</span> (<a class="code" href="structstate.html">state</a> != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>) {
<a name="l00816"></a>00816       <span class="keywordflow">if</span> (<a class="code" href="pbx_8h.html#a9a937fbb3b5f4e68880a9c5714a29ce5" title="Create a new thread and start the PBX.">ast_pbx_start</a>(c)) {
<a name="l00817"></a>00817          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to start PBX on %s\n&quot;</span>, c-&gt;name);
<a name="l00818"></a>00818          <a class="code" href="channel_8h.html#a8f2c0f3dcafbc3a74d84a8dddcce6b9c" title="Hang up a channel.">ast_hangup</a>(c);
<a name="l00819"></a>00819          o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> = c = NULL;
<a name="l00820"></a>00820       }
<a name="l00821"></a>00821    }
<a name="l00822"></a>00822    <a class="code" href="console__video_8c.html#a0bbb87120da7024ff01c39a0d40372fa">console_video_start</a>(<a class="code" href="chan__oss_8c.html#a9efa542d6b1bda9e31a607c40e5d826a" title="return the pointer to the video descriptor">get_video_desc</a>(c), c); <span class="comment">/* XXX cleanup */</span>
<a name="l00823"></a>00823 
<a name="l00824"></a>00824    <span class="keywordflow">return</span> c;
<a name="l00825"></a>00825 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a57cda405686ea2b49440e85e2308eb"></a><!-- doxytag: member="chan_oss.c::oss_read" ref="a3a57cda405686ea2b49440e85e2308eb" args="(struct ast_channel *chan)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__frame.html">ast_frame</a> * oss_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00692">692</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00469">ast_channel::_state</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h_source.html#l00107">AST_FRAME_NULL</a>, <a class="el" href="frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h_source.html#l00203">AST_FRIENDLY_OFFSET</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, <a class="el" href="chan__oss_8c_source.html#l00274">chan_oss_pvt::boost</a>, <a class="el" href="chan__oss_8c_source.html#l00272">BOOST_SCALE</a>, <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="format__g726_8c_source.html#l00177">f</a>, <a class="el" href="chan__alsa_8c_source.html#l00077">FRAME_SIZE</a>, <a class="el" href="frame_8h_source.html#l00143">ast_frame::frametype</a>, <a class="el" href="chan__oss_8c_source.html#l00267">chan_oss_pvt::mute</a>, <a class="el" href="frame_8h_source.html#l00155">ast_frame::offset</a>, <a class="el" href="chan__oss_8c_source.html#l00296">chan_oss_pvt::oss_read_buf</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="chan__oss_8c_source.html#l00298">chan_oss_pvt::read_f</a>, <a class="el" href="chan__oss_8c_source.html#l00297">chan_oss_pvt::readpos</a>, <a class="el" href="frame_8h_source.html#l00149">ast_frame::samples</a>, <a class="el" href="chan__oss_8c_source.html#l00250">chan_oss_pvt::sounddev</a>, <a class="el" href="frame_8h_source.html#l00157">ast_frame::src</a>, <a class="el" href="frame_8h_source.html#l00145">ast_frame::subclass</a>, <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>, and <a class="el" href="channel_8h_source.html#l00226">ast_channel_tech::type</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00693"></a>00693 {
<a name="l00694"></a>00694    <span class="keywordtype">int</span> res;
<a name="l00695"></a>00695    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c-&gt;tech_pvt;
<a name="l00696"></a>00696    <span class="keyword">struct </span><a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a> *<a class="code" href="format__g726_8c.html#a6add0b75a88c25db4ccbf690acda6d7f">f</a> = &amp;o-&gt;<a class="code" href="structchan__oss__pvt.html#ae76466f730a632fe0cbebdf16c61d228">read_f</a>;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698    <span class="comment">/* XXX can be simplified returning &amp;ast_null_frame */</span>
<a name="l00699"></a>00699    <span class="comment">/* prepare a NULL frame in case we don&apos;t have enough data to return */</span>
<a name="l00700"></a>00700    memset(f, <span class="charliteral">&apos;\0&apos;</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__frame.html" title="Data structure associated with a single frame of data.">ast_frame</a>));
<a name="l00701"></a>00701    f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a29ff71f9d5c7927906ebd437fe372056">AST_FRAME_NULL</a>;
<a name="l00702"></a>00702    f-&gt;<a class="code" href="structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = <a class="code" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a>.<a class="code" href="structast__channel__tech.html#a8ff938fb2f815be425fd2859a21e6d61">type</a>;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704    res = read(o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>, o-&gt;<a class="code" href="structchan__oss__pvt.html#ae6f6c882638f2681da4695d4eac28d96">oss_read_buf</a> + o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a>, <span class="keyword">sizeof</span>(o-&gt;<a class="code" href="structchan__oss__pvt.html#ae6f6c882638f2681da4695d4eac28d96">oss_read_buf</a>) - o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a>);
<a name="l00705"></a>00705    <span class="keywordflow">if</span> (res &lt; 0)            <span class="comment">/* audio data not ready, return a NULL frame */</span>
<a name="l00706"></a>00706       <span class="keywordflow">return</span> f;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> += res;
<a name="l00709"></a>00709    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> &lt; <span class="keyword">sizeof</span>(o-&gt;<a class="code" href="structchan__oss__pvt.html#ae6f6c882638f2681da4695d4eac28d96">oss_read_buf</a>)) <span class="comment">/* not enough samples */</span>
<a name="l00710"></a>00710       <span class="keywordflow">return</span> f;
<a name="l00711"></a>00711 
<a name="l00712"></a>00712    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a29128ae5c15a12dea5fe4f263ba6cec1">mute</a>)
<a name="l00713"></a>00713       <span class="keywordflow">return</span> f;
<a name="l00714"></a>00714 
<a name="l00715"></a>00715    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> = <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;   <span class="comment">/* reset read pointer for next frame */</span>
<a name="l00716"></a>00716    <span class="keywordflow">if</span> (c-&gt;_state != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>)   <span class="comment">/* drop data if frame is not up */</span>
<a name="l00717"></a>00717       <span class="keywordflow">return</span> f;
<a name="l00718"></a>00718    <span class="comment">/* ok we can build and deliver the frame to the caller */</span>
<a name="l00719"></a>00719    f-&gt;<a class="code" href="structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>;
<a name="l00720"></a>00720    f-&gt;<a class="code" href="structast__frame.html#a8690cd2e4b0ef8477711b72a120ae086">subclass</a> = <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>;
<a name="l00721"></a>00721    f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a> = <a class="code" href="chan__alsa_8c.html#af9b1b2ba12857a4bf11289dac8c5462d">FRAME_SIZE</a>;
<a name="l00722"></a>00722    f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> = <a class="code" href="chan__alsa_8c.html#af9b1b2ba12857a4bf11289dac8c5462d">FRAME_SIZE</a> * 2;
<a name="l00723"></a>00723    f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = o-&gt;<a class="code" href="structchan__oss__pvt.html#ae6f6c882638f2681da4695d4eac28d96">oss_read_buf</a> + <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00724"></a>00724    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#acd32205748f53b345085531047aefa00">boost</a> != <a class="code" href="chan__oss_8c.html#a7b687e61ed66e74f77982bc22fd0c446">BOOST_SCALE</a>) {   <span class="comment">/* scale and clip values */</span>
<a name="l00725"></a>00725       <span class="keywordtype">int</span> i, x;
<a name="l00726"></a>00726       int16_t *p = (int16_t *) f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;
<a name="l00727"></a>00727       for (i = 0; i &lt; f-&gt;<a class="code" href="structast__frame.html#a37672e6b906143604cefd3e959777b31">samples</a>; i++) {
<a name="l00728"></a>00728          x = (p[i] * o-&gt;<a class="code" href="structchan__oss__pvt.html#acd32205748f53b345085531047aefa00">boost</a>) / <a class="code" href="chan__oss_8c.html#a7b687e61ed66e74f77982bc22fd0c446">BOOST_SCALE</a>;
<a name="l00729"></a>00729          <span class="keywordflow">if</span> (x &gt; 32767)
<a name="l00730"></a>00730             x = 32767;
<a name="l00731"></a>00731          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &lt; -32768)
<a name="l00732"></a>00732             x = -32768;
<a name="l00733"></a>00733          p[i] = x;
<a name="l00734"></a>00734       }
<a name="l00735"></a>00735    }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737    f-&gt;<a class="code" href="structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = <a class="code" href="frame_8h.html#ac8f7380b8620c80443286b44481f641c" title="Offset into a frame&amp;#39;s data buffer.">AST_FRIENDLY_OFFSET</a>;
<a name="l00738"></a>00738    <span class="keywordflow">return</span> f;
<a name="l00739"></a>00739 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa050fb51e60829a7bee767bf07c36186"></a><!-- doxytag: member="chan_oss.c::oss_request" ref="aa050fb51e60829a7bee767bf07c36186" args="(const char *type, int format, void *data, int *cause)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__channel.html">ast_channel</a> * oss_request </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>cause</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00827">827</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="app_8h_source.html#l00338">AST_APP_ARG</a>, <a class="el" href="causes_8h_source.html#l00147">AST_CAUSE_BUSY</a>, <a class="el" href="app_8h_source.html#l00355">AST_DECLARE_APP_ARGS</a>, <a class="el" href="frame_8h_source.html#l00253">AST_FORMAT_SLINEAR</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="app_8h_source.html#l00402">AST_NONSTANDARD_APP_ARGS</a>, <a class="el" href="channel_8h_source.html#l00359">AST_STATE_DOWN</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="chan__oss_8c_source.html#l00364">find_desc()</a>, <a class="el" href="logger_8h_source.html#l00141">LOG_NOTICE</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="cdr__adaptive__odbc_8c_source.html#l00053">name</a>, <a class="el" href="chan__oss_8c_source.html#l00784">oss_new()</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, and <a class="el" href="chan__mgcp_8c_source.html#l01737">parse()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00828"></a>00828 {
<a name="l00829"></a>00829    <span class="keyword">struct </span><a class="code" href="structast__channel.html" title="Main Channel structure associated with a channel. This is the side of it mostly used...">ast_channel</a> *c;
<a name="l00830"></a>00830    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o;
<a name="l00831"></a>00831    <a class="code" href="app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2" title="Declare a structure to hold an application&amp;#39;s arguments.">AST_DECLARE_APP_ARGS</a>(args,
<a name="l00832"></a>00832       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00833"></a>00833       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(flags);
<a name="l00834"></a>00834    );
<a name="l00835"></a>00835    <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a> = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l00836"></a>00836 
<a name="l00837"></a>00837    <a class="code" href="app_8h.html#accfcb380df76a64251d88ef49c2dd4e3" title="Performs the &amp;#39;nonstandard&amp;#39; argument separation process for an application...">AST_NONSTANDARD_APP_ARGS</a>(args, parse, <span class="charliteral">&apos;/&apos;</span>);
<a name="l00838"></a>00838    o = <a class="code" href="chan__oss_8c.html#a1258323075e6f065208634313f361d72" title="returns a pointer to the descriptor with the given name">find_desc</a>(args.name);
<a name="l00839"></a>00839 
<a name="l00840"></a>00840    <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;oss_request ty &lt;%s&gt; data 0x%p &lt;%s&gt;\n&quot;</span>, <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, data, (<span class="keywordtype">char</span> *) data);
<a name="l00841"></a>00841    <span class="keywordflow">if</span> (o == NULL) {
<a name="l00842"></a>00842       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Device %s not found\n&quot;</span>, args.name);
<a name="l00843"></a>00843       <span class="comment">/* XXX we could default to &apos;dsp&apos; perhaps ? */</span>
<a name="l00844"></a>00844       <span class="keywordflow">return</span> NULL;
<a name="l00845"></a>00845    }
<a name="l00846"></a>00846    <span class="keywordflow">if</span> ((<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> &amp; <a class="code" href="frame_8h.html#aa68ce7f14882005613a3e1fb0f4181b7">AST_FORMAT_SLINEAR</a>) == 0) {
<a name="l00847"></a>00847       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Format 0x%x unsupported\n&quot;</span>, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);
<a name="l00848"></a>00848       <span class="keywordflow">return</span> NULL;
<a name="l00849"></a>00849    }
<a name="l00850"></a>00850    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {
<a name="l00851"></a>00851       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Already have a call (chan %p) on the OSS channel\n&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>);
<a name="l00852"></a>00852       *<a class="code" href="channel_8c.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a> = <a class="code" href="causes_8h.html#ae009c193522491f7de7ea28b23f20868">AST_CAUSE_BUSY</a>;
<a name="l00853"></a>00853       <span class="keywordflow">return</span> NULL;
<a name="l00854"></a>00854    }
<a name="l00855"></a>00855    c = <a class="code" href="chan__oss_8c.html#a2ac8539acc7a1fdfc33592b8f822cdce" title="allocate a new channel.">oss_new</a>(o, NULL, NULL, <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660a81348336816e0a2f6f3a76da487a46dc">AST_STATE_DOWN</a>);
<a name="l00856"></a>00856    <span class="keywordflow">if</span> (c == NULL) {
<a name="l00857"></a>00857       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to create new OSS channel\n&quot;</span>);
<a name="l00858"></a>00858       <span class="keywordflow">return</span> NULL;
<a name="l00859"></a>00859    }
<a name="l00860"></a>00860    <span class="keywordflow">return</span> c;
<a name="l00861"></a>00861 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24e02bf3a54ce9faac294cd2e13d425a"></a><!-- doxytag: member="chan_oss.c::oss_text" ref="a24e02bf3a54ce9faac294cd2e13d425a" args="(struct ast_channel *c, const char *text)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_text </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>text</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00581">581</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="logger_8h_source.html#l00079">ast_verbose</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00582"></a>00582 {
<a name="l00583"></a>00583    <span class="comment">/* print received messages */</span>
<a name="l00584"></a>00584    <a class="code" href="logger_8h.html#afcd8b407dfb3f461488abf7d1ed70fb9">ast_verbose</a>(<span class="stringliteral">&quot; &lt;&lt; Console Received text %s &gt;&gt; \n&quot;</span>, <a class="code" href="app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>);
<a name="l00585"></a>00585    <span class="keywordflow">return</span> 0;
<a name="l00586"></a>00586 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05474cf14eae6989d1bbb685221401b0"></a><!-- doxytag: member="chan_oss.c::oss_write" ref="a05474cf14eae6989d1bbb685221401b0" args="(struct ast_channel *c, struct ast_frame *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int oss_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>used for data coming from the network </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00661">661</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">ast_frame::data</a>, <a class="el" href="frame_8h_source.html#l00147">ast_frame::datalen</a>, <a class="el" href="chan__oss_8c_source.html#l00291">chan_oss_pvt::oss_write_buf</a>, <a class="el" href="chan__oss_8c_source.html#l00292">chan_oss_pvt::oss_write_dst</a>, <a class="el" href="frame_8h_source.html#l00159">ast_frame::ptr</a>, <a class="el" href="chan__oss_8c_source.html#l00440">soundcard_writeframe()</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00662"></a>00662 {
<a name="l00663"></a>00663    <span class="keywordtype">int</span> src;
<a name="l00664"></a>00664    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o = c-&gt;tech_pvt;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666    <span class="comment">/*</span>
<a name="l00667"></a>00667 <span class="comment">    * we could receive a block which is not a multiple of our</span>
<a name="l00668"></a>00668 <span class="comment">    * FRAME_SIZE, so buffer it locally and write to the device</span>
<a name="l00669"></a>00669 <span class="comment">    * in FRAME_SIZE chunks.</span>
<a name="l00670"></a>00670 <span class="comment">    * Keep the residue stored for future use.</span>
<a name="l00671"></a>00671 <span class="comment">    */</span>
<a name="l00672"></a>00672    src = 0;             <span class="comment">/* read position into f-&gt;data */</span>
<a name="l00673"></a>00673    <span class="keywordflow">while</span> (src &lt; f-&gt;datalen) {
<a name="l00674"></a>00674       <span class="comment">/* Compute spare room in the buffer */</span>
<a name="l00675"></a>00675       <span class="keywordtype">int</span> l = <span class="keyword">sizeof</span>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a5418e1b55f4c65196cbbc35b03defc71">oss_write_buf</a>) - o-&gt;<a class="code" href="structchan__oss__pvt.html#a1e0cc9ca08fcb14db02a5fcc075dfdad">oss_write_dst</a>;
<a name="l00676"></a>00676 
<a name="l00677"></a>00677       if (f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> - src &gt;= l) {  <span class="comment">/* enough to fill a frame */</span>
<a name="l00678"></a>00678          memcpy(o-&gt;<a class="code" href="structchan__oss__pvt.html#a5418e1b55f4c65196cbbc35b03defc71">oss_write_buf</a> + o-&gt;<a class="code" href="structchan__oss__pvt.html#a1e0cc9ca08fcb14db02a5fcc075dfdad">oss_write_dst</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> + src, l);
<a name="l00679"></a>00679          <a class="code" href="chan__oss_8c.html#acedc91aa257e17f0d04f4b6cdd587fec">soundcard_writeframe</a>(o, (<span class="keywordtype">short</span> *) o-&gt;<a class="code" href="structchan__oss__pvt.html#a5418e1b55f4c65196cbbc35b03defc71">oss_write_buf</a>);
<a name="l00680"></a>00680          src += l;
<a name="l00681"></a>00681          o-&gt;<a class="code" href="structchan__oss__pvt.html#a1e0cc9ca08fcb14db02a5fcc075dfdad">oss_write_dst</a> = 0;
<a name="l00682"></a>00682       } <span class="keywordflow">else</span> {          <span class="comment">/* copy residue */</span>
<a name="l00683"></a>00683          l = f-&gt;<a class="code" href="structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a> - src;
<a name="l00684"></a>00684          memcpy(o-&gt;<a class="code" href="structchan__oss__pvt.html#a5418e1b55f4c65196cbbc35b03defc71">oss_write_buf</a> + o-&gt;<a class="code" href="structchan__oss__pvt.html#a1e0cc9ca08fcb14db02a5fcc075dfdad">oss_write_dst</a>, f-&gt;<a class="code" href="structast__frame.html#a7c81436eb90123aabf892413fc5bf849">data</a>.<a class="code" href="structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> + src, l);
<a name="l00685"></a>00685          src += l;         <span class="comment">/* but really, we are done */</span>
<a name="l00686"></a>00686          o-&gt;<a class="code" href="structchan__oss__pvt.html#a1e0cc9ca08fcb14db02a5fcc075dfdad">oss_write_dst</a> += l;
<a name="l00687"></a>00687       }
<a name="l00688"></a>00688    }
<a name="l00689"></a>00689    <span class="keywordflow">return</span> 0;
<a name="l00690"></a>00690 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a846ca28a12888dffef1ceaa0145fc9e5"></a><!-- doxytag: member="chan_oss.c::setformat" ref="a846ca28a12888dffef1ceaa0145fc9e5" args="(struct chan_oss_pvt *o, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int setformat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>reset and close the device if opened, then open and initialize it in the desired mode, trigger reads and writes so we can start using it. </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00469">469</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l01576">ast_channel_set_fd()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="time_8h_source.html#l00089">ast_tvdiff_ms()</a>, <a class="el" href="time_8h_source.html#l00141">ast_tvnow()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="asterisk_8h_source.html#l00041">DEFAULT_SAMPLE_RATE</a>, <a class="el" href="chan__oss_8c_source.html#l00275">chan_oss_pvt::device</a>, <a class="el" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">chan_oss_pvt::duplex</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="chan__oss_8c_source.html#l00257">chan_oss_pvt::frags</a>, <a class="el" href="chan__oss_8c_source.html#l00264">chan_oss_pvt::lastopen</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l00225">O_CLOSE</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, <a class="el" href="chan__oss_8c_source.html#l00250">chan_oss_pvt::sounddev</a>, <a class="el" href="chan__oss_8c_source.html#l00262">WARN_frag</a>, <a class="el" href="chan__oss_8c_source.html#l00261">WARN_speed</a>, and <a class="el" href="chan__oss_8c_source.html#l00259">chan_oss_pvt::warned</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01018">console_hangup()</a>, <a class="el" href="chan__oss_8c_source.html#l00641">oss_hangup()</a>, <a class="el" href="chan__oss_8c_source.html#l00784">oss_new()</a>, <a class="el" href="chan__oss_8c_source.html#l00440">soundcard_writeframe()</a>, and <a class="el" href="chan__oss_8c_source.html#l01348">store_config()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00470"></a>00470 {
<a name="l00471"></a>00471    <span class="keywordtype">int</span> fmt, desired, res, fd;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a> &gt;= 0) {
<a name="l00474"></a>00474       ioctl(o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>, SNDCTL_DSP_RESET, 0);
<a name="l00475"></a>00475       close(o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>);
<a name="l00476"></a>00476       o-&gt;<a class="code" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">duplex</a> = <a class="code" href="structchan__oss__pvt.html#a9e93d8eae633734dfeb29e24a1f3a7c0a89ae3203603c2cd0eecb06b10597f94f">M_UNSET</a>;
<a name="l00477"></a>00477       o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a> = -1;
<a name="l00478"></a>00478    }
<a name="l00479"></a>00479    <span class="keywordflow">if</span> (mode == <a class="code" href="chan__oss_8c.html#a9d6bb64b7e9ca3602a00db074a84103d">O_CLOSE</a>)    <span class="comment">/* we are done */</span>
<a name="l00480"></a>00480       <span class="keywordflow">return</span> 0;
<a name="l00481"></a>00481    <span class="keywordflow">if</span> (<a class="code" href="time_8h.html#a74e35cffcd45ad6cd7c8587921e8a4c2" title="Computes the difference (in milliseconds) between two struct timeval instances.">ast_tvdiff_ms</a>(<a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>(), o-&gt;<a class="code" href="structchan__oss__pvt.html#a335ae1f9f7ea2bc5d6cd92a35bb675c3">lastopen</a>) &lt; 1000)
<a name="l00482"></a>00482       <span class="keywordflow">return</span> -1;           <span class="comment">/* don&apos;t open too often */</span>
<a name="l00483"></a>00483    o-&gt;<a class="code" href="structchan__oss__pvt.html#a335ae1f9f7ea2bc5d6cd92a35bb675c3">lastopen</a> = <a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>();
<a name="l00484"></a>00484    fd = o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a> = open(o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>, mode | O_NONBLOCK);
<a name="l00485"></a>00485    <span class="keywordflow">if</span> (fd &lt; 0) {
<a name="l00486"></a>00486       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to re-open DSP device %s: %s\n&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>, strerror(errno));
<a name="l00487"></a>00487       <span class="keywordflow">return</span> -1;
<a name="l00488"></a>00488    }
<a name="l00489"></a>00489    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)
<a name="l00490"></a>00490       <a class="code" href="channel_8h.html#aca37ca2f3d55a223d26617329ed48a3e">ast_channel_set_fd</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0, fd);
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="preprocessor">#if __BYTE_ORDER == __LITTLE_ENDIAN</span>
<a name="l00493"></a>00493 <span class="preprocessor"></span>   fmt = AFMT_S16_LE;
<a name="l00494"></a>00494 <span class="preprocessor">#else</span>
<a name="l00495"></a>00495 <span class="preprocessor"></span>   fmt = AFMT_S16_BE;
<a name="l00496"></a>00496 <span class="preprocessor">#endif</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span>   res = ioctl(fd, SNDCTL_DSP_SETFMT, &amp;fmt);
<a name="l00498"></a>00498    <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l00499"></a>00499       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to set format to 16-bit signed\n&quot;</span>);
<a name="l00500"></a>00500       <span class="keywordflow">return</span> -1;
<a name="l00501"></a>00501    }
<a name="l00502"></a>00502    <span class="keywordflow">switch</span> (mode) {
<a name="l00503"></a>00503    <span class="keywordflow">case</span> O_RDWR:
<a name="l00504"></a>00504       res = ioctl(fd, SNDCTL_DSP_SETDUPLEX, 0);
<a name="l00505"></a>00505       <span class="comment">/* Check to see if duplex set (FreeBSD Bug) */</span>
<a name="l00506"></a>00506       res = ioctl(fd, SNDCTL_DSP_GETCAPS, &amp;fmt);
<a name="l00507"></a>00507       <span class="keywordflow">if</span> (res == 0 &amp;&amp; (fmt &amp; DSP_CAP_DUPLEX)) {
<a name="l00508"></a>00508          <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Console is full duplex\n&quot;</span>);
<a name="l00509"></a>00509          o-&gt;<a class="code" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">duplex</a> = <a class="code" href="structchan__oss__pvt.html#a9e93d8eae633734dfeb29e24a1f3a7c0a4d444b330d2372546edf9ba1dc8f85e7">M_FULL</a>;
<a name="l00510"></a>00510       };
<a name="l00511"></a>00511       <span class="keywordflow">break</span>;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513    <span class="keywordflow">case</span> O_WRONLY:
<a name="l00514"></a>00514       o-&gt;<a class="code" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">duplex</a> = <a class="code" href="structchan__oss__pvt.html#a9e93d8eae633734dfeb29e24a1f3a7c0a7af369c035a45a9babde5a9443b5ef01">M_WRITE</a>;
<a name="l00515"></a>00515       <span class="keywordflow">break</span>;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517    <span class="keywordflow">case</span> O_RDONLY:
<a name="l00518"></a>00518       o-&gt;<a class="code" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">duplex</a> = <a class="code" href="structchan__oss__pvt.html#a9e93d8eae633734dfeb29e24a1f3a7c0a0cb0be5475011ea9319ce55b30e74634">M_READ</a>;
<a name="l00519"></a>00519       <span class="keywordflow">break</span>;
<a name="l00520"></a>00520    }
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    fmt = 0;
<a name="l00523"></a>00523    res = ioctl(fd, SNDCTL_DSP_STEREO, &amp;fmt);
<a name="l00524"></a>00524    <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l00525"></a>00525       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to set audio device to mono\n&quot;</span>);
<a name="l00526"></a>00526       <span class="keywordflow">return</span> -1;
<a name="l00527"></a>00527    }
<a name="l00528"></a>00528    fmt = desired = <a class="code" href="asterisk_8h.html#abe9b1c28165a7071e354bd9d7823ca1a">DEFAULT_SAMPLE_RATE</a>;   <span class="comment">/* 8000 Hz desired */</span>
<a name="l00529"></a>00529    res = ioctl(fd, SNDCTL_DSP_SPEED, &amp;fmt);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531    <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l00532"></a>00532       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to set audio device to mono\n&quot;</span>);
<a name="l00533"></a>00533       <span class="keywordflow">return</span> -1;
<a name="l00534"></a>00534    }
<a name="l00535"></a>00535    <span class="keywordflow">if</span> (fmt != desired) {
<a name="l00536"></a>00536       <span class="keywordflow">if</span> (!(o-&gt;<a class="code" href="structchan__oss__pvt.html#a873db0c09e74a379eb9c741329f126f3">warned</a> &amp; <a class="code" href="chan__oss_8c.html#a93bf0c7c887e8b899663f17882cf5b40">WARN_speed</a>)) {
<a name="l00537"></a>00537          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,
<a name="l00538"></a>00538              <span class="stringliteral">&quot;Requested %d Hz, got %d Hz -- sound may be choppy\n&quot;</span>,
<a name="l00539"></a>00539              desired, fmt);
<a name="l00540"></a>00540          o-&gt;<a class="code" href="structchan__oss__pvt.html#a873db0c09e74a379eb9c741329f126f3">warned</a> |= <a class="code" href="chan__oss_8c.html#a93bf0c7c887e8b899663f17882cf5b40">WARN_speed</a>;
<a name="l00541"></a>00541       }
<a name="l00542"></a>00542    }
<a name="l00543"></a>00543    <span class="comment">/*</span>
<a name="l00544"></a>00544 <span class="comment">    * on Freebsd, SETFRAGMENT does not work very well on some cards.</span>
<a name="l00545"></a>00545 <span class="comment">    * Default to use 256 bytes, let the user override</span>
<a name="l00546"></a>00546 <span class="comment">    */</span>
<a name="l00547"></a>00547    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a2f37ac27c86df549c61c5dcdc26de20d">frags</a>) {
<a name="l00548"></a>00548       fmt = o-&gt;<a class="code" href="structchan__oss__pvt.html#a2f37ac27c86df549c61c5dcdc26de20d">frags</a>;
<a name="l00549"></a>00549       res = ioctl(fd, SNDCTL_DSP_SETFRAGMENT, &amp;fmt);
<a name="l00550"></a>00550       <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l00551"></a>00551          <span class="keywordflow">if</span> (!(o-&gt;<a class="code" href="structchan__oss__pvt.html#a873db0c09e74a379eb9c741329f126f3">warned</a> &amp; <a class="code" href="chan__oss_8c.html#a422b43626fc2d780dad3ca0280b79225">WARN_frag</a>)) {
<a name="l00552"></a>00552             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,
<a name="l00553"></a>00553                <span class="stringliteral">&quot;Unable to set fragment size -- sound may be choppy\n&quot;</span>);
<a name="l00554"></a>00554             o-&gt;<a class="code" href="structchan__oss__pvt.html#a873db0c09e74a379eb9c741329f126f3">warned</a> |= <a class="code" href="chan__oss_8c.html#a422b43626fc2d780dad3ca0280b79225">WARN_frag</a>;
<a name="l00555"></a>00555          }
<a name="l00556"></a>00556       }
<a name="l00557"></a>00557    }
<a name="l00558"></a>00558    <span class="comment">/* on some cards, we need SNDCTL_DSP_SETTRIGGER to start outputting */</span>
<a name="l00559"></a>00559    res = PCM_ENABLE_INPUT | PCM_ENABLE_OUTPUT;
<a name="l00560"></a>00560    res = ioctl(fd, SNDCTL_DSP_SETTRIGGER, &amp;res);
<a name="l00561"></a>00561    <span class="comment">/* it may fail if we are in half duplex, never mind */</span>
<a name="l00562"></a>00562    <span class="keywordflow">return</span> 0;
<a name="l00563"></a>00563 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acedc91aa257e17f0d04f4b6cdd587fec"></a><!-- doxytag: member="chan_oss.c::soundcard_writeframe" ref="acedc91aa257e17f0d04f4b6cdd587fec" args="(struct chan_oss_pvt *o, short *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soundcard_writeframe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Write an exactly FRAME_SIZE sized frame </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00440">440</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="chan__alsa_8c_source.html#l00077">FRAME_SIZE</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l00256">chan_oss_pvt::queuesize</a>, <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>, <a class="el" href="chan__oss_8c_source.html#l00250">chan_oss_pvt::sounddev</a>, <a class="el" href="chan__oss_8c_source.html#l00418">used_blocks()</a>, and <a class="el" href="chan__oss_8c_source.html#l00263">chan_oss_pvt::w_errors</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00661">oss_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00441"></a>00441 {
<a name="l00442"></a>00442    <span class="keywordtype">int</span> res;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a> &lt; 0)
<a name="l00445"></a>00445       <a class="code" href="chan__oss_8c.html#a846ca28a12888dffef1ceaa0145fc9e5">setformat</a>(o, O_RDWR);
<a name="l00446"></a>00446    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a> &lt; 0)
<a name="l00447"></a>00447       <span class="keywordflow">return</span> 0;            <span class="comment">/* not fatal */</span>
<a name="l00448"></a>00448    <span class="comment">/*</span>
<a name="l00449"></a>00449 <span class="comment">    * Nothing complex to manage the audio device queue.</span>
<a name="l00450"></a>00450 <span class="comment">    * If the buffer is full just drop the extra, otherwise write.</span>
<a name="l00451"></a>00451 <span class="comment">    * XXX in some cases it might be useful to write anyways after</span>
<a name="l00452"></a>00452 <span class="comment">    * a number of failures, to restart the output chain.</span>
<a name="l00453"></a>00453 <span class="comment">    */</span>
<a name="l00454"></a>00454    res = <a class="code" href="chan__oss_8c.html#a2b350571365a38d4c829a611e6625d83" title="Returns the number of blocks used in the audio output channel.">used_blocks</a>(o);
<a name="l00455"></a>00455    <span class="keywordflow">if</span> (res &gt; o-&gt;<a class="code" href="structchan__oss__pvt.html#a33e55b30ec9ce66362b23d8fb1582630">queuesize</a>) {  <span class="comment">/* no room to write a block */</span>
<a name="l00456"></a>00456       <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#af9377710db171b729a953696795e29b3">w_errors</a>++ == 0 &amp;&amp; (<a class="code" href="chan__oss_8c.html#a55655e6e4f992661feb99f55a1589539">oss_debug</a> &amp; 0x4))
<a name="l00457"></a>00457          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;write: used %d blocks (%d)\n&quot;</span>, res, o-&gt;<a class="code" href="structchan__oss__pvt.html#af9377710db171b729a953696795e29b3">w_errors</a>);
<a name="l00458"></a>00458       <span class="keywordflow">return</span> 0;
<a name="l00459"></a>00459    }
<a name="l00460"></a>00460    o-&gt;<a class="code" href="structchan__oss__pvt.html#af9377710db171b729a953696795e29b3">w_errors</a> = 0;
<a name="l00461"></a>00461    <span class="keywordflow">return</span> write(o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>, (<span class="keywordtype">void</span> *)data, <a class="code" href="chan__alsa_8c.html#af9b1b2ba12857a4bf11289dac8c5462d">FRAME_SIZE</a> * 2);
<a name="l00462"></a>00462 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a84654a000b40dc9279c90ebe4f0cec8d"></a><!-- doxytag: member="chan_oss.c::store_boost" ref="a84654a000b40dc9279c90ebe4f0cec8d" args="(struct chan_oss_pvt *o, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void store_boost </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>store the boost factor </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01233">1233</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="chan__oss_8c_source.html#l00274">chan_oss_pvt::boost</a>, <a class="el" href="chan__oss_8c_source.html#l00273">BOOST_MAX</a>, <a class="el" href="chan__oss_8c_source.html#l00272">BOOST_SCALE</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01252">console_boost()</a>, and <a class="el" href="chan__oss_8c_source.html#l01317">store_config_core()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01234"></a>01234 {
<a name="l01235"></a>01235    <span class="keywordtype">double</span> <a class="code" href="structchan__oss__pvt.html#acd32205748f53b345085531047aefa00">boost</a> = 0;
<a name="l01236"></a>01236    <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <span class="stringliteral">&quot;%30lf&quot;</span>, &amp;boost) != 1) {
<a name="l01237"></a>01237       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;invalid boost &lt;%s&gt;\n&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>);
<a name="l01238"></a>01238       <span class="keywordflow">return</span>;
<a name="l01239"></a>01239    }
<a name="l01240"></a>01240    <span class="keywordflow">if</span> (boost &lt; -<a class="code" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>) {
<a name="l01241"></a>01241       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;boost %s too small, using %d\n&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, -<a class="code" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>);
<a name="l01242"></a>01242       boost = -<a class="code" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>;
<a name="l01243"></a>01243    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (boost &gt; <a class="code" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>) {
<a name="l01244"></a>01244       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;boost %s too large, using %d\n&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, <a class="code" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>);
<a name="l01245"></a>01245       boost = <a class="code" href="chan__oss_8c.html#a54f5d9a8e570842ff9e4aac3157907c0">BOOST_MAX</a>;
<a name="l01246"></a>01246    }
<a name="l01247"></a>01247    boost = exp(log(10) * boost / 20) * <a class="code" href="chan__oss_8c.html#a7b687e61ed66e74f77982bc22fd0c446">BOOST_SCALE</a>;
<a name="l01248"></a>01248    o-&gt;<a class="code" href="structchan__oss__pvt.html#acd32205748f53b345085531047aefa00">boost</a> = boost;
<a name="l01249"></a>01249    <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;setting boost %s to %d\n&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, o-&gt;<a class="code" href="structchan__oss__pvt.html#acd32205748f53b345085531047aefa00">boost</a>);
<a name="l01250"></a>01250 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af61d034633d0712785e391e59e0a62ed"></a><!-- doxytag: member="chan_oss.c::store_callerid" ref="af61d034633d0712785e391e59e0a62ed" args="(struct chan_oss_pvt *o, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void store_callerid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>store the callerid components </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01312">1312</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="callerid_8c_source.html#l01087">ast_callerid_split()</a>, <a class="el" href="chan__oss_8c_source.html#l00286">chan_oss_pvt::cid_name</a>, and <a class="el" href="chan__oss_8c_source.html#l00287">chan_oss_pvt::cid_num</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01317">store_config_core()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01313"></a>01313 {
<a name="l01314"></a>01314    <a class="code" href="callerid_8h.html#af33ee38631fe79ab21d91bcd0634903a">ast_callerid_split</a>(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a2916929201e1417f4ea335e9276aa382">cid_name</a>, <span class="keyword">sizeof</span>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a2916929201e1417f4ea335e9276aa382">cid_name</a>), o-&gt;<a class="code" href="structchan__oss__pvt.html#a557b0d5a633c0a98162e973793689380">cid_num</a>, <span class="keyword">sizeof</span>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a557b0d5a633c0a98162e973793689380">cid_num</a>));
<a name="l01315"></a>01315 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0c9e9a2c27099a98cad529efa81b63ed"></a><!-- doxytag: member="chan_oss.c::store_config" ref="a0c9e9a2c27099a98cad529efa81b63ed" args="(struct ast_config *cfg, char *ctg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a>* store_config </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__config.html">ast_config</a> *&nbsp;</td>
          <td class="paramname"> <em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ctg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>grab fields from the config file, init the descriptor and open the device. </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01348">1348</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00108">asprintf</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="time_8h_source.html#l00141">ast_tvnow()</a>, <a class="el" href="config_8c_source.html#l00411">ast_variable_browse()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="console__video_8c_source.html#l00131">console_video_start()</a>, <a class="el" href="chan__oss_8c_source.html#l00230">DEV_DSP</a>, <a class="el" href="chan__oss_8c_source.html#l00275">chan_oss_pvt::device</a>, <a class="el" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">chan_oss_pvt::duplex</a>, <a class="el" href="chan__oss_8c_source.html#l00281">chan_oss_pvt::env</a>, <a class="el" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="console__video_8c_source.html#l00140">get_gui_startup()</a>, <a class="el" href="chan__oss_8c_source.html#l00264">chan_oss_pvt::lastopen</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l00251">chan_oss_pvt::M_FULL</a>, <a class="el" href="chan__oss_8c_source.html#l00255">chan_oss_pvt::mixer_cmd</a>, <a class="el" href="chan__oss_8c_source.html#l00288">chan_oss_pvt::mohinterpret</a>, <a class="el" href="config_8h_source.html#l00075">ast_variable::name</a>, <a class="el" href="chan__oss_8c_source.html#l00248">chan_oss_pvt::name</a>, <a class="el" href="chan__oss_8c_source.html#l00246">chan_oss_pvt::next</a>, <a class="el" href="config_8h_source.html#l00077">ast_variable::next</a>, <a class="el" href="chan__oss_8c_source.html#l00469">setformat()</a>, <a class="el" href="chan__oss_8c_source.html#l01317">store_config_core()</a>, and <a class="el" href="config_8h_source.html#l00076">ast_variable::value</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01425">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01349"></a>01349 {
<a name="l01350"></a>01350    <span class="keyword">struct </span><a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *v;
<a name="l01351"></a>01351    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o;
<a name="l01352"></a>01352 
<a name="l01353"></a>01353    <span class="keywordflow">if</span> (ctg == NULL) {
<a name="l01354"></a>01354       o = &amp;<a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>;
<a name="l01355"></a>01355       ctg = <span class="stringliteral">&quot;general&quot;</span>;
<a name="l01356"></a>01356    } <span class="keywordflow">else</span> {
<a name="l01357"></a>01357       <span class="keywordflow">if</span> (!(o = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*o))))
<a name="l01358"></a>01358          <span class="keywordflow">return</span> NULL;
<a name="l01359"></a>01359       *o = <a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>;
<a name="l01360"></a>01360       <span class="comment">/* &quot;general&quot; is also the default thing */</span>
<a name="l01361"></a>01361       <span class="keywordflow">if</span> (strcmp(ctg, <span class="stringliteral">&quot;general&quot;</span>) == 0) {
<a name="l01362"></a>01362          o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<span class="stringliteral">&quot;dsp&quot;</span>);
<a name="l01363"></a>01363          <a class="code" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a> = o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a>;
<a name="l01364"></a>01364          <span class="keywordflow">goto</span> openit;
<a name="l01365"></a>01365       }
<a name="l01366"></a>01366       o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(ctg);
<a name="l01367"></a>01367    }
<a name="l01368"></a>01368 
<a name="l01369"></a>01369    strcpy(o-&gt;<a class="code" href="structchan__oss__pvt.html#af689da2b77d1265192a78a5b0994a1d5">mohinterpret</a>, <span class="stringliteral">&quot;default&quot;</span>);
<a name="l01370"></a>01370 
<a name="l01371"></a>01371    o-&gt;<a class="code" href="structchan__oss__pvt.html#a335ae1f9f7ea2bc5d6cd92a35bb675c3">lastopen</a> = <a class="code" href="time_8h.html#abd5ba75c20787bcc479809c53b58406e" title="Returns current timeval. Meant to replace calls to gettimeofday().">ast_tvnow</a>(); <span class="comment">/* don&apos;t leave it 0 or tvdiff may wrap */</span>
<a name="l01372"></a>01372    <span class="comment">/* fill other fields from configuration */</span>
<a name="l01373"></a>01373    <span class="keywordflow">for</span> (v = <a class="code" href="config_8h.html#a935ccfa153100ddd320c8918bd6e941b" title="Goes through variables Somewhat similar in intent as the ast_category_browse. List...">ast_variable_browse</a>(cfg, ctg); v; v = v-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l01374"></a>01374       <a class="code" href="chan__oss_8c.html#a5aaad0a97630adacb1072ec67727d221">store_config_core</a>(o, v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l01375"></a>01375    }
<a name="l01376"></a>01376    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>))
<a name="l01377"></a>01377       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>, <a class="code" href="chan__oss_8c.html#a6be84301906dae965d8f760e7779161a">DEV_DSP</a>, <span class="keyword">sizeof</span>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>));
<a name="l01378"></a>01378    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf49840be4c26471e5aad7e741445c8">mixer_cmd</a>) {
<a name="l01379"></a>01379       <span class="keywordtype">char</span> *cmd;
<a name="l01380"></a>01380 
<a name="l01381"></a>01381       <span class="keywordflow">if</span> (<a class="code" href="astmm_8h.html#a5d1f84199c77c83b8b51928dd359e228">asprintf</a>(&amp;cmd, <span class="stringliteral">&quot;mixer %s&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf49840be4c26471e5aad7e741445c8">mixer_cmd</a>) &lt; 0) {
<a name="l01382"></a>01382          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;asprintf() failed: %s\n&quot;</span>, strerror(errno));
<a name="l01383"></a>01383       } <span class="keywordflow">else</span> {
<a name="l01384"></a>01384          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;running [%s]\n&quot;</span>, cmd);
<a name="l01385"></a>01385          <span class="keywordflow">if</span> (system(cmd) &lt; 0) {
<a name="l01386"></a>01386             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;system() failed: %s\n&quot;</span>, strerror(errno));
<a name="l01387"></a>01387          }
<a name="l01388"></a>01388          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cmd);
<a name="l01389"></a>01389       }
<a name="l01390"></a>01390    }
<a name="l01391"></a>01391 
<a name="l01392"></a>01392    <span class="comment">/* if the config file requested to start the GUI, do it */</span>
<a name="l01393"></a>01393    <span class="keywordflow">if</span> (<a class="code" href="console__video_8c.html#ac11b40fb6b553af0941bb9079e0a3acc">get_gui_startup</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a53a1ea8614142fc091720c64f0209ac4">env</a>))
<a name="l01394"></a>01394       <a class="code" href="console__video_8c.html#a0bbb87120da7024ff01c39a0d40372fa">console_video_start</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a53a1ea8614142fc091720c64f0209ac4">env</a>, NULL);
<a name="l01395"></a>01395 
<a name="l01396"></a>01396    <span class="keywordflow">if</span> (o == &amp;<a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>)     <span class="comment">/* we are done with the default */</span>
<a name="l01397"></a>01397       <span class="keywordflow">return</span> NULL;
<a name="l01398"></a>01398 
<a name="l01399"></a>01399 openit:
<a name="l01400"></a>01400 <span class="preprocessor">#ifdef TRYOPEN</span>
<a name="l01401"></a>01401 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="chan__oss_8c.html#a846ca28a12888dffef1ceaa0145fc9e5">setformat</a>(o, O_RDWR) &lt; 0) {  <span class="comment">/* open device */</span>
<a name="l01402"></a>01402       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Device %s not detected\n&quot;</span>, ctg);
<a name="l01403"></a>01403       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Turn off OSS support by adding &quot;</span> <span class="stringliteral">&quot;&apos;noload=chan_oss.so&apos; in /etc/asterisk/modules.conf\n&quot;</span>);
<a name="l01404"></a>01404       <span class="keywordflow">goto</span> error;
<a name="l01405"></a>01405    }
<a name="l01406"></a>01406    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a019517e6fb4251257135b8db7938bca9">duplex</a> != <a class="code" href="structchan__oss__pvt.html#a9e93d8eae633734dfeb29e24a1f3a7c0a4d444b330d2372546edf9ba1dc8f85e7">M_FULL</a>)
<a name="l01407"></a>01407       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;XXX I don&apos;t work right with non &quot;</span> <span class="stringliteral">&quot;full-duplex sound cards XXX\n&quot;</span>);
<a name="l01408"></a>01408 <span class="preprocessor">#endif </span><span class="comment">/* TRYOPEN */</span>
<a name="l01409"></a>01409 
<a name="l01410"></a>01410    <span class="comment">/* link into list of devices */</span>
<a name="l01411"></a>01411    <span class="keywordflow">if</span> (o != &amp;<a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>) {
<a name="l01412"></a>01412       o-&gt;<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a> = <a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>.<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>;
<a name="l01413"></a>01413       <a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>.<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a> = o;
<a name="l01414"></a>01414    }
<a name="l01415"></a>01415    <span class="keywordflow">return</span> o;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417 <span class="preprocessor">#ifdef TRYOPEN</span>
<a name="l01418"></a>01418 <span class="preprocessor"></span>error:
<a name="l01419"></a>01419    <span class="keywordflow">if</span> (o != &amp;<a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>)
<a name="l01420"></a>01420       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o);
<a name="l01421"></a>01421    <span class="keywordflow">return</span> NULL;
<a name="l01422"></a>01422 <span class="preprocessor">#endif</span>
<a name="l01423"></a>01423 <span class="preprocessor"></span>}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5aaad0a97630adacb1072ec67727d221"></a><!-- doxytag: member="chan_oss.c::store_config_core" ref="a5aaad0a97630adacb1072ec67727d221" args="(struct chan_oss_pvt *o, const char *var, const char *value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void store_config_core </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01317">1317</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="abstract__jb_8c_source.html#l00571">ast_jb_read_conf()</a>, <a class="el" href="chan__oss_8c_source.html#l00252">chan_oss_pvt::autoanswer</a>, <a class="el" href="chan__oss_8c_source.html#l00253">chan_oss_pvt::autohangup</a>, <a class="el" href="console__video_8c_source.html#l00126">console_video_config()</a>, <a class="el" href="chan__oss_8c_source.html#l00284">chan_oss_pvt::ctx</a>, <a class="el" href="config_8h_source.html#l00581">CV_BOOL</a>, <a class="el" href="config_8h_source.html#l00573">CV_END</a>, <a class="el" href="config_8h_source.html#l00576">CV_F</a>, <a class="el" href="config_8h_source.html#l00567">CV_START</a>, <a class="el" href="config_8h_source.html#l00583">CV_STR</a>, <a class="el" href="config_8h_source.html#l00582">CV_UINT</a>, <a class="el" href="chan__oss_8c_source.html#l00275">chan_oss_pvt::device</a>, <a class="el" href="chan__oss_8c_source.html#l00281">chan_oss_pvt::env</a>, <a class="el" href="chan__oss_8c_source.html#l00283">chan_oss_pvt::ext</a>, <a class="el" href="chan__oss_8c_source.html#l00257">chan_oss_pvt::frags</a>, <a class="el" href="chan__oss_8c_source.html#l00077">global_jbconf</a>, <a class="el" href="chan__oss_8c_source.html#l00285">chan_oss_pvt::language</a>, <a class="el" href="chan__oss_8c_source.html#l00288">chan_oss_pvt::mohinterpret</a>, <a class="el" href="chan__oss_8c_source.html#l00266">chan_oss_pvt::overridecontext</a>, <a class="el" href="chan__oss_8c_source.html#l00256">chan_oss_pvt::queuesize</a>, <a class="el" href="chan__oss_8c_source.html#l01233">store_boost()</a>, <a class="el" href="chan__oss_8c_source.html#l01312">store_callerid()</a>, and <a class="el" href="chan__oss_8c_source.html#l01293">store_mixer()</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00868">console_cmd()</a>, and <a class="el" href="chan__oss_8c_source.html#l01348">store_config()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01318"></a>01318 {
<a name="l01319"></a>01319    <a class="code" href="config_8h.html#a32da71a793e99764383cb3eb2080a346" title="the macro to open a block for variable parsing">CV_START</a>(<a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, value);
<a name="l01320"></a>01320 
<a name="l01321"></a>01321    <span class="comment">/* handle jb conf */</span>
<a name="l01322"></a>01322    <span class="keywordflow">if</span> (!<a class="code" href="abstract__jb_8h.html#ae50ad081bd2ae6b58bcfc4687916c586" title="Sets jitterbuffer configuration property.">ast_jb_read_conf</a>(&amp;<a class="code" href="chan__oss_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>, <a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, value))
<a name="l01323"></a>01323       <span class="keywordflow">return</span>;
<a name="l01324"></a>01324 
<a name="l01325"></a>01325    <span class="keywordflow">if</span> (!<a class="code" href="console__video_8c.html#ace0be9353d0ac2c1aef275e15b5e6ef7">console_video_config</a>(&amp;o-&gt;<a class="code" href="structchan__oss__pvt.html#a53a1ea8614142fc091720c64f0209ac4">env</a>, <a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, value))
<a name="l01326"></a>01326       <span class="keywordflow">return</span>;  <span class="comment">/* matched there */</span>
<a name="l01327"></a>01327    <a class="code" href="config_8h.html#aafea033c0475a1369e75b63aa36bf4fb" title="helper macros to assign the value to a BOOL, UINT, static string and dynamic string...">CV_BOOL</a>(<span class="stringliteral">&quot;autoanswer&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#aa682db27c8180700165db1398964b3c8">autoanswer</a>);
<a name="l01328"></a>01328    <a class="code" href="config_8h.html#aafea033c0475a1369e75b63aa36bf4fb" title="helper macros to assign the value to a BOOL, UINT, static string and dynamic string...">CV_BOOL</a>(<span class="stringliteral">&quot;autohangup&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a56c3f16f4a1c55d1d95c6a9523cd65ca">autohangup</a>);
<a name="l01329"></a>01329    <a class="code" href="config_8h.html#aafea033c0475a1369e75b63aa36bf4fb" title="helper macros to assign the value to a BOOL, UINT, static string and dynamic string...">CV_BOOL</a>(<span class="stringliteral">&quot;overridecontext&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a4eedfe56e88e9cb9777a619c022fe6a8">overridecontext</a>);
<a name="l01330"></a>01330    <a class="code" href="config_8h.html#a4a4b29ba86635a1575dc2c34403844eb">CV_STR</a>(<span class="stringliteral">&quot;device&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a658d9ce13ced0e72930f779042e4576f">device</a>);
<a name="l01331"></a>01331    <a class="code" href="config_8h.html#ad034d966d46d0a4a8731b294262f5e4b">CV_UINT</a>(<span class="stringliteral">&quot;frags&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a2f37ac27c86df549c61c5dcdc26de20d">frags</a>);
<a name="l01332"></a>01332    <a class="code" href="config_8h.html#ad034d966d46d0a4a8731b294262f5e4b">CV_UINT</a>(<span class="stringliteral">&quot;debug&quot;</span>, <a class="code" href="chan__oss_8c.html#a55655e6e4f992661feb99f55a1589539">oss_debug</a>);
<a name="l01333"></a>01333    <a class="code" href="config_8h.html#ad034d966d46d0a4a8731b294262f5e4b">CV_UINT</a>(<span class="stringliteral">&quot;queuesize&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a33e55b30ec9ce66362b23d8fb1582630">queuesize</a>);
<a name="l01334"></a>01334    <a class="code" href="config_8h.html#a4a4b29ba86635a1575dc2c34403844eb">CV_STR</a>(<span class="stringliteral">&quot;context&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a02d0db19ebec1fa1e0d29bda775c1096">ctx</a>);
<a name="l01335"></a>01335    <a class="code" href="config_8h.html#a4a4b29ba86635a1575dc2c34403844eb">CV_STR</a>(<span class="stringliteral">&quot;language&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#adf416dc058363e2fd5750c77e2d78bee">language</a>);
<a name="l01336"></a>01336    <a class="code" href="config_8h.html#a4a4b29ba86635a1575dc2c34403844eb">CV_STR</a>(<span class="stringliteral">&quot;mohinterpret&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#af689da2b77d1265192a78a5b0994a1d5">mohinterpret</a>);
<a name="l01337"></a>01337    <a class="code" href="config_8h.html#a4a4b29ba86635a1575dc2c34403844eb">CV_STR</a>(<span class="stringliteral">&quot;extension&quot;</span>, o-&gt;<a class="code" href="structchan__oss__pvt.html#a1ad093b5bae14543eb7fe9f409d9c83b">ext</a>);
<a name="l01338"></a>01338    <a class="code" href="config_8h.html#a573667b0b56503ba54ed0fbbb227b8ab" title="call a generic function if the name matches.">CV_F</a>(<span class="stringliteral">&quot;mixer&quot;</span>, <a class="code" href="chan__oss_8c.html#a26239196e7baece3ba160c70995afcef">store_mixer</a>(o, value));
<a name="l01339"></a>01339    <a class="code" href="config_8h.html#a573667b0b56503ba54ed0fbbb227b8ab" title="call a generic function if the name matches.">CV_F</a>(<span class="stringliteral">&quot;callerid&quot;</span>, <a class="code" href="chan__oss_8c.html#af61d034633d0712785e391e59e0a62ed">store_callerid</a>(o, value))  ;
<a name="l01340"></a>01340    <a class="code" href="config_8h.html#a573667b0b56503ba54ed0fbbb227b8ab" title="call a generic function if the name matches.">CV_F</a>(<span class="stringliteral">&quot;boost&quot;</span>, <a class="code" href="chan__oss_8c.html#a84654a000b40dc9279c90ebe4f0cec8d" title="store the boost factor">store_boost</a>(o, value));
<a name="l01341"></a>01341 
<a name="l01342"></a>01342    <a class="code" href="config_8h.html#a4529d9f44c4461f1d4b5bde4e968447e" title="close a variable parsing block">CV_END</a>;
<a name="l01343"></a>01343 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a26239196e7baece3ba160c70995afcef"></a><!-- doxytag: member="chan_oss.c::store_mixer" ref="a26239196e7baece3ba160c70995afcef" args="(struct chan_oss_pvt *o, const char *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void store_mixer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>store the mixer argument from the config file, filtering possibly invalid or dangerous <a class="el" href="structvalues.html">values</a> (the string is used as argument for system("mixer %s") </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01293">1293</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, and <a class="el" href="chan__oss_8c_source.html#l00255">chan_oss_pvt::mixer_cmd</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01317">store_config_core()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01294"></a>01294 {
<a name="l01295"></a>01295    <span class="keywordtype">int</span> i;
<a name="l01296"></a>01296 
<a name="l01297"></a>01297    <span class="keywordflow">for</span> (i = 0; i &lt; strlen(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>); i++) {
<a name="l01298"></a>01298       <span class="keywordflow">if</span> (!isalnum(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[i]) &amp;&amp; strchr(<span class="stringliteral">&quot; \t-/&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[i]) == NULL) {
<a name="l01299"></a>01299          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Suspect char %c in mixer cmd, ignoring:\n\t%s\n&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>[i], <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>);
<a name="l01300"></a>01300          <span class="keywordflow">return</span>;
<a name="l01301"></a>01301       }
<a name="l01302"></a>01302    }
<a name="l01303"></a>01303    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf49840be4c26471e5aad7e741445c8">mixer_cmd</a>)
<a name="l01304"></a>01304       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf49840be4c26471e5aad7e741445c8">mixer_cmd</a>);
<a name="l01305"></a>01305    o-&gt;<a class="code" href="structchan__oss__pvt.html#a6bf49840be4c26471e5aad7e741445c8">mixer_cmd</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>);
<a name="l01306"></a>01306    <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;setting mixer %s\n&quot;</span>, <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>);
<a name="l01307"></a>01307 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad09fa931f468002152a3cc2d5ce25eae"></a><!-- doxytag: member="chan_oss.c::unload_module" ref="ad09fa931f468002152a3cc2d5ce25eae" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01469">1469</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="channel_8c_source.html#l00587">ast_channel_unregister()</a>, <a class="el" href="cli_8c_source.html#l01937">ast_cli_unregister_multiple()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="channel_8c_source.html#l01666">ast_softhangup()</a>, <a class="el" href="channel_8h_source.html#l00638">AST_SOFTHANGUP_APPUNLOAD</a>, <a class="el" href="chan__oss_8c_source.html#l00248">chan_oss_pvt::name</a>, <a class="el" href="chan__oss_8c_source.html#l00246">chan_oss_pvt::next</a>, <a class="el" href="chan__oss_8c_source.html#l00279">chan_oss_pvt::owner</a>, and <a class="el" href="chan__oss_8c_source.html#l00250">chan_oss_pvt::sounddev</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01470"></a>01470 {
<a name="l01471"></a>01471    <span class="keyword">struct </span><a class="code" href="structchan__oss__pvt.html" title="descriptor for one of our channels.">chan_oss_pvt</a> *o, *<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>;
<a name="l01472"></a>01472 
<a name="l01473"></a>01473    <a class="code" href="channel_8h.html#a53b708b7fc71dcbcd33acae0ad4d7ef8" title="Unregister a channel technology.">ast_channel_unregister</a>(&amp;<a class="code" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a>);
<a name="l01474"></a>01474    <a class="code" href="cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09" title="Unregister multiple commands.">ast_cli_unregister_multiple</a>(<a class="code" href="chan__oss_8c.html#a657fc1119d2a6e1a4678fbbbe73b18f9">cli_oss</a>, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="chan__oss_8c.html#a657fc1119d2a6e1a4678fbbbe73b18f9">cli_oss</a>));
<a name="l01475"></a>01475 
<a name="l01476"></a>01476    o = <a class="code" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a>.<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>;
<a name="l01477"></a>01477    <span class="keywordflow">while</span> (o) {
<a name="l01478"></a>01478       close(o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>);
<a name="l01479"></a>01479       <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)
<a name="l01480"></a>01480          <a class="code" href="channel_8h.html#ac2d6607253f7e8b272d4e845474eaa9b" title="Softly hangup up a channel.">ast_softhangup</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="channel_8h.html#a2dbb833ef0dcc466dd02ee76badaf709aeeafae6abd77156800ec76b0ff7d3867">AST_SOFTHANGUP_APPUNLOAD</a>);
<a name="l01481"></a>01481       <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>)
<a name="l01482"></a>01482          <span class="keywordflow">return</span> -1;
<a name="l01483"></a>01483       next = o-&gt;<a class="code" href="structchan__oss__pvt.html#a44cc17a839c49e5e08f9b4e1379f91ee">next</a>;
<a name="l01484"></a>01484       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o-&gt;<a class="code" href="structchan__oss__pvt.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l01485"></a>01485       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o);
<a name="l01486"></a>01486       o = next;
<a name="l01487"></a>01487    }
<a name="l01488"></a>01488    <span class="keywordflow">return</span> 0;
<a name="l01489"></a>01489 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2b350571365a38d4c829a611e6625d83"></a><!-- doxytag: member="chan_oss.c::used_blocks" ref="a2b350571365a38d4c829a611e6625d83" args="(struct chan_oss_pvt *o)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int used_blocks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> *&nbsp;</td>
          <td class="paramname"> <em>o</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the <a class="el" href="structnumber.html" title="Number structure.">number</a> of blocks used in the audio output channel. </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00418">418</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>References <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__oss_8c_source.html#l00250">chan_oss_pvt::sounddev</a>, <a class="el" href="chan__oss_8c_source.html#l00249">chan_oss_pvt::total_blocks</a>, <a class="el" href="chan__oss_8c_source.html#l00260">WARN_used_blocks</a>, and <a class="el" href="chan__oss_8c_source.html#l00259">chan_oss_pvt::warned</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l00440">soundcard_writeframe()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00419"></a>00419 {
<a name="l00420"></a>00420    <span class="keyword">struct </span>audio_buf_info info;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422    <span class="keywordflow">if</span> (ioctl(o-&gt;<a class="code" href="structchan__oss__pvt.html#ac3fb672ce98321ddfeba0b02fba73298">sounddev</a>, SNDCTL_DSP_GETOSPACE, &amp;info)) {
<a name="l00423"></a>00423       <span class="keywordflow">if</span> (!(o-&gt;<a class="code" href="structchan__oss__pvt.html#a873db0c09e74a379eb9c741329f126f3">warned</a> &amp; <a class="code" href="chan__oss_8c.html#a11aaf77355342e1ba8feee89c4d66e51">WARN_used_blocks</a>)) {
<a name="l00424"></a>00424          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error reading output space\n&quot;</span>);
<a name="l00425"></a>00425          o-&gt;<a class="code" href="structchan__oss__pvt.html#a873db0c09e74a379eb9c741329f126f3">warned</a> |= <a class="code" href="chan__oss_8c.html#a11aaf77355342e1ba8feee89c4d66e51">WARN_used_blocks</a>;
<a name="l00426"></a>00426       }
<a name="l00427"></a>00427       <span class="keywordflow">return</span> 1;
<a name="l00428"></a>00428    }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structchan__oss__pvt.html#a665434db7b1be9dbe9d9729696eaa857">total_blocks</a> == 0) {
<a name="l00431"></a>00431       <span class="keywordflow">if</span> (0)               <span class="comment">/* debugging */</span>
<a name="l00432"></a>00432          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;fragtotal %d size %d avail %d\n&quot;</span>, info.fragstotal, info.fragsize, info.fragments);
<a name="l00433"></a>00433       o-&gt;<a class="code" href="structchan__oss__pvt.html#a665434db7b1be9dbe9d9729696eaa857">total_blocks</a> = info.fragments;
<a name="l00434"></a>00434    }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436    <span class="keywordflow">return</span> o-&gt;<a class="code" href="structchan__oss__pvt.html#a665434db7b1be9dbe9d9729696eaa857">total_blocks</a> - info.fragments;
<a name="l00437"></a>00437 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a657fc1119d2a6e1a4678fbbbe73b18f9"></a><!-- doxytag: member="chan_oss.c::cli_oss" ref="a657fc1119d2a6e1a4678fbbbe73b18f9" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="chan__oss_8c.html#a657fc1119d2a6e1a4678fbbbe73b18f9">cli_oss</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l01274">1274</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a74bb62276efdf39dd94048e007fca05b"></a><!-- doxytag: member="chan_oss.c::config" ref="a74bb62276efdf39dd94048e007fca05b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="pbx__lua_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = &quot;oss.conf&quot;<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00233">233</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2d8d5920e90ccbad7832926becdadb29"></a><!-- doxytag: member="chan_oss.c::default_jbconf" ref="a2d8d5920e90ccbad7832926becdadb29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__jb__conf.html">ast_jb_conf</a> <a class="el" href="misdn__config_8c.html#a2d8d5920e90ccbad7832926becdadb29">default_jbconf</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Global jitterbuffer configuration - by default, jb is disabled </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00069">69</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="abaabcb7f4349cc632dde3af5c6a5e1bd"></a><!-- doxytag: member="chan_oss.c::global_jbconf" ref="abaabcb7f4349cc632dde3af5c6a5e1bd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__jb__conf.html">ast_jb_conf</a> <a class="el" href="misdn__config_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00077">77</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

<p>Referenced by <a class="el" href="chan__oss_8c_source.html#l01425">load_module()</a>, <a class="el" href="chan__oss_8c_source.html#l00784">oss_new()</a>, and <a class="el" href="chan__oss_8c_source.html#l01317">store_config_core()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a0a95a89b3987345c36137e069271b9"></a><!-- doxytag: member="chan_oss.c::oss_active" ref="a3a0a95a89b3987345c36137e069271b9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="chan__oss_8c.html#a3a0a95a89b3987345c36137e069271b9">oss_active</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>the active device </p>

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00304">304</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a55655e6e4f992661feb99f55a1589539"></a><!-- doxytag: member="chan_oss.c::oss_debug" ref="a55655e6e4f992661feb99f55a1589539" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="chan__oss_8c.html#a55655e6e4f992661feb99f55a1589539">oss_debug</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00235">235</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="adadac996cf8f169382f06cf961e8b26a"></a><!-- doxytag: member="chan_oss.c::oss_default" ref="adadac996cf8f169382f06cf961e8b26a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structchan__oss__pvt.html">chan_oss_pvt</a> <a class="el" href="chan__oss_8c.html#adadac996cf8f169382f06cf961e8b26a">oss_default</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00312">312</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a93ea6f8c122b95b395f6a5fa9287aa03"></a><!-- doxytag: member="chan_oss.c::oss_tech" ref="a93ea6f8c122b95b395f6a5fa9287aa03" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a> <a class="el" href="chan__oss_8c.html#a93ea6f8c122b95b395f6a5fa9287aa03">oss_tech</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00343">343</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
<a class="anchor" id="a206197bcdc50090e511e22b33a2166a9"></a><!-- doxytag: member="chan_oss.c::tdesc" ref="a206197bcdc50090e511e22b33a2166a9" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="chan__usbradio_8c.html#a206197bcdc50090e511e22b33a2166a9">tdesc</a>[] = &quot;OSS Console Channel Driver&quot;<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="chan__oss_8c_source.html#l00340">340</a> of file <a class="el" href="chan__oss_8c_source.html">chan_oss.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:20:25 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
