<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:23:38 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Module: Dial plan applications</h1>
<p>Applications support the dialplan. They register dynamically with.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Files</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__adsiprog_8c.html">app_adsiprog.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Program Asterisk ADSI Scripts into phone. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__alarmreceiver_8c.html">app_alarmreceiver.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Central Station Alarm receiver for Ademco Contact ID. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__authenticate_8c.html">app_authenticate.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Execute arbitrary authenticate commands. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__cdr_8c.html">app_cdr.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Applications connected with CDR engine. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__chanisavail_8c.html">app_chanisavail.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Check if Channel is Available. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__channelredirect_8c.html">app_channelredirect.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>ChannelRedirect application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__chanspy_8c.html">app_chanspy.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>ChanSpy: Listen in on any channel. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__confbridge_8c.html">app_confbridge.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Conference Bridge application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__controlplayback_8c.html">app_controlplayback.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Trivial application to control playback of a <a class="el" href="structsound.html">sound</a> file. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__dahdibarge_8c.html">app_dahdibarge.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>DAHDI Barge support. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__dahdiras_8c.html">app_dahdiras.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Execute an ISDN RAS. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__dahdiscan_8c.html">app_dahdiscan.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>DAHDI Scanner. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__db_8c.html">app_db.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Database access functions. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__dial_8c.html">app_dial.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>dial() &amp; retrydial() - Trivial application to dial a channel and send an URL on answer </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__dictate_8c.html">app_dictate.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Virtual Dictation Machine Application For Asterisk. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__directed__pickup_8c.html">app_directed_pickup.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Directed Call Pickup Support. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__directory_8c.html">app_directory.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Provide a directory of extensions. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__disa_8c.html">app_disa.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>DISA -- Direct Inward System Access Application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__dumpchan_8c.html">app_dumpchan.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Application to dump channel variables. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__echo_8c.html">app_echo.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Echo application -- play back what you hear to evaluate latency. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__exec_8c.html">app_exec.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Exec application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__externalivr_8c.html">app_externalivr.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>External IVR application interface. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__festival_8c.html">app_festival.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Connect to festival. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__flash_8c.html">app_flash.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>App to flash a DAHDI trunk. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__followme_8c.html">app_followme.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Find-Me Follow-Me application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__forkcdr_8c.html">app_forkcdr.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Fork CDR application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__getcpeid_8c.html">app_getcpeid.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Get ADSI CPE ID. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__ices_8c.html">app_ices.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Stream to an icecast server via ICES (see contrib/asterisk-ices.xml). </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__image_8c.html">app_image.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>App to transmit an image. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__ivrdemo_8c.html">app_ivrdemo.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>IVR Demo application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__jack_8c.html">app_jack.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Jack Application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__macro_8c.html">app_macro.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Dial plan macro Implementation. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__meetme_8c.html">app_meetme.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Meet me conference bridge and Shared Line Appearances. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__milliwatt_8c.html">app_milliwatt.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Digital Milliwatt Test. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__minivm_8c.html">app_minivm.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>MiniVoiceMail - A Minimal Voicemail System for Asterisk. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__mixmonitor_8c.html">app_mixmonitor.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>MixMonitor() - Record a call and mix the audio during the recording. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__morsecode_8c.html">app_morsecode.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Morsecode application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__mp3_8c.html">app_mp3.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Silly application to play an MP3 file -- uses mpg123. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__nbscat_8c.html">app_nbscat.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Silly application to play an NBScat file -- uses nbscat8k. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__originate_8c.html">app_originate.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Originate application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__osplookup_8c.html">app_osplookup.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Open Settlement Protocol (OSP) Applications. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__page_8c.html">app_page.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p><a class="el" href="adsistub_8c.html#a68cf50bee509a6b69603c25cb19921c6">page()</a> - Paging application </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__parkandannounce_8c.html">app_parkandannounce.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>ParkAndAnnounce application for Asterisk. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__playback_8c.html">app_playback.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Trivial application to playback a <a class="el" href="structsound.html">sound</a> file. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__playtones_8c.html">app_playtones.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Playtones application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__privacy_8c.html">app_privacy.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Block all calls without Caller*ID, require phone # to be entered. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__queue_8c.html">app_queue.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>True call queues with optional send URL on answer. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__read_8c.html">app_read.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Trivial application to read a variable. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__readexten_8c.html">app_readexten.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Trivial application to read an <a class="el" href="structextension.html">extension</a> into a variable. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__readfile_8c.html">app_readfile.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>ReadFile application -- Reads in a File for you. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__record_8c.html">app_record.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Trivial application to record a <a class="el" href="structsound.html">sound</a> file. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__sayunixtime_8c.html">app_sayunixtime.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>SayUnixTime application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__senddtmf_8c.html">app_senddtmf.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>App to send DTMF digits. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__sendtext_8c.html">app_sendtext.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>App to transmit a text <a class="el" href="structmessage.html">message</a>. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__setcallerid_8c.html">app_setcallerid.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>App to set callerid presentation. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__skel_8c.html">app_skel.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Skeleton application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__sms_8c.html">app_sms.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>SMS application - ETSI ES 201 912 protocol 1 implementation. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__softhangup_8c.html">app_softhangup.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>SoftHangup application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__speech__utils_8c.html">app_speech_utils.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Speech Recognition Utility Applications. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__stack_8c.html">app_stack.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Stack applications Gosub, Return, etc. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__system_8c.html">app_system.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Execute arbitrary system commands. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__talkdetect_8c.html">app_talkdetect.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Playback a file with audio detect. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__test_8c.html">app_test.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Applications to test connection and produce report in text file. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__transfer_8c.html">app_transfer.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Transfer a caller. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__url_8c.html">app_url.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>App to transmit a URL. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__userevent_8c.html">app_userevent.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>UserEvent application -- send manager event. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__verbose_8c.html">app_verbose.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Verbose logging application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__voicemail_8c.html">app_voicemail.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Comedian Mail - Voicemail System. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__waitforring_8c.html">app_waitforring.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Wait for Ring Application. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__waitforsilence_8c.html">app_waitforsilence.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Wait for Silence</p>
<ul>
<li>Waits for up to 'x' milliseconds of silence, 'y' times <br/>
</li>
<li>WaitForSilence(500,2) will wait for 1/2 second of silence, twice <br/>
</li>
<li>WaitForSilence(1000,1) will wait for 1 second of silence, once <br/>
</li>
<li>WaitForSilence(300,3,10) will wait for 300ms of silence, 3 times, and return after 10sec <br/>
. </li>
</ul>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__waituntil_8c.html">app_waituntil.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Sleep until the given epoch. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__while_8c.html">app_while.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>While Loop Implementation. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="app__zapateller_8c.html">app_zapateller.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Playback the special information tone to get rid of telemarketers. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__ael__share_8c.html">res_ael_share.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Shareable AEL code -- mainly between internal and external modules. </p>
<br/></td></tr>
</p>
<tr><td class="memItemLeft" align="right" valign="top">file &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="res__realtime_8c.html">res_realtime.c</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>RealTime CLI. </p>
<br/></td></tr>
</p>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gad2402d98af3b54a22d8f5421b7e0d814">iax2_prov_app</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#a322af389d034b8f1282da0a853ffb921">chan</a>, void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga07e7e350a58c79e93f784ca58ee57988">pbx_builtin_answer</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gaab32a9f46cfa10fd991f16c6a7dc0f41">pbx_builtin_background</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gafdd3cfad2a2fa9180649782c8794b01f">pbx_builtin_busy</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga5f356581010a6f1ed24407db1758cdc2">pbx_builtin_congestion</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gaa259135ffd279c9afc70b476ee0b4cd6">pbx_builtin_execiftime</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gae51321ae79f6f8a85cfbfe8d033a2df6">pbx_builtin_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga71db5198713c09e6b55360f5ced0212e">pbx_builtin_gotoiftime</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga30a1a1a976e72e564e7babdbbe26ca7c">pbx_builtin_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga8511a318e816998621739771aaab5a1f">pbx_builtin_proceeding</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga0afd7cd1dcef243a218c70fe30551b15">pbx_builtin_progress</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga2f1090aa1e3405c842bedae424db5b20">pbx_builtin_resetcdr</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga9dadf39fac4d7bf36c38ce43bef6e8bc">pbx_builtin_ringing</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gab695b2eba5ced025a2eb04fbdd87475f">pbx_builtin_setamaflags</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga68501e1e569b1d53a6bba41cc1d20a90">pbx_builtin_wait</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga0c007df1099e478f13cdde9876a7f9df">pbx_builtin_waitexten</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Applications support the dialplan. They register dynamically with. </p>
<h2><a class="anchor" id="app_generic">
Asterisk Dial Plan Applications</a></h2>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="module_8h.html#aa47a7223480d23a864cf83fef0f8585e" title="Register an application.">ast_register_application()</a> and unregister with </dd>
<dd>
<a class="el" href="module_8h.html#ad2ca15621101154f29748cf1dac3c3cf" title="Unregister an application.">ast_unregister_application()</a> </dd></dl>
<dl class="user"><dt><b>See also</b></dt><dd><ul>
<li><a class="el" href="group__functions.html">Module: Dial plan functions</a> </li>
</ul>
</dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gad2402d98af3b54a22d8f5421b7e0d814"></a><!-- doxytag: member="chan_iax2.c::iax2_prov_app" ref="gad2402d98af3b54a22d8f5421b7e0d814" args="(struct ast_channel *chan, void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int iax2_prov_app </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>iax2provision </p>

<p>Definition at line <a class="el" href="chan__iax2_8c_source.html#l11373">11373</a> of file <a class="el" href="chan__iax2_8c_source.html">chan_iax2.c</a>.</p>

<p>References <a class="el" href="chan__iax2_8c_source.html#l00497">iax2_trunk_peer::addr</a>, <a class="el" href="utils_8c_source.html#l00431">ast_inet_ntoa()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="chan__iax2_8c_source.html#l11321">iax2_provision()</a>, <a class="el" href="chan__iax2_8c_source.html#l01157">iax2_tech</a>, <a class="el" href="chan__iax2_8c_source.html#l01009">iaxs</a>, <a class="el" href="logger_8h_source.html#l00141">LOG_NOTICE</a>, <a class="el" href="chan__iax2_8c_source.html#l00193">PTR_TO_CALLNO</a>, <a class="el" href="chan__iax2_8c_source.html#l00496">iax2_trunk_peer::sockfd</a>, <a class="el" href="channel_8h_source.html#l00400">ast_channel::tech</a>, and <a class="el" href="channel_8h_source.html#l00401">ast_channel::tech_pvt</a>.</p>

<p>Referenced by <a class="el" href="chan__iax2_8c_source.html#l13805">load_module()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l11374"></a>11374 {
<a name="l11375"></a>11375    <span class="keywordtype">int</span> res;
<a name="l11376"></a>11376    <span class="keywordtype">char</span> *sdata;
<a name="l11377"></a>11377    <span class="keywordtype">char</span> *opts;
<a name="l11378"></a>11378    <span class="keywordtype">int</span> force =0;
<a name="l11379"></a>11379    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> callno = <a class="code" href="chan__iax2_8c.html#a253fef13f324ad1569d580e47e080ca9">PTR_TO_CALLNO</a>(chan-&gt;<a class="code" href="structast__channel.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>);
<a name="l11380"></a>11380    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data))
<a name="l11381"></a>11381       data = <span class="stringliteral">&quot;default&quot;</span>;
<a name="l11382"></a>11382    sdata = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l11383"></a>11383    opts = strchr(sdata, <span class="charliteral">&apos;|&apos;</span>);
<a name="l11384"></a>11384    <span class="keywordflow">if</span> (opts)
<a name="l11385"></a>11385       *opts=<span class="charliteral">&apos;\0&apos;</span>;
<a name="l11386"></a>11386 
<a name="l11387"></a>11387    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#a0716a334727b22adf0290792bd80de10">tech</a> != &amp;<a class="code" href="chan__iax2_8c.html#a0af0245e4ac84fd0d4c5fd5a61829ac5">iax2_tech</a>) {
<a name="l11388"></a>11388       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Can&apos;t provision a non-IAX device!\n&quot;</span>);
<a name="l11389"></a>11389       <span class="keywordflow">return</span> -1;
<a name="l11390"></a>11390    } 
<a name="l11391"></a>11391    <span class="keywordflow">if</span> (!callno || !<a class="code" href="chan__iax2_8c.html#a0cb402a1e272ec52f1ccd7409e55f7f7" title="an array of iax2 pvt structures">iaxs</a>[callno] || !<a class="code" href="chan__iax2_8c.html#a0cb402a1e272ec52f1ccd7409e55f7f7" title="an array of iax2 pvt structures">iaxs</a>[callno]-&gt;addr.sin_addr.s_addr) {
<a name="l11392"></a>11392       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Can&apos;t provision something with no IP?\n&quot;</span>);
<a name="l11393"></a>11393       <span class="keywordflow">return</span> -1;
<a name="l11394"></a>11394    }
<a name="l11395"></a>11395    res = <a class="code" href="chan__iax2_8c.html#afb50b8462a8f5ed65a4df220ab27e293">iax2_provision</a>(&amp;<a class="code" href="chan__iax2_8c.html#a0cb402a1e272ec52f1ccd7409e55f7f7" title="an array of iax2 pvt structures">iaxs</a>[callno]-&gt;addr, <a class="code" href="chan__iax2_8c.html#a0cb402a1e272ec52f1ccd7409e55f7f7" title="an array of iax2 pvt structures">iaxs</a>[callno]-&gt;sockfd, NULL, sdata, force);
<a name="l11396"></a>11396    <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Provisioned IAXY at &apos;%s&apos; with &apos;%s&apos;= %d\n&quot;</span>,
<a name="l11397"></a>11397       <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(<a class="code" href="chan__iax2_8c.html#a0cb402a1e272ec52f1ccd7409e55f7f7" title="an array of iax2 pvt structures">iaxs</a>[callno]-&gt;addr.sin_addr),
<a name="l11398"></a>11398       sdata, res);
<a name="l11399"></a>11399    <span class="keywordflow">return</span> res;
<a name="l11400"></a>11400 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga07e7e350a58c79e93f784ca58ee57988"></a><!-- doxytag: member="pbx.c::pbx_builtin_answer" ref="ga07e7e350a58c79e93f784ca58ee57988" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_answer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08504">8504</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l01850">__ast_answer()</a>, <a class="el" href="channel_8h_source.html#l00469">ast_channel::_state</a>, <a class="el" href="app_8h_source.html#l00338">AST_APP_ARG</a>, <a class="el" href="app_8h_source.html#l00355">AST_DECLARE_APP_ARGS</a>, <a class="el" href="app_8h_source.html#l00387">AST_STANDARD_APP_ARGS</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, and <a class="el" href="chan__mgcp_8c_source.html#l01737">parse()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08505"></a>08505 {
<a name="l08506"></a>08506    <span class="keywordtype">int</span> delay = 0;
<a name="l08507"></a>08507    <span class="keywordtype">int</span> answer_cdr = 1;
<a name="l08508"></a>08508    <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;
<a name="l08509"></a>08509    <a class="code" href="app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2" title="Declare a structure to hold an application&amp;#39;s arguments.">AST_DECLARE_APP_ARGS</a>(args,
<a name="l08510"></a>08510       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(delay);
<a name="l08511"></a>08511       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(answer_cdr);
<a name="l08512"></a>08512    );
<a name="l08513"></a>08513 
<a name="l08514"></a>08514    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08515"></a>08515       <span class="keywordflow">return</span> <a class="code" href="channel_8h.html#a5457ba5b9d85a5167027716d84449f1f" title="Answer a channel, with a selectable delay before returning.">__ast_answer</a>(chan, 0, 1);
<a name="l08516"></a>08516    }
<a name="l08517"></a>08517 
<a name="l08518"></a>08518    parse = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l08519"></a>08519 
<a name="l08520"></a>08520    <a class="code" href="app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8" title="Performs the &amp;#39;standard&amp;#39; argument separation process for an application.">AST_STANDARD_APP_ARGS</a>(args, parse);
<a name="l08521"></a>08521 
<a name="l08522"></a>08522    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(args.delay) &amp;&amp; (chan-&gt;<a class="code" href="structast__channel.html#abc7d0b575ffea0b65ce604e0e4c99d3d">_state</a> != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>))
<a name="l08523"></a>08523       delay = atoi(data);
<a name="l08524"></a>08524 
<a name="l08525"></a>08525    <span class="keywordflow">if</span> (delay &lt; 0) {
<a name="l08526"></a>08526       delay = 0;
<a name="l08527"></a>08527    }
<a name="l08528"></a>08528 
<a name="l08529"></a>08529    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(args.answer_cdr) &amp;&amp; !strcasecmp(args.answer_cdr, <span class="stringliteral">&quot;nocdr&quot;</span>)) {
<a name="l08530"></a>08530       answer_cdr = 0;
<a name="l08531"></a>08531    }
<a name="l08532"></a>08532 
<a name="l08533"></a>08533    <span class="keywordflow">return</span> <a class="code" href="channel_8h.html#a5457ba5b9d85a5167027716d84449f1f" title="Answer a channel, with a selectable delay before returning.">__ast_answer</a>(chan, delay, answer_cdr);
<a name="l08534"></a>08534 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gaab32a9f46cfa10fd991f16c6a7dc0f41"></a><!-- doxytag: member="pbx.c::pbx_builtin_background" ref="gaab32a9f46cfa10fd991f16c6a7dc0f41" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_background </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08798">8798</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00469">ast_channel::_state</a>, <a class="el" href="channel_8c_source.html#l01951">ast_answer()</a>, <a class="el" href="app_8h_source.html#l00338">AST_APP_ARG</a>, <a class="el" href="app_8c_source.html#l01776">ast_app_parse_options()</a>, <a class="el" href="pbx_8c_source.html#l04158">ast_canmatch_extension()</a>, <a class="el" href="lock_8h_source.html#l02031">ast_channel_lock</a>, <a class="el" href="lock_8h_source.html#l02034">ast_channel_unlock</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="app_8h_source.html#l00355">AST_DECLARE_APP_ARGS</a>, <a class="el" href="file_8h_source.html#l00047">AST_DIGIT_ANY</a>, <a class="el" href="channel_8h_source.html#l00571">AST_FLAG_DISABLE_WORKAROUNDS</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="pbx_8c_source.html#l04163">ast_matchmore_extension()</a>, <a class="el" href="app_8h_source.html#l00387">AST_STANDARD_APP_ARGS</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, <a class="el" href="file_8c_source.html#l00122">ast_stopstream()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="file_8c_source.html#l00943">ast_streamfile()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="utils_8h_source.html#l00061">ast_test_flag</a>, <a class="el" href="file_8c_source.html#l01315">ast_waitstream()</a>, <a class="el" href="file_8c_source.html#l01326">ast_waitstream_exten()</a>, <a class="el" href="pbx_8c_source.html#l00737">BACKGROUND_MATCHEXTEN</a>, <a class="el" href="pbx_8c_source.html#l00736">BACKGROUND_NOANSWER</a>, <a class="el" href="pbx_8c_source.html#l00745">background_opts</a>, <a class="el" href="pbx_8c_source.html#l00738">BACKGROUND_PLAYBACK</a>, <a class="el" href="pbx_8c_source.html#l00735">BACKGROUND_SKIP</a>, <a class="el" href="channel_8h_source.html#l00444">ast_channel::cid</a>, <a class="el" href="channel_8h_source.html#l00203">ast_callerid::cid_num</a>, <a class="el" href="channel_8h_source.html#l00503">ast_channel::context</a>, <a class="el" href="channel_8h_source.html#l00504">ast_channel::exten</a>, <a class="el" href="utils_8h_source.html#l00199">ast_flags::flags</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__mgcp_8c_source.html#l01737">parse()</a>, <a class="el" href="pbx_8c_source.html#l08951">pbx_builtin_getvar_helper()</a>, <a class="el" href="pbx_8c_source.html#l09023">pbx_builtin_setvar_helper()</a>, <a class="el" href="channel_8h_source.html#l00471">ast_channel::priority</a>, and <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08799"></a>08799 {
<a name="l08800"></a>08800    <span class="keywordtype">int</span> res = 0;
<a name="l08801"></a>08801    <span class="keywordtype">int</span> mres = 0;
<a name="l08802"></a>08802    <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> <a class="code" href="structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = {0};
<a name="l08803"></a>08803    <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>, <a class="code" href="chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>[2] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l08804"></a>08804    <a class="code" href="app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2" title="Declare a structure to hold an application&amp;#39;s arguments.">AST_DECLARE_APP_ARGS</a>(args,
<a name="l08805"></a>08805       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(filename);
<a name="l08806"></a>08806       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(options);
<a name="l08807"></a>08807       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(lang);
<a name="l08808"></a>08808       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(<a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>);
<a name="l08809"></a>08809    );
<a name="l08810"></a>08810 
<a name="l08811"></a>08811    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08812"></a>08812       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Background requires an argument (filename)\n&quot;</span>);
<a name="l08813"></a>08813       <span class="keywordflow">return</span> -1;
<a name="l08814"></a>08814    }
<a name="l08815"></a>08815 
<a name="l08816"></a>08816    parse = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l08817"></a>08817 
<a name="l08818"></a>08818    <a class="code" href="app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8" title="Performs the &amp;#39;standard&amp;#39; argument separation process for an application.">AST_STANDARD_APP_ARGS</a>(args, parse);
<a name="l08819"></a>08819 
<a name="l08820"></a>08820    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(args.lang))
<a name="l08821"></a>08821       args.lang = (<span class="keywordtype">char</span> *)chan-&gt;language; <span class="comment">/* XXX this is const */</span>
<a name="l08822"></a>08822 
<a name="l08823"></a>08823    if (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(args.context)) {
<a name="l08824"></a>08824       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;
<a name="l08825"></a>08825       <a class="code" href="lock_8h.html#acbcec0b11bb6e43e0ebcd82828bc8684" title="Lock a channel. If DEBUG_CHANNEL_LOCKS is defined in the Makefile, print relevant...">ast_channel_lock</a>(chan);
<a name="l08826"></a>08826       <span class="keywordflow">if</span> ((context = <a class="code" href="pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b" title="Return a pointer to the value of the corresponding channel variable.">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;MACRO_CONTEXT&quot;</span>))) {
<a name="l08827"></a>08827          args.context = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(context);
<a name="l08828"></a>08828       } <span class="keywordflow">else</span> {
<a name="l08829"></a>08829          args.context = chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;
<a name="l08830"></a>08830       }
<a name="l08831"></a>08831       <a class="code" href="lock_8h.html#a853c07107a1385c83c5d2a0ab7e01d79" title="Unlock a channel. If DEBUG_CHANNEL_LOCKS is defined in the Makefile, print relevant...">ast_channel_unlock</a>(chan);
<a name="l08832"></a>08832    }
<a name="l08833"></a>08833 
<a name="l08834"></a>08834    <span class="keywordflow">if</span> (args.options) {
<a name="l08835"></a>08835       <span class="keywordflow">if</span> (!strcasecmp(args.options, <span class="stringliteral">&quot;skip&quot;</span>))
<a name="l08836"></a>08836          flags.<a class="code" href="structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = <a class="code" href="pbx_8c.html#a95d317328467a30745a66647d2d232b1">BACKGROUND_SKIP</a>;
<a name="l08837"></a>08837       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(args.options, <span class="stringliteral">&quot;noanswer&quot;</span>))
<a name="l08838"></a>08838          flags.<a class="code" href="structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = <a class="code" href="pbx_8c.html#a248fc16b454bba0625d03d7d51efab8a">BACKGROUND_NOANSWER</a>;
<a name="l08839"></a>08839       <span class="keywordflow">else</span>
<a name="l08840"></a>08840          <a class="code" href="app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb" title="Parses a string containing application options and sets flags/arguments.">ast_app_parse_options</a>(<a class="code" href="pbx_8c.html#a7d8f03c22efbc83c74240c45229c1ce9">background_opts</a>, &amp;flags, NULL, args.options);
<a name="l08841"></a>08841    }
<a name="l08842"></a>08842 
<a name="l08843"></a>08843    <span class="comment">/* Answer if need be */</span>
<a name="l08844"></a>08844    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#abc7d0b575ffea0b65ce604e0e4c99d3d">_state</a> != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {
<a name="l08845"></a>08845       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a95d317328467a30745a66647d2d232b1">BACKGROUND_SKIP</a>)) {
<a name="l08846"></a>08846          <span class="keywordflow">goto</span> done;
<a name="l08847"></a>08847       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a248fc16b454bba0625d03d7d51efab8a">BACKGROUND_NOANSWER</a>)) {
<a name="l08848"></a>08848          res = <a class="code" href="channel_8h.html#aec583a3e25358ee552a4f3df53914cd0" title="Answer a channel.">ast_answer</a>(chan);
<a name="l08849"></a>08849       }
<a name="l08850"></a>08850    }
<a name="l08851"></a>08851 
<a name="l08852"></a>08852    <span class="keywordflow">if</span> (!res) {
<a name="l08853"></a>08853       <span class="keywordtype">char</span> *back = args.filename;
<a name="l08854"></a>08854       <span class="keywordtype">char</span> *front;
<a name="l08855"></a>08855 
<a name="l08856"></a>08856       <a class="code" href="file_8h.html#a3092bf11d4bba66f646562759608b1bc" title="Stops a stream.">ast_stopstream</a>(chan);      <span class="comment">/* Stop anything playing */</span>
<a name="l08857"></a>08857       <span class="comment">/* Stream the list of files */</span>
<a name="l08858"></a>08858       <span class="keywordflow">while</span> (!res &amp;&amp; (front = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;back, <span class="stringliteral">&quot;&amp;&quot;</span>)) ) {
<a name="l08859"></a>08859          <span class="keywordflow">if</span> ( (res = <a class="code" href="file_8h.html#a67c7e271b4ca70aca6d48fd48d121857" title="Streams a file.">ast_streamfile</a>(chan, front, args.lang)) ) {
<a name="l08860"></a>08860             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;ast_streamfile failed on %s for %s\n&quot;</span>, chan-&gt;name, (<span class="keywordtype">char</span>*)data);
<a name="l08861"></a>08861             res = 0;
<a name="l08862"></a>08862             mres = 1;
<a name="l08863"></a>08863             <span class="keywordflow">break</span>;
<a name="l08864"></a>08864          }
<a name="l08865"></a>08865          <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a90814d9147f1b02a8e33667d6400c43d">BACKGROUND_PLAYBACK</a>)) {
<a name="l08866"></a>08866             res = <a class="code" href="file_8h.html#affc21cb57c6bf72a2cb7ec8a379b2137" title="Waits for a stream to stop or digit to be pressed.">ast_waitstream</a>(chan, <span class="stringliteral">&quot;&quot;</span>);
<a name="l08867"></a>08867          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a9e2cebe13600680593a802b3189f0b27">BACKGROUND_MATCHEXTEN</a>)) {
<a name="l08868"></a>08868             res = <a class="code" href="file_8h.html#ae6eb4e1e4576abe04a4b185688f6690c" title="Waits for a stream to stop or digit matching a valid one digit exten to be pressed...">ast_waitstream_exten</a>(chan, args.<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>);
<a name="l08869"></a>08869          } <span class="keywordflow">else</span> {
<a name="l08870"></a>08870             res = <a class="code" href="file_8h.html#affc21cb57c6bf72a2cb7ec8a379b2137" title="Waits for a stream to stop or digit to be pressed.">ast_waitstream</a>(chan, <a class="code" href="file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>);
<a name="l08871"></a>08871          }
<a name="l08872"></a>08872          <a class="code" href="file_8h.html#a3092bf11d4bba66f646562759608b1bc" title="Stops a stream.">ast_stopstream</a>(chan);
<a name="l08873"></a>08873       }
<a name="l08874"></a>08874    }
<a name="l08875"></a>08875 
<a name="l08876"></a>08876    <span class="comment">/*</span>
<a name="l08877"></a>08877 <span class="comment">    * If the single digit DTMF is an extension in the specified context, then</span>
<a name="l08878"></a>08878 <span class="comment">    * go there and signal no DTMF.  Otherwise, we should exit with that DTMF.</span>
<a name="l08879"></a>08879 <span class="comment">    * If we&apos;re in Macro, we&apos;ll exit and seek that DTMF as the beginning of an</span>
<a name="l08880"></a>08880 <span class="comment">    * extension in the Macro&apos;s calling context.  If we&apos;re not in Macro, then</span>
<a name="l08881"></a>08881 <span class="comment">    * we&apos;ll simply seek that extension in the calling context.  Previously,</span>
<a name="l08882"></a>08882 <span class="comment">    * someone complained about the behavior as it related to the interior of a</span>
<a name="l08883"></a>08883 <span class="comment">    * Gosub routine, and the fix (#14011) inadvertently broke FreePBX</span>
<a name="l08884"></a>08884 <span class="comment">    * (#14940).  This change should fix both of these situations, but with the</span>
<a name="l08885"></a>08885 <span class="comment">    * possible incompatibility that if a single digit extension does not exist</span>
<a name="l08886"></a>08886 <span class="comment">    * (but a longer extension COULD have matched), it would have previously</span>
<a name="l08887"></a>08887 <span class="comment">    * gone immediately to the &quot;i&quot; extension, but will now need to wait for a</span>
<a name="l08888"></a>08888 <span class="comment">    * timeout.</span>
<a name="l08889"></a>08889 <span class="comment">    *</span>
<a name="l08890"></a>08890 <span class="comment">    * Later, we had to add a flag to disable this workaround, because AGI</span>
<a name="l08891"></a>08891 <span class="comment">    * users can EXEC Background and reasonably expect that the DTMF code will</span>
<a name="l08892"></a>08892 <span class="comment">    * be returned (see #16434).</span>
<a name="l08893"></a>08893 <span class="comment">    */</span>
<a name="l08894"></a>08894    <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#adbaf9202177df73e6880eab6e6aab329ad3827e45a36d53f7570b8cd2ed8fad67">AST_FLAG_DISABLE_WORKAROUNDS</a>) &amp;&amp;
<a name="l08895"></a>08895          (exten[0] = res) &amp;&amp;
<a name="l08896"></a>08896          <a class="code" href="pbx_8h.html#a93f9868530c1e8a9d9d367d1ead8782e" title="Looks for a valid matching extension.">ast_canmatch_extension</a>(chan, args.<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, exten, 1, chan-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>) &amp;&amp;
<a name="l08897"></a>08897          !<a class="code" href="pbx_8h.html#ac359af75b9494f50904583d2168a7577" title="Looks to see if adding anything to this extension might match something. (exists...">ast_matchmore_extension</a>(chan, args.<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, exten, 1, chan-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>)) {
<a name="l08898"></a>08898       snprintf(chan-&gt;<a class="code" href="structast__channel.html#a78d4847658b695383d849efd12399b38">exten</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#a78d4847658b695383d849efd12399b38">exten</a>), <span class="stringliteral">&quot;%c&quot;</span>, res);
<a name="l08899"></a>08899       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, args.context, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>));
<a name="l08900"></a>08900       chan-&gt;<a class="code" href="structast__channel.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = 0;
<a name="l08901"></a>08901       res = 0;
<a name="l08902"></a>08902    }
<a name="l08903"></a>08903 done:
<a name="l08904"></a>08904    <a class="code" href="pbx_8h.html#ac74f20f5a5f022a60fdf2db0dc84889c" title="Add a variable to the channel variable stack, removing the most recently set value...">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;BACKGROUNDSTATUS&quot;</span>, mres ? <span class="stringliteral">&quot;FAILED&quot;</span> : <span class="stringliteral">&quot;SUCCESS&quot;</span>);
<a name="l08905"></a>08905    <span class="keywordflow">return</span> res;
<a name="l08906"></a>08906 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gafdd3cfad2a2fa9180649782c8794b01f"></a><!-- doxytag: member="pbx.c::pbx_builtin_busy" ref="gafdd3cfad2a2fa9180649782c8794b01f" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_busy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08474">8474</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00469">ast_channel::_state</a>, <a class="el" href="cdr_8c_source.html#l00703">ast_cdr_busy()</a>, <a class="el" href="frame_8h_source.html#l00302">AST_CONTROL_BUSY</a>, <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>, <a class="el" href="channel_8c_source.html#l04695">ast_setstate()</a>, <a class="el" href="channel_8h_source.html#l00366">AST_STATE_BUSY</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, <a class="el" href="channel_8h_source.html#l00422">ast_channel::cdr</a>, and <a class="el" href="pbx_8c_source.html#l08422">wait_for_hangup()</a>.</p>

<p>Referenced by <a class="el" href="pbx_8c_source.html#l04214">__ast_pbx_run()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08475"></a>08475 {
<a name="l08476"></a>08476    <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>);
<a name="l08477"></a>08477    <span class="comment">/* Don&apos;t change state of an UP channel, just indicate</span>
<a name="l08478"></a>08478 <span class="comment">      busy in audio */</span>
<a name="l08479"></a>08479    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#abc7d0b575ffea0b65ce604e0e4c99d3d">_state</a> != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {
<a name="l08480"></a>08480       <a class="code" href="channel_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448" title="Change the state of a channel.">ast_setstate</a>(chan, <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa00d313d1a4f4502932f1c10bd619591">AST_STATE_BUSY</a>);
<a name="l08481"></a>08481       <a class="code" href="cdr_8h.html#a4df18ef44f74b2dce240ca02a9c22ddf" title="Busy a call.">ast_cdr_busy</a>(chan-&gt;<a class="code" href="structast__channel.html#a0b6fbd632bcf2e09017a0b82c2ed41ff">cdr</a>);
<a name="l08482"></a>08482    }
<a name="l08483"></a>08483    <a class="code" href="pbx_8c.html#ab75080c1a163039879284089415e416f">wait_for_hangup</a>(chan, data);
<a name="l08484"></a>08484    <span class="keywordflow">return</span> -1;
<a name="l08485"></a>08485 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga5f356581010a6f1ed24407db1758cdc2"></a><!-- doxytag: member="pbx.c::pbx_builtin_congestion" ref="ga5f356581010a6f1ed24407db1758cdc2" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_congestion </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08490">8490</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00469">ast_channel::_state</a>, <a class="el" href="frame_8h_source.html#l00305">AST_CONTROL_CONGESTION</a>, <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>, <a class="el" href="channel_8c_source.html#l04695">ast_setstate()</a>, <a class="el" href="channel_8h_source.html#l00366">AST_STATE_BUSY</a>, <a class="el" href="channel_8h_source.html#l00365">AST_STATE_UP</a>, and <a class="el" href="pbx_8c_source.html#l08422">wait_for_hangup()</a>.</p>

<p>Referenced by <a class="el" href="pbx_8c_source.html#l04214">__ast_pbx_run()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08491"></a>08491 {
<a name="l08492"></a>08492    <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>);
<a name="l08493"></a>08493    <span class="comment">/* Don&apos;t change state of an UP channel, just indicate</span>
<a name="l08494"></a>08494 <span class="comment">      congestion in audio */</span>
<a name="l08495"></a>08495    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#abc7d0b575ffea0b65ce604e0e4c99d3d">_state</a> != <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>)
<a name="l08496"></a>08496       <a class="code" href="channel_8h.html#ad9d8f7d9e228b5af98a7b40db9f06448" title="Change the state of a channel.">ast_setstate</a>(chan, <a class="code" href="channel_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa00d313d1a4f4502932f1c10bd619591">AST_STATE_BUSY</a>);
<a name="l08497"></a>08497    <a class="code" href="pbx_8c.html#ab75080c1a163039879284089415e416f">wait_for_hangup</a>(chan, data);
<a name="l08498"></a>08498    <span class="keywordflow">return</span> -1;
<a name="l08499"></a>08499 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gaa259135ffd279c9afc70b476ee0b4cd6"></a><!-- doxytag: member="pbx.c::pbx_builtin_execiftime" ref="gaa259135ffd279c9afc70b476ee0b4cd6" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_execiftime </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08659">8659</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="pbx_8c_source.html#l06939">ast_build_timing()</a>, <a class="el" href="pbx_8c_source.html#l06982">ast_check_timing()</a>, <a class="el" href="pbx_8c_source.html#l07017">ast_destroy_timing()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="pbx_8c_source.html#l01322">pbx_exec()</a>, <a class="el" href="pbx_8c_source.html#l01363">pbx_findapp()</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, <a class="el" href="strings_8h_source.html#l00072">S_OR</a>, and <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08660"></a>08660 {
<a name="l08661"></a>08661    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, *appname;
<a name="l08662"></a>08662    <span class="keyword">struct </span><a class="code" href="structast__timing.html">ast_timing</a> timing;
<a name="l08663"></a>08663    <span class="keyword">struct </span><a class="code" href="structast__app.html" title="ast_app: A registered application">ast_app</a> *<a class="code" href="adsistub_8c.html#ad194d73de26c0d836555e029d245493d">app</a>;
<a name="l08664"></a>08664    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *usage = <span class="stringliteral">&quot;ExecIfTime requires an argument:\n  &lt;time range&gt;,&lt;days of week&gt;,&lt;days of month&gt;,&lt;months&gt;[,&lt;timezone&gt;]?&lt;appname&gt;[(&lt;appargs&gt;)]&quot;</span>;
<a name="l08665"></a>08665 
<a name="l08666"></a>08666    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08667"></a>08667       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, usage);
<a name="l08668"></a>08668       <span class="keywordflow">return</span> -1;
<a name="l08669"></a>08669    }
<a name="l08670"></a>08670 
<a name="l08671"></a>08671    appname = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l08672"></a>08672 
<a name="l08673"></a>08673    s = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;appname, <span class="stringliteral">&quot;?&quot;</span>); <span class="comment">/* Separate the timerange and application name/data */</span>
<a name="l08674"></a>08674    <span class="keywordflow">if</span> (!appname) {   <span class="comment">/* missing application */</span>
<a name="l08675"></a>08675       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, usage);
<a name="l08676"></a>08676       <span class="keywordflow">return</span> -1;
<a name="l08677"></a>08677    }
<a name="l08678"></a>08678 
<a name="l08679"></a>08679    <span class="keywordflow">if</span> (!<a class="code" href="pbx_8h.html#a018549fd5d5470b676da92f6034b7347" title="Construct a timing bitmap, for use in time-based conditionals.">ast_build_timing</a>(&amp;timing, s)) {
<a name="l08680"></a>08680       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid Time Spec: %s\nCorrect usage: %s\n&quot;</span>, s, usage);
<a name="l08681"></a>08681       <a class="code" href="pbx_8h.html#a2bc52adc4f80137db9161ed499f82a00" title="Deallocates memory structures associated with a timing bitmap.">ast_destroy_timing</a>(&amp;timing);
<a name="l08682"></a>08682       <span class="keywordflow">return</span> -1;
<a name="l08683"></a>08683    }
<a name="l08684"></a>08684 
<a name="l08685"></a>08685    <span class="keywordflow">if</span> (!<a class="code" href="pbx_8h.html#a17b7d6ec799c60a8fda825cf59aea7eb" title="Evaluate a pre-constructed bitmap as to whether the current time falls within the...">ast_check_timing</a>(&amp;timing))  { <span class="comment">/* outside the valid time window, just return */</span>
<a name="l08686"></a>08686       <a class="code" href="pbx_8h.html#a2bc52adc4f80137db9161ed499f82a00" title="Deallocates memory structures associated with a timing bitmap.">ast_destroy_timing</a>(&amp;timing);
<a name="l08687"></a>08687       <span class="keywordflow">return</span> 0;
<a name="l08688"></a>08688    }
<a name="l08689"></a>08689    <a class="code" href="pbx_8h.html#a2bc52adc4f80137db9161ed499f82a00" title="Deallocates memory structures associated with a timing bitmap.">ast_destroy_timing</a>(&amp;timing);
<a name="l08690"></a>08690 
<a name="l08691"></a>08691    <span class="comment">/* now split appname(appargs) */</span>
<a name="l08692"></a>08692    <span class="keywordflow">if</span> ((s = strchr(appname, <span class="charliteral">&apos;(&apos;</span>))) {
<a name="l08693"></a>08693       <span class="keywordtype">char</span> *e;
<a name="l08694"></a>08694       *s++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l08695"></a>08695       <span class="keywordflow">if</span> ((e = strrchr(s, <span class="charliteral">&apos;)&apos;</span>)))
<a name="l08696"></a>08696          *e = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l08697"></a>08697       <span class="keywordflow">else</span>
<a name="l08698"></a>08698          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to find closing parenthesis\n&quot;</span>);
<a name="l08699"></a>08699    }
<a name="l08700"></a>08700 
<a name="l08701"></a>08701 
<a name="l08702"></a>08702    <span class="keywordflow">if</span> ((app = <a class="code" href="pbx_8h.html#a0db9808b647984133225652170b22b79" title="Look up an application.">pbx_findapp</a>(appname))) {
<a name="l08703"></a>08703       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#afb87ff7a4504ef6031a45ae4170acaad" title="Execute an application.">pbx_exec</a>(chan, app, <a class="code" href="strings_8h.html#a2faaa16929951bfd2802b7829a100ba2" title="returns the equivalent of logic or for strings: first one if not empty, otherwise...">S_OR</a>(s, <span class="stringliteral">&quot;&quot;</span>));
<a name="l08704"></a>08704    } <span class="keywordflow">else</span> {
<a name="l08705"></a>08705       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Cannot locate application %s\n&quot;</span>, appname);
<a name="l08706"></a>08706       <span class="keywordflow">return</span> -1;
<a name="l08707"></a>08707    }
<a name="l08708"></a>08708 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gae51321ae79f6f8a85cfbfe8d033a2df6"></a><!-- doxytag: member="pbx.c::pbx_builtin_goto" ref="gae51321ae79f6f8a85cfbfe8d033a2df6" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_goto </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Goto </p>

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08911">8911</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="pbx_8c_source.html#l09633">ast_parseable_goto()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="channel_8h_source.html#l00503">ast_channel::context</a>, <a class="el" href="channel_8h_source.html#l00504">ast_channel::exten</a>, and <a class="el" href="channel_8h_source.html#l00471">ast_channel::priority</a>.</p>

<p>Referenced by <a class="el" href="pbx_8c_source.html#l09204">pbx_builtin_gotoif()</a>, and <a class="el" href="pbx_8c_source.html#l08624">pbx_builtin_gotoiftime()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08912"></a>08912 {
<a name="l08913"></a>08913    <span class="keywordtype">int</span> res = <a class="code" href="pbx_8h.html#ae9b65b0515d88371a5293dd354bfd92f">ast_parseable_goto</a>(chan, data);
<a name="l08914"></a>08914    <span class="keywordflow">if</span> (!res)
<a name="l08915"></a>08915       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Goto (%s,%s,%d)\n&quot;</span>, chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, chan-&gt;<a class="code" href="structast__channel.html#a78d4847658b695383d849efd12399b38">exten</a>, chan-&gt;<a class="code" href="structast__channel.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> + 1);
<a name="l08916"></a>08916    <span class="keywordflow">return</span> res;
<a name="l08917"></a>08917 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga71db5198713c09e6b55360f5ced0212e"></a><!-- doxytag: member="pbx.c::pbx_builtin_gotoiftime" ref="ga71db5198713c09e6b55360f5ced0212e" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_gotoiftime </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08624">8624</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="pbx_8c_source.html#l06939">ast_build_timing()</a>, <a class="el" href="pbx_8c_source.html#l06982">ast_check_timing()</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="pbx_8c_source.html#l07017">ast_destroy_timing()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="pbx_8c_source.html#l08911">pbx_builtin_goto()</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, and <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08625"></a>08625 {
<a name="l08626"></a>08626    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>, *ts, *branch1, *branch2, *branch;
<a name="l08627"></a>08627    <span class="keyword">struct </span><a class="code" href="structast__timing.html">ast_timing</a> timing;
<a name="l08628"></a>08628 
<a name="l08629"></a>08629    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08630"></a>08630       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;GotoIfTime requires an argument:\n  &lt;time range&gt;,&lt;days of week&gt;,&lt;days of month&gt;,&lt;months&gt;[,&lt;timezone&gt;]?&apos;labeliftrue&apos;:&apos;labeliffalse&apos;\n&quot;</span>);
<a name="l08631"></a>08631       <span class="keywordflow">return</span> -1;
<a name="l08632"></a>08632    }
<a name="l08633"></a>08633 
<a name="l08634"></a>08634    ts = s = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l08635"></a>08635 
<a name="l08636"></a>08636    <span class="comment">/* Separate the Goto path */</span>
<a name="l08637"></a>08637    <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;ts, <span class="stringliteral">&quot;?&quot;</span>);
<a name="l08638"></a>08638    branch1 = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;ts,<span class="stringliteral">&quot;:&quot;</span>);
<a name="l08639"></a>08639    branch2 = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;ts,<span class="stringliteral">&quot;&quot;</span>);
<a name="l08640"></a>08640 
<a name="l08641"></a>08641    <span class="comment">/* struct ast_include include contained garbage here, fixed by zeroing it on get_timerange */</span>
<a name="l08642"></a>08642    <span class="keywordflow">if</span> (<a class="code" href="pbx_8h.html#a018549fd5d5470b676da92f6034b7347" title="Construct a timing bitmap, for use in time-based conditionals.">ast_build_timing</a>(&amp;timing, s) &amp;&amp; <a class="code" href="pbx_8h.html#a17b7d6ec799c60a8fda825cf59aea7eb" title="Evaluate a pre-constructed bitmap as to whether the current time falls within the...">ast_check_timing</a>(&amp;timing))
<a name="l08643"></a>08643       branch = branch1;
<a name="l08644"></a>08644    <span class="keywordflow">else</span>
<a name="l08645"></a>08645       branch = branch2;
<a name="l08646"></a>08646    <a class="code" href="pbx_8h.html#a2bc52adc4f80137db9161ed499f82a00" title="Deallocates memory structures associated with a timing bitmap.">ast_destroy_timing</a>(&amp;timing);
<a name="l08647"></a>08647 
<a name="l08648"></a>08648    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(branch)) {
<a name="l08649"></a>08649       <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Not taking any branch\n&quot;</span>);
<a name="l08650"></a>08650       <span class="keywordflow">return</span> 0;
<a name="l08651"></a>08651    }
<a name="l08652"></a>08652 
<a name="l08653"></a>08653    <span class="keywordflow">return</span> <a class="code" href="group__applications.html#gae51321ae79f6f8a85cfbfe8d033a2df6">pbx_builtin_goto</a>(chan, branch);
<a name="l08654"></a>08654 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga30a1a1a976e72e564e7babdbbe26ca7c"></a><!-- doxytag: member="pbx.c::pbx_builtin_hangup" ref="ga30a1a1a976e72e564e7babdbbe26ca7c" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_hangup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08594">8594</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="causes_8h_source.html#l00102">AST_CAUSE_NORMAL_CLEARING</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="channel_8c_source.html#l00642">ast_str2cause()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="channel_8c_source.html#l00136">cause</a>, <a class="el" href="channel_8h_source.html#l00479">ast_channel::hangupcause</a>, and <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08595"></a>08595 {
<a name="l08596"></a>08596    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08597"></a>08597       <span class="keywordtype">int</span> <a class="code" href="channel_8c.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a>;
<a name="l08598"></a>08598       <span class="keywordtype">char</span> *endptr;
<a name="l08599"></a>08599 
<a name="l08600"></a>08600       <span class="keywordflow">if</span> ((cause = <a class="code" href="channel_8h.html#a058d07bbed187a4548f2667a8404f2c4" title="Convert a symbolic hangup cause to number.">ast_str2cause</a>(data)) &gt; -1) {
<a name="l08601"></a>08601          chan-&gt;<a class="code" href="structast__channel.html#aa4261b664d6712ba8551bde24ad17382">hangupcause</a> = cause;
<a name="l08602"></a>08602          <span class="keywordflow">return</span> -1;
<a name="l08603"></a>08603       }
<a name="l08604"></a>08604 
<a name="l08605"></a>08605       cause = strtol((<span class="keyword">const</span> <span class="keywordtype">char</span> *) data, &amp;endptr, 10);
<a name="l08606"></a>08606       <span class="keywordflow">if</span> (cause != 0 || (data != endptr)) {
<a name="l08607"></a>08607          chan-&gt;<a class="code" href="structast__channel.html#aa4261b664d6712ba8551bde24ad17382">hangupcause</a> = cause;
<a name="l08608"></a>08608          <span class="keywordflow">return</span> -1;
<a name="l08609"></a>08609       }
<a name="l08610"></a>08610 
<a name="l08611"></a>08611       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid cause given to Hangup(): \&quot;%s\&quot;\n&quot;</span>, (<span class="keywordtype">char</span> *) data);
<a name="l08612"></a>08612    }
<a name="l08613"></a>08613 
<a name="l08614"></a>08614    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#aa4261b664d6712ba8551bde24ad17382">hangupcause</a>) {
<a name="l08615"></a>08615       chan-&gt;<a class="code" href="structast__channel.html#aa4261b664d6712ba8551bde24ad17382">hangupcause</a> = <a class="code" href="causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>;
<a name="l08616"></a>08616    }
<a name="l08617"></a>08617 
<a name="l08618"></a>08618    <span class="keywordflow">return</span> -1;
<a name="l08619"></a>08619 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga8511a318e816998621739771aaab5a1f"></a><!-- doxytag: member="pbx.c::pbx_builtin_proceeding" ref="ga8511a318e816998621739771aaab5a1f" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_proceeding </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08447">8447</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00312">AST_CONTROL_PROCEEDING</a>, and <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08448"></a>08448 {
<a name="l08449"></a>08449    <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a50b7fe33bba67b74dd7b746539e81000">AST_CONTROL_PROCEEDING</a>);
<a name="l08450"></a>08450    <span class="keywordflow">return</span> 0;
<a name="l08451"></a>08451 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga0afd7cd1dcef243a218c70fe30551b15"></a><!-- doxytag: member="pbx.c::pbx_builtin_progress" ref="ga0afd7cd1dcef243a218c70fe30551b15" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_progress </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08456">8456</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00311">AST_CONTROL_PROGRESS</a>, and <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08457"></a>08457 {
<a name="l08458"></a>08458    <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a1a461c5e737ed6ed7c8cb0f78557a6fd">AST_CONTROL_PROGRESS</a>);
<a name="l08459"></a>08459    <span class="keywordflow">return</span> 0;
<a name="l08460"></a>08460 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga2f1090aa1e3405c842bedae424db5b20"></a><!-- doxytag: member="pbx.c::pbx_builtin_resetcdr" ref="ga2f1090aa1e3405c842bedae424db5b20" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_resetcdr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08566">8566</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="app_8c_source.html#l01776">ast_app_parse_options()</a>, <a class="el" href="cdr_8c_source.html#l01062">ast_cdr_reset()</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="channel_8h_source.html#l00422">ast_channel::cdr</a>, and <a class="el" href="pbx_8c_source.html#l08561">resetcdr_opts</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08567"></a>08567 {
<a name="l08568"></a>08568    <span class="keywordtype">char</span> *args;
<a name="l08569"></a>08569    <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> <a class="code" href="structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = { 0 };
<a name="l08570"></a>08570 
<a name="l08571"></a>08571    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08572"></a>08572       args = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l08573"></a>08573       <a class="code" href="app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb" title="Parses a string containing application options and sets flags/arguments.">ast_app_parse_options</a>(<a class="code" href="pbx_8c.html#ad35970bca312826e185d7cc0c8285abe">resetcdr_opts</a>, &amp;flags, NULL, args);
<a name="l08574"></a>08574    }
<a name="l08575"></a>08575 
<a name="l08576"></a>08576    <a class="code" href="cdr_8h.html#a70abe6f1e79dda51a858cee326a90d8e" title="Reset the detail record, optionally posting it first.">ast_cdr_reset</a>(chan-&gt;<a class="code" href="structast__channel.html#a0b6fbd632bcf2e09017a0b82c2ed41ff">cdr</a>, &amp;flags);
<a name="l08577"></a>08577 
<a name="l08578"></a>08578    <span class="keywordflow">return</span> 0;
<a name="l08579"></a>08579 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga9dadf39fac4d7bf36c38ce43bef6e8bc"></a><!-- doxytag: member="pbx.c::pbx_builtin_ringing" ref="ga9dadf39fac4d7bf36c38ce43bef6e8bc" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_ringing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08465">8465</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="frame_8h_source.html#l00300">AST_CONTROL_RINGING</a>, and <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08466"></a>08466 {
<a name="l08467"></a>08467    <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);
<a name="l08468"></a>08468    <span class="keywordflow">return</span> 0;
<a name="l08469"></a>08469 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gab695b2eba5ced025a2eb04fbdd87475f"></a><!-- doxytag: member="pbx.c::pbx_builtin_setamaflags" ref="gab695b2eba5ced025a2eb04fbdd87475f" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_setamaflags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08584">8584</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="cdr_8c_source.html#l00955">ast_cdr_setamaflags()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08585"></a>08585 {
<a name="l08586"></a>08586    <span class="comment">/* Copy the AMA Flags as specified */</span>
<a name="l08587"></a>08587    <a class="code" href="cdr_8h.html#a801a6c8fd5cf3c9960c1167920ce7bf1" title="Set AMA flags for channel.">ast_cdr_setamaflags</a>(chan, data ? data : <span class="stringliteral">&quot;&quot;</span>);
<a name="l08588"></a>08588    <span class="keywordflow">return</span> 0;
<a name="l08589"></a>08589 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga68501e1e569b1d53a6bba41cc1d20a90"></a><!-- doxytag: member="pbx.c::pbx_builtin_wait" ref="ga68501e1e569b1d53a6bba41cc1d20a90" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_wait </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08713">8713</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="channel_8c_source.html#l01367">ast_safe_sleep()</a>, and <a class="el" href="aesopt_8h_source.html#l00399">s</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08714"></a>08714 {
<a name="l08715"></a>08715    <span class="keywordtype">double</span> <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l08716"></a>08716    <span class="keywordtype">int</span> ms;
<a name="l08717"></a>08717 
<a name="l08718"></a>08718    <span class="comment">/* Wait for &quot;n&quot; seconds */</span>
<a name="l08719"></a>08719    <span class="keywordflow">if</span> (data &amp;&amp; (s = atof(data)) &gt; 0.0) {
<a name="l08720"></a>08720       ms = s * 1000.0;
<a name="l08721"></a>08721       <span class="keywordflow">return</span> <a class="code" href="channel_8h.html#af10e3bd01602095e1908d3926afc3b76" title="Wait for a specified amount of time, looking for hangups.">ast_safe_sleep</a>(chan, ms);
<a name="l08722"></a>08722    }
<a name="l08723"></a>08723    <span class="keywordflow">return</span> 0;
<a name="l08724"></a>08724 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga0c007df1099e478f13cdde9876a7f9df"></a><!-- doxytag: member="pbx.c::pbx_builtin_waitexten" ref="ga0c007df1099e478f13cdde9876a7f9df" args="(struct ast_channel *, void *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int pbx_builtin_waitexten </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="paramname"> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pbx_8c_source.html#l08729">8729</a> of file <a class="el" href="pbx_8c_source.html">pbx.c</a>.</p>

<p>References <a class="el" href="channel_8h_source.html#l00462">ast_channel::_softhangup</a>, <a class="el" href="app_8h_source.html#l00338">AST_APP_ARG</a>, <a class="el" href="app_8c_source.html#l01776">ast_app_parse_options()</a>, <a class="el" href="frame_8h_source.html#l00313">AST_CONTROL_HOLD</a>, <a class="el" href="frame_8h_source.html#l00314">AST_CONTROL_UNHOLD</a>, <a class="el" href="app_8h_source.html#l00355">AST_DECLARE_APP_ARGS</a>, <a class="el" href="pbx_8c_source.html#l04143">ast_exists_extension()</a>, <a class="el" href="indications_8c_source.html#l00452">ast_get_indication_tone()</a>, <a class="el" href="channel_8c_source.html#l03110">ast_indicate()</a>, <a class="el" href="channel_8c_source.html#l03150">ast_indicate_data()</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="indications_8c_source.html#l00301">ast_playtones_start()</a>, <a class="el" href="indications_8c_source.html#l00390">ast_playtones_stop()</a>, <a class="el" href="channel_8h_source.html#l00637">AST_SOFTHANGUP_TIMEOUT</a>, <a class="el" href="app_8h_source.html#l00387">AST_STANDARD_APP_ARGS</a>, <a class="el" href="utils_8h_source.html#l00616">ast_strdupa</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="utils_8h_source.html#l00061">ast_test_flag</a>, <a class="el" href="indications_8h_source.html#l00223">ast_tone_zone_sound_unref()</a>, <a class="el" href="channel_8c_source.html#l05449">ast_tonepair_start()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="channel_8c_source.html#l02400">ast_waitfordigit()</a>, <a class="el" href="channel_8h_source.html#l00444">ast_channel::cid</a>, <a class="el" href="channel_8h_source.html#l00203">ast_callerid::cid_num</a>, <a class="el" href="channel_8h_source.html#l00503">ast_channel::context</a>, <a class="el" href="indications_8h_source.html#l00051">ast_tone_zone_sound::data</a>, <a class="el" href="channel_8h_source.html#l00504">ast_channel::exten</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="chan__mgcp_8c_source.html#l01737">parse()</a>, <a class="el" href="channel_8h_source.html#l00418">ast_channel::pbx</a>, <a class="el" href="channel_8h_source.html#l00471">ast_channel::priority</a>, <a class="el" href="pbx_8h_source.html#l00146">ast_pbx::rtimeoutms</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, <a class="el" href="strings_8h_source.html#l00072">S_OR</a>, <a class="el" href="pbx_8c_source.html#l04174">set_ext_pri()</a>, <a class="el" href="pbx_8c_source.html#l00748">WAITEXTEN_DIALTONE</a>, <a class="el" href="pbx_8c_source.html#l00747">WAITEXTEN_MOH</a>, <a class="el" href="pbx_8c_source.html#l00753">waitexten_opts</a>, and <a class="el" href="channel_8h_source.html#l00423">ast_channel::zone</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l08730"></a>08730 {
<a name="l08731"></a>08731    <span class="keywordtype">int</span> ms, res;
<a name="l08732"></a>08732    <span class="keywordtype">double</span> <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;
<a name="l08733"></a>08733    <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> <a class="code" href="structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = {0};
<a name="l08734"></a>08734    <span class="keywordtype">char</span> *opts[1] = { NULL };
<a name="l08735"></a>08735    <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;
<a name="l08736"></a>08736    <a class="code" href="app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2" title="Declare a structure to hold an application&amp;#39;s arguments.">AST_DECLARE_APP_ARGS</a>(args,
<a name="l08737"></a>08737       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(timeout);
<a name="l08738"></a>08738       <a class="code" href="app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5" title="Define an application argument.">AST_APP_ARG</a>(options);
<a name="l08739"></a>08739    );
<a name="l08740"></a>08740 
<a name="l08741"></a>08741    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(data)) {
<a name="l08742"></a>08742       parse = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(data);
<a name="l08743"></a>08743       <a class="code" href="app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8" title="Performs the &amp;#39;standard&amp;#39; argument separation process for an application.">AST_STANDARD_APP_ARGS</a>(args, parse);
<a name="l08744"></a>08744    } <span class="keywordflow">else</span>
<a name="l08745"></a>08745       memset(&amp;args, 0, <span class="keyword">sizeof</span>(args));
<a name="l08746"></a>08746 
<a name="l08747"></a>08747    <span class="keywordflow">if</span> (args.options)
<a name="l08748"></a>08748       <a class="code" href="app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb" title="Parses a string containing application options and sets flags/arguments.">ast_app_parse_options</a>(<a class="code" href="pbx_8c.html#a89c4b430fb75cf73d9aac833701ee3e2">waitexten_opts</a>, &amp;flags, opts, args.options);
<a name="l08749"></a>08749 
<a name="l08750"></a>08750    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a0e259130f0ff2cd87950ae18493ce7c1">WAITEXTEN_MOH</a>) &amp;&amp; !opts[0] ) {
<a name="l08751"></a>08751       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;The &apos;m&apos; option has been specified for WaitExten without a class.\n&quot;</span>); 
<a name="l08752"></a>08752    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a0e259130f0ff2cd87950ae18493ce7c1">WAITEXTEN_MOH</a>)) {
<a name="l08753"></a>08753       <a class="code" href="channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa" title="Indicates condition of channel, with payload.">ast_indicate_data</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a>, <a class="code" href="strings_8h.html#a2faaa16929951bfd2802b7829a100ba2" title="returns the equivalent of logic or for strings: first one if not empty, otherwise...">S_OR</a>(opts[0], NULL), strlen(opts[0]));
<a name="l08754"></a>08754    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a359267485801a1ea1e310520cf44e698">WAITEXTEN_DIALTONE</a>)) {
<a name="l08755"></a>08755       <span class="keyword">struct </span><a class="code" href="structast__tone__zone__sound.html" title="Description of a tone.">ast_tone_zone_sound</a> *ts = <a class="code" href="indications_8h.html#a516be2823557000dcd4be685a44d1d09" title="Locate a tone zone sound.">ast_get_indication_tone</a>(chan-&gt;<a class="code" href="structast__channel.html#a3b50931566324162ca5ebdd52fb5874c">zone</a>, <span class="stringliteral">&quot;dial&quot;</span>);
<a name="l08756"></a>08756       <span class="keywordflow">if</span> (ts) {
<a name="l08757"></a>08757          <a class="code" href="app__rpt_8c.html#a544e8a1dd4a986b00754103dda6a7d3b">ast_playtones_start</a>(chan, 0, ts-&gt;<a class="code" href="structast__tone__zone__sound.html#a8f64897c7ccc5c13f276d1d07c4e7095" title="Description of a tone.">data</a>, 0);
<a name="l08758"></a>08758          ts = <a class="code" href="indications_8h.html#a8b52ace68f21c0ac24414f038471647d" title="Release a reference to an ast_tone_zone_sound.">ast_tone_zone_sound_unref</a>(ts);
<a name="l08759"></a>08759       } <span class="keywordflow">else</span> {
<a name="l08760"></a>08760          <a class="code" href="channel_8h.html#a45670e7ba068c0e69745fc44e2084046">ast_tonepair_start</a>(chan, 350, 440, 0, 0);
<a name="l08761"></a>08761       }
<a name="l08762"></a>08762    }
<a name="l08763"></a>08763    <span class="comment">/* Wait for &quot;n&quot; seconds */</span>
<a name="l08764"></a>08764    <span class="keywordflow">if</span> (args.timeout &amp;&amp; (s = atof(args.timeout)) &gt; 0)
<a name="l08765"></a>08765        ms = s * 1000.0;
<a name="l08766"></a>08766    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>)
<a name="l08767"></a>08767       ms = chan-&gt;<a class="code" href="structast__channel.html#aebc9ecdf679da616c7d975b827e1f4b4">pbx</a>-&gt;<a class="code" href="structast__pbx.html#a765bfb11e07b0f90c235c9af9d7f46fa">rtimeoutms</a>;
<a name="l08768"></a>08768    <span class="keywordflow">else</span>
<a name="l08769"></a>08769       ms = 10000;
<a name="l08770"></a>08770 
<a name="l08771"></a>08771    res = <a class="code" href="channel_8h.html#a050bec9a4abc1a599b6573a6091b080c" title="Waits for a digit.">ast_waitfordigit</a>(chan, ms);
<a name="l08772"></a>08772    <span class="keywordflow">if</span> (!res) {
<a name="l08773"></a>08773       <span class="keywordflow">if</span> (<a class="code" href="pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7" title="Determine whether an extension exists.">ast_exists_extension</a>(chan, chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, chan-&gt;<a class="code" href="structast__channel.html#a78d4847658b695383d849efd12399b38">exten</a>, chan-&gt;<a class="code" href="structast__channel.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> + 1, chan-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>)) {
<a name="l08774"></a>08774          <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Timeout on %s, continuing...\n&quot;</span>, chan-&gt;name);
<a name="l08775"></a>08775       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#a7386ba9cc89b0b446f553a4d0f36576a">_softhangup</a> == <a class="code" href="channel_8h.html#a2dbb833ef0dcc466dd02ee76badaf709a90cd950abc1c22b0701a476bdd6cc246">AST_SOFTHANGUP_TIMEOUT</a>) {
<a name="l08776"></a>08776          <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Call timeout on %s, checking for &apos;T&apos;\n&quot;</span>, chan-&gt;name);
<a name="l08777"></a>08777          res = -1;
<a name="l08778"></a>08778       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7" title="Determine whether an extension exists.">ast_exists_extension</a>(chan, chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="stringliteral">&quot;t&quot;</span>, 1, chan-&gt;<a class="code" href="structast__channel.html#ad7a6835087355f91c8a8236e9a2ef23f">cid</a>.<a class="code" href="structast__callerid.html#ac8e0930b3408bc3745d3d841c520fe2f">cid_num</a>)) {
<a name="l08779"></a>08779          <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Timeout on %s, going to &apos;t&apos;\n&quot;</span>, chan-&gt;name);
<a name="l08780"></a>08780          <a class="code" href="pbx_8c.html#ae269f012897ae046fe6e785ba8521c88">set_ext_pri</a>(chan, <span class="stringliteral">&quot;t&quot;</span>, 0); <span class="comment">/* 0 will become 1, next time through the loop */</span>
<a name="l08781"></a>08781       } <span class="keywordflow">else</span> {
<a name="l08782"></a>08782          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Timeout but no rule &apos;t&apos; in context &apos;%s&apos;\n&quot;</span>, chan-&gt;<a class="code" href="structast__channel.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>);
<a name="l08783"></a>08783          res = -1;
<a name="l08784"></a>08784       }
<a name="l08785"></a>08785    }
<a name="l08786"></a>08786 
<a name="l08787"></a>08787    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a0e259130f0ff2cd87950ae18493ce7c1">WAITEXTEN_MOH</a>))
<a name="l08788"></a>08788       <a class="code" href="channel_8h.html#aef2af15a597c948e97628da6c5c84f28" title="Indicates condition of channel.">ast_indicate</a>(chan, <a class="code" href="frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a>);
<a name="l08789"></a>08789    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;flags, <a class="code" href="pbx_8c.html#a359267485801a1ea1e310520cf44e698">WAITEXTEN_DIALTONE</a>))
<a name="l08790"></a>08790       <a class="code" href="app__rpt_8c.html#a9d5be069b7060d326a213f5d60b8dc77">ast_playtones_stop</a>(chan);
<a name="l08791"></a>08791 
<a name="l08792"></a>08792    <span class="keywordflow">return</span> res;
<a name="l08793"></a>08793 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:23:39 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
