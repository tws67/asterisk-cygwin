<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:22:21 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_afe38fc0ccf2e9eefca5d5c6b03503d9.html">main</a>
  </div>
</div>
<div class="contents">
<h1>manager.c File Reference</h1>
<p>The Asterisk Management Interface - AMI.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="asterisk_8h_source.html">asterisk.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="__private_8h_source.html">asterisk/_private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="paths_8h_source.html">asterisk/paths.h</a>&quot;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;sys/mman.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="file_8h_source.html">asterisk/file.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="manager_8h_source.html">asterisk/manager.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="module_8h_source.html">asterisk/module.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="config_8h_source.html">asterisk/config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app_8h_source.html">asterisk/app.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="md5_8h_source.html">asterisk/md5.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="acl_8h_source.html">asterisk/acl.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tcptls_8h_source.html">asterisk/tcptls.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="http_8h_source.html">asterisk/http.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ast__version_8h_source.html">asterisk/ast_version.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadstorage_8h_source.html">asterisk/threadstorage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="version_8h_source.html">asterisk/version.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="term_8h_source.html">asterisk/term.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="features_8h_source.html">asterisk/features.h</a>&quot;</code><br/>

<p><a href="manager_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structactions.html">actions</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">list of <a class="el" href="structactions.html" title="list of actions registered">actions</a> registered  <a href="structactions.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structall__events.html">all_events</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__manager__user.html">ast_manager_user</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structuser.html" title="structure to hold users read from users.conf">user</a> descriptor, as read from the config file.  <a href="structast__manager__user.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structeventqent.html">eventqent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfast__originate__helper.html">fast_originate_helper</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">helper function for originate  <a href="structfast__originate__helper.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmanager__hooks.html">manager_hooks</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">list of hooks registered  <a href="structmanager__hooks.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmansession.html">mansession</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmansession__session_1_1mansession__datastores.html">mansession_datastores</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmansession__session.html">mansession_session</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpermalias.html">permalias</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsessions.html">sessions</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structusers.html">users</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">list of <a class="el" href="structusers.html" title="list of users found in the config file">users</a> found in the config file  <a href="structusers.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvariable__count.html">variable_count</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef">ASTMAN_APPEND_BUF_INITSIZE</a>&nbsp;&nbsp;&nbsp;256</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">initial allocated size for the astman_append_buf  <a href="group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaeac2210b7c1bd030e2766730c0f6f0e6">GET_HEADER_FIRST_MATCH</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga085b42ebdf75f324731bbbfc3edc0d8d">GET_HEADER_LAST_MATCH</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa0b13360e4e6387c7a73239b67a19d57">GET_HEADER_SKIP_EMPTY</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a9eeaf526330f14e1906f9e6f2557364b">HSMC_FORMAT</a>&nbsp;&nbsp;&nbsp;&quot;  %-15.15s  %-15.15s  %-55.55s\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a4f17d74ca1307a629a1d6b237ca02c35">HSMCONN_FORMAT1</a>&nbsp;&nbsp;&nbsp;&quot;  %-15.15s  %-15.15s  %-10.10s  %-10.10s  %-8.8s  %-8.8s  %-5.5s  %-5.5s\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#afd6ff00e10a26f619b167194999013b5">HSMCONN_FORMAT2</a>&nbsp;&nbsp;&nbsp;&quot;  %-15.15s  %-15.15s  %-10d  %-10d  %-8d  %-8d  %-5.5d  %-5.5d\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaf5f8f8fba6bc87e2788f8075148eb3ed">MANAGER_EVENT_BUF_INITSIZE</a>&nbsp;&nbsp;&nbsp;256</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaacec20eeac5fcdb47de6e5f98bab33df">MAX_BLACKLIST_CMD_LEN</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Descriptor for a manager session, either on the AMI socket or over HTTP.  <a href="group__Group__AMI.html#gaacec20eeac5fcdb47de6e5f98bab33df"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5">MSG_MOREDATA</a>&nbsp;&nbsp;&nbsp;((char *)astman_send_response)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send a response with an optional <a class="el" href="structmessage.html">message</a>, and terminate it with an empty line. m is used only to grab the 'ActionID' field.  <a href="group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaac650d5681bed46d2bb97b4a142f0114">NEW_EVENT</a>(m)&nbsp;&nbsp;&nbsp;(AST_LIST_NEXT(m-&gt;session-&gt;last_ev, eq_next))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a0f30c6e376cc35312886a20eae8cce2a">ROW_FMT</a>&nbsp;&nbsp;&nbsp;&quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot; bgcolor=\&quot;#f1f1ff\&quot;&gt;%s&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#ae266fd2d3b1b5374127ad824217bb025">TEST_STRING</a>&nbsp;&nbsp;&nbsp;&quot;&lt;form action=\&quot;manager\&quot;&gt;\n\	Action: &lt;select <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;action\&quot;&gt;\n\		&lt;option value=\&quot;\&quot;&gt;-----&amp;gt;&lt;/option&gt;\n\		&lt;option value=\&quot;login\&quot;&gt;login&lt;/option&gt;\n\		&lt;option value=\&quot;command\&quot;&gt;Command&lt;/option&gt;\n\		&lt;option value=\&quot;waitevent\&quot;&gt;waitevent&lt;/option&gt;\n\		&lt;option value=\&quot;listcommands\&quot;&gt;listcommands&lt;/option&gt;\n\	&lt;/select&gt;\n\	or &lt;input <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;action\&quot;&gt;&lt;br/&gt;\n\	CLI Command &lt;input <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;command\&quot;&gt;&lt;br&gt;\n\	<a class="el" href="structuser.html">user</a> &lt;input <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;username\&quot;&gt; pass &lt;input <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>=\&quot;password\&quot; name=\&quot;secret\&quot;&gt;&lt;br&gt;\n\	&lt;input <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>=\&quot;submit\&quot;&gt;\n&lt;/form&gt;\n&quot;</td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a> { <br/>
&nbsp;&nbsp;<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8">UNKNOWN_ACTION</a> =  1, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da">UNSPECIFIED_CATEGORY</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9">FAILURE_NEWCAT</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92aa8e1a46fc31ba23e18080284f3938d75">FAILURE_DELCAT</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a468f85e937d9a9d14172b0239d212125">FAILURE_EMPTYCAT</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9">FAILURE_UPDATE</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a873b7dc80f148550a62038a0f860f31d">FAILURE_DELETE</a>, 
<a class="el" href="group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a97ea9672929721f6b45f60f058465bd9">FAILURE_APPEND</a>
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> { <a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>, 
<a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>, 
<a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>
 }</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5106d8afed1eac24399cc5d57ab0c7e6">__astman_get_header</a> (const struct <a class="el" href="structmessage.html">message</a> *m, char *var, int mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2febd1b3a8ac68d84ee6fb3330276c7f">__init_astman_append_buf</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">thread local buffer for astman_append  <a href="group__Group__AMI.html#ga2febd1b3a8ac68d84ee6fb3330276c7f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a1d18fccb8dd1b468c17c0a89983b7d82">__init_manager</a> (int reload)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaea9436e4545799a89acf24ea113d0266">__init_manager_event_buf</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga463ca538d0f8666156e5a35db50d4efc">__init_userevent_buf</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa77d1f2d6eb8dbf1e1bc5d6d682b82cd">__manager_event</a> (int category, const char *event, const char *file, int line, const char *func, const char *fmt,...)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">manager_event: Send AMI event to client  <a href="group__Group__AMI.html#gaa77d1f2d6eb8dbf1e1bc5d6d682b82cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2dfc6e6a7c0200c34dbbc6021f10c649">action_atxfer</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gade12539a3e517752ad60fef428394532">action_challenge</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74">action_command</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manager command "command" - execute CLI command.  <a href="group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05">action_coresettings</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Show PBX core settings information.  <a href="group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930">action_coreshowchannels</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manager command "CoreShowChannels" - List currently defined <a class="el" href="structchannels.html" title="the list of channels we have. Note that the lock for this list is used for both the...">channels</a> and some information about them.  <a href="group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30">action_corestatus</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Show PBX core status information.  <a href="group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga03aa8a5224eadc07dddc34751e1868d0">action_createconfig</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga954eccb4f48bd6797ba65a9cada6446a">action_events</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5f3b2b093b498ed27078743ec10c05b7">action_extensionstate</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga607030674dbfc12f62148d375b4e320f">action_getconfig</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga22cac49ed9e48c4bed52477e6334278e">action_getconfigjson</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga46026a8e1dfda56ac9dc23cd31515def">action_getvar</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2b80579f3d94f43d2e7def7add35dc61">action_hangup</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga28572e9c3a5f7c565f68eae095454d3c">action_listcategories</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2cf03665d072e22c68953f8dadc65690">action_listcommands</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga446d7b8021ecd45234cd3053734c9d53">action_login</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga70e9f0abcbf6c0aca44ad6e3f941c266">action_logoff</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga1e0bee965191aad897199382d0f36aba">action_mailboxcount</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga41ec46957049f65f0409d8d92f21b428">action_mailboxstatus</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa72169a44884720d85770602ffe6cdb5">action_originate</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaea3a1b38ba96480a2f09d7109a69b0fd">action_ping</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac">action_redirect</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">action_redirect: The redirect manager command  <a href="group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb">action_reload</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a reload event.  <a href="group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga1c6842f7ec1925c46db96beaaf8d24b1">action_sendtext</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga0063f7b7d4976f533e64e98503e535aa">action_setvar</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584">action_status</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manager "status" command to show <a class="el" href="structchannels.html" title="the list of channels we have. Note that the lock for this list is used for both the...">channels</a>.  <a href="group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2ec80a6f9d335e9240ce5cc6ab49221b">action_timeout</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga722b7d69a94cb2ececdb88bf67f80667">action_updateconfig</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa837605a5558f94ae96ed1b881aa75e7">action_userevent</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gadf9acbde2aab503926610acb110634d6">action_waitevent</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1">append_event</a> (const char *<a class="el" href="evt_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, int category)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaaab162dbd3271550e8bb515c1e431bd9">ast_instring</a> (const char *bigstr, const char *smallstr, const char delim)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2">ast_manager_register2</a> (const char *action, int auth, int(*func)(struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m), const char *<a class="el" href="res__agi_8c.html#a1539fbb78128c8c72e41d1e9d2c09351">synopsis</a>, const char *<a class="el" href="callerid_8c.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">register a new command with manager, including online help. This is the preferred way to register a manager command  <a href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga9b312f4df19fa79a2185f41ff533516b">ast_manager_register_hook</a> (struct <a class="el" href="structmanager__custom__hook.html">manager_custom_hook</a> *hook)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a custom hook to be called when an event is fired.  <a href="group__Group__AMI.html#ga9b312f4df19fa79a2185f41ff533516b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga1f6d4d99712fba3bb1075b0984bc2731">ast_manager_register_struct</a> (struct <a class="el" href="structmanager__action.html">manager_action</a> *act)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5a9336fe5bb6b2cf350de9571080809d">ast_manager_unregister</a> (char *action)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister a registered manager command.  <a href="group__Group__AMI.html#ga5a9336fe5bb6b2cf350de9571080809d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga9592be65e0f9c99b7952a5841888757f">ast_manager_unregister_hook</a> (struct <a class="el" href="structmanager__custom__hook.html">manager_custom_hook</a> *hook)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete a custom hook to be called when an event is fired.  <a href="group__Group__AMI.html#ga9592be65e0f9c99b7952a5841888757f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const char *fmt,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a56275a7a3b863c8b4a49d2e74ebe739c">astman_datastore_add</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, struct <a class="el" href="structast__datastore.html">ast_datastore</a> *datastore)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a datastore to a session.  <a href="#a56275a7a3b863c8b4a49d2e74ebe739c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a1a24728a1340746b7d1e914f0bc6bc78">astman_datastore_find</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structast__datastore__info.html">ast_datastore_info</a> *info, const char *uid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a datastore on a session.  <a href="#a1a24728a1340746b7d1e914f0bc6bc78"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#af9f2dfb1df89986ee6613d2bfa541688">astman_datastore_remove</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, struct <a class="el" href="structast__datastore.html">ast_datastore</a> *datastore)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a datastore from a session.  <a href="#af9f2dfb1df89986ee6613d2bfa541688"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a> (const struct <a class="el" href="structmessage.html">message</a> *m, char *var)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get header from mananger transaction.  <a href="group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga21a20a25e6d03f6fd32cdc86fe9b53d1">astman_get_variables</a> (const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a linked list of the Variable: headers.  <a href="group__Group__AMI.html#ga21a20a25e6d03f6fd32cdc86fe9b53d1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#acb49e15f3ae80cc0ee0cfa3a250d00c0">astman_is_authed</a> (uint32_t ident)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determinie if a manager session ident is authenticated.  <a href="#acb49e15f3ae80cc0ee0cfa3a250d00c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *<a class="el" href="adsistub_8c.html#a0dee90db1d6eb30329bee1ae6cec036a">msg</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send ack in manager transaction.  <a href="group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *error)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send error in manager transaction.  <a href="group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *<a class="el" href="adsistub_8c.html#a0dee90db1d6eb30329bee1ae6cec036a">msg</a>, char *listflag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send ack in manager list transaction.  <a href="group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a">astman_send_response</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *resp, char *<a class="el" href="adsistub_8c.html#a0dee90db1d6eb30329bee1ae6cec036a">msg</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send response in manager transaction.  <a href="group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *resp, char *<a class="el" href="adsistub_8c.html#a0dee90db1d6eb30329bee1ae6cec036a">msg</a>, char *listflag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a73a22446241314099a4e371157e360f5">astman_verify_session_readpermissions</a> (uint32_t ident, int perm)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify a session's read permissions against a <a class="el" href="structpermission.html">permission</a> mask.  <a href="#a73a22446241314099a4e371157e360f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a38eb222ca678604d4f203c9e9d5295ab">astman_verify_session_writepermissions</a> (uint32_t ident, int perm)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify a session's write permissions against a <a class="el" href="structpermission.html">permission</a> mask.  <a href="#a38eb222ca678604d4f203c9e9d5295ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac0f21735eb8551ed24735a71ea26e13c">authenticate</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaccf6f6ca5a0c126f41096f5c44869b4f">authority_to_str</a> (int authority, struct <a class="el" href="structast__str.html">ast_str</a> **res)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert authority code to a list of options.  <a href="group__Group__AMI.html#gaccf6f6ca5a0c126f41096f5c44869b4f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga9227e0d88226ca4021dadf7d03d63976">check_blacklist</a> (const char *cmd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad908dfa4d3b37621b01531d8f9f41df6">check_manager_enabled</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Event list management functions. We assume that the event list always has at least one element, and the delete code will not remove the last entry even if the.  <a href="group__Group__AMI.html#gad908dfa4d3b37621b01531d8f9f41df6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga91820dbca9ccfa57da1a8c3c183a56a4">check_manager_session_inuse</a> (const char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gafd05c33fae7e3a3db836fede838c0b09">check_webmanager_enabled</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if AMI/HTTP is enabled.  <a href="group__Group__AMI.html#gafd05c33fae7e3a3db836fede838c0b09"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#aa8be2e22d4b4246e934cf0638aa0d095">compress_char</a> (char c)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga4455e2dfb7ec15524bdcd295f0695e14">destroy_session</a> (struct <a class="el" href="structmansession__session.html">mansession_session</a> *session)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga32ac2419647ed028f30dc1de0f01056e">do_message</a> (struct <a class="el" href="structmansession.html">mansession</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gab0df757e83667997fd4b802de7c7c45b">fast_originate</a> (void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmansession__session.html">mansession_session</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a> (uint32_t ident, int incinuse)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga00a98b86b15afa19451776ef1bb23452">free_session</a> (struct <a class="el" href="structmansession__session.html">mansession_session</a> *session)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__str.html">ast_str</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a329d804fa86d5ccea431b91af21455f0">generic_http_callback</a> (enum <a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, struct sockaddr_in *remote_address, const char *uri, enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> method, struct <a class="el" href="structast__variable.html">ast_variable</a> *params, int *<a class="el" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, char **title, int *contentlength)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga460510e6866d4785ec6bd0181c443739">get_input</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, char *output)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__manager__user.html">ast_manager_user</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a> (const char *<a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a> (const char *instr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structeventqent.html">eventqent</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gae44104439ab29d44fcd84f0361493625">handle_manager_reload</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CLI command manager reload.  <a href="group__Group__AMI.html#gae44104439ab29d44fcd84f0361493625"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac71fa21ee14d825bf98e4a658604c492">handle_mandebug</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5226d999bfd60cad437504afd1db054c">handle_showmanager</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga0a3fb6c9b8db835d467df360cb34f403">handle_showmanagers</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga689bc5c3cd185f54178b3719a5e834ac">handle_showmancmd</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad3ecc04e5e7484463d64fa6d00c2bdd2">handle_showmancmds</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CLI command manager list commands.  <a href="group__Group__AMI.html#gad3ecc04e5e7484463d64fa6d00c2bdd2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga26ac9d8e0f9483bd06741753ebcfe6d6">handle_showmanconn</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CLI command manager list connected.  <a href="group__Group__AMI.html#ga26ac9d8e0f9483bd06741753ebcfe6d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga4aa0274bed0fc74d53f43cad92c2e263">handle_showmaneventq</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CLI command manager list eventq.  <a href="group__Group__AMI.html#ga4aa0274bed0fc74d53f43cad92c2e263"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5da77ad82c423fcfee5299611ed6d7ce">handle_updates</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, struct <a class="el" href="structast__config.html">ast_config</a> *cfg, const char *dfn)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#abd67495092f6edf4b7e5b6ae94be3154">init_manager</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by Asterisk initialization.  <a href="#abd67495092f6edf4b7e5b6ae94be3154"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga6dba42aa414d62585a0a662a5561ec73">json_escape</a> (char *out, const char *in)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a> (struct <a class="el" href="structmansession__session.html">mansession_session</a> *session)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get displayconnects config option.  <a href="group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__str.html">ast_str</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#af287035ba3c63aabd151f2fb58b6e172">manager_http_callback</a> (struct <a class="el" href="structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, const struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> *urih, const char *uri, enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> method, struct <a class="el" href="structast__variable.html">ast_variable</a> *params, struct <a class="el" href="structast__variable.html">ast_variable</a> *headers, int *<a class="el" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, char **title, int *contentlength)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac730b751a77b99e3dd3eb4b1880ba933">manager_modulecheck</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga7c11fab0bce951155235b8e7a2013e1d">manager_moduleload</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga965e7cfa847a7dab9eac56d05d8ec8e7">manager_state_cb</a> (char *<a class="el" href="chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, char *<a class="el" href="chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, int <a class="el" href="structstate.html">state</a>, void *data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__str.html">ast_str</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#ad0469ed5deab2674afe9a20a7acc50b9">mxml_http_callback</a> (struct <a class="el" href="structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, const struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> *urih, const char *uri, enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> method, struct <a class="el" href="structast__variable.html">ast_variable</a> *params, struct <a class="el" href="structast__variable.html">ast_variable</a> *headers, int *<a class="el" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, char **title, int *contentlength)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50">process_events</a> (struct <a class="el" href="structmansession.html">mansession</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga0464e7b1c82d29cbe8b3f70bf7ca29c6">purge_events</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a47595f828e8f0e6b1faf176311417168">purge_old_stuff</a> (void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cleanup code called at each iteration of server_root, guaranteed to happen every 5 seconds at most  <a href="#a47595f828e8f0e6b1faf176311417168"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c">purge_sessions</a> (int n_max)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">remove at most n_max stale session from the list.  <a href="group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__str.html">ast_str</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a7ec28372585ee6ad7dda7ee9426ad7b0">rawman_http_callback</a> (struct <a class="el" href="structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, const struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> *urih, const char *uri, enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> method, struct <a class="el" href="structast__variable.html">ast_variable</a> *params, struct <a class="el" href="structast__variable.html">ast_variable</a> *headers, int *<a class="el" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, char **title, int *contentlength)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga1822b76d9dfd5d4c289e082e0aaa0342">ref_event</a> (struct <a class="el" href="structeventqent.html">eventqent</a> *e)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a272b99cacf89996831cfd6dc5253d6e8">reload_manager</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by Asterisk module functions and the CLI command.  <a href="#a272b99cacf89996831cfd6dc5253d6e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22">send_string</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, char *string)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d">session_do</a> (void *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The body of the individual manager session. Call <a class="el" href="group__Group__AMI.html#ga460510e6866d4785ec6bd0181c443739">get_input()</a> to read one line at a time (or be woken up on new events), collect the lines in a <a class="el" href="structmessage.html">message</a> until found an empty line, and execute the request. In any case, deliver events asynchronously through <a class="el" href="group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50">process_events()</a> (called from here if no line is available, or at the end of <a class="el" href="group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message()</a>. ).  <a href="group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6">set_eventmask</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const char *eventmask)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rather than braindead on,off this now can also accept a specific int mask value or a ',' delim list of mask strings (the same as manager.conf) -anthm.  <a href="group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga11ada23da895363223ba26f69d39029a">strings_to_mask</a> (const char *string)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structeventqent.html">eventqent</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga859bbcf21348ccba2527c2525d47444d">unref_event</a> (struct <a class="el" href="structeventqent.html">eventqent</a> *e)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a58d789617a4c4f4fb0ec8cef1147ea49">variable_count_cmp_fn</a> (void *obj, void *vstr, int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#ac8bebf364f7d11e1affc6c15dc7fd895">variable_count_hash_fn</a> (const void *vvc, const int flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a> (struct <a class="el" href="structast__str.html">ast_str</a> **out, const char *src, int mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a35b1a18a306de254383a797e1e08bc55">xml_translate</a> (struct <a class="el" href="structast__str.html">ast_str</a> **out, char *in, struct <a class="el" href="structast__variable.html">ast_variable</a> *vars, enum <a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> <a class="el" href="chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert the input into XML or HTML. The input is supposed to be a sequence of lines of the form Name: value optionally followed by a blob of unformatted text. A blank line is a section separator. Basically, this is a mixture of the format of Manager Interface and CLI commands. The unformatted text is considered as a single value of a field named 'Opaque-data'.  <a href="#a35b1a18a306de254383a797e1e08bc55"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <br class="typebreak"/>
<a class="el" href="structast__tcptls__session__args.html">ast_tcptls_session_args</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__tls__config.html">ast_tls_config</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <br class="typebreak"/>
<a class="el" href="structast__tcptls__session__args.html">ast_tcptls_session_args</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_astman_append_buf , .custom_init = NULL , }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5bcf86bb44835a62fce64a0588d567e2">block_sockets</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gacde8c68737c4518caab9fe2769738002">cli_manager</a> []</td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char *&nbsp;&nbsp;&nbsp;<a class="el" href="manager_8c.html#a5faa4602a940792af415e7372e66f86a">words</a> [AST_MAX_CMD_LEN]</td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad9ae9f0fc0cf847818ea0e2b0c985002">command_blacklist</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#ae93b19979f76ef4c841d10b58d24b149">contenttype</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> = 60</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2e585cbfd7440aa94b0eb20ff93f1c3c">manager_event_buf</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_manager_event_buf , .custom_init = NULL , }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__http__uri.html">ast_http_uri</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a7df8bb3a46439212b942a1802e5fa167">manageruri</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__http__uri.html">ast_http_uri</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a2baf609069e59000350384fc6d5e2e48">managerxmluri</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2376c66c8573f83f035c24394e4669dd">mandescr_atxfer</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2a8ff6ebd584dd9f0d552e7368cb7a0a">mandescr_command</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaaa71c1bc183ce0db22f228b4f3811484">mandescr_coresettings</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga505863ddf4757a231cd6ca88eaa258fb">mandescr_coreshowchannels</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga8d9855d70a83ba0db9026e31768c57c9">mandescr_corestatus</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga4c051895e3d550ea63e563746345d6a0">mandescr_createconfig</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad1f9f8ce7c2105ece9722c551fea8334">mandescr_events</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5ad9f64f3fef0f75713081b0e59cbed3">mandescr_extensionstate</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga6cc7441c713beaed63c502b76655cf18">mandescr_getconfig</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga6b15d6c1bbb3c63be292dd5ae020ac2c">mandescr_getconfigjson</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad9f1d2811425781096f2ef3b0f7677e1">mandescr_getvar</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga109ead6c8a438c5af4482c434ec556d1">mandescr_hangup</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaeaa3cb002108eeaf77aa087e368fcebb">mandescr_listcategories</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gabd38e076de1f5515d04af9ed94cf9899">mandescr_listcommands</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga20b9b777c442a640a759fee762e825e5">mandescr_logoff</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga6763d4f89c07763112f53805c79dfbaa">mandescr_mailboxcount</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga8a5c807c1e49261a012741e409fbf1f5">mandescr_mailboxstatus</a> []</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Help text for manager command mailboxstatus.  <a href="group__Group__AMI.html#ga8a5c807c1e49261a012741e409fbf1f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga14d160799265bf19c02ada75b60684dc">mandescr_modulecheck</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga8a0ae4999dc80689744ae856c2af3192">mandescr_moduleload</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga4c3456f071d3e8a6f47c2c2da24ba51d">mandescr_originate</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaf7c8d0005896c4df57ff33edfdcff00a">mandescr_ping</a> []</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manager PING.  <a href="group__Group__AMI.html#gaf7c8d0005896c4df57ff33edfdcff00a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga2463ff1a4e845d70eb98b8d999a95fd5">mandescr_redirect</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gae118a54e809a63562e9beee9246d12c7">mandescr_reload</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga8c84af5770d0abe20291331c8a4f1fdc">mandescr_sendtext</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga074598e3fcf531a758de1451f3be470d">mandescr_setvar</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac00394d3387deda4651dbb7f2f75dd7c">mandescr_status</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac6122a2e7a821bf1076bafb95b7f3099">mandescr_timeout</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga5c943e989aba7fcf95ba9ccf7efc5214">mandescr_updateconfig</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad81f23d6f66693c6d541804bf6db363e">mandescr_userevent</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga7400fb9c266849cfa6e0ef3a11beb27a">mandescr_waitevent</a> []</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manager WAITEVENT.  <a href="group__Group__AMI.html#ga7400fb9c266849cfa6e0ef3a11beb27a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga14cc85c894edb525f4553f47a1060f92">num_sessions</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structpermalias.html">permalias</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gac34fccf799ea11437149bf669762f3da">perms</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__http__uri.html">ast_http_uri</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54">rawmanuri</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gaa1e469ecb509cb8dd2b26bde7dd1e1be">userevent_buf</a> = { .once = PTHREAD_ONCE_INIT , .key_init = __init_userevent_buf , .custom_init = NULL , }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a> = 0</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The Asterisk Management Interface - AMI. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Mark Spencer &lt;<a href="mailto:markster@digium.com">markster@digium.com</a>&gt;</dd></dl>
<dl class="extref"><dt><b><a class="el" href="extref.html#_extref000018">ExtRef:</a></b></dt><dd>OpenSSL <a href="http://www.openssl.org">http://www.openssl.org</a> - for AMI/SSL</dd></dl>
<p>At the moment this file contains a <a class="el" href="structnumber.html" title="Number structure.">number</a> of functions, namely:</p>
<ul>
<li>data structures storing AMI <a class="el" href="structstate.html">state</a></li>
<li>AMI-related API functions, used by internal asterisk components</li>
<li>handlers for AMI-related CLI functions</li>
<li>handlers for AMI functions (available through the AMI socket)</li>
<li>the code for the main AMI listener thread and individual session threads</li>
<li>the http handlers invoked for AMI-over-HTTP by the threads in <a class="el" href="http_8c.html" title="http server for AMI access">main/http.c</a></li>
</ul>
<p><a class="el" href="Config_ami.html#amiconf">manager.conf</a> </p>

<p>Definition in file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a9eeaf526330f14e1906f9e6f2557364b"></a><!-- doxytag: member="manager.c::HSMC_FORMAT" ref="a9eeaf526330f14e1906f9e6f2557364b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HSMC_FORMAT&nbsp;&nbsp;&nbsp;&quot;  %-15.15s  %-15.15s  %-55.55s\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="manager_8c_source.html#l00695">handle_showmancmds()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f17d74ca1307a629a1d6b237ca02c35"></a><!-- doxytag: member="manager.c::HSMCONN_FORMAT1" ref="a4f17d74ca1307a629a1d6b237ca02c35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HSMCONN_FORMAT1&nbsp;&nbsp;&nbsp;&quot;  %-15.15s  %-15.15s  %-10.10s  %-10.10s  %-8.8s  %-8.8s  %-5.5s  %-5.5s\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="manager_8c_source.html#l00723">handle_showmanconn()</a>.</p>

</div>
</div>
<a class="anchor" id="afd6ff00e10a26f619b167194999013b5"></a><!-- doxytag: member="manager.c::HSMCONN_FORMAT2" ref="afd6ff00e10a26f619b167194999013b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HSMCONN_FORMAT2&nbsp;&nbsp;&nbsp;&quot;  %-15.15s  %-15.15s  %-10d  %-10d  %-8d  %-8d  %-5.5d  %-5.5d\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="manager_8c_source.html#l00723">handle_showmanconn()</a>.</p>

</div>
</div>
<a class="anchor" id="a0f30c6e376cc35312886a20eae8cce2a"></a><!-- doxytag: member="manager.c::ROW_FMT" ref="a0f30c6e376cc35312886a20eae8cce2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROW_FMT&nbsp;&nbsp;&nbsp;&quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot; bgcolor=\&quot;#f1f1ff\&quot;&gt;%s&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>.</p>

</div>
</div>
<a class="anchor" id="ae266fd2d3b1b5374127ad824217bb025"></a><!-- doxytag: member="manager.c::TEST_STRING" ref="ae266fd2d3b1b5374127ad824217bb025" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEST_STRING&nbsp;&nbsp;&nbsp;&quot;&lt;form action=\&quot;manager\&quot;&gt;\n\	Action: &lt;select <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;action\&quot;&gt;\n\		&lt;option value=\&quot;\&quot;&gt;-----&amp;gt;&lt;/option&gt;\n\		&lt;option value=\&quot;login\&quot;&gt;login&lt;/option&gt;\n\		&lt;option value=\&quot;command\&quot;&gt;Command&lt;/option&gt;\n\		&lt;option value=\&quot;waitevent\&quot;&gt;waitevent&lt;/option&gt;\n\		&lt;option value=\&quot;listcommands\&quot;&gt;listcommands&lt;/option&gt;\n\	&lt;/select&gt;\n\	or &lt;input <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;action\&quot;&gt;&lt;br/&gt;\n\	CLI Command &lt;input <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;command\&quot;&gt;&lt;br&gt;\n\	<a class="el" href="structuser.html">user</a> &lt;input <a class="el" href="channel_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>=\&quot;username\&quot;&gt; pass &lt;input <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>=\&quot;password\&quot; name=\&quot;secret\&quot;&gt;&lt;br&gt;\n\	&lt;input <a class="el" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>=\&quot;submit\&quot;&gt;\n&lt;/form&gt;\n&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="adab978eb5c8aa199396471558598dc53"></a><!-- doxytag: member="manager.c::output_format" ref="adab978eb5c8aa199396471558598dc53" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>END Doxygen <a class="el" href="structgroup.html">group</a> </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9"></a><!-- doxytag: member="FORMAT_RAW" ref="adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9" args="" -->FORMAT_RAW</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824"></a><!-- doxytag: member="FORMAT_HTML" ref="adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824" args="" -->FORMAT_HTML</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d"></a><!-- doxytag: member="FORMAT_XML" ref="adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d" args="" -->FORMAT_XML</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="manager_8c_source.html#l03483">3483</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03483"></a>03483                    {
<a name="l03484"></a>03484    <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>,
<a name="l03485"></a>03485    <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>,
<a name="l03486"></a>03486    <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>,
<a name="l03487"></a>03487 };
</pre></div></p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a1d18fccb8dd1b468c17c0a89983b7d82"></a><!-- doxytag: member="manager.c::__init_manager" ref="a1d18fccb8dd1b468c17c0a89983b7d82" args="(int reload)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int __init_manager </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reload</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04061">4061</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l02168">action_atxfer()</a>, <a class="el" href="manager_8c_source.html#l01755">action_challenge()</a>, <a class="el" href="manager_8c_source.html#l02258">action_command()</a>, <a class="el" href="manager_8c_source.html#l02709">action_coresettings()</a>, <a class="el" href="manager_8c_source.html#l02814">action_coreshowchannels()</a>, <a class="el" href="manager_8c_source.html#l02755">action_corestatus()</a>, <a class="el" href="manager_8c_source.html#l01565">action_createconfig()</a>, <a class="el" href="manager_8c_source.html#l01715">action_events()</a>, <a class="el" href="manager_8c_source.html#l02590">action_extensionstate()</a>, <a class="el" href="manager_8c_source.html#l01156">action_getconfig()</a>, <a class="el" href="manager_8c_source.html#l01257">action_getconfigjson()</a>, <a class="el" href="manager_8c_source.html#l01847">action_getvar()</a>, <a class="el" href="manager_8c_source.html#l01777">action_hangup()</a>, <a class="el" href="manager_8c_source.html#l01204">action_listcategories()</a>, <a class="el" href="manager_8c_source.html#l01691">action_listcommands()</a>, <a class="el" href="manager_8c_source.html#l01740">action_login()</a>, <a class="el" href="manager_8c_source.html#l01734">action_logoff()</a>, <a class="el" href="manager_8c_source.html#l02558">action_mailboxcount()</a>, <a class="el" href="manager_8c_source.html#l02529">action_mailboxstatus()</a>, <a class="el" href="manager_8c_source.html#l02392">action_originate()</a>, <a class="el" href="manager_8c_source.html#l01137">action_ping()</a>, <a class="el" href="manager_8c_source.html#l02084">action_redirect()</a>, <a class="el" href="manager_8c_source.html#l02794">action_reload()</a>, <a class="el" href="manager_8c_source.html#l02039">action_sendtext()</a>, <a class="el" href="manager_8c_source.html#l01803">action_setvar()</a>, <a class="el" href="manager_8c_source.html#l01904">action_status()</a>, <a class="el" href="manager_8c_source.html#l02621">action_timeout()</a>, <a class="el" href="manager_8c_source.html#l01481">action_updateconfig()</a>, <a class="el" href="manager_8c_source.html#l02684">action_userevent()</a>, <a class="el" href="manager_8c_source.html#l01591">action_waitevent()</a>, <a class="el" href="chan__skinny_8c_source.html#l00981">ahp</a>, <a class="el" href="manager_8c_source.html#l04040">ami_desc</a>, <a class="el" href="manager_8c_source.html#l04039">ami_tls_cfg</a>, <a class="el" href="manager_8c_source.html#l04051">amis_desc</a>, <a class="el" href="manager_8c_source.html#l03273">append_event()</a>, <a class="el" href="isdn__lib_8c_source.html#l00040">ARRAY_LEN</a>, <a class="el" href="acl_8c_source.html#l00272">ast_append_ha()</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="config_8c_source.html#l00613">ast_category_browse()</a>, <a class="el" href="tcptls_8h_source.html#l00067">AST_CERTFILE</a>, <a class="el" href="cli_8c_source.html#l01927">ast_cli_register_multiple()</a>, <a class="el" href="config_8c_source.html#l00827">ast_config_destroy()</a>, <a class="el" href="config_8c_source.html#l02071">ast_config_load2()</a>, <a class="el" href="strings_8h_source.html#l00218">ast_copy_string()</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="pbx_8c_source.html#l03896">ast_extension_state_add()</a>, <a class="el" href="astmm_8h_source.html#l00087">ast_free</a>, <a class="el" href="acl_8c_source.html#l00217">ast_free_ha()</a>, <a class="el" href="utils_8c_source.html#l00182">ast_gethostbyname()</a>, <a class="el" href="http_8c_source.html#l00344">ast_http_uri_link()</a>, <a class="el" href="http_8c_source.html#l00380">ast_http_uri_unlink()</a>, <a class="el" href="linkedlists_8h_source.html#l00715">AST_LIST_INSERT_TAIL</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="manager_8c_source.html#l03448">ast_manager_register2()</a>, <a class="el" href="linkedlists_8h_source.html#l00725">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h_source.html#l00564">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h_source.html#l00541">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00601">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="tcptls_8c_source.html#l00334">ast_ssl_setup()</a>, <a class="el" href="astmm_8h_source.html#l00099">ast_strdup</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="tcptls_8c_source.html#l00432">ast_tcptls_server_start()</a>, <a class="el" href="utils_8c_source.html#l01311">ast_true()</a>, <a class="el" href="config_8c_source.html#l00411">ast_variable_browse()</a>, <a class="el" href="config_8c_source.html#l00435">ast_variable_retrieve()</a>, <a class="el" href="tcptls_8h_source.html#l00080">ast_tls_config::certfile</a>, <a class="el" href="tcptls_8h_source.html#l00081">ast_tls_config::cipher</a>, <a class="el" href="manager_8c_source.html#l00803">cli_manager</a>, <a class="el" href="config_8h_source.html#l00043">CONFIG_FLAG_FILEUNCHANGED</a>, <a class="el" href="app__rpt_8c_source.html#l00368">config_flags</a>, <a class="el" href="config_8h_source.html#l00050">CONFIG_STATUS_FILEINVALID</a>, <a class="el" href="config_8h_source.html#l00049">CONFIG_STATUS_FILEUNCHANGED</a>, <a class="el" href="manager_8h_source.html#l00057">DEFAULT_MANAGER_PORT</a>, <a class="el" href="manager_8c_source.html#l00241">ast_manager_user::displayconnects</a>, <a class="el" href="tcptls_8h_source.html#l00079">ast_tls_config::enabled</a>, <a class="el" href="manager_8h_source.html#l00062">EVENT_FLAG_CALL</a>, <a class="el" href="manager_8h_source.html#l00065">EVENT_FLAG_COMMAND</a>, <a class="el" href="manager_8h_source.html#l00068">EVENT_FLAG_CONFIG</a>, <a class="el" href="manager_8h_source.html#l00073">EVENT_FLAG_ORIGINATE</a>, <a class="el" href="manager_8h_source.html#l00070">EVENT_FLAG_REPORTING</a>, <a class="el" href="manager_8h_source.html#l00061">EVENT_FLAG_SYSTEM</a>, <a class="el" href="manager_8h_source.html#l00067">EVENT_FLAG_USER</a>, <a class="el" href="manager_8c_source.html#l00491">get_manager_by_name_locked()</a>, <a class="el" href="manager_8c_source.html#l00430">get_perm()</a>, <a class="el" href="manager_8c_source.html#l00237">ast_manager_user::ha</a>, <a class="el" href="chan__skinny_8c_source.html#l00982">hp</a>, <a class="el" href="manager_8c_source.html#l00242">ast_manager_user::keep</a>, <a class="el" href="config_8h_source.html#l00081">ast_variable::lineno</a>, <a class="el" href="tcptls_8h_source.html#l00116">ast_tcptls_session_args::local_address</a>, <a class="el" href="logger_8h_source.html#l00141">LOG_NOTICE</a>, <a class="el" href="logger_8h_source.html#l00152">LOG_WARNING</a>, <a class="el" href="manager_8h_source.html#l00181">manager_event</a>, <a class="el" href="manager_8c_source.html#l02885">manager_modulecheck()</a>, <a class="el" href="manager_8c_source.html#l02938">manager_moduleload()</a>, <a class="el" href="manager_8c_source.html#l03402">manager_state_cb()</a>, <a class="el" href="manager_8c_source.html#l04009">manageruri</a>, <a class="el" href="manager_8c_source.html#l04018">managerxmluri</a>, <a class="el" href="manager_8c_source.html#l02159">mandescr_atxfer</a>, <a class="el" href="manager_8c_source.html#l02251">mandescr_command</a>, <a class="el" href="manager_8c_source.html#l02703">mandescr_coresettings</a>, <a class="el" href="manager_8c_source.html#l02806">mandescr_coreshowchannels</a>, <a class="el" href="manager_8c_source.html#l02749">mandescr_corestatus</a>, <a class="el" href="manager_8c_source.html#l01558">mandescr_createconfig</a>, <a class="el" href="manager_8c_source.html#l01707">mandescr_events</a>, <a class="el" href="manager_8c_source.html#l02579">mandescr_extensionstate</a>, <a class="el" href="manager_8c_source.html#l01149">mandescr_getconfig</a>, <a class="el" href="manager_8c_source.html#l01250">mandescr_getconfigjson</a>, <a class="el" href="manager_8c_source.html#l01840">mandescr_getvar</a>, <a class="el" href="manager_8c_source.html#l01772">mandescr_hangup</a>, <a class="el" href="manager_8c_source.html#l01198">mandescr_listcategories</a>, <a class="el" href="manager_8c_source.html#l01685">mandescr_listcommands</a>, <a class="el" href="manager_8c_source.html#l01730">mandescr_logoff</a>, <a class="el" href="manager_8c_source.html#l02546">mandescr_mailboxcount</a>, <a class="el" href="manager_8c_source.html#l02518">mandescr_mailboxstatus</a>, <a class="el" href="manager_8c_source.html#l02875">mandescr_modulecheck</a>, <a class="el" href="manager_8c_source.html#l02927">mandescr_moduleload</a>, <a class="el" href="manager_8c_source.html#l02376">mandescr_originate</a>, <a class="el" href="manager_8c_source.html#l01132">mandescr_ping</a>, <a class="el" href="manager_8c_source.html#l02073">mandescr_redirect</a>, <a class="el" href="manager_8c_source.html#l02787">mandescr_reload</a>, <a class="el" href="manager_8c_source.html#l02032">mandescr_sendtext</a>, <a class="el" href="manager_8c_source.html#l01796">mandescr_setvar</a>, <a class="el" href="manager_8c_source.html#l01892">mandescr_status</a>, <a class="el" href="manager_8c_source.html#l02614">mandescr_timeout</a>, <a class="el" href="manager_8c_source.html#l01467">mandescr_updateconfig</a>, <a class="el" href="manager_8c_source.html#l02677">mandescr_userevent</a>, <a class="el" href="manager_8c_source.html#l01584">mandescr_waitevent</a>, <a class="el" href="config_8h_source.html#l00075">ast_variable::name</a>, <a class="el" href="config_8h_source.html#l00077">ast_variable::next</a>, <a class="el" href="manager_8c_source.html#l04000">rawmanuri</a>, <a class="el" href="manager_8c_source.html#l00238">ast_manager_user::readperm</a>, <a class="el" href="manager_8c_source.html#l04027">registered</a>, <a class="el" href="manager_8c_source.html#l00236">ast_manager_user::secret</a>, <a class="el" href="tcptls_8h_source.html#l00120">ast_tcptls_session_args::tls_cfg</a>, <a class="el" href="manager_8c_source.html#l00235">ast_manager_user::username</a>, <a class="el" href="config_8h_source.html#l00076">ast_variable::value</a>, <a class="el" href="ast__expr2f_8c_source.html#l00613">var</a>, <a class="el" href="manager_8c_source.html#l04028">webregged</a>, <a class="el" href="manager_8c_source.html#l00239">ast_manager_user::writeperm</a>, and <a class="el" href="manager_8c_source.html#l00240">ast_manager_user::writetimeout</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04376">init_manager()</a>, and <a class="el" href="manager_8c_source.html#l04381">reload_manager()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04062"></a>04062 {
<a name="l04063"></a>04063    <span class="keyword">struct </span><a class="code" href="structast__config.html">ast_config</a> *ucfg = NULL, *cfg = NULL;
<a name="l04064"></a>04064    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structval.html">val</a>;
<a name="l04065"></a>04065    <span class="keywordtype">char</span> *cat = NULL;
<a name="l04066"></a>04066    <span class="keywordtype">int</span> newhttptimeout = 60;
<a name="l04067"></a>04067    <span class="keywordtype">int</span> have_sslbindaddr = 0;
<a name="l04068"></a>04068    <span class="keyword">struct </span>hostent *<a class="code" href="chan__skinny_8c.html#aa0f575fa3882aa394cc287edba645a35">hp</a>;
<a name="l04069"></a>04069    <span class="keyword">struct </span><a class="code" href="structast__hostent.html">ast_hostent</a> <a class="code" href="chan__skinny_8c.html#a9e435aef83f14da6d3d5ec44f821558e">ahp</a>;
<a name="l04070"></a>04070    <span class="keyword">struct </span><a class="code" href="structast__manager__user.html" title="user descriptor, as read from the config file.">ast_manager_user</a> *<a class="code" href="structuser.html" title="structure to hold users read from users.conf">user</a> = NULL;
<a name="l04071"></a>04071    <span class="keyword">struct </span><a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *<a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;
<a name="l04072"></a>04072    <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> <a class="code" href="app__rpt_8c.html#a1f57f20c1f46890828791a4827fe8752">config_flags</a> = { <a class="code" href="app__amd_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> ? <a class="code" href="config_8h.html#a2d5492e116eebd5075f247d21fb9db26afa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };
<a name="l04073"></a>04073 
<a name="l04074"></a>04074    <a class="code" href="group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> = 0;
<a name="l04075"></a>04075 
<a name="l04076"></a>04076    <span class="keywordflow">if</span> (!<a class="code" href="manager_8c.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a>) {
<a name="l04077"></a>04077       <span class="comment">/* Register default actions */</span>
<a name="l04078"></a>04078       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Ping&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#gaea3a1b38ba96480a2f09d7109a69b0fd">action_ping</a>, <span class="stringliteral">&quot;Keepalive command&quot;</span>, <a class="code" href="group__Group__AMI.html#gaf7c8d0005896c4df57ff33edfdcff00a" title="Manager PING.">mandescr_ping</a>);
<a name="l04079"></a>04079       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Events&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#ga954eccb4f48bd6797ba65a9cada6446a">action_events</a>, <span class="stringliteral">&quot;Control Event Flow&quot;</span>, <a class="code" href="group__Group__AMI.html#gad1f9f8ce7c2105ece9722c551fea8334">mandescr_events</a>);
<a name="l04080"></a>04080       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Logoff&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#ga70e9f0abcbf6c0aca44ad6e3f941c266">action_logoff</a>, <span class="stringliteral">&quot;Logoff Manager&quot;</span>, <a class="code" href="group__Group__AMI.html#ga20b9b777c442a640a759fee762e825e5">mandescr_logoff</a>);
<a name="l04081"></a>04081       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Login&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#ga446d7b8021ecd45234cd3053734c9d53">action_login</a>, <span class="stringliteral">&quot;Login Manager&quot;</span>, NULL);
<a name="l04082"></a>04082       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Challenge&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#gade12539a3e517752ad60fef428394532">action_challenge</a>, <span class="stringliteral">&quot;Generate Challenge for MD5 Auth&quot;</span>, NULL);
<a name="l04083"></a>04083       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Hangup&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga2b80579f3d94f43d2e7def7add35dc61">action_hangup</a>, <span class="stringliteral">&quot;Hangup Channel&quot;</span>, <a class="code" href="group__Group__AMI.html#ga109ead6c8a438c5af4482c434ec556d1">mandescr_hangup</a>);
<a name="l04084"></a>04084       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Status&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584" title="Manager &amp;quot;status&amp;quot; command to show channels.">action_status</a>, <span class="stringliteral">&quot;Lists channel status&quot;</span>, <a class="code" href="group__Group__AMI.html#gac00394d3387deda4651dbb7f2f75dd7c">mandescr_status</a>);
<a name="l04085"></a>04085       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Setvar&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga0063f7b7d4976f533e64e98503e535aa">action_setvar</a>, <span class="stringliteral">&quot;Set Channel Variable&quot;</span>, <a class="code" href="group__Group__AMI.html#ga074598e3fcf531a758de1451f3be470d">mandescr_setvar</a>);
<a name="l04086"></a>04086       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Getvar&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#ga46026a8e1dfda56ac9dc23cd31515def">action_getvar</a>, <span class="stringliteral">&quot;Gets a Channel Variable&quot;</span>, <a class="code" href="group__Group__AMI.html#gad9f1d2811425781096f2ef3b0f7677e1">mandescr_getvar</a>);
<a name="l04087"></a>04087       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;GetConfig&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#ga607030674dbfc12f62148d375b4e320f">action_getconfig</a>, <span class="stringliteral">&quot;Retrieve configuration&quot;</span>, <a class="code" href="group__Group__AMI.html#ga6cc7441c713beaed63c502b76655cf18">mandescr_getconfig</a>);
<a name="l04088"></a>04088       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;GetConfigJSON&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#ga22cac49ed9e48c4bed52477e6334278e">action_getconfigjson</a>, <span class="stringliteral">&quot;Retrieve configuration (JSON format)&quot;</span>, <a class="code" href="group__Group__AMI.html#ga6b15d6c1bbb3c63be292dd5ae020ac2c">mandescr_getconfigjson</a>);
<a name="l04089"></a>04089       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;UpdateConfig&quot;</span>, <a class="code" href="manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#ga722b7d69a94cb2ececdb88bf67f80667">action_updateconfig</a>, <span class="stringliteral">&quot;Update basic configuration&quot;</span>, <a class="code" href="group__Group__AMI.html#ga5c943e989aba7fcf95ba9ccf7efc5214">mandescr_updateconfig</a>);
<a name="l04090"></a>04090       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;CreateConfig&quot;</span>, <a class="code" href="manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#ga03aa8a5224eadc07dddc34751e1868d0">action_createconfig</a>, <span class="stringliteral">&quot;Creates an empty file in the configuration directory&quot;</span>, <a class="code" href="group__Group__AMI.html#ga4c051895e3d550ea63e563746345d6a0">mandescr_createconfig</a>);
<a name="l04091"></a>04091       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;ListCategories&quot;</span>, <a class="code" href="manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#ga28572e9c3a5f7c565f68eae095454d3c">action_listcategories</a>, <span class="stringliteral">&quot;List categories in configuration file&quot;</span>, <a class="code" href="group__Group__AMI.html#gaeaa3cb002108eeaf77aa087e368fcebb">mandescr_listcategories</a>);
<a name="l04092"></a>04092       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Redirect&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac" title="action_redirect: The redirect manager command">action_redirect</a>, <span class="stringliteral">&quot;Redirect (transfer) a call&quot;</span>, <a class="code" href="group__Group__AMI.html#ga2463ff1a4e845d70eb98b8d999a95fd5">mandescr_redirect</a> );
<a name="l04093"></a>04093       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Atxfer&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga2dfc6e6a7c0200c34dbbc6021f10c649">action_atxfer</a>, <span class="stringliteral">&quot;Attended transfer&quot;</span>, <a class="code" href="group__Group__AMI.html#ga2376c66c8573f83f035c24394e4669dd">mandescr_atxfer</a>);
<a name="l04094"></a>04094       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Originate&quot;</span>, <a class="code" href="manager_8h.html#ad6acb19e6de27692675f1706d390f548">EVENT_FLAG_ORIGINATE</a>, <a class="code" href="group__Group__AMI.html#gaa72169a44884720d85770602ffe6cdb5">action_originate</a>, <span class="stringliteral">&quot;Originate Call&quot;</span>, <a class="code" href="group__Group__AMI.html#ga4c3456f071d3e8a6f47c2c2da24ba51d">mandescr_originate</a>);
<a name="l04095"></a>04095       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Command&quot;</span>, <a class="code" href="manager_8h.html#ab9bbbe9b1fbde6ccff1f0a1ec0521afd">EVENT_FLAG_COMMAND</a>, <a class="code" href="group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74" title="Manager command &amp;quot;command&amp;quot; - execute CLI command.">action_command</a>, <span class="stringliteral">&quot;Execute Asterisk CLI Command&quot;</span>, <a class="code" href="group__Group__AMI.html#ga2a8ff6ebd584dd9f0d552e7368cb7a0a">mandescr_command</a> );
<a name="l04096"></a>04096       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;ExtensionState&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#ga5f3b2b093b498ed27078743ec10c05b7">action_extensionstate</a>, <span class="stringliteral">&quot;Check Extension Status&quot;</span>, <a class="code" href="group__Group__AMI.html#ga5ad9f64f3fef0f75713081b0e59cbed3">mandescr_extensionstate</a> );
<a name="l04097"></a>04097       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;AbsoluteTimeout&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga2ec80a6f9d335e9240ce5cc6ab49221b">action_timeout</a>, <span class="stringliteral">&quot;Set Absolute Timeout&quot;</span>, <a class="code" href="group__Group__AMI.html#gac6122a2e7a821bf1076bafb95b7f3099">mandescr_timeout</a> );
<a name="l04098"></a>04098       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;MailboxStatus&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#ga41ec46957049f65f0409d8d92f21b428">action_mailboxstatus</a>, <span class="stringliteral">&quot;Check Mailbox&quot;</span>, <a class="code" href="group__Group__AMI.html#ga8a5c807c1e49261a012741e409fbf1f5" title="Help text for manager command mailboxstatus.">mandescr_mailboxstatus</a> );
<a name="l04099"></a>04099       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;MailboxCount&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#ga1e0bee965191aad897199382d0f36aba">action_mailboxcount</a>, <span class="stringliteral">&quot;Check Mailbox Message Count&quot;</span>, <a class="code" href="group__Group__AMI.html#ga6763d4f89c07763112f53805c79dfbaa">mandescr_mailboxcount</a> );
<a name="l04100"></a>04100       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;ListCommands&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#ga2cf03665d072e22c68953f8dadc65690">action_listcommands</a>, <span class="stringliteral">&quot;List available manager commands&quot;</span>, <a class="code" href="group__Group__AMI.html#gabd38e076de1f5515d04af9ed94cf9899">mandescr_listcommands</a>);
<a name="l04101"></a>04101       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;SendText&quot;</span>, <a class="code" href="manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga1c6842f7ec1925c46db96beaaf8d24b1">action_sendtext</a>, <span class="stringliteral">&quot;Send text message to channel&quot;</span>, <a class="code" href="group__Group__AMI.html#ga8c84af5770d0abe20291331c8a4f1fdc">mandescr_sendtext</a>);
<a name="l04102"></a>04102       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;UserEvent&quot;</span>, <a class="code" href="manager_8h.html#acc12c2bc03dce67ddd1590d67ab11f4d">EVENT_FLAG_USER</a>, <a class="code" href="group__Group__AMI.html#gaa837605a5558f94ae96ed1b881aa75e7">action_userevent</a>, <span class="stringliteral">&quot;Send an arbitrary event&quot;</span>, <a class="code" href="group__Group__AMI.html#gad81f23d6f66693c6d541804bf6db363e">mandescr_userevent</a>);
<a name="l04103"></a>04103       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;WaitEvent&quot;</span>, 0, <a class="code" href="group__Group__AMI.html#gadf9acbde2aab503926610acb110634d6">action_waitevent</a>, <span class="stringliteral">&quot;Wait for an event to occur&quot;</span>, <a class="code" href="group__Group__AMI.html#ga7400fb9c266849cfa6e0ef3a11beb27a" title="Manager WAITEVENT.">mandescr_waitevent</a>);
<a name="l04104"></a>04104       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;CoreSettings&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05" title="Show PBX core settings information.">action_coresettings</a>, <span class="stringliteral">&quot;Show PBX core settings (version etc)&quot;</span>, <a class="code" href="group__Group__AMI.html#gaaa71c1bc183ce0db22f228b4f3811484">mandescr_coresettings</a>);
<a name="l04105"></a>04105       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;CoreStatus&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30" title="Show PBX core status information.">action_corestatus</a>, <span class="stringliteral">&quot;Show PBX core status variables&quot;</span>, <a class="code" href="group__Group__AMI.html#ga8d9855d70a83ba0db9026e31768c57c9">mandescr_corestatus</a>);
<a name="l04106"></a>04106       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;Reload&quot;</span>, <a class="code" href="manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a> | <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb" title="Send a reload event.">action_reload</a>, <span class="stringliteral">&quot;Send a reload event&quot;</span>, <a class="code" href="group__Group__AMI.html#gae118a54e809a63562e9beee9246d12c7">mandescr_reload</a>);
<a name="l04107"></a>04107       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;CoreShowChannels&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930" title="Manager command &amp;quot;CoreShowChannels&amp;quot; - List currently defined channels and...">action_coreshowchannels</a>, <span class="stringliteral">&quot;List currently active channels&quot;</span>, <a class="code" href="group__Group__AMI.html#ga505863ddf4757a231cd6ca88eaa258fb">mandescr_coreshowchannels</a>);
<a name="l04108"></a>04108       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;ModuleLoad&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="group__Group__AMI.html#ga7c11fab0bce951155235b8e7a2013e1d">manager_moduleload</a>, <span class="stringliteral">&quot;Module management&quot;</span>, <a class="code" href="group__Group__AMI.html#ga8a0ae4999dc80689744ae856c2af3192">mandescr_moduleload</a>);
<a name="l04109"></a>04109       <a class="code" href="group__Group__AMI.html#ga332bf7ef48f67d63d849dd9febb18fb2" title="Register a manager command with the manager interface.">ast_manager_register2</a>(<span class="stringliteral">&quot;ModuleCheck&quot;</span>, <a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="group__Group__AMI.html#gac730b751a77b99e3dd3eb4b1880ba933">manager_modulecheck</a>, <span class="stringliteral">&quot;Check if module is loaded&quot;</span>, <a class="code" href="group__Group__AMI.html#ga14d160799265bf19c02ada75b60684dc">mandescr_modulecheck</a>);
<a name="l04110"></a>04110 
<a name="l04111"></a>04111       <a class="code" href="cli_8h.html#aadeef34f3106bb78aeb3414032ad7fb7" title="Register multiple commands.">ast_cli_register_multiple</a>(<a class="code" href="group__Group__AMI.html#gacde8c68737c4518caab9fe2769738002">cli_manager</a>, <a class="code" href="isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="group__Group__AMI.html#gacde8c68737c4518caab9fe2769738002">cli_manager</a>));
<a name="l04112"></a>04112       <a class="code" href="pbx_8h.html#aa3a30d0a841ee2bc0d87af763a99629f" title="Registers a state change callback.">ast_extension_state_add</a>(NULL, NULL, <a class="code" href="group__Group__AMI.html#ga965e7cfa847a7dab9eac56d05d8ec8e7">manager_state_cb</a>, NULL);
<a name="l04113"></a>04113       <a class="code" href="manager_8c.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a> = 1;
<a name="l04114"></a>04114       <span class="comment">/* Append placeholder event so master_eventq never runs dry */</span>
<a name="l04115"></a>04115       <a class="code" href="group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1">append_event</a>(<span class="stringliteral">&quot;Event: Placeholder\r\n\r\n&quot;</span>, 0);
<a name="l04116"></a>04116    }
<a name="l04117"></a>04117    <span class="keywordflow">if</span> ((cfg = <a class="code" href="config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9" title="Load a config file.">ast_config_load2</a>(<span class="stringliteral">&quot;manager.conf&quot;</span>, <span class="stringliteral">&quot;manager&quot;</span>, config_flags)) == <a class="code" href="config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>)
<a name="l04118"></a>04118       <span class="keywordflow">return</span> 0;
<a name="l04119"></a>04119 
<a name="l04120"></a>04120    <a class="code" href="group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = 1;
<a name="l04121"></a>04121    <span class="keywordflow">if</span> (!cfg || cfg == <a class="code" href="config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {
<a name="l04122"></a>04122       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Unable to open AMI configuration manager.conf, or configuration is invalid. Asterisk management interface (AMI) disabled.\n&quot;</span>);
<a name="l04123"></a>04123       <span class="keywordflow">return</span> 0;
<a name="l04124"></a>04124    }
<a name="l04125"></a>04125 
<a name="l04126"></a>04126    <span class="comment">/* default values */</span>
<a name="l04127"></a>04127    memset(&amp;<a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));
<a name="l04128"></a>04128    memset(&amp;<a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>));
<a name="l04129"></a>04129    <a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_port = htons(5039);
<a name="l04130"></a>04130    <a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_port = htons(<a class="code" href="manager_8h.html#a9aeced7f8d9056c4ec2663f1ad10a4a4">DEFAULT_MANAGER_PORT</a>);
<a name="l04131"></a>04131 
<a name="l04132"></a>04132    <a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a> = 0;
<a name="l04133"></a>04133    <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a>)
<a name="l04134"></a>04134       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a>);
<a name="l04135"></a>04135    <a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<a class="code" href="tcptls_8h.html#a1850a109f5255895d75980912723ae7c">AST_CERTFILE</a>);
<a name="l04136"></a>04136    <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a>)
<a name="l04137"></a>04137       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a>);
<a name="l04138"></a>04138    <a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l04139"></a>04139 
<a name="l04140"></a>04140    <span class="keywordflow">for</span> (var = <a class="code" href="config_8h.html#a935ccfa153100ddd320c8918bd6e941b" title="Goes through variables Somewhat similar in intent as the ast_category_browse. List...">ast_variable_browse</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>); var; var = var-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l04141"></a>04141       val = var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;
<a name="l04142"></a>04142       <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sslenable&quot;</span>))
<a name="l04143"></a>04143          <a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04144"></a>04144       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sslbindport&quot;</span>))
<a name="l04145"></a>04145          <a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_port = htons(atoi(val));
<a name="l04146"></a>04146       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sslbindaddr&quot;</span>)) {
<a name="l04147"></a>04147          <span class="keywordflow">if</span> ((hp = <a class="code" href="utils_8h.html#ad3b63ee1041593219ef0765b28d70442" title="Thread-safe gethostbyname function to use in Asterisk.">ast_gethostbyname</a>(val, &amp;<a class="code" href="chan__skinny_8c.html#a9e435aef83f14da6d3d5ec44f821558e">ahp</a>))) {
<a name="l04148"></a>04148             memcpy(&amp;<a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr, hp-&gt;h_addr, <span class="keyword">sizeof</span>(<a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr));
<a name="l04149"></a>04149             have_sslbindaddr = 1;
<a name="l04150"></a>04150          } <span class="keywordflow">else</span> {
<a name="l04151"></a>04151             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid bind address &apos;%s&apos;\n&quot;</span>, val);
<a name="l04152"></a>04152          }
<a name="l04153"></a>04153       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sslcert&quot;</span>)) {
<a name="l04154"></a>04154          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a>);
<a name="l04155"></a>04155          <a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(val);
<a name="l04156"></a>04156       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sslcipher&quot;</span>)) {
<a name="l04157"></a>04157          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a>);
<a name="l04158"></a>04158          <a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(val);
<a name="l04159"></a>04159       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;enabled&quot;</span>)) {
<a name="l04160"></a>04160          <a class="code" href="group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04161"></a>04161       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;block-sockets&quot;</span>)) {
<a name="l04162"></a>04162          <a class="code" href="group__Group__AMI.html#ga5bcf86bb44835a62fce64a0588d567e2">block_sockets</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04163"></a>04163       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;webenabled&quot;</span>)) {
<a name="l04164"></a>04164          <a class="code" href="group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04165"></a>04165       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;port&quot;</span>)) {
<a name="l04166"></a>04166          <a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_port = htons(atoi(val));
<a name="l04167"></a>04167       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;bindaddr&quot;</span>)) {
<a name="l04168"></a>04168          <span class="keywordflow">if</span> (!inet_aton(val, &amp;<a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr)) {
<a name="l04169"></a>04169             <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid address &apos;%s&apos; specified, using 0.0.0.0\n&quot;</span>, val);
<a name="l04170"></a>04170             memset(&amp;<a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr, 0, <span class="keyword">sizeof</span>(<a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr));
<a name="l04171"></a>04171          }
<a name="l04172"></a>04172       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;allowmultiplelogin&quot;</span>)) { 
<a name="l04173"></a>04173          <a class="code" href="group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04174"></a>04174       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;displayconnects&quot;</span>)) {
<a name="l04175"></a>04175          <a class="code" href="group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04176"></a>04176       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;timestampevents&quot;</span>)) {
<a name="l04177"></a>04177          <a class="code" href="group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04178"></a>04178       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;debug&quot;</span>)) {
<a name="l04179"></a>04179          <a class="code" href="group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(val);
<a name="l04180"></a>04180       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;httptimeout&quot;</span>)) {
<a name="l04181"></a>04181          newhttptimeout = atoi(val);
<a name="l04182"></a>04182       } <span class="keywordflow">else</span> {
<a name="l04183"></a>04183          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Invalid keyword &lt;%s&gt; = &lt;%s&gt; in manager.conf [general]\n&quot;</span>,
<a name="l04184"></a>04184             var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, val);
<a name="l04185"></a>04185       }  
<a name="l04186"></a>04186    }
<a name="l04187"></a>04187 
<a name="l04188"></a>04188    <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>)
<a name="l04189"></a>04189       <a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_family = AF_INET;
<a name="l04190"></a>04190    <span class="keywordflow">if</span> (!have_sslbindaddr)
<a name="l04191"></a>04191       <a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr = <a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_addr;
<a name="l04192"></a>04192    <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>)
<a name="l04193"></a>04193       <a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#a38212d367966159801236cfb1b78b1b1">local_address</a>.sin_family = AF_INET;
<a name="l04194"></a>04194 
<a name="l04195"></a>04195    
<a name="l04196"></a>04196    <a class="code" href="linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595" title="Write locks a list.">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="structusers.html" title="list of users found in the config file">users</a>);
<a name="l04197"></a>04197 
<a name="l04198"></a>04198    <span class="comment">/* First, get users from users.conf */</span>
<a name="l04199"></a>04199    ucfg = <a class="code" href="config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9" title="Load a config file.">ast_config_load2</a>(<span class="stringliteral">&quot;users.conf&quot;</span>, <span class="stringliteral">&quot;manager&quot;</span>, config_flags);
<a name="l04200"></a>04200    <span class="keywordflow">if</span> (ucfg &amp;&amp; (ucfg != <a class="code" href="config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) &amp;&amp; ucfg != <a class="code" href="config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {
<a name="l04201"></a>04201       <span class="keyword">const</span> <span class="keywordtype">char</span> *hasmanager;
<a name="l04202"></a>04202       <span class="keywordtype">int</span> genhasmanager = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(<a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;hasmanager&quot;</span>));
<a name="l04203"></a>04203 
<a name="l04204"></a>04204       <span class="keywordflow">while</span> ((cat = <a class="code" href="config_8h.html#a611776300f941a63266cb220ac62b4db" title="Goes through categories.">ast_category_browse</a>(ucfg, cat))) {
<a name="l04205"></a>04205          <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>))
<a name="l04206"></a>04206             <span class="keywordflow">continue</span>;
<a name="l04207"></a>04207          
<a name="l04208"></a>04208          hasmanager = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;hasmanager&quot;</span>);
<a name="l04209"></a>04209          <span class="keywordflow">if</span> ((!hasmanager &amp;&amp; genhasmanager) || <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(hasmanager)) {
<a name="l04210"></a>04210             <span class="keyword">const</span> <span class="keywordtype">char</span> *user_secret = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;secret&quot;</span>);
<a name="l04211"></a>04211             <span class="keyword">const</span> <span class="keywordtype">char</span> *user_read = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;read&quot;</span>);
<a name="l04212"></a>04212             <span class="keyword">const</span> <span class="keywordtype">char</span> *user_write = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;write&quot;</span>);
<a name="l04213"></a>04213             <span class="keyword">const</span> <span class="keywordtype">char</span> *user_displayconnects = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;displayconnects&quot;</span>);
<a name="l04214"></a>04214             <span class="keyword">const</span> <span class="keywordtype">char</span> *user_writetimeout = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;writetimeout&quot;</span>);
<a name="l04215"></a>04215             
<a name="l04216"></a>04216             <span class="comment">/* Look for an existing entry,</span>
<a name="l04217"></a>04217 <span class="comment">             * if none found - create one and add it to the list</span>
<a name="l04218"></a>04218 <span class="comment">             */</span>
<a name="l04219"></a>04219             <span class="keywordflow">if</span> (!(user = <a class="code" href="group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(cat))) {
<a name="l04220"></a>04220                <span class="keywordflow">if</span> (!(user = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*user))))
<a name="l04221"></a>04221                   <span class="keywordflow">break</span>;
<a name="l04222"></a>04222 
<a name="l04223"></a>04223                <span class="comment">/* Copy name over */</span>
<a name="l04224"></a>04224                <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(user-&gt;<a class="code" href="structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, cat, <span class="keyword">sizeof</span>(user-&gt;<a class="code" href="structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>));
<a name="l04225"></a>04225                <span class="comment">/* Insert into list */</span>
<a name="l04226"></a>04226                <a class="code" href="linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960" title="Appends a list entry to the tail of a list.">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="structusers.html" title="list of users found in the config file">users</a>, user, list);
<a name="l04227"></a>04227                user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a> = NULL;
<a name="l04228"></a>04228                user-&gt;<a class="code" href="structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 1;
<a name="l04229"></a>04229                user-&gt;<a class="code" href="structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = -1;
<a name="l04230"></a>04230                user-&gt;<a class="code" href="structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = -1;
<a name="l04231"></a>04231                <span class="comment">/* Default displayconnect from [general] */</span>
<a name="l04232"></a>04232                user-&gt;<a class="code" href="structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;
<a name="l04233"></a>04233                user-&gt;<a class="code" href="structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = 100;
<a name="l04234"></a>04234             }
<a name="l04235"></a>04235 
<a name="l04236"></a>04236             <span class="keywordflow">if</span> (!user_secret)
<a name="l04237"></a>04237                user_secret = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;secret&quot;</span>);
<a name="l04238"></a>04238             <span class="keywordflow">if</span> (!user_read)
<a name="l04239"></a>04239                user_read = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;read&quot;</span>);
<a name="l04240"></a>04240             <span class="keywordflow">if</span> (!user_write)
<a name="l04241"></a>04241                user_write = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;write&quot;</span>);
<a name="l04242"></a>04242             <span class="keywordflow">if</span> (!user_displayconnects)
<a name="l04243"></a>04243                user_displayconnects = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;displayconnects&quot;</span>);
<a name="l04244"></a>04244             <span class="keywordflow">if</span> (!user_writetimeout)
<a name="l04245"></a>04245                user_writetimeout = <a class="code" href="config_8h.html#ab87fa38c79226e5a0105ad9d2e2e9ae5" title="Gets a variable.">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;writetimeout&quot;</span>);
<a name="l04246"></a>04246 
<a name="l04247"></a>04247             <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(user_secret)) {
<a name="l04248"></a>04248                <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>)
<a name="l04249"></a>04249                   <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);
<a name="l04250"></a>04250                user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(user_secret);
<a name="l04251"></a>04251             }
<a name="l04252"></a>04252 
<a name="l04253"></a>04253             <span class="keywordflow">if</span> (user_read)
<a name="l04254"></a>04254                user-&gt;<a class="code" href="structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = <a class="code" href="group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(user_read);
<a name="l04255"></a>04255             <span class="keywordflow">if</span> (user_write)
<a name="l04256"></a>04256                user-&gt;<a class="code" href="structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = <a class="code" href="group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(user_write);
<a name="l04257"></a>04257             <span class="keywordflow">if</span> (user_displayconnects)
<a name="l04258"></a>04258                user-&gt;<a class="code" href="structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(user_displayconnects);
<a name="l04259"></a>04259 
<a name="l04260"></a>04260             <span class="keywordflow">if</span> (user_writetimeout) {
<a name="l04261"></a>04261                <span class="keywordtype">int</span> value = atoi(user_writetimeout);
<a name="l04262"></a>04262                <span class="keywordflow">if</span> (value &lt; 100)
<a name="l04263"></a>04263                   <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid writetimeout value &apos;%s&apos; at users.conf line %d\n&quot;</span>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, var-&gt;<a class="code" href="structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);
<a name="l04264"></a>04264                <span class="keywordflow">else</span>
<a name="l04265"></a>04265                   user-&gt;<a class="code" href="structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = value;
<a name="l04266"></a>04266             }
<a name="l04267"></a>04267          }
<a name="l04268"></a>04268       }
<a name="l04269"></a>04269       <a class="code" href="config_8h.html#a710f0b2a897849572b77dd0854b8dc03" title="Destroys a config.">ast_config_destroy</a>(ucfg);
<a name="l04270"></a>04270    }
<a name="l04271"></a>04271 
<a name="l04272"></a>04272    <span class="comment">/* cat is NULL here in any case */</span>
<a name="l04273"></a>04273 
<a name="l04274"></a>04274    <span class="keywordflow">while</span> ((cat = <a class="code" href="config_8h.html#a611776300f941a63266cb220ac62b4db" title="Goes through categories.">ast_category_browse</a>(cfg, cat))) {
<a name="l04275"></a>04275       <span class="keyword">struct </span><a class="code" href="structast__ha.html" title="internal representation of acl entries In principle user applications would have...">ast_ha</a> *oldha;
<a name="l04276"></a>04276 
<a name="l04277"></a>04277       <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>))
<a name="l04278"></a>04278          <span class="keywordflow">continue</span>;
<a name="l04279"></a>04279 
<a name="l04280"></a>04280       <span class="comment">/* Look for an existing entry, if none found - create one and add it to the list */</span>
<a name="l04281"></a>04281       <span class="keywordflow">if</span> (!(user = <a class="code" href="group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(cat))) {
<a name="l04282"></a>04282          <span class="keywordflow">if</span> (!(user = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*user))))
<a name="l04283"></a>04283             <span class="keywordflow">break</span>;
<a name="l04284"></a>04284          <span class="comment">/* Copy name over */</span>
<a name="l04285"></a>04285          <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(user-&gt;<a class="code" href="structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, cat, <span class="keyword">sizeof</span>(user-&gt;<a class="code" href="structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>));
<a name="l04286"></a>04286 
<a name="l04287"></a>04287          user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a> = NULL;
<a name="l04288"></a>04288          user-&gt;<a class="code" href="structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = 0;
<a name="l04289"></a>04289          user-&gt;<a class="code" href="structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = 0;
<a name="l04290"></a>04290          <span class="comment">/* Default displayconnect from [general] */</span>
<a name="l04291"></a>04291          user-&gt;<a class="code" href="structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;
<a name="l04292"></a>04292          user-&gt;<a class="code" href="structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = 100;
<a name="l04293"></a>04293 
<a name="l04294"></a>04294          <span class="comment">/* Insert into list */</span>
<a name="l04295"></a>04295          <a class="code" href="linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="structusers.html" title="list of users found in the config file">users</a>, user, list);
<a name="l04296"></a>04296       }
<a name="l04297"></a>04297 
<a name="l04298"></a>04298       <span class="comment">/* Make sure we keep this user and don&apos;t destroy it during cleanup */</span>
<a name="l04299"></a>04299       user-&gt;<a class="code" href="structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 1;
<a name="l04300"></a>04300       oldha = user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a>;
<a name="l04301"></a>04301       user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a> = NULL;
<a name="l04302"></a>04302 
<a name="l04303"></a>04303       var = <a class="code" href="config_8h.html#a935ccfa153100ddd320c8918bd6e941b" title="Goes through variables Somewhat similar in intent as the ast_category_browse. List...">ast_variable_browse</a>(cfg, cat);
<a name="l04304"></a>04304       <span class="keywordflow">for</span> (; var; var = var-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l04305"></a>04305          <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;secret&quot;</span>)) {
<a name="l04306"></a>04306             <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>)
<a name="l04307"></a>04307                <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);
<a name="l04308"></a>04308             user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a> = <a class="code" href="astmm_8h.html#a2ef2401ade6b4b773138a82c86c40903">ast_strdup</a>(var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l04309"></a>04309          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;deny&quot;</span>) ||
<a name="l04310"></a>04310                    !strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;permit&quot;</span>)) {
<a name="l04311"></a>04311             user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a> = <a class="code" href="acl_8h.html#ae839a9c2465be4e9a560dda668a65b9b" title="Append ACL entry to host access list.">ast_append_ha</a>(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a>, NULL);
<a name="l04312"></a>04312          }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;read&quot;</span>) ) {
<a name="l04313"></a>04313             user-&gt;<a class="code" href="structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = <a class="code" href="group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l04314"></a>04314          }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;write&quot;</span>) ) {
<a name="l04315"></a>04315             user-&gt;<a class="code" href="structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = <a class="code" href="group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l04316"></a>04316          }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;displayconnects&quot;</span>) ) {
<a name="l04317"></a>04317             user-&gt;<a class="code" href="structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l04318"></a>04318          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;writetimeout&quot;</span>)) {
<a name="l04319"></a>04319             <span class="keywordtype">int</span> value = atoi(var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l04320"></a>04320             <span class="keywordflow">if</span> (value &lt; 100)
<a name="l04321"></a>04321                <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid writetimeout value &apos;%s&apos; at line %d\n&quot;</span>, var-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, var-&gt;<a class="code" href="structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);
<a name="l04322"></a>04322             <span class="keywordflow">else</span>
<a name="l04323"></a>04323                user-&gt;<a class="code" href="structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = value;
<a name="l04324"></a>04324          } <span class="keywordflow">else</span>
<a name="l04325"></a>04325             <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;%s is an unknown option.\n&quot;</span>, var-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);
<a name="l04326"></a>04326       }
<a name="l04327"></a>04327       <a class="code" href="acl_8h.html#a45dc427430b544afc0ef8e898b2c57bf" title="Free host access list.">ast_free_ha</a>(oldha);
<a name="l04328"></a>04328    }
<a name="l04329"></a>04329    <a class="code" href="config_8h.html#a710f0b2a897849572b77dd0854b8dc03" title="Destroys a config.">ast_config_destroy</a>(cfg);
<a name="l04330"></a>04330 
<a name="l04331"></a>04331    <span class="comment">/* Perform cleanup - essentially prune out old users that no longer exist */</span>
<a name="l04332"></a>04332    <a class="code" href="linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="structusers.html" title="list of users found in the config file">users</a>, user, list) {
<a name="l04333"></a>04333       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a>) { <span class="comment">/* valid record. clear flag for the next round */</span>
<a name="l04334"></a>04334          user-&gt;<a class="code" href="structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 0;
<a name="l04335"></a>04335          <span class="keywordflow">continue</span>;
<a name="l04336"></a>04336       }
<a name="l04337"></a>04337       <span class="comment">/* We do not need to keep this user so take them out of the list */</span>
<a name="l04338"></a>04338       <a class="code" href="linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(list);
<a name="l04339"></a>04339       <span class="comment">/* Free their memory now */</span>
<a name="l04340"></a>04340       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>)
<a name="l04341"></a>04341          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);
<a name="l04342"></a>04342       <a class="code" href="acl_8h.html#a45dc427430b544afc0ef8e898b2c57bf" title="Free host access list.">ast_free_ha</a>(user-&gt;<a class="code" href="structast__manager__user.html#a6c6c2b6adbe74acc944bc0c55b16c8f4">ha</a>);
<a name="l04343"></a>04343       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user);
<a name="l04344"></a>04344    }
<a name="l04345"></a>04345    <a class="code" href="linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l04346"></a>04346 
<a name="l04347"></a>04347    <a class="code" href="linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138" title="Attempts to unlock a read/write based list.">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="structusers.html" title="list of users found in the config file">users</a>);
<a name="l04348"></a>04348 
<a name="l04349"></a>04349    <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> &amp;&amp; <a class="code" href="group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>) {
<a name="l04350"></a>04350       <span class="keywordflow">if</span> (!<a class="code" href="manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a>) {
<a name="l04351"></a>04351          <a class="code" href="http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75" title="Register a URI handler.">ast_http_uri_link</a>(&amp;<a class="code" href="manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54">rawmanuri</a>);
<a name="l04352"></a>04352          <a class="code" href="http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75" title="Register a URI handler.">ast_http_uri_link</a>(&amp;<a class="code" href="manager_8c.html#a7df8bb3a46439212b942a1802e5fa167">manageruri</a>);
<a name="l04353"></a>04353          <a class="code" href="http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75" title="Register a URI handler.">ast_http_uri_link</a>(&amp;<a class="code" href="manager_8c.html#a2baf609069e59000350384fc6d5e2e48">managerxmluri</a>);
<a name="l04354"></a>04354          <a class="code" href="manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a> = 1;
<a name="l04355"></a>04355       }
<a name="l04356"></a>04356    } <span class="keywordflow">else</span> {
<a name="l04357"></a>04357       <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a>) {
<a name="l04358"></a>04358          <a class="code" href="http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14" title="Unregister a URI handler.">ast_http_uri_unlink</a>(&amp;<a class="code" href="manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54">rawmanuri</a>);
<a name="l04359"></a>04359          <a class="code" href="http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14" title="Unregister a URI handler.">ast_http_uri_unlink</a>(&amp;<a class="code" href="manager_8c.html#a7df8bb3a46439212b942a1802e5fa167">manageruri</a>);
<a name="l04360"></a>04360          <a class="code" href="http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14" title="Unregister a URI handler.">ast_http_uri_unlink</a>(&amp;<a class="code" href="manager_8c.html#a2baf609069e59000350384fc6d5e2e48">managerxmluri</a>);
<a name="l04361"></a>04361          <a class="code" href="manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a> = 0;
<a name="l04362"></a>04362       }
<a name="l04363"></a>04363    }
<a name="l04364"></a>04364 
<a name="l04365"></a>04365    <span class="keywordflow">if</span> (newhttptimeout &gt; 0)
<a name="l04366"></a>04366       <a class="code" href="group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> = newhttptimeout;
<a name="l04367"></a>04367 
<a name="l04368"></a>04368    <a class="code" href="manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208" title="External routines may send asterisk manager events this way.">manager_event</a>(<a class="code" href="manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <span class="stringliteral">&quot;Reload&quot;</span>, <span class="stringliteral">&quot;Module: Manager\r\nStatus: %s\r\nMessage: Manager reload Requested\r\n&quot;</span>, <a class="code" href="group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> ? <span class="stringliteral">&quot;Enabled&quot;</span> : <span class="stringliteral">&quot;Disabled&quot;</span>);
<a name="l04369"></a>04369 
<a name="l04370"></a>04370    <a class="code" href="tcptls_8h.html#a29375a4482c8de1e9879b97be2e88bf0" title="This is a generic (re)start routine for a TCP server, which does the socket/bind/listen...">ast_tcptls_server_start</a>(&amp;<a class="code" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a>);
<a name="l04371"></a>04371    <span class="keywordflow">if</span> (<a class="code" href="tcptls_8h.html#a24ff4bad1d2894ae3cae4e555d508fd0">ast_ssl_setup</a>(<a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>.<a class="code" href="structast__tcptls__session__args.html#aeb4a21e3ae033a326cc9dfd20a7ab074">tls_cfg</a>))
<a name="l04372"></a>04372       <a class="code" href="tcptls_8h.html#a29375a4482c8de1e9879b97be2e88bf0" title="This is a generic (re)start routine for a TCP server, which does the socket/bind/listen...">ast_tcptls_server_start</a>(&amp;<a class="code" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a>);
<a name="l04373"></a>04373    <span class="keywordflow">return</span> 0;
<a name="l04374"></a>04374 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56275a7a3b863c8b4a49d2e74ebe739c"></a><!-- doxytag: member="manager.c::astman_datastore_add" ref="a56275a7a3b863c8b4a49d2e74ebe739c" args="(struct mansession *s, struct ast_datastore *datastore)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int astman_datastore_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmansession.html">mansession</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td>
          <td class="paramname"> <em>datastore</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a datastore to a session. </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="manager_8c_source.html#l04386">4386</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00695">AST_LIST_INSERT_HEAD</a>, <a class="el" href="structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">mansession_session::datastores</a>, and <a class="el" href="manager_8c_source.html#l00219">mansession::session</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04387"></a>04387 {
<a name="l04388"></a>04388    <a class="code" href="linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307" title="Inserts a list entry at the head of a list.">AST_LIST_INSERT_HEAD</a>(&amp;s-&gt;<a class="code" href="structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, datastore, entry);
<a name="l04389"></a>04389 
<a name="l04390"></a>04390    <span class="keywordflow">return</span> 0;
<a name="l04391"></a>04391 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1a24728a1340746b7d1e914f0bc6bc78"></a><!-- doxytag: member="manager.c::astman_datastore_find" ref="a1a24728a1340746b7d1e914f0bc6bc78" args="(struct mansession *s, const struct ast_datastore_info *info, const char *uid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__datastore.html">ast_datastore</a>* astman_datastore_find </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmansession.html">mansession</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__datastore__info.html">ast_datastore_info</a> *&nbsp;</td>
          <td class="paramname"> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find a datastore on a session. </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pointer</em>&nbsp;</td><td>to the datastore if found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NULL</em>&nbsp;</td><td>if not found </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="manager_8c_source.html#l04398">4398</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h_source.html#l00599">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">mansession_session::datastores</a>, <a class="el" href="datastore_8h_source.html#l00057">ast_datastore::info</a>, <a class="el" href="manager_8c_source.html#l00219">mansession::session</a>, and <a class="el" href="datastore_8h_source.html#l00055">ast_datastore::uid</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04399"></a>04399 {
<a name="l04400"></a>04400    <span class="keyword">struct </span><a class="code" href="structast__datastore.html" title="Structure for a data store object.">ast_datastore</a> *datastore = NULL;
<a name="l04401"></a>04401    
<a name="l04402"></a>04402    <span class="keywordflow">if</span> (info == NULL)
<a name="l04403"></a>04403       <span class="keywordflow">return</span> NULL;
<a name="l04404"></a>04404 
<a name="l04405"></a>04405    <a class="code" href="linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d" title="Loops safely over (traverses) the entries in a list.">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;s-&gt;<a class="code" href="structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, datastore, entry) {
<a name="l04406"></a>04406       <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="structast__datastore.html#ac63f10c4295eed928ba083bcdff5500c">info</a> != info) {
<a name="l04407"></a>04407          <span class="keywordflow">continue</span>;
<a name="l04408"></a>04408       }
<a name="l04409"></a>04409 
<a name="l04410"></a>04410       <span class="keywordflow">if</span> (<a class="code" href="structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a> == NULL) {
<a name="l04411"></a>04411          <span class="comment">/* matched by type only */</span>
<a name="l04412"></a>04412          <span class="keywordflow">break</span>;
<a name="l04413"></a>04413       }
<a name="l04414"></a>04414 
<a name="l04415"></a>04415       <span class="keywordflow">if</span> ((datastore-&gt;<a class="code" href="structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a> != NULL) &amp;&amp; !strcasecmp(<a class="code" href="structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>, datastore-&gt;<a class="code" href="structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>)) {
<a name="l04416"></a>04416          <span class="comment">/* Matched by type AND uid */</span>
<a name="l04417"></a>04417          <span class="keywordflow">break</span>;
<a name="l04418"></a>04418       }
<a name="l04419"></a>04419    }
<a name="l04420"></a>04420    <a class="code" href="linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9" title="Closes a safe loop traversal block.">AST_LIST_TRAVERSE_SAFE_END</a>;
<a name="l04421"></a>04421 
<a name="l04422"></a>04422    <span class="keywordflow">return</span> datastore;
<a name="l04423"></a>04423 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af9f2dfb1df89986ee6613d2bfa541688"></a><!-- doxytag: member="manager.c::astman_datastore_remove" ref="af9f2dfb1df89986ee6613d2bfa541688" args="(struct mansession *s, struct ast_datastore *datastore)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int astman_datastore_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmansession.html">mansession</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td>
          <td class="paramname"> <em>datastore</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remove a datastore from a session. </p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>failure </td></tr>
  </table>
  </dd>
</dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.6.1 </dd></dl>

<p>Definition at line <a class="el" href="manager_8c_source.html#l04393">4393</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="linkedlists_8h_source.html#l00838">AST_LIST_REMOVE</a>, <a class="el" href="structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">mansession_session::datastores</a>, and <a class="el" href="manager_8c_source.html#l00219">mansession::session</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04394"></a>04394 {
<a name="l04395"></a>04395    <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#aa36e72b77f1b80881cd0a9fcca66ce19" title="Removes a specific entry from a list.">AST_LIST_REMOVE</a>(&amp;s-&gt;<a class="code" href="structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, datastore, entry) ? 0 : -1;
<a name="l04396"></a>04396 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acb49e15f3ae80cc0ee0cfa3a250d00c0"></a><!-- doxytag: member="manager.c::astman_is_authed" ref="acb49e15f3ae80cc0ee0cfa3a250d00c0" args="(uint32_t ident)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int astman_is_authed </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>ident</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determinie if a manager session ident is authenticated. </p>

<p>Definition at line <a class="el" href="manager_8c_source.html#l03521">3521</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l00186">mansession_session::__lock</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="manager_8c_source.html#l00199">mansession_session::authenticated</a>, and <a class="el" href="manager_8c_source.html#l03500">find_session()</a>.</p>

<p>Referenced by <a class="el" href="http_8c_source.html#l00423">handle_uri()</a>, and <a class="el" href="http_8c_source.html#l00154">static_callback()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03522"></a>03522 {
<a name="l03523"></a>03523    <span class="keywordtype">int</span> authed;
<a name="l03524"></a>03524    <span class="keyword">struct </span><a class="code" href="structmansession__session.html">mansession_session</a> *session;
<a name="l03525"></a>03525 
<a name="l03526"></a>03526    <span class="keywordflow">if</span> (!(session = <a class="code" href="manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a>(ident, 0)))
<a name="l03527"></a>03527       <span class="keywordflow">return</span> 0;
<a name="l03528"></a>03528 
<a name="l03529"></a>03529    authed = (session-&gt;<a class="code" href="structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> != 0);
<a name="l03530"></a>03530 
<a name="l03531"></a>03531    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03532"></a>03532 
<a name="l03533"></a>03533    <span class="keywordflow">return</span> authed;
<a name="l03534"></a>03534 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a73a22446241314099a4e371157e360f5"></a><!-- doxytag: member="manager.c::astman_verify_session_readpermissions" ref="a73a22446241314099a4e371157e360f5" args="(uint32_t ident, int perm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int astman_verify_session_readpermissions </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>ident</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>perm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verify a session's read permissions against a <a class="el" href="structpermission.html">permission</a> mask. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ident</em>&nbsp;</td><td>session identity </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td><a class="el" href="structpermission.html">permission</a> mask to verify </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if the session has the <a class="el" href="structpermission.html">permission</a> mask capabilities </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manager_8c_source.html#l03536">3536</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l00186">mansession_session::__lock</a>, <a class="el" href="linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="manager_8c_source.html#l00194">mansession_session::managerid</a>, and <a class="el" href="manager_8c_source.html#l00200">mansession_session::readperm</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03537"></a>03537 {
<a name="l03538"></a>03538    <span class="keywordtype">int</span> result = 0;
<a name="l03539"></a>03539    <span class="keyword">struct </span><a class="code" href="structmansession__session.html">mansession_session</a> *session;
<a name="l03540"></a>03540 
<a name="l03541"></a>03541    <a class="code" href="linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40" title="Locks a list.">AST_LIST_LOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03542"></a>03542    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="structsessions.html">sessions</a>, session, <a class="code" href="structmansession__session.html#a815de629926cb685e0c54eab5ac892ff">list</a>) {
<a name="l03543"></a>03543       <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03544"></a>03544       <span class="keywordflow">if</span> ((session-&gt;<a class="code" href="structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == ident) &amp;&amp; (session-&gt;<a class="code" href="structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> &amp; perm)) {
<a name="l03545"></a>03545          result = 1;
<a name="l03546"></a>03546          <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03547"></a>03547          <span class="keywordflow">break</span>;
<a name="l03548"></a>03548       }
<a name="l03549"></a>03549       <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03550"></a>03550    }
<a name="l03551"></a>03551    <a class="code" href="linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01" title="Attempts to unlock a list.">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03552"></a>03552    <span class="keywordflow">return</span> result;
<a name="l03553"></a>03553 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a38eb222ca678604d4f203c9e9d5295ab"></a><!-- doxytag: member="manager.c::astman_verify_session_writepermissions" ref="a38eb222ca678604d4f203c9e9d5295ab" args="(uint32_t ident, int perm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int astman_verify_session_writepermissions </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>ident</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>perm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verify a session's write permissions against a <a class="el" href="structpermission.html">permission</a> mask. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ident</em>&nbsp;</td><td>session identity </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td><a class="el" href="structpermission.html">permission</a> mask to verify </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>if the session has the <a class="el" href="structpermission.html">permission</a> mask capabilities, otherwise 0 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manager_8c_source.html#l03555">3555</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l00186">mansession_session::__lock</a>, <a class="el" href="linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="manager_8c_source.html#l00194">mansession_session::managerid</a>, and <a class="el" href="manager_8c_source.html#l00201">mansession_session::writeperm</a>.</p>

<p>Referenced by <a class="el" href="res__http__post_8c_source.html#l00296">http_post_callback()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03556"></a>03556 {
<a name="l03557"></a>03557    <span class="keywordtype">int</span> result = 0;
<a name="l03558"></a>03558    <span class="keyword">struct </span><a class="code" href="structmansession__session.html">mansession_session</a> *session;
<a name="l03559"></a>03559 
<a name="l03560"></a>03560    <a class="code" href="linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40" title="Locks a list.">AST_LIST_LOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03561"></a>03561    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="structsessions.html">sessions</a>, session, <a class="code" href="structmansession__session.html#a815de629926cb685e0c54eab5ac892ff">list</a>) {
<a name="l03562"></a>03562       <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03563"></a>03563       <span class="keywordflow">if</span> ((session-&gt;<a class="code" href="structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == ident) &amp;&amp; (session-&gt;<a class="code" href="structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> &amp; perm)) {
<a name="l03564"></a>03564          result = 1;
<a name="l03565"></a>03565          <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03566"></a>03566          <span class="keywordflow">break</span>;
<a name="l03567"></a>03567       }
<a name="l03568"></a>03568       <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03569"></a>03569    }
<a name="l03570"></a>03570    <a class="code" href="linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01" title="Attempts to unlock a list.">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03571"></a>03571    <span class="keywordflow">return</span> result;
<a name="l03572"></a>03572 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa8be2e22d4b4246e934cf0638aa0d095"></a><!-- doxytag: member="manager.c::compress_char" ref="aa8be2e22d4b4246e934cf0638aa0d095" args="(char c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int compress_char </td>
          <td>(</td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03640">3640</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03653">variable_count_hash_fn()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03641"></a>03641 {
<a name="l03642"></a>03642    c &amp;= 0x7f;
<a name="l03643"></a>03643    <span class="keywordflow">if</span> (c &lt; 32)
<a name="l03644"></a>03644       <span class="keywordflow">return</span> 0;
<a name="l03645"></a>03645    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt;= <span class="charliteral">&apos;a&apos;</span> &amp;&amp; c &lt;= <span class="charliteral">&apos;z&apos;</span>)
<a name="l03646"></a>03646       <span class="keywordflow">return</span> c - 64;
<a name="l03647"></a>03647    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt; <span class="charliteral">&apos;z&apos;</span>)
<a name="l03648"></a>03648       <span class="keywordflow">return</span> <span class="charliteral">&apos;_&apos;</span>;
<a name="l03649"></a>03649    <span class="keywordflow">else</span>
<a name="l03650"></a>03650       <span class="keywordflow">return</span> c - 32;
<a name="l03651"></a>03651 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a914dce58348e2b56ed139c441198b82f"></a><!-- doxytag: member="manager.c::find_session" ref="a914dce58348e2b56ed139c441198b82f" args="(uint32_t ident, int incinuse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structmansession__session.html">mansession_session</a>* find_session </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>ident</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>incinuse</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>locate an http session in the list. The search key (ident) is the value of the mansession_id cookie (0 is not valid and means a session on the AMI socket). </p>

<p>Definition at line <a class="el" href="manager_8c_source.html#l03500">3500</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l00186">mansession_session::__lock</a>, <a class="el" href="lock_8h_source.html#l01964">ast_atomic_fetchadd_int()</a>, <a class="el" href="linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="manager_8c_source.html#l00191">mansession_session::inuse</a>, <a class="el" href="manager_8c_source.html#l00194">mansession_session::managerid</a>, and <a class="el" href="manager_8c_source.html#l00192">mansession_session::needdestroy</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03521">astman_is_authed()</a>, and <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03501"></a>03501 {
<a name="l03502"></a>03502    <span class="keyword">struct </span><a class="code" href="structmansession__session.html">mansession_session</a> *session;
<a name="l03503"></a>03503 
<a name="l03504"></a>03504    <span class="keywordflow">if</span> (ident == 0)
<a name="l03505"></a>03505       <span class="keywordflow">return</span> NULL;
<a name="l03506"></a>03506 
<a name="l03507"></a>03507    <a class="code" href="linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40" title="Locks a list.">AST_LIST_LOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03508"></a>03508    <a class="code" href="linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef" title="Loops over (traverses) the entries in a list.">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="structsessions.html">sessions</a>, session, <a class="code" href="structmansession__session.html#a815de629926cb685e0c54eab5ac892ff">list</a>) {
<a name="l03509"></a>03509       <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03510"></a>03510       <span class="keywordflow">if</span> (session-&gt;<a class="code" href="structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == ident &amp;&amp; !session-&gt;<a class="code" href="structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>) {
<a name="l03511"></a>03511          <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>, incinuse ? 1 : 0);
<a name="l03512"></a>03512          <span class="keywordflow">break</span>;
<a name="l03513"></a>03513       }
<a name="l03514"></a>03514       <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03515"></a>03515    }
<a name="l03516"></a>03516    <a class="code" href="linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01" title="Attempts to unlock a list.">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03517"></a>03517 
<a name="l03518"></a>03518    <span class="keywordflow">return</span> session;
<a name="l03519"></a>03519 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a329d804fa86d5ccea431b91af21455f0"></a><!-- doxytag: member="manager.c::generic_http_callback" ref="a329d804fa86d5ccea431b91af21455f0" args="(enum output_format format, struct sockaddr_in *remote_address, const char *uri, enum ast_http_method method, struct ast_variable *params, int *status, char **title, int *contentlength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__str.html">ast_str</a>* generic_http_callback </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a>&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct sockaddr_in *&nbsp;</td>
          <td class="paramname"> <em>remote_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a>&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>contentlength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><dl class="note"><dt><b>Note:</b></dt><dd>There is approximately a 1 in 1.8E19 chance that the following calculation will produce 0, which is an invalid ID, but due to the properties of the rand() function (and the constantcy of s), that won't happen twice in a row.</dd></dl>
</p>

<p>Definition at line <a class="el" href="manager_8c_source.html#l03804">3804</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l00186">mansession_session::__lock</a>, <a class="el" href="lock_8h_source.html#l01964">ast_atomic_fetchadd_int()</a>, <a class="el" href="astmm_8h_source.html#l00072">ast_calloc</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="http_8c_source.html#l00309">ast_http_error()</a>, <a class="el" href="utils_8c_source.html#l00431">ast_inet_ntoa()</a>, <a class="el" href="linkedlists_8h_source.html#l00665">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00695">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h_source.html#l00039">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h_source.html#l00139">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c_source.html#l01090">ast_log()</a>, <a class="el" href="manager_8h_source.html#l00078">AST_MAX_MANHEADERS</a>, <a class="el" href="lock_8h_source.html#l01692">ast_mutex_init()</a>, <a class="el" href="lock_8h_source.html#l01717">ast_mutex_lock()</a>, <a class="el" href="lock_8h_source.html#l01707">ast_mutex_unlock()</a>, <a class="el" href="lock_8h_source.html#l00082">AST_PTHREADT_NULL</a>, <a class="el" href="utils_8c_source.html#l01401">ast_random()</a>, <a class="el" href="strings_8h_source.html#l00846">ast_str_append()</a>, <a class="el" href="strings_8h_source.html#l00415">ast_str_create()</a>, <a class="el" href="logger_8h_source.html#l00220">ast_verb</a>, <a class="el" href="manager_8c_source.html#l00199">mansession_session::authenticated</a>, <a class="el" href="adsistub_8c_source.html#l00059">buf</a>, <a class="el" href="manager_8c_source.html#l03489">contenttype</a>, <a class="el" href="manager_8c_source.html#l00852">destroy_session()</a>, <a class="el" href="manager_8c_source.html#l00220">mansession::f</a>, <a class="el" href="manager_8c_source.html#l00221">mansession::fd</a>, <a class="el" href="manager_8c_source.html#l00190">mansession_session::fd</a>, <a class="el" href="manager_8c_source.html#l03500">find_session()</a>, <a class="el" href="manager_8c_source.html#l03485">FORMAT_HTML</a>, <a class="el" href="manager_8c_source.html#l03486">FORMAT_XML</a>, <a class="el" href="manager_8c_source.html#l00330">grab_last()</a>, <a class="el" href="manager_8h_source.html#l00112">message::hdrcount</a>, <a class="el" href="manager_8h_source.html#l00113">message::headers</a>, <a class="el" href="manager_8c_source.html#l00191">mansession_session::inuse</a>, <a class="el" href="logger_8h_source.html#l00130">LOG_EVENT</a>, <a class="el" href="manager_8c_source.html#l00505">manager_displayconnects()</a>, <a class="el" href="manager_8c_source.html#l00194">mansession_session::managerid</a>, <a class="el" href="config_8h_source.html#l00075">ast_variable::name</a>, <a class="el" href="manager_8c_source.html#l00192">mansession_session::needdestroy</a>, <a class="el" href="config_8h_source.html#l00077">ast_variable::next</a>, <a class="el" href="manager_8c_source.html#l02992">process_message()</a>, <a class="el" href="manager_8c.html#a0f30c6e376cc35312886a20eae8cce2a">ROW_FMT</a>, <a class="el" href="aesopt_8h_source.html#l00399">s</a>, <a class="el" href="manager_8c_source.html#l00205">mansession_session::send_events</a>, <a class="el" href="manager_8c_source.html#l00219">mansession::session</a>, <a class="el" href="manager_8c_source.html#l00196">mansession_session::sessiontimeout</a>, <a class="el" href="manager_8c_source.html#l00188">mansession_session::sin</a>, <a class="el" href="manager_8c.html#ae266fd2d3b1b5374127ad824217bb025">TEST_STRING</a>, <a class="el" href="manager_8c_source.html#l00197">mansession_session::username</a>, <a class="el" href="config_8h_source.html#l00076">ast_variable::value</a>, <a class="el" href="manager_8c_source.html#l00193">mansession_session::waiting_thread</a>, and <a class="el" href="manager_8c_source.html#l03704">xml_translate()</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03985">manager_http_callback()</a>, <a class="el" href="manager_8c_source.html#l03990">mxml_http_callback()</a>, and <a class="el" href="manager_8c_source.html#l03995">rawman_http_callback()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03808"></a>03808 {
<a name="l03809"></a>03809    <span class="keyword">struct </span><a class="code" href="structmansession.html">mansession</a> <a class="code" href="aesopt_8h.html#a20c782a91c883391b9bdf9e3176e447c">s</a> = {.session = NULL, };
<a name="l03810"></a>03810    <span class="keyword">struct </span><a class="code" href="structmansession__session.html">mansession_session</a> *session = NULL;
<a name="l03811"></a>03811    uint32_t ident = 0;
<a name="l03812"></a>03812    <span class="keywordtype">int</span> blastaway = 0;
<a name="l03813"></a>03813    <span class="keyword">struct </span><a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *v;
<a name="l03814"></a>03814    <span class="keywordtype">char</span> <span class="keyword">template</span>[] = <span class="stringliteral">&quot;/tmp/ast-http-XXXXXX&quot;</span>; <span class="comment">/* template for temporary file */</span>
<a name="l03815"></a>03815    <span class="keyword">struct </span><a class="code" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a> *out = NULL;
<a name="l03816"></a>03816    <span class="keyword">struct </span><a class="code" href="structmessage.html">message</a> m = { 0 };
<a name="l03817"></a>03817    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x;
<a name="l03818"></a>03818    <span class="keywordtype">size_t</span> hdrlen;
<a name="l03819"></a>03819 
<a name="l03820"></a>03820    <span class="keywordflow">for</span> (v = params; v; v = v-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l03821"></a>03821       <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;mansession_id&quot;</span>)) {
<a name="l03822"></a>03822          sscanf(v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;%30x&quot;</span>, &amp;ident);
<a name="l03823"></a>03823          <span class="keywordflow">break</span>;
<a name="l03824"></a>03824       }
<a name="l03825"></a>03825    }
<a name="l03826"></a>03826 
<a name="l03827"></a>03827    <span class="keywordflow">if</span> (!(session = <a class="code" href="manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a>(ident, 1))) {
<a name="l03828"></a>03828       <span class="comment">/* Create new session.</span>
<a name="l03829"></a>03829 <span class="comment">       * While it is not in the list we don&apos;t need any locking</span>
<a name="l03830"></a>03830 <span class="comment">       */</span>
<a name="l03831"></a>03831       <span class="keywordflow">if</span> (!(session = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*session)))) {
<a name="l03832"></a>03832          *<a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = 500;
<a name="l03833"></a>03833          <span class="keywordflow">goto</span> generic_callback_out;
<a name="l03834"></a>03834       }
<a name="l03835"></a>03835       session-&gt;<a class="code" href="structmansession__session.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a> = *remote_address;
<a name="l03836"></a>03836       session-&gt;<a class="code" href="structmansession__session.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = -1;
<a name="l03837"></a>03837       session-&gt;<a class="code" href="structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> = <a class="code" href="lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;
<a name="l03838"></a>03838       session-&gt;<a class="code" href="structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> = 0;
<a name="l03839"></a>03839       <a class="code" href="lock_8h.html#a5dc895fe6e8c089175159fc22e33fc3b">ast_mutex_init</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03840"></a>03840       <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03841"></a>03841       session-&gt;<a class="code" href="structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a> = 1;<span class="comment"></span>
<a name="l03842"></a>03842 <span class="comment">      /*!\note There is approximately a 1 in 1.8E19 chance that the following</span>
<a name="l03843"></a>03843 <span class="comment">       * calculation will produce 0, which is an invalid ID, but due to the</span>
<a name="l03844"></a>03844 <span class="comment">       * properties of the rand() function (and the constantcy of s), that</span>
<a name="l03845"></a>03845 <span class="comment">       * won&apos;t happen twice in a row.</span>
<a name="l03846"></a>03846 <span class="comment">       */</span>
<a name="l03847"></a>03847       <span class="keywordflow">while</span> ((session-&gt;<a class="code" href="structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> = <a class="code" href="utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() ^ (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) session) == 0);
<a name="l03848"></a>03848       session-&gt;last_ev = <a class="code" href="group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a>();
<a name="l03849"></a>03849       <a class="code" href="linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27" title="Initializes a list head structure.">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;session-&gt;datastores);
<a name="l03850"></a>03850       <a class="code" href="linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40" title="Locks a list.">AST_LIST_LOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03851"></a>03851       <a class="code" href="linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307" title="Inserts a list entry at the head of a list.">AST_LIST_INSERT_HEAD</a>(&amp;<a class="code" href="structsessions.html">sessions</a>, session, list);
<a name="l03852"></a>03852       <a class="code" href="lock_8h.html#a30df186a6f53f66621e88fae2e7adaf9" title="Atomically add v to *p and return * the previous value of *p. This can be used to...">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="group__Group__AMI.html#ga14cc85c894edb525f4553f47a1060f92">num_sessions</a>, 1);
<a name="l03853"></a>03853       <a class="code" href="linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01" title="Attempts to unlock a list.">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="structsessions.html">sessions</a>);
<a name="l03854"></a>03854    }
<a name="l03855"></a>03855 
<a name="l03856"></a>03856    s.<a class="code" href="structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = session;
<a name="l03857"></a>03857 
<a name="l03858"></a>03858    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03859"></a>03859 
<a name="l03860"></a>03860    <span class="keywordflow">if</span> (!(out = <a class="code" href="strings_8h.html#a8ec37e4acb6ecb20eb6f6edd1141cd76" title="Create a malloc&amp;#39;ed dynamic length string.">ast_str_create</a>(1024))) {
<a name="l03861"></a>03861       *<a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = 500;
<a name="l03862"></a>03862       <span class="keywordflow">goto</span> generic_callback_out;
<a name="l03863"></a>03863    }
<a name="l03864"></a>03864 
<a name="l03865"></a>03865    s.<a class="code" href="structmansession.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = mkstemp(<span class="keyword">template</span>);  <span class="comment">/* create a temporary file for command output */</span>
<a name="l03866"></a>03866    unlink(<span class="keyword">template</span>);
<a name="l03867"></a>03867    s.<a class="code" href="structmansession.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a> = fdopen(s.<a class="code" href="structmansession.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, <span class="stringliteral">&quot;w+&quot;</span>);
<a name="l03868"></a>03868 
<a name="l03869"></a>03869    <span class="keywordflow">for</span> (x = 0, v = params; v &amp;&amp; (x &lt; <a class="code" href="manager_8h.html#a98b15e5ddea410372fed1a16c046034b" title="Export manager structures.">AST_MAX_MANHEADERS</a>); x++, v = v-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l03870"></a>03870       hdrlen = strlen(v-&gt;name) + strlen(v-&gt;value) + 3;
<a name="l03871"></a>03871       m.<a class="code" href="structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m.<a class="code" href="structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>] = alloca(hdrlen);
<a name="l03872"></a>03872       snprintf((<span class="keywordtype">char</span> *) m.<a class="code" href="structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m.<a class="code" href="structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>], hdrlen, <span class="stringliteral">&quot;%s: %s&quot;</span>, v-&gt;name, v-&gt;value);
<a name="l03873"></a>03873       <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(4, <span class="stringliteral">&quot;HTTP Manager add header %s\n&quot;</span>, m.<a class="code" href="structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m.<a class="code" href="structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>]);
<a name="l03874"></a>03874       m.<a class="code" href="structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a> = x + 1;
<a name="l03875"></a>03875    }
<a name="l03876"></a>03876 
<a name="l03877"></a>03877    <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a>(&amp;s, &amp;m)) {
<a name="l03878"></a>03878       <span class="keywordflow">if</span> (session-&gt;<a class="code" href="structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {
<a name="l03879"></a>03879          <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010" title="Get displayconnects config option.">manager_displayconnects</a>(session)) {
<a name="l03880"></a>03880             <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Manager &apos;%s&apos; logged off from %s\n&quot;</span>, session-&gt;<a class="code" href="structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(session-&gt;<a class="code" href="structmansession__session.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr));
<a name="l03881"></a>03881          }
<a name="l03882"></a>03882          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#af7c8529df13c84f0c9d1122f36a94a41">LOG_EVENT</a>, <span class="stringliteral">&quot;HTTP Manager &apos;%s&apos; logged off from %s\n&quot;</span>, session-&gt;<a class="code" href="structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(session-&gt;<a class="code" href="structmansession__session.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr));
<a name="l03883"></a>03883       } <span class="keywordflow">else</span> {
<a name="l03884"></a>03884          <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>) {
<a name="l03885"></a>03885             <a class="code" href="logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Connect attempt from &apos;%s&apos; unable to authenticate\n&quot;</span>, <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(session-&gt;<a class="code" href="structmansession__session.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr));
<a name="l03886"></a>03886          }
<a name="l03887"></a>03887          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#af7c8529df13c84f0c9d1122f36a94a41">LOG_EVENT</a>, <span class="stringliteral">&quot;HTTP Failed attempt from %s\n&quot;</span>, <a class="code" href="network_8h.html#a5a735cb59e8a8ddd78078d396db7e106" title="thread-safe replacement for inet_ntoa().">ast_inet_ntoa</a>(session-&gt;<a class="code" href="structmansession__session.html#ac7cbd331d33fcd5a6f81a257975e4cd5">sin</a>.sin_addr));
<a name="l03888"></a>03888       }
<a name="l03889"></a>03889       session-&gt;<a class="code" href="structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a> = 1;
<a name="l03890"></a>03890    }
<a name="l03891"></a>03891 
<a name="l03892"></a>03892    <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0,
<a name="l03893"></a>03893              <span class="stringliteral">&quot;Content-type: text/%s\r\n&quot;</span>
<a name="l03894"></a>03894              <span class="stringliteral">&quot;Cache-Control: no-cache;\r\n&quot;</span>
<a name="l03895"></a>03895              <span class="stringliteral">&quot;Set-Cookie: mansession_id=\&quot;%08x\&quot;; Version=\&quot;1\&quot;; Max-Age=%d\r\n&quot;</span>
<a name="l03896"></a>03896              <span class="stringliteral">&quot;Pragma: SuppressEvents\r\n&quot;</span>
<a name="l03897"></a>03897              <span class="stringliteral">&quot;\r\n&quot;</span>,
<a name="l03898"></a>03898          <a class="code" href="manager_8c.html#ae93b19979f76ef4c841d10b58d24b149">contenttype</a>[<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>],
<a name="l03899"></a>03899          session-&gt;<a class="code" href="structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a>, <a class="code" href="group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a>);
<a name="l03900"></a>03900 
<a name="l03901"></a>03901    <span class="keywordflow">if</span> (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>) {
<a name="l03902"></a>03902       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;ajax-response&gt;\n&quot;</span>);
<a name="l03903"></a>03903    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {
<a name="l03904"></a>03904       <span class="comment">/*</span>
<a name="l03905"></a>03905 <span class="comment">       * When handling AMI-over-HTTP in HTML format, we provide a simple form for</span>
<a name="l03906"></a>03906 <span class="comment">       * debugging purposes. This HTML code should not be here, we</span>
<a name="l03907"></a>03907 <span class="comment">       * should read from some config file...</span>
<a name="l03908"></a>03908 <span class="comment">       */</span>
<a name="l03909"></a>03909 
<a name="l03910"></a>03910 <span class="preprocessor">#define ROW_FMT   &quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot; bgcolor=\&quot;#f1f1ff\&quot;&gt;%s&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span>
<a name="l03911"></a>03911 <span class="preprocessor"></span><span class="preprocessor">#define TEST_STRING \</span>
<a name="l03912"></a>03912 <span class="preprocessor">   &quot;&lt;form action=\&quot;manager\&quot;&gt;\n\</span>
<a name="l03913"></a>03913 <span class="preprocessor">   Action: &lt;select name=\&quot;action\&quot;&gt;\n\</span>
<a name="l03914"></a>03914 <span class="preprocessor">      &lt;option value=\&quot;\&quot;&gt;-----&amp;gt;&lt;/option&gt;\n\</span>
<a name="l03915"></a>03915 <span class="preprocessor">      &lt;option value=\&quot;login\&quot;&gt;login&lt;/option&gt;\n\</span>
<a name="l03916"></a>03916 <span class="preprocessor">      &lt;option value=\&quot;command\&quot;&gt;Command&lt;/option&gt;\n\</span>
<a name="l03917"></a>03917 <span class="preprocessor">      &lt;option value=\&quot;waitevent\&quot;&gt;waitevent&lt;/option&gt;\n\</span>
<a name="l03918"></a>03918 <span class="preprocessor">      &lt;option value=\&quot;listcommands\&quot;&gt;listcommands&lt;/option&gt;\n\</span>
<a name="l03919"></a>03919 <span class="preprocessor">   &lt;/select&gt;\n\</span>
<a name="l03920"></a>03920 <span class="preprocessor">   or &lt;input name=\&quot;action\&quot;&gt;&lt;br/&gt;\n\</span>
<a name="l03921"></a>03921 <span class="preprocessor">   CLI Command &lt;input name=\&quot;command\&quot;&gt;&lt;br&gt;\n\</span>
<a name="l03922"></a>03922 <span class="preprocessor">   user &lt;input name=\&quot;username\&quot;&gt; pass &lt;input type=\&quot;password\&quot; name=\&quot;secret\&quot;&gt;&lt;br&gt;\n\</span>
<a name="l03923"></a>03923 <span class="preprocessor">   &lt;input type=\&quot;submit\&quot;&gt;\n&lt;/form&gt;\n&quot;</span>
<a name="l03924"></a>03924 <span class="preprocessor"></span>
<a name="l03925"></a>03925       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;title&gt;Asterisk&amp;trade; Manager Interface&lt;/title&gt;&quot;</span>);
<a name="l03926"></a>03926       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;body bgcolor=\&quot;#ffffff\&quot;&gt;&lt;table align=center bgcolor=\&quot;#f1f1f1\&quot; width=\&quot;500\&quot;&gt;\r\n&quot;</span>);
<a name="l03927"></a>03927       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, ROW_FMT, <span class="stringliteral">&quot;&lt;h1&gt;Manager Tester&lt;/h1&gt;&quot;</span>);
<a name="l03928"></a>03928       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, ROW_FMT, TEST_STRING);
<a name="l03929"></a>03929    }
<a name="l03930"></a>03930 
<a name="l03931"></a>03931    <span class="keywordflow">if</span> (s.<a class="code" href="structmansession.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a> != NULL) {   <span class="comment">/* have temporary output */</span>
<a name="l03932"></a>03932       <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>;
<a name="l03933"></a>03933       <span class="keywordtype">size_t</span> l;
<a name="l03934"></a>03934       
<a name="l03935"></a>03935       <span class="comment">/* Ensure buffer is NULL-terminated */</span>
<a name="l03936"></a>03936       fprintf(s.<a class="code" href="structmansession.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>, <span class="stringliteral">&quot;%c&quot;</span>, 0);
<a name="l03937"></a>03937 
<a name="l03938"></a>03938       <span class="keywordflow">if</span> ((l = ftell(s.<a class="code" href="structmansession.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>))) {
<a name="l03939"></a>03939          <span class="keywordflow">if</span> ((buf = mmap(NULL, l, PROT_READ | PROT_WRITE, MAP_SHARED, s.<a class="code" href="structmansession.html#a6f8059414f0228f0256115e024eeed4b">fd</a>, 0))) {
<a name="l03940"></a>03940             <span class="keywordflow">if</span> (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a> || <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>)
<a name="l03941"></a>03941                <a class="code" href="manager_8c.html#a35b1a18a306de254383a797e1e08bc55" title="Convert the input into XML or HTML. The input is supposed to be a sequence of lines...">xml_translate</a>(&amp;out, buf, params, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);
<a name="l03942"></a>03942             <span class="keywordflow">else</span>
<a name="l03943"></a>03943                <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;%s&quot;</span>, buf);
<a name="l03944"></a>03944             munmap(buf, l);
<a name="l03945"></a>03945          }
<a name="l03946"></a>03946       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a> || <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {
<a name="l03947"></a>03947          <a class="code" href="manager_8c.html#a35b1a18a306de254383a797e1e08bc55" title="Convert the input into XML or HTML. The input is supposed to be a sequence of lines...">xml_translate</a>(&amp;out, <span class="stringliteral">&quot;&quot;</span>, params, <a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a>);
<a name="l03948"></a>03948       }
<a name="l03949"></a>03949       fclose(s.<a class="code" href="structmansession.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>);
<a name="l03950"></a>03950       s.<a class="code" href="structmansession.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a> = NULL;
<a name="l03951"></a>03951       s.<a class="code" href="structmansession.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = -1;
<a name="l03952"></a>03952    }
<a name="l03953"></a>03953 
<a name="l03954"></a>03954    <span class="keywordflow">if</span> (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>) {
<a name="l03955"></a>03955       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;/ajax-response&gt;\n&quot;</span>);
<a name="l03956"></a>03956    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>)
<a name="l03957"></a>03957       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;/table&gt;&lt;/body&gt;\r\n&quot;</span>);
<a name="l03958"></a>03958 
<a name="l03959"></a>03959    <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03960"></a>03960    <span class="comment">/* Reset HTTP timeout.  If we&apos;re not authenticated, keep it extremely short */</span>
<a name="l03961"></a>03961    session-&gt;<a class="code" href="structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a> = time(NULL) + ((session-&gt;<a class="code" href="structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> || <a class="code" href="group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> &lt; 5) ? <a class="code" href="group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> : 5);
<a name="l03962"></a>03962 
<a name="l03963"></a>03963    <span class="keywordflow">if</span> (session-&gt;<a class="code" href="structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>) {
<a name="l03964"></a>03964       <span class="keywordflow">if</span> (session-&gt;<a class="code" href="structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a> == 1) {
<a name="l03965"></a>03965          <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Need destroy, doing it now!\n&quot;</span>);
<a name="l03966"></a>03966          blastaway = 1;
<a name="l03967"></a>03967       } <span class="keywordflow">else</span> {
<a name="l03968"></a>03968          <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(1, <span class="stringliteral">&quot;Need destroy, but can&apos;t do it yet!\n&quot;</span>);
<a name="l03969"></a>03969          <span class="keywordflow">if</span> (session-&gt;<a class="code" href="structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> != <a class="code" href="lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>)
<a name="l03970"></a>03970             pthread_kill(session-&gt;<a class="code" href="structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a>, SIGURG);
<a name="l03971"></a>03971          session-&gt;<a class="code" href="structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>--;
<a name="l03972"></a>03972       }
<a name="l03973"></a>03973    } <span class="keywordflow">else</span>
<a name="l03974"></a>03974       session-&gt;<a class="code" href="structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>--;
<a name="l03975"></a>03975    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="structmansession__session.html#acc08bc856eb8a6f898a257a7d76f1dba">__lock</a>);
<a name="l03976"></a>03976 
<a name="l03977"></a>03977    <span class="keywordflow">if</span> (blastaway)
<a name="l03978"></a>03978       <a class="code" href="group__Group__AMI.html#ga4455e2dfb7ec15524bdcd295f0695e14">destroy_session</a>(session);
<a name="l03979"></a>03979 generic_callback_out:
<a name="l03980"></a>03980    <span class="keywordflow">if</span> (*<a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> != 200)
<a name="l03981"></a>03981       <span class="keywordflow">return</span> <a class="code" href="http_8h.html#a934683361438de9f78b6c88a6a106b46" title="Return an ast_str malloc()&amp;#39;d string containing an HTTP error message.">ast_http_error</a>(500, <span class="stringliteral">&quot;Server Error&quot;</span>, NULL, <span class="stringliteral">&quot;Internal Server Error (out of memory)\n&quot;</span>);
<a name="l03982"></a>03982    <span class="keywordflow">return</span> out;
<a name="l03983"></a>03983 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd67495092f6edf4b7e5b6ae94be3154"></a><!-- doxytag: member="manager.c::init_manager" ref="abd67495092f6edf4b7e5b6ae94be3154" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_manager </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called by Asterisk initialization. </p>

<p>Definition at line <a class="el" href="manager_8c_source.html#l04376">4376</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

<p>Referenced by <a class="el" href="asterisk_8c_source.html#l03095">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04377"></a>04377 {
<a name="l04378"></a>04378    <span class="keywordflow">return</span> <a class="code" href="manager_8c.html#a1d18fccb8dd1b468c17c0a89983b7d82">__init_manager</a>(0);
<a name="l04379"></a>04379 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af287035ba3c63aabd151f2fb58b6e172"></a><!-- doxytag: member="manager.c::manager_http_callback" ref="af287035ba3c63aabd151f2fb58b6e172" args="(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *params, struct ast_variable *headers, int *status, char **title, int *contentlength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__str.html">ast_str</a>* manager_http_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *&nbsp;</td>
          <td class="paramname"> <em>ser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> *&nbsp;</td>
          <td class="paramname"> <em>urih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a>&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>contentlength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03985">3985</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l03485">FORMAT_HTML</a>, <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>, and <a class="el" href="tcptls_8h_source.html#l00139">ast_tcptls_session_instance::remote_address</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03986"></a>03986 {
<a name="l03987"></a>03987    <span class="keywordflow">return</span> <a class="code" href="manager_8c.html#a329d804fa86d5ccea431b91af21455f0">generic_http_callback</a>(<a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>, &amp;ser-&gt;<a class="code" href="structast__tcptls__session__instance.html#aa328808993fa36d65b987f07ede2e0a4">remote_address</a>, uri, method, params, <a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, title, contentlength);
<a name="l03988"></a>03988 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad0469ed5deab2674afe9a20a7acc50b9"></a><!-- doxytag: member="manager.c::mxml_http_callback" ref="ad0469ed5deab2674afe9a20a7acc50b9" args="(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *params, struct ast_variable *headers, int *status, char **title, int *contentlength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__str.html">ast_str</a>* mxml_http_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *&nbsp;</td>
          <td class="paramname"> <em>ser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> *&nbsp;</td>
          <td class="paramname"> <em>urih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a>&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>contentlength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03990">3990</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l03486">FORMAT_XML</a>, <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>, and <a class="el" href="tcptls_8h_source.html#l00139">ast_tcptls_session_instance::remote_address</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03991"></a>03991 {
<a name="l03992"></a>03992    <span class="keywordflow">return</span> <a class="code" href="manager_8c.html#a329d804fa86d5ccea431b91af21455f0">generic_http_callback</a>(<a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>, &amp;ser-&gt;<a class="code" href="structast__tcptls__session__instance.html#aa328808993fa36d65b987f07ede2e0a4">remote_address</a>, uri, method, params, <a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, title, contentlength);
<a name="l03993"></a>03993 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a47595f828e8f0e6b1faf176311417168"></a><!-- doxytag: member="manager.c::purge_old_stuff" ref="a47595f828e8f0e6b1faf176311417168" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void purge_old_stuff </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cleanup code called at each iteration of server_root, guaranteed to happen every 5 seconds at most </p>

<p>Definition at line <a class="el" href="manager_8c_source.html#l04033">4033</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l00349">purge_events()</a>, and <a class="el" href="manager_8c_source.html#l03246">purge_sessions()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04034"></a>04034 {
<a name="l04035"></a>04035    <a class="code" href="group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c" title="remove at most n_max stale session from the list.">purge_sessions</a>(1);
<a name="l04036"></a>04036    <a class="code" href="group__Group__AMI.html#ga0464e7b1c82d29cbe8b3f70bf7ca29c6">purge_events</a>();
<a name="l04037"></a>04037 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ec28372585ee6ad7dda7ee9426ad7b0"></a><!-- doxytag: member="manager.c::rawman_http_callback" ref="a7ec28372585ee6ad7dda7ee9426ad7b0" args="(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *params, struct ast_variable *headers, int *status, char **title, int *contentlength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structast__str.html">ast_str</a>* rawman_http_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *&nbsp;</td>
          <td class="paramname"> <em>ser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> *&nbsp;</td>
          <td class="paramname"> <em>urih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a>&nbsp;</td>
          <td class="paramname"> <em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>headers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>title</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>contentlength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03995">3995</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l03484">FORMAT_RAW</a>, <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>, and <a class="el" href="tcptls_8h_source.html#l00139">ast_tcptls_session_instance::remote_address</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03996"></a>03996 {
<a name="l03997"></a>03997    <span class="keywordflow">return</span> <a class="code" href="manager_8c.html#a329d804fa86d5ccea431b91af21455f0">generic_http_callback</a>(<a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>, &amp;ser-&gt;<a class="code" href="structast__tcptls__session__instance.html#aa328808993fa36d65b987f07ede2e0a4">remote_address</a>, uri, method, params, <a class="code" href="app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>, title, contentlength);
<a name="l03998"></a>03998 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a272b99cacf89996831cfd6dc5253d6e8"></a><!-- doxytag: member="manager.c::reload_manager" ref="a272b99cacf89996831cfd6dc5253d6e8" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int reload_manager </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called by Asterisk module functions and the CLI command. </p>

<p>Definition at line <a class="el" href="manager_8c_source.html#l04381">4381</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l00784">handle_manager_reload()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04382"></a>04382 {
<a name="l04383"></a>04383    <span class="keywordflow">return</span> <a class="code" href="manager_8c.html#a1d18fccb8dd1b468c17c0a89983b7d82">__init_manager</a>(1);
<a name="l04384"></a>04384 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a58d789617a4c4f4fb0ec8cef1147ea49"></a><!-- doxytag: member="manager.c::variable_count_cmp_fn" ref="a58d789617a4c4f4fb0ec8cef1147ea49" args="(void *obj, void *vstr, int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int variable_count_cmp_fn </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>vstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03665">3665</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00653">CMP_MATCH</a>, <a class="el" href="astobj2_8h_source.html#l00654">CMP_STOP</a>, <a class="el" href="app__jack_8c_source.html#l00142">str</a>, and <a class="el" href="manager_8c_source.html#l03636">variable_count::varname</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03704">xml_translate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03666"></a>03666 {
<a name="l03667"></a>03667    <span class="comment">/* Due to the simplicity of struct variable_count, it makes no difference</span>
<a name="l03668"></a>03668 <span class="comment">    * if you pass in objects or strings, the same operation applies. This is</span>
<a name="l03669"></a>03669 <span class="comment">    * due to the fact that the hash occurs on the first element, which means</span>
<a name="l03670"></a>03670 <span class="comment">    * the address of both the struct and the string are exactly the same. */</span>
<a name="l03671"></a>03671    <span class="keyword">struct </span><a class="code" href="structvariable__count.html">variable_count</a> *vc = obj;
<a name="l03672"></a>03672    <span class="keywordtype">char</span> *<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = vstr;
<a name="l03673"></a>03673    <span class="keywordflow">return</span> !strcmp(vc-&gt;<a class="code" href="structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a>, str) ? <a class="code" href="astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a> : 0;
<a name="l03674"></a>03674 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac8bebf364f7d11e1affc6c15dc7fd895"></a><!-- doxytag: member="manager.c::variable_count_hash_fn" ref="ac8bebf364f7d11e1affc6c15dc7fd895" args="(const void *vvc, const int flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int variable_count_hash_fn </td>
          <td>(</td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>vvc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>flags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03653">3653</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="manager_8c_source.html#l03640">compress_char()</a>, and <a class="el" href="manager_8c_source.html#l03636">variable_count::varname</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03704">xml_translate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03654"></a>03654 {
<a name="l03655"></a>03655    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structvariable__count.html">variable_count</a> *vc = vvc;
<a name="l03656"></a>03656    <span class="keywordtype">int</span> res = 0, i;
<a name="l03657"></a>03657    <span class="keywordflow">for</span> (i = 0; i &lt; 5; i++) {
<a name="l03658"></a>03658       <span class="keywordflow">if</span> (vc-&gt;<a class="code" href="structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a>[i] == <span class="charliteral">&apos;\0&apos;</span>)
<a name="l03659"></a>03659          <span class="keywordflow">break</span>;
<a name="l03660"></a>03660       res += <a class="code" href="manager_8c.html#aa8be2e22d4b4246e934cf0638aa0d095">compress_char</a>(vc-&gt;<a class="code" href="structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a>[i]) &lt;&lt; (i * 6);
<a name="l03661"></a>03661    }
<a name="l03662"></a>03662    <span class="keywordflow">return</span> res;
<a name="l03663"></a>03663 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3e1c1c66b6011486996f6ef543bd5313"></a><!-- doxytag: member="manager.c::xml_copy_escape" ref="a3e1c1c66b6011486996f6ef543bd5313" args="(struct ast_str **out, const char *src, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void xml_copy_escape </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__str.html">ast_str</a> **&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l03579">3579</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="strings_8h_source.html#l00846">ast_str_append()</a>, and <a class="el" href="adsistub_8c_source.html#l00059">buf</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03704">xml_translate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03580"></a>03580 {
<a name="l03581"></a>03581    <span class="comment">/* store in a local buffer to avoid calling ast_str_append too often */</span>
<a name="l03582"></a>03582    <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>[256];
<a name="l03583"></a>03583    <span class="keywordtype">char</span> *dst = buf;
<a name="l03584"></a>03584    <span class="keywordtype">int</span> space = <span class="keyword">sizeof</span>(buf);
<a name="l03585"></a>03585    <span class="comment">/* repeat until done and nothing to flush */</span>
<a name="l03586"></a>03586    <span class="keywordflow">for</span> ( ; *src || dst != buf ; src++) {
<a name="l03587"></a>03587       <span class="keywordflow">if</span> (*src == <span class="charliteral">&apos;\0&apos;</span> || space &lt; 10) {   <span class="comment">/* flush */</span>
<a name="l03588"></a>03588          *dst++ = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l03589"></a>03589          <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;%s&quot;</span>, buf);
<a name="l03590"></a>03590          dst = buf;
<a name="l03591"></a>03591          space = <span class="keyword">sizeof</span>(buf);
<a name="l03592"></a>03592          <span class="keywordflow">if</span> (*src == <span class="charliteral">&apos;\0&apos;</span>)
<a name="l03593"></a>03593             <span class="keywordflow">break</span>;
<a name="l03594"></a>03594       }
<a name="l03595"></a>03595          
<a name="l03596"></a>03596       <span class="keywordflow">if</span> ( (mode &amp; 2) &amp;&amp; !isalnum(*src)) {
<a name="l03597"></a>03597          *dst++ = <span class="charliteral">&apos;_&apos;</span>;
<a name="l03598"></a>03598          space--;
<a name="l03599"></a>03599          <span class="keywordflow">continue</span>;
<a name="l03600"></a>03600       }
<a name="l03601"></a>03601       <span class="keywordflow">switch</span> (*src) {
<a name="l03602"></a>03602       <span class="keywordflow">case</span> <span class="charliteral">&apos;&lt;&apos;</span>:
<a name="l03603"></a>03603          strcpy(dst, <span class="stringliteral">&quot;&amp;lt;&quot;</span>);
<a name="l03604"></a>03604          dst += 4;
<a name="l03605"></a>03605          space -= 4;
<a name="l03606"></a>03606          <span class="keywordflow">break</span>;
<a name="l03607"></a>03607       <span class="keywordflow">case</span> <span class="charliteral">&apos;&gt;&apos;</span>:
<a name="l03608"></a>03608          strcpy(dst, <span class="stringliteral">&quot;&amp;gt;&quot;</span>);
<a name="l03609"></a>03609          dst += 4;
<a name="l03610"></a>03610          space -= 4;
<a name="l03611"></a>03611          <span class="keywordflow">break</span>;
<a name="l03612"></a>03612       <span class="keywordflow">case</span> <span class="charliteral">&apos;\&quot;&apos;</span>:
<a name="l03613"></a>03613          strcpy(dst, <span class="stringliteral">&quot;&amp;quot;&quot;</span>);
<a name="l03614"></a>03614          dst += 6;
<a name="l03615"></a>03615          space -= 6;
<a name="l03616"></a>03616          <span class="keywordflow">break</span>;
<a name="l03617"></a>03617       <span class="keywordflow">case</span> <span class="charliteral">&apos;\&apos;&apos;</span>:
<a name="l03618"></a>03618          strcpy(dst, <span class="stringliteral">&quot;&amp;apos;&quot;</span>);
<a name="l03619"></a>03619          dst += 6;
<a name="l03620"></a>03620          space -= 6;
<a name="l03621"></a>03621          <span class="keywordflow">break</span>;
<a name="l03622"></a>03622       <span class="keywordflow">case</span> <span class="charliteral">&apos;&amp;&apos;</span>:
<a name="l03623"></a>03623          strcpy(dst, <span class="stringliteral">&quot;&amp;amp;&quot;</span>);
<a name="l03624"></a>03624          dst += 5;
<a name="l03625"></a>03625          space -= 5;
<a name="l03626"></a>03626          <span class="keywordflow">break</span>;
<a name="l03627"></a>03627 
<a name="l03628"></a>03628       <span class="keywordflow">default</span>:
<a name="l03629"></a>03629          *dst++ = mode ? tolower(*src) : *src;
<a name="l03630"></a>03630          space--;
<a name="l03631"></a>03631       }
<a name="l03632"></a>03632    }
<a name="l03633"></a>03633 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a35b1a18a306de254383a797e1e08bc55"></a><!-- doxytag: member="manager.c::xml_translate" ref="a35b1a18a306de254383a797e1e08bc55" args="(struct ast_str **out, char *in, struct ast_variable *vars, enum output_format format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void xml_translate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structast__str.html">ast_str</a> **&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="paramname"> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a>&nbsp;</td>
          <td class="paramname"> <em>format</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert the input into XML or HTML. The input is supposed to be a sequence of lines of the form Name: value optionally followed by a blob of unformatted text. A blank line is a section separator. Basically, this is a mixture of the format of Manager Interface and CLI commands. The unformatted text is considered as a single value of a field named 'Opaque-data'. </p>
<p>At the moment the output format is the following (but it may change depending on future requirements so don't count too much on it when writing applications):</p>
<p>General: the unformatted text is used as a value of XML output: to be completed</p>
<div class="fragment"><pre class="fragment">
 *   Each section is within &lt;response type="object" id="xxx"&gt;
 *   where xxx is taken from ajaxdest variable or defaults to unknown
 *   Each row is reported as an attribute Name="value" of an XML
 *   entity named from the variable ajaxobjtype, default to "generic"
 * </pre></div><p>HTML output: each Name-value pair is output as a single row of a two-column table. Sections (blank lines in the input) are separated by a <hr/>
 
<p>Definition at line <a class="el" href="manager_8c_source.html#l03704">3704</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>References <a class="el" href="astobj2_8h_source.html#l00413">ao2_alloc</a>, <a class="el" href="astobj2_8h_source.html#l00727">ao2_container_alloc</a>, <a class="el" href="astobj2_8h_source.html#l00968">ao2_find</a>, <a class="el" href="astobj2_8h_source.html#l00782">ao2_link</a>, <a class="el" href="astobj2_8h_source.html#l00459">ao2_ref</a>, <a class="el" href="logger_8h_source.html#l00213">ast_debug</a>, <a class="el" href="strings_8h_source.html#l00092">ast_skip_blanks()</a>, <a class="el" href="strings_8h_source.html#l00846">ast_str_append()</a>, <a class="el" href="strings_8h_source.html#l00063">ast_strlen_zero()</a>, <a class="el" href="strings_8h_source.html#l00117">ast_trim_blanks()</a>, <a class="el" href="manager_8c_source.html#l03637">variable_count::count</a>, <a class="el" href="manager_8c_source.html#l03486">FORMAT_XML</a>, <a class="el" href="config_8h_source.html#l00075">ast_variable::name</a>, <a class="el" href="config_8h_source.html#l00077">ast_variable::next</a>, <a class="el" href="agi_2strcompat_8c_source.html#l00027">strsep()</a>, <a class="el" href="config_8h_source.html#l00076">ast_variable::value</a>, <a class="el" href="ast__expr2f_8c_source.html#l00613">var</a>, <a class="el" href="manager_8c_source.html#l03665">variable_count_cmp_fn()</a>, <a class="el" href="manager_8c_source.html#l03653">variable_count_hash_fn()</a>, <a class="el" href="manager_8c_source.html#l03636">variable_count::varname</a>, and <a class="el" href="manager_8c_source.html#l03579">xml_copy_escape()</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03705"></a>03705 {
<a name="l03706"></a>03706    <span class="keyword">struct </span><a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *v;
<a name="l03707"></a>03707    <span class="keyword">const</span> <span class="keywordtype">char</span> *dest = NULL;
<a name="l03708"></a>03708    <span class="keywordtype">char</span> *<a class="code" href="ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, *<a class="code" href="structval.html">val</a>;
<a name="l03709"></a>03709    <span class="keyword">const</span> <span class="keywordtype">char</span> *objtype = NULL;
<a name="l03710"></a>03710    <span class="keywordtype">int</span> in_data = 0;  <span class="comment">/* parsing data */</span>
<a name="l03711"></a>03711    <span class="keywordtype">int</span> inobj = 0;
<a name="l03712"></a>03712    <span class="keywordtype">int</span> xml = (<a class="code" href="cdr__custom_8c.html#a2177723f86d0a496f395614f4493cd7f">format</a> == <a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>);
<a name="l03713"></a>03713    <span class="keyword">struct </span><a class="code" href="structvariable__count.html">variable_count</a> *vc = NULL;
<a name="l03714"></a>03714    <span class="keyword">struct </span><a class="code" href="structao2__container.html">ao2_container</a> *vco = NULL;
<a name="l03715"></a>03715 
<a name="l03716"></a>03716    <span class="keywordflow">for</span> (v = vars; v; v = v-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l03717"></a>03717       <span class="keywordflow">if</span> (!dest &amp;&amp; !strcasecmp(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ajaxdest&quot;</span>))
<a name="l03718"></a>03718          dest = v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;
<a name="l03719"></a>03719       <span class="keywordflow">else</span> if (!objtype &amp;&amp; !strcasecmp(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ajaxobjtype&quot;</span>))
<a name="l03720"></a>03720          objtype = v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;
<a name="l03721"></a>03721    }
<a name="l03722"></a>03722    <span class="keywordflow">if</span> (!dest)
<a name="l03723"></a>03723       dest = <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l03724"></a>03724    <span class="keywordflow">if</span> (!objtype)
<a name="l03725"></a>03725       objtype = <span class="stringliteral">&quot;generic&quot;</span>;
<a name="l03726"></a>03726 
<a name="l03727"></a>03727    <span class="comment">/* we want to stop when we find an empty line */</span>
<a name="l03728"></a>03728    <span class="keywordflow">while</span> (in &amp;&amp; *in) {
<a name="l03729"></a>03729       val = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;in, <span class="stringliteral">&quot;\r\n&quot;</span>); <span class="comment">/* mark start and end of line */</span>
<a name="l03730"></a>03730       <span class="keywordflow">if</span> (in &amp;&amp; *in == <span class="charliteral">&apos;\n&apos;</span>)     <span class="comment">/* remove trailing \n if any */</span>
<a name="l03731"></a>03731          in++;
<a name="l03732"></a>03732       <a class="code" href="strings_8h.html#ac5899ca9e586caf3041865762e770550" title="Trims trailing whitespace characters from a string.">ast_trim_blanks</a>(val);
<a name="l03733"></a>03733       <a class="code" href="logger_8h.html#a3f248112c8d6ce7e3959aa723dade648" title="Log a DEBUG message.">ast_debug</a>(5, <span class="stringliteral">&quot;inobj %d in_data %d line &lt;%s&gt;\n&quot;</span>, inobj, in_data, val);
<a name="l03734"></a>03734       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(val)) {
<a name="l03735"></a>03735          <span class="keywordflow">if</span> (in_data) { <span class="comment">/* close data */</span>
<a name="l03736"></a>03736             <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;&apos;&quot;</span> : <span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l03737"></a>03737             in_data = 0;
<a name="l03738"></a>03738          }
<a name="l03739"></a>03739          <span class="keywordflow">if</span> (inobj) {
<a name="l03740"></a>03740             <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot; /&gt;&lt;/response&gt;\n&quot;</span> :
<a name="l03741"></a>03741                <span class="stringliteral">&quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot;&gt;&lt;hr&gt;&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span>);
<a name="l03742"></a>03742             inobj = 0;
<a name="l03743"></a>03743             <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vco, -1);
<a name="l03744"></a>03744             vco = NULL;
<a name="l03745"></a>03745          }
<a name="l03746"></a>03746          <span class="keywordflow">continue</span>;
<a name="l03747"></a>03747       }
<a name="l03748"></a>03748 
<a name="l03749"></a>03749       <span class="comment">/* we expect Name: value lines */</span>
<a name="l03750"></a>03750       <span class="keywordflow">if</span> (in_data) {
<a name="l03751"></a>03751          var = NULL;
<a name="l03752"></a>03752       } <span class="keywordflow">else</span> {
<a name="l03753"></a>03753          var = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;val, <span class="stringliteral">&quot;:&quot;</span>);
<a name="l03754"></a>03754          <span class="keywordflow">if</span> (val) {  <span class="comment">/* found the field name */</span>
<a name="l03755"></a>03755             val = <a class="code" href="strings_8h.html#aba29020090d7b4238027c5746e7ad722" title="Gets a pointer to the first non-whitespace character in a string.">ast_skip_blanks</a>(val);
<a name="l03756"></a>03756             <a class="code" href="strings_8h.html#ac5899ca9e586caf3041865762e770550" title="Trims trailing whitespace characters from a string.">ast_trim_blanks</a>(var);
<a name="l03757"></a>03757          } <span class="keywordflow">else</span> {    <span class="comment">/* field name not found, move to opaque mode */</span>
<a name="l03758"></a>03758             val = var;
<a name="l03759"></a>03759             var = <span class="stringliteral">&quot;Opaque-data&quot;</span>;
<a name="l03760"></a>03760          }
<a name="l03761"></a>03761       }
<a name="l03762"></a>03762 
<a name="l03763"></a>03763       <span class="keywordflow">if</span> (!inobj) {
<a name="l03764"></a>03764          <span class="keywordflow">if</span> (xml)
<a name="l03765"></a>03765             <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;&lt;response type=&apos;object&apos; id=&apos;%s&apos;&gt;&lt;%s&quot;</span>, dest, objtype);
<a name="l03766"></a>03766          <span class="keywordflow">else</span>
<a name="l03767"></a>03767             <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;&lt;body&gt;\n&quot;</span>);
<a name="l03768"></a>03768          vco = <a class="code" href="astobj2_8h.html#a82534c91be59ec9a3d3318ec85ac5695">ao2_container_alloc</a>(37, <a class="code" href="manager_8c.html#ac8bebf364f7d11e1affc6c15dc7fd895">variable_count_hash_fn</a>, <a class="code" href="manager_8c.html#a58d789617a4c4f4fb0ec8cef1147ea49">variable_count_cmp_fn</a>);
<a name="l03769"></a>03769          inobj = 1;
<a name="l03770"></a>03770       }
<a name="l03771"></a>03771 
<a name="l03772"></a>03772       <span class="keywordflow">if</span> (!in_data) {   <span class="comment">/* build appropriate line start */</span>
<a name="l03773"></a>03773          <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot; &quot;</span> : <span class="stringliteral">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>);
<a name="l03774"></a>03774          <span class="keywordflow">if</span> ((vc = <a class="code" href="astobj2_8h.html#a618587b42226725315b96db394b13673">ao2_find</a>(vco, var, 0)))
<a name="l03775"></a>03775             vc-&gt;<a class="code" href="structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>++;
<a name="l03776"></a>03776          <span class="keywordflow">else</span> {
<a name="l03777"></a>03777             <span class="comment">/* Create a new entry for this one */</span>
<a name="l03778"></a>03778             vc = <a class="code" href="astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*vc), NULL);
<a name="l03779"></a>03779             vc-&gt;<a class="code" href="structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a> = var;
<a name="l03780"></a>03780             vc-&gt;<a class="code" href="structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> = 1;
<a name="l03781"></a>03781             <a class="code" href="astobj2_8h.html#a210544bdcc5afe0601d01d6e529c22d8">ao2_link</a>(vco, vc);
<a name="l03782"></a>03782          }
<a name="l03783"></a>03783          <a class="code" href="manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a>(out, var, xml ? 1 | 2 : 0);
<a name="l03784"></a>03784          <span class="keywordflow">if</span> (vc-&gt;<a class="code" href="structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> &gt; 1)
<a name="l03785"></a>03785             <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;-%d&quot;</span>, vc-&gt;<a class="code" href="structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);
<a name="l03786"></a>03786          <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vc, -1);
<a name="l03787"></a>03787          <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;=&apos;&quot;</span> : <span class="stringliteral">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>);
<a name="l03788"></a>03788          <span class="keywordflow">if</span> (!strcmp(var, <span class="stringliteral">&quot;Opaque-data&quot;</span>))
<a name="l03789"></a>03789             in_data = 1;
<a name="l03790"></a>03790       }
<a name="l03791"></a>03791       <a class="code" href="manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a>(out, val, 0); <span class="comment">/* data field */</span>
<a name="l03792"></a>03792       <span class="keywordflow">if</span> (!in_data)
<a name="l03793"></a>03793          <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;&apos;&quot;</span> : <span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);
<a name="l03794"></a>03794       <span class="keywordflow">else</span>
<a name="l03795"></a>03795          <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&quot;&lt;br&gt;\n&quot;</span>);
<a name="l03796"></a>03796    }
<a name="l03797"></a>03797    <span class="keywordflow">if</span> (inobj) {
<a name="l03798"></a>03798       <a class="code" href="strings_8h.html#a85cd5a8ef499e39d22b4bfeb8b9a64f7" title="Append to a thread local dynamic string.">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot; /&gt;&lt;/response&gt;\n&quot;</span> :
<a name="l03799"></a>03799          <span class="stringliteral">&quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot;&gt;&lt;hr&gt;&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span>);
<a name="l03800"></a>03800       <a class="code" href="astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vco, -1);
<a name="l03801"></a>03801    }
<a name="l03802"></a>03802 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a2ac502bd95ead52fb558fe72c16fc2e8"></a><!-- doxytag: member="manager.c::ami_desc" ref="a2ac502bd95ead52fb558fe72c16fc2e8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__tcptls__session__args.html">ast_tcptls_session_args</a> <a class="el" href="manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04040">4040</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="a0f80ee007271e5c19ce14fdf196d377b"></a><!-- doxytag: member="manager.c::ami_tls_cfg" ref="a0f80ee007271e5c19ce14fdf196d377b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__tls__config.html">ast_tls_config</a> <a class="el" href="manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04039">4039</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="a3b8da7be23f759b74fa78fca2356ea58"></a><!-- doxytag: member="manager.c::amis_desc" ref="a3b8da7be23f759b74fa78fca2356ea58" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__tcptls__session__args.html">ast_tcptls_session_args</a> <a class="el" href="manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04051">4051</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="ae93b19979f76ef4c841d10b58d24b149"></a><!-- doxytag: member="manager.c::contenttype" ref="ae93b19979f76ef4c841d10b58d24b149" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="manager_8c.html#ae93b19979f76ef4c841d10b58d24b149">contenttype</a>[]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
   [<a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>] = <span class="stringliteral">&quot;plain&quot;</span>,
   [<a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>] = <span class="stringliteral">&quot;html&quot;</span>,
   [<a class="code" href="manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>] =  <span class="stringliteral">&quot;xml&quot;</span>,
}
</pre></div>
<p>Definition at line <a class="el" href="manager_8c_source.html#l03489">3489</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l03804">generic_http_callback()</a>.</p>

</div>
</div>
<a class="anchor" id="a7df8bb3a46439212b942a1802e5fa167"></a><!-- doxytag: member="manager.c::manageruri" ref="a7df8bb3a46439212b942a1802e5fa167" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> <a class="el" href="manager_8c.html#a7df8bb3a46439212b942a1802e5fa167">manageruri</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04009">4009</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="a2baf609069e59000350384fc6d5e2e48"></a><!-- doxytag: member="manager.c::managerxmluri" ref="a2baf609069e59000350384fc6d5e2e48" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> <a class="el" href="manager_8c.html#a2baf609069e59000350384fc6d5e2e48">managerxmluri</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04018">4018</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="acbf2cba285ffaf8ad7040ee38da09c54"></a><!-- doxytag: member="manager.c::rawmanuri" ref="acbf2cba285ffaf8ad7040ee38da09c54" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__http__uri.html">ast_http_uri</a> <a class="el" href="manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54">rawmanuri</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04000">4000</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="a995fb73070b544ea93cbc8b4552a44b0"></a><!-- doxytag: member="manager.c::registered" ref="a995fb73070b544ea93cbc8b4552a44b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="manager_8c.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04027">4027</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="ae2bb15afe29e63b72c564aa73ce69f23"></a><!-- doxytag: member="manager.c::webregged" ref="ae2bb15afe29e63b72c564aa73ce69f23" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a> = 0<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l04028">4028</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l04061">__init_manager()</a>.</p>

</div>
</div>
<a class="anchor" id="a5faa4602a940792af415e7372e66f86a"></a><!-- doxytag: member="manager.c::words" ref="a5faa4602a940792af415e7372e66f86a" args="[AST_MAX_CMD_LEN]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="manager_8c.html#a5faa4602a940792af415e7372e66f86a">words</a>[AST_MAX_CMD_LEN]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manager_8c_source.html#l00145">145</a> of file <a class="el" href="manager_8c_source.html">manager.c</a>.</p>

<p>Referenced by <a class="el" href="manager_8c_source.html#l02216">check_blacklist()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:22:22 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
