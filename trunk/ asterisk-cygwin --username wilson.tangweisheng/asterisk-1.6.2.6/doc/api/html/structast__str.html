<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:23:41 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structure&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ast_str Struct Reference</h1><!-- doxytag: class="ast_str" -->
<p>The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field to indicate the type of storage. Three special constants indicate malloc, alloca() or static variables, all other <a class="el" href="structvalues.html">values</a> indicate a struct <a class="el" href="structast__threadstorage.html" title="data for a thread locally stored variable">ast_threadstorage</a> pointer.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="strings_8h_source.html">strings.h</a>&gt;</code></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__str.html#aa267a036c77c703cb494286a049d624b">__AST_STR_LEN</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__str.html#a502643f03592ad00c4216e337a27b3d8">__AST_STR_STR</a> [0]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__str.html#ac0f4c76f6cddc0e88aeb69e414b10017">__AST_STR_TS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__str.html#a7acf1b4de87eb325127bcbb90be35d71">__AST_STR_USED</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field to indicate the type of storage. Three special constants indicate malloc, alloca() or static variables, all other <a class="el" href="structvalues.html">values</a> indicate a struct <a class="el" href="structast__threadstorage.html" title="data for a thread locally stored variable">ast_threadstorage</a> pointer. </p>
<p>Support for dynamic strings.</p>
<p>A dynamic string is just a C string prefixed by a few control fields that help setting/appending/extending it using a printf-like syntax.</p>
<p>One should never declare a variable with this type, but only a pointer to it, e.g.</p>
<p>struct <a class="el" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a> *ds;</p>
<p>The pointer can be initialized with the following:</p>
<p>ds = ast_str_create(init_len); creates a <a class="el" href="astmm_8h.html#ab8b25cd8f16d4a6552afe4e65c4f082d">malloc()</a>'ed dynamic string;</p>
<p>ds = <a class="el" href="strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca(init_len)</a>; creates a string on the stack (not very dynamic!).</p>
<p>ds = ast_str_thread_get(ts, init_len) creates a <a class="el" href="astmm_8h.html#ab8b25cd8f16d4a6552afe4e65c4f082d">malloc()</a>'ed dynamic string associated to the thread-local storage key ts</p>
<p>Finally, the string can be manipulated with the following:</p>
<p>ast_str_set(&amp;buf, max_len, fmt, ...) ast_str_append(&amp;buf, max_len, fmt, ...)</p>
<p>and their varargs variant</p>
<p>ast_str_set_va(&amp;buf, max_len, ap) ast_str_append_va(&amp;buf, max_len, ap)</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>max_len</em>&nbsp;</td><td>The maximum allowed capacity of the <a class="el" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a>. Note that if the value of max_len is less than the current capacity of the <a class="el" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a> (as returned by ast_str_size), then the parameter is effectively ignored. 0 means unlimited, -1 means "at most the available space"</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>All the functions return &lt;0 in case of error, or the length of the string added to the buffer otherwise. Note that in most cases where an error is returned, characters ARE written to the <a class="el" href="structast__str.html" title="The descriptor of a dynamic string XXX storage will be optimized later if needed...">ast_str</a>. </dd></dl>

<p>Definition at line <a class="el" href="strings_8h_source.html#l00359">359</a> of file <a class="el" href="strings_8h_source.html">strings.h</a>.</p>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="aa267a036c77c703cb494286a049d624b"></a><!-- doxytag: member="ast_str::__AST_STR_LEN" ref="aa267a036c77c703cb494286a049d624b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="structast__str.html#aa267a036c77c703cb494286a049d624b">__AST_STR_LEN</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The current maximum length of the string </p>

<p>Definition at line <a class="el" href="strings_8h_source.html#l00360">360</a> of file <a class="el" href="strings_8h_source.html">strings.h</a>.</p>

<p>Referenced by <a class="el" href="strings_8c_source.html#l00125">__ast_str_helper2()</a>, <a class="el" href="strings_8h_source.html#l00415">ast_str_create()</a>, <a class="el" href="strings_8h_source.html#l00466">ast_str_strlen()</a>, and <a class="el" href="strings_8h_source.html#l00637">ast_str_thread_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a502643f03592ad00c4216e337a27b3d8"></a><!-- doxytag: member="ast_str::__AST_STR_STR" ref="a502643f03592ad00c4216e337a27b3d8" args="[0]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="structast__str.html#a502643f03592ad00c4216e337a27b3d8">__AST_STR_STR</a>[0]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The string buffer </p>

<p>Definition at line <a class="el" href="strings_8h_source.html#l00366">366</a> of file <a class="el" href="strings_8h_source.html">strings.h</a>.</p>

<p>Referenced by <a class="el" href="strings_8h_source.html#l00488">ast_str_buffer()</a>, <a class="el" href="strings_8h_source.html#l00415">ast_str_create()</a>, <a class="el" href="strings_8h_source.html#l00431">ast_str_reset()</a>, <a class="el" href="strings_8h_source.html#l00477">ast_str_size()</a>, and <a class="el" href="strings_8h_source.html#l00441">ast_str_update()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0f4c76f6cddc0e88aeb69e414b10017"></a><!-- doxytag: member="ast_str::__AST_STR_TS" ref="ac0f4c76f6cddc0e88aeb69e414b10017" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structast__threadstorage.html">ast_threadstorage</a>* <a class="el" href="structast__str.html#ac0f4c76f6cddc0e88aeb69e414b10017">__AST_STR_TS</a><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>What kind of storage is this ? </p>

<p>Definition at line <a class="el" href="strings_8h_source.html#l00362">362</a> of file <a class="el" href="strings_8h_source.html">strings.h</a>.</p>

<p>Referenced by <a class="el" href="strings_8h_source.html#l00637">ast_str_thread_get()</a>.</p>

</div>
</div>
<a class="anchor" id="a7acf1b4de87eb325127bcbb90be35d71"></a><!-- doxytag: member="ast_str::__AST_STR_USED" ref="a7acf1b4de87eb325127bcbb90be35d71" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t <a class="el" href="structast__str.html#a7acf1b4de87eb325127bcbb90be35d71">__AST_STR_USED</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Amount of space used </p>

<p>Definition at line <a class="el" href="strings_8h_source.html#l00361">361</a> of file <a class="el" href="strings_8h_source.html">strings.h</a>.</p>

<p>Referenced by <a class="el" href="strings_8h_source.html#l00488">ast_str_buffer()</a>, <a class="el" href="strings_8h_source.html#l00415">ast_str_create()</a>, <a class="el" href="strings_8h_source.html#l00431">ast_str_reset()</a>, <a class="el" href="strings_8h_source.html#l00637">ast_str_thread_get()</a>, <a class="el" href="strings_8h_source.html#l00456">ast_str_trim_blanks()</a>, and <a class="el" href="strings_8h_source.html#l00441">ast_str_update()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="strings_8h_source.html">strings.h</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:23:41 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
