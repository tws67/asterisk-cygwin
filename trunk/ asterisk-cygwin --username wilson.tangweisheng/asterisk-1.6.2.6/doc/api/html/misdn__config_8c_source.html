<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (5 May 2010)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Wed May 5 15:18:43 2010</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_0ca6ff3bf6b340411b2c6edd15b1a34d.html">channels</a>
  </div>
</div>
<div class="contents">
<h1>misdn_config.c</h1><a href="misdn__config_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Asterisk -- An open source telephony toolkit.</span>
<a name="l00003"></a>00003 <span class="comment"> * </span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (C) 2005, Christian Richter</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Christian Richter &lt;crich@beronet.com&gt;</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * See http://www.asterisk.org for more information about</span>
<a name="l00009"></a>00009 <span class="comment"> * the Asterisk project. Please do not directly contact</span>
<a name="l00010"></a>00010 <span class="comment"> * any of the maintainers of this project for assistance;</span>
<a name="l00011"></a>00011 <span class="comment"> * the project provides a web site, mailing lists and IRC</span>
<a name="l00012"></a>00012 <span class="comment"> * channels for your use.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * This program is free software, distributed under the terms of</span>
<a name="l00015"></a>00015 <span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span>
<a name="l00016"></a>00016 <span class="comment"> * at the top of the source tree.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> */</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">/*!</span>
<a name="l00021"></a>00021 <span class="comment"> * \file</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * \brief chan_misdn configuration management</span>
<a name="l00024"></a>00024 <span class="comment"> * \author Christian Richter &lt;crich@beronet.com&gt;</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> * \ingroup channel_drivers</span>
<a name="l00027"></a>00027 <span class="comment"> */</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions.">asterisk.h</a>&quot;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <a class="code" href="asterisk_8h.html#ab0390be60f8c539a2662df2faf9985c7" title="Register/unregister a source code file with the core.">ASTERISK_FILE_VERSION</a>(__FILE__, <span class="stringliteral">&quot;$Revision: 249895 $&quot;</span>)
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;chan_misdn_config.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="config_8h.html" title="Configuration File Parser.">asterisk/config.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="channel_8h.html" title="General Asterisk PBX channel definitions.">asterisk/channel.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="lock_8h.html" title="Asterisk locking-related definitions:ast_mutext_t, ast_rwlock_t and related functions;atomic...">asterisk/lock.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="pbx_8h.html" title="Core PBX routines and definitions.">asterisk/pbx.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="strings_8h.html" title="String manipulation functions.">asterisk/strings.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html" title="Utility functions.">asterisk/utils.h</a>&quot;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">00042</a> <span class="preprocessor">#define NO_DEFAULT &quot;&lt;&gt;&quot;</span>
<a name="l00043"></a><a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define NONE 0</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a><a class="code" href="misdn__config_8c.html#ac83a664de90770af20fa45e23a2f6a0b">00045</a> <span class="preprocessor">#define GEN_CFG 1</span>
<a name="l00046"></a><a class="code" href="misdn__config_8c.html#af239c62f325c4a450832ba971ad30594">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define PORT_CFG 2</span>
<a name="l00047"></a><a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define NUM_GEN_ELEMENTS (sizeof(gen_spec) / sizeof(struct misdn_cfg_spec))</span>
<a name="l00048"></a><a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define NUM_PORT_ELEMENTS (sizeof(port_spec) / sizeof(struct misdn_cfg_spec))</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00050"></a>00050 <span class="comment">/*! Global jitterbuffer configuration - by default, jb is disabled */</span>
<a name="l00051"></a><a class="code" href="misdn__config_8c.html#a2d8d5920e90ccbad7832926becdadb29">00051</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structast__jb__conf.html" title="General jitterbuffer configuration.">ast_jb_conf</a> <a class="code" href="misdn__config_8c.html#a2d8d5920e90ccbad7832926becdadb29">default_jbconf</a> =
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053    .<a class="code" href="structast__jb__conf.html#ac92588540e8c1d014a08cd8a45462b19" title="Combination of the AST_JB_ENABLED, AST_JB_FORCED and AST_JB_LOG flags.">flags</a> = 0,
<a name="l00054"></a>00054    .max_size = -1,
<a name="l00055"></a>00055    .resync_threshold = -1,
<a name="l00056"></a>00056    .impl = <span class="stringliteral">&quot;&quot;</span>,
<a name="l00057"></a>00057    .target_extra = -1,
<a name="l00058"></a>00058 };
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="misdn__config_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">00060</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structast__jb__conf.html" title="General jitterbuffer configuration.">ast_jb_conf</a> <a class="code" href="misdn__config_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>;
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1">00062</a> <span class="keyword">enum</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1">misdn_cfg_type</a> {
<a name="l00063"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">00063</a>    <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>,
<a name="l00064"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">00064</a>    <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>,
<a name="l00065"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">00065</a>    <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>,
<a name="l00066"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">00066</a>    <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>,
<a name="l00067"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a1b4b4bec0d3721002c16eb2d28fab14c">00067</a>    <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a1b4b4bec0d3721002c16eb2d28fab14c">MISDN_CTYPE_MSNLIST</a>,
<a name="l00068"></a><a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a40c3b08f125c2ddf122150790302f80b">00068</a>    <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a40c3b08f125c2ddf122150790302f80b">MISDN_CTYPE_ASTGROUP</a>
<a name="l00069"></a>00069 };
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="structmsn__list.html">00071</a> <span class="keyword">struct </span><a class="code" href="structmsn__list.html">msn_list</a> {
<a name="l00072"></a><a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">00072</a>    <span class="keywordtype">char</span> *<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>;
<a name="l00073"></a><a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">00073</a>    <span class="keyword">struct </span><a class="code" href="structmsn__list.html">msn_list</a> *<a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">next</a>;
<a name="l00074"></a>00074 };
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="unionmisdn__cfg__pt.html">00076</a> <span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> {
<a name="l00077"></a><a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">00077</a>    <span class="keywordtype">char</span> *<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>;
<a name="l00078"></a><a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">00078</a>    <span class="keywordtype">int</span> *<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>;
<a name="l00079"></a><a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">00079</a>    <span class="keyword">struct </span><a class="code" href="structmsn__list.html">msn_list</a> *<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>;
<a name="l00080"></a><a class="code" href="unionmisdn__cfg__pt.html#af18db33a9880bbb832e539ff639b0411">00080</a>    <a class="code" href="channel_8h.html#a641d81d0c5c8df99d43eff69aede3bfd">ast_group_t</a> *<a class="code" href="unionmisdn__cfg__pt.html#af18db33a9880bbb832e539ff639b0411">grp</a>;
<a name="l00081"></a><a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">00081</a>    <span class="keywordtype">void</span> *<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a>;
<a name="l00082"></a>00082 };
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="structmisdn__cfg__spec.html">00084</a> <span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> {
<a name="l00085"></a><a class="code" href="structmisdn__cfg__spec.html#a15ac20622176e779d3d9796447973771">00085</a>    <span class="keywordtype">char</span> <a class="code" href="structmisdn__cfg__spec.html#a15ac20622176e779d3d9796447973771">name</a>[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>];
<a name="l00086"></a><a class="code" href="structmisdn__cfg__spec.html#a1865504fb01a2e4ec328ccb0699f5a36">00086</a>    <span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3a">misdn_cfg_elements</a> <a class="code" href="structmisdn__cfg__spec.html#a1865504fb01a2e4ec328ccb0699f5a36">elem</a>;
<a name="l00087"></a><a class="code" href="structmisdn__cfg__spec.html#a88b351b6cfc442e1679c9537bca61cab">00087</a>    <span class="keyword">enum</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1">misdn_cfg_type</a> <a class="code" href="structmisdn__cfg__spec.html#a88b351b6cfc442e1679c9537bca61cab">type</a>;
<a name="l00088"></a><a class="code" href="structmisdn__cfg__spec.html#a06df8b8b6c73d221965c28812a1c149e">00088</a>    <span class="keywordtype">char</span> <a class="code" href="structmisdn__cfg__spec.html#a06df8b8b6c73d221965c28812a1c149e">def</a>[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>];
<a name="l00089"></a><a class="code" href="structmisdn__cfg__spec.html#a8d928300435d8100e57a316008d390b7">00089</a>    <span class="keywordtype">int</span> <a class="code" href="structmisdn__cfg__spec.html#a8d928300435d8100e57a316008d390b7">boolint_def</a>;
<a name="l00090"></a><a class="code" href="structmisdn__cfg__spec.html#a045dfbfa7e9fff67e2ad56674f8a403c">00090</a>    <span class="keywordtype">char</span> <a class="code" href="structmisdn__cfg__spec.html#a045dfbfa7e9fff67e2ad56674f8a403c">desc</a>[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>];
<a name="l00091"></a>00091 };
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="misdn__config_8c.html#a0e04b70145d8bfed373b2341bffb78b8">00094</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="misdn__config_8c.html#a0e04b70145d8bfed373b2341bffb78b8">ports_description</a>[] =
<a name="l00095"></a>00095    <span class="stringliteral">&quot;Define your ports, e.g. 1,2 (depends on mISDN-driver loading order).&quot;</span>;
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="misdn__config_8c.html#ab39610cf57f36b653b2f73c7a2f44175">00097</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> <a class="code" href="misdn__config_8c.html#ab39610cf57f36b653b2f73c7a2f44175">port_spec</a>[] = {
<a name="l00098"></a>00098    { <span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;default&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00099"></a>00099       <span class="stringliteral">&quot;Name of the portgroup.&quot;</span> },
<a name="l00100"></a>00100    { <span class="stringliteral">&quot;allowed_bearers&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa0fc9a3291b3570d7ae4ff6509e3c4175">MISDN_CFG_ALLOWED_BEARERS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;all&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00101"></a>00101       <span class="stringliteral">&quot;Here you can list which bearer capabilities should be allowed:\n&quot;</span>
<a name="l00102"></a>00102       <span class="stringliteral">&quot;\t  all                  - allow any bearer capability\n&quot;</span>
<a name="l00103"></a>00103       <span class="stringliteral">&quot;\t  speech               - allow speech\n&quot;</span>
<a name="l00104"></a>00104       <span class="stringliteral">&quot;\t  3_1khz               - allow 3.1KHz audio\n&quot;</span>
<a name="l00105"></a>00105       <span class="stringliteral">&quot;\t  digital_unrestricted - allow unrestricted digital\n&quot;</span>
<a name="l00106"></a>00106       <span class="stringliteral">&quot;\t  digital_restricted   - allow restricted digital\n&quot;</span>
<a name="l00107"></a>00107       <span class="stringliteral">&quot;\t  video                - allow video&quot;</span> },
<a name="l00108"></a>00108    { <span class="stringliteral">&quot;rxgain&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa28b6ec109ef1c2e3d2a4852e05eb286e">MISDN_CFG_RXGAIN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00109"></a>00109       <span class="stringliteral">&quot;Set this between -8 and 8 to change the RX Gain.&quot;</span> },
<a name="l00110"></a>00110    { <span class="stringliteral">&quot;txgain&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa79ed1457f88463d9b7f0a620edf91f87">MISDN_CFG_TXGAIN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00111"></a>00111       <span class="stringliteral">&quot;Set this between -8 and 8 to change the TX Gain.&quot;</span> },
<a name="l00112"></a>00112    { <span class="stringliteral">&quot;te_choose_channel&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa51fc893ce032204f67eb70f7d6149c69">MISDN_CFG_TE_CHOOSE_CHANNEL</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00113"></a>00113       <span class="stringliteral">&quot;Some telcos especially in NL seem to need this set to yes,\n&quot;</span>
<a name="l00114"></a>00114       <span class="stringliteral">&quot;\talso in Switzerland this seems to be important.&quot;</span> },
<a name="l00115"></a>00115    { <span class="stringliteral">&quot;far_alerting&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa3378ea921d35f1a8db7c2e9d4b728ed1">MISDN_CFG_FAR_ALERTING</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00116"></a>00116       <span class="stringliteral">&quot;If we should generate ringing for chan_sip and others.&quot;</span> },
<a name="l00117"></a>00117    { <span class="stringliteral">&quot;pmp_l1_check&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa64335a712087c9b8d9895fa30febcf64">MISDN_CFG_PMP_L1_CHECK</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00118"></a>00118       <span class="stringliteral">&quot;This option defines, if chan_misdn should check the L1 on a PMP\n&quot;</span>
<a name="l00119"></a>00119       <span class="stringliteral">&quot;\tbefore making a group call on it. The L1 may go down for PMP Ports\n&quot;</span>
<a name="l00120"></a>00120       <span class="stringliteral">&quot;\tso we might need this.\n&quot;</span>
<a name="l00121"></a>00121       <span class="stringliteral">&quot;\tBut be aware! a broken or plugged off cable might be used for a group call\n&quot;</span>
<a name="l00122"></a>00122       <span class="stringliteral">&quot;\tas well, since chan_misdn has no chance to distinguish if the L1 is down\n&quot;</span>
<a name="l00123"></a>00123       <span class="stringliteral">&quot;\tbecause of a lost Link or because the Provider shut it down...&quot;</span> },
<a name="l00124"></a>00124    { <span class="stringliteral">&quot;block_on_alarm&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa2a00b1227ee6580b8e844fef837e7b84">MISDN_CFG_ALARM_BLOCK</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a> ,
<a name="l00125"></a>00125      <span class="stringliteral">&quot;Block this port if we have an alarm on it.&quot;</span> },
<a name="l00126"></a>00126    { <span class="stringliteral">&quot;hdlc&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa3fc00b937ced5f7098458c4336dd7090">MISDN_CFG_HDLC</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00127"></a>00127       <span class="stringliteral">&quot;Set this to yes, if you want to bridge a mISDN data channel to\n&quot;</span>
<a name="l00128"></a>00128       <span class="stringliteral">&quot;\tanother channel type or to an application.&quot;</span> },
<a name="l00129"></a>00129    { <span class="stringliteral">&quot;context&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabaf5dd0190bcf5e7f1eb97eabdda2825">MISDN_CFG_CONTEXT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;default&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00130"></a>00130       <span class="stringliteral">&quot;Context to use for incoming calls.&quot;</span> },
<a name="l00131"></a>00131    { <span class="stringliteral">&quot;language&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa53656db2e4faebc5aa1430b3a5560e67">MISDN_CFG_LANGUAGE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;en&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00132"></a>00132       <span class="stringliteral">&quot;Language.&quot;</span> },
<a name="l00133"></a>00133    { <span class="stringliteral">&quot;musicclass&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaa0290565a9bb7788123e3146f947829e">MISDN_CFG_MUSICCLASS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;default&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00134"></a>00134       <span class="stringliteral">&quot;Sets the musiconhold class.&quot;</span> },
<a name="l00135"></a>00135    { <span class="stringliteral">&quot;callerid&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaa04f72918b990207c9b90096462bd6de">MISDN_CFG_CALLERID</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00136"></a>00136       <span class="stringliteral">&quot;Sets the caller ID.&quot;</span> },
<a name="l00137"></a>00137    { <span class="stringliteral">&quot;method&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa987f6cab53c31e4d59eb76f485d7cf14">MISDN_CFG_METHOD</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;standard&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00138"></a>00138       <span class="stringliteral">&quot;Set the method to use for channel selection:\n&quot;</span>
<a name="l00139"></a>00139       <span class="stringliteral">&quot;\t  standard     - Use the first free channel starting from the lowest number.\n&quot;</span>
<a name="l00140"></a>00140       <span class="stringliteral">&quot;\t  standard_dec - Use the first free channel starting from the highest number.\n&quot;</span>
<a name="l00141"></a>00141       <span class="stringliteral">&quot;\t  round_robin  - Use the round robin algorithm to select a channel. Use this\n&quot;</span>
<a name="l00142"></a>00142       <span class="stringliteral">&quot;\t                 if you want to balance your load.&quot;</span> },
<a name="l00143"></a>00143    { <span class="stringliteral">&quot;dialplan&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa6beababcb69d8c4125f07df481846ba4">MISDN_CFG_DIALPLAN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00144"></a>00144       <span class="stringliteral">&quot;Dialplan means Type Of Number in ISDN Terms (for outgoing calls)\n&quot;</span>
<a name="l00145"></a>00145       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00146"></a>00146       <span class="stringliteral">&quot;\tThere are different types of the dialplan:\n&quot;</span>
<a name="l00147"></a>00147       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00148"></a>00148       <span class="stringliteral">&quot;\tdialplan -&gt; outgoing Number\n&quot;</span>
<a name="l00149"></a>00149       <span class="stringliteral">&quot;\tlocaldialplan -&gt; callerid\n&quot;</span>
<a name="l00150"></a>00150       <span class="stringliteral">&quot;\tcpndialplan -&gt; connected party number\n&quot;</span>
<a name="l00151"></a>00151       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00152"></a>00152       <span class="stringliteral">&quot;\tdialplan options:\n&quot;</span>
<a name="l00153"></a>00153       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00154"></a>00154       <span class="stringliteral">&quot;\t0 - unknown\n&quot;</span>
<a name="l00155"></a>00155       <span class="stringliteral">&quot;\t1 - International\n&quot;</span>
<a name="l00156"></a>00156       <span class="stringliteral">&quot;\t2 - National\n&quot;</span>
<a name="l00157"></a>00157       <span class="stringliteral">&quot;\t4 - Subscriber\n&quot;</span>
<a name="l00158"></a>00158       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00159"></a>00159       <span class="stringliteral">&quot;\tThis setting is used for outgoing calls.&quot;</span> },
<a name="l00160"></a>00160    { <span class="stringliteral">&quot;localdialplan&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaf91e0f4ad7302b0e9446ef3367ef9fd1">MISDN_CFG_LOCALDIALPLAN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00161"></a>00161       <span class="stringliteral">&quot;Dialplan means Type Of Number in ISDN Terms (for outgoing calls)\n&quot;</span>
<a name="l00162"></a>00162       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00163"></a>00163       <span class="stringliteral">&quot;\tThere are different types of the dialplan:\n&quot;</span>
<a name="l00164"></a>00164       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00165"></a>00165       <span class="stringliteral">&quot;\tdialplan -&gt; outgoing Number\n&quot;</span>
<a name="l00166"></a>00166       <span class="stringliteral">&quot;\tlocaldialplan -&gt; callerid\n&quot;</span>
<a name="l00167"></a>00167       <span class="stringliteral">&quot;\tcpndialplan -&gt; connected party number\n&quot;</span>
<a name="l00168"></a>00168       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00169"></a>00169       <span class="stringliteral">&quot;\tdialplan options:\n&quot;</span>
<a name="l00170"></a>00170       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00171"></a>00171       <span class="stringliteral">&quot;\t0 - unknown\n&quot;</span>
<a name="l00172"></a>00172       <span class="stringliteral">&quot;\t1 - International\n&quot;</span>
<a name="l00173"></a>00173       <span class="stringliteral">&quot;\t2 - National\n&quot;</span>
<a name="l00174"></a>00174       <span class="stringliteral">&quot;\t4 - Subscriber\n&quot;</span>
<a name="l00175"></a>00175       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00176"></a>00176       <span class="stringliteral">&quot;\tThis setting is used for outgoing calls.&quot;</span> },
<a name="l00177"></a>00177    { <span class="stringliteral">&quot;cpndialplan&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa92b890538b4c95499a88ab65a2052bdb">MISDN_CFG_CPNDIALPLAN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00178"></a>00178       <span class="stringliteral">&quot;Dialplan means Type Of Number in ISDN Terms (for outgoing calls)\n&quot;</span>
<a name="l00179"></a>00179       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00180"></a>00180       <span class="stringliteral">&quot;\tThere are different types of the dialplan:\n&quot;</span>
<a name="l00181"></a>00181       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00182"></a>00182       <span class="stringliteral">&quot;\tdialplan -&gt; outgoing Number\n&quot;</span>
<a name="l00183"></a>00183       <span class="stringliteral">&quot;\tlocaldialplan -&gt; callerid\n&quot;</span>
<a name="l00184"></a>00184       <span class="stringliteral">&quot;\tcpndialplan -&gt; connected party number\n&quot;</span>
<a name="l00185"></a>00185       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00186"></a>00186       <span class="stringliteral">&quot;\tdialplan options:\n&quot;</span>
<a name="l00187"></a>00187       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00188"></a>00188       <span class="stringliteral">&quot;\t0 - unknown\n&quot;</span>
<a name="l00189"></a>00189       <span class="stringliteral">&quot;\t1 - International\n&quot;</span>
<a name="l00190"></a>00190       <span class="stringliteral">&quot;\t2 - National\n&quot;</span>
<a name="l00191"></a>00191       <span class="stringliteral">&quot;\t4 - Subscriber\n&quot;</span>
<a name="l00192"></a>00192       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00193"></a>00193       <span class="stringliteral">&quot;\tThis setting is used for outgoing calls.&quot;</span> },
<a name="l00194"></a>00194    { <span class="stringliteral">&quot;nationalprefix&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa7da865040af68c081f3e0d0e2cf024b4">MISDN_CFG_NATPREFIX</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00195"></a>00195       <span class="stringliteral">&quot;Prefix for national, this is put before the\n&quot;</span>
<a name="l00196"></a>00196       <span class="stringliteral">&quot;\toad if an according dialplan is set by the other end.&quot;</span> },
<a name="l00197"></a>00197    { <span class="stringliteral">&quot;internationalprefix&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa480f3d235461dc11476e5097f6c9c558">MISDN_CFG_INTERNATPREFIX</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;00&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00198"></a>00198       <span class="stringliteral">&quot;Prefix for international, this is put before the\n&quot;</span>
<a name="l00199"></a>00199       <span class="stringliteral">&quot;\toad if an according dialplan is set by the other end.&quot;</span> },
<a name="l00200"></a>00200    { <span class="stringliteral">&quot;presentation&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa081eefea700315bc374c8e412810eb19">MISDN_CFG_PRES</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;-1&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00201"></a>00201       <span class="stringliteral">&quot;These (presentation and screen) are the exact isdn screening and presentation\n&quot;</span>
<a name="l00202"></a>00202       <span class="stringliteral">&quot;\tindicators.\n&quot;</span>
<a name="l00203"></a>00203       <span class="stringliteral">&quot;\tIf -1 is given for either value, the presentation indicators are used from\n&quot;</span>
<a name="l00204"></a>00204       <span class="stringliteral">&quot;\tAsterisk&apos;s CALLERPRES function.\n&quot;</span>
<a name="l00205"></a>00205       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00206"></a>00206       <span class="stringliteral">&quot;\tscreen=0, presentation=0 -&gt; callerid presented\n&quot;</span>
<a name="l00207"></a>00207       <span class="stringliteral">&quot;\tscreen=1, presentation=1 -&gt; callerid restricted (the remote end doesn&apos;t see it!)&quot;</span> },
<a name="l00208"></a>00208    { <span class="stringliteral">&quot;screen&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaee3e055a6155d455c07900e0d6e5bbca">MISDN_CFG_SCREEN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;-1&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00209"></a>00209       <span class="stringliteral">&quot;These (presentation and screen) are the exact isdn screening and presentation\n&quot;</span>
<a name="l00210"></a>00210       <span class="stringliteral">&quot;\tindicators.\n&quot;</span>
<a name="l00211"></a>00211       <span class="stringliteral">&quot;\tIf -1 is given for either value, the presentation indicators are used from\n&quot;</span>
<a name="l00212"></a>00212       <span class="stringliteral">&quot;\tAsterisk&apos;s CALLERPRES function.\n&quot;</span>
<a name="l00213"></a>00213       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00214"></a>00214       <span class="stringliteral">&quot;\tscreen=0, presentation=0 -&gt; callerid presented\n&quot;</span>
<a name="l00215"></a>00215       <span class="stringliteral">&quot;\tscreen=1, presentation=1 -&gt; callerid restricted (the remote end doesn&apos;t see it!)&quot;</span> },
<a name="l00216"></a>00216    { <span class="stringliteral">&quot;always_immediate&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaf9368cd93cfd0d4ec714e920a9587c41">MISDN_CFG_ALWAYS_IMMEDIATE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00217"></a>00217       <span class="stringliteral">&quot;Enable this to get into the s dialplan-extension.\n&quot;</span>
<a name="l00218"></a>00218       <span class="stringliteral">&quot;\tThere you can use DigitTimeout if you can&apos;t or don&apos;t want to use\n&quot;</span>
<a name="l00219"></a>00219       <span class="stringliteral">&quot;\tisdn overlap dial.\n&quot;</span>
<a name="l00220"></a>00220       <span class="stringliteral">&quot;\tNOTE: This will jump into the s extension for every exten!&quot;</span> },
<a name="l00221"></a>00221    { <span class="stringliteral">&quot;nodialtone&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa23c446035a120715be770b3c7c32a579">MISDN_CFG_NODIALTONE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00222"></a>00222       <span class="stringliteral">&quot;Enable this to prevent chan_misdn to generate the dialtone\n&quot;</span>
<a name="l00223"></a>00223       <span class="stringliteral">&quot;\tThis makes only sense together with the always_immediate=yes option\n&quot;</span>
<a name="l00224"></a>00224       <span class="stringliteral">&quot;\tto generate your own dialtone with Playtones or so.&quot;</span>},
<a name="l00225"></a>00225    { <span class="stringliteral">&quot;immediate&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa1741048a25b1d75660664a24ebaadbcf">MISDN_CFG_IMMEDIATE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00226"></a>00226       <span class="stringliteral">&quot;Enable this if you want callers which called exactly the base\n&quot;</span>
<a name="l00227"></a>00227       <span class="stringliteral">&quot;\tnumber (so no extension is set) to jump into the s extension.\n&quot;</span>
<a name="l00228"></a>00228       <span class="stringliteral">&quot;\tIf the user dials something more, it jumps to the correct extension\n&quot;</span>
<a name="l00229"></a>00229       <span class="stringliteral">&quot;\tinstead.&quot;</span> },
<a name="l00230"></a>00230    { <span class="stringliteral">&quot;senddtmf&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa0397bab2056b56ac849cd042367a0095">MISDN_CFG_SENDDTMF</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00231"></a>00231       <span class="stringliteral">&quot;Enable this if we should produce DTMF Tones ourselves.&quot;</span> },
<a name="l00232"></a>00232    { <span class="stringliteral">&quot;astdtmf&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa5427637d0d273b717c2fc60cecbc1b84">MISDN_CFG_ASTDTMF</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00233"></a>00233       <span class="stringliteral">&quot;Enable this if you want to use the Asterisk dtmf detector\n&quot;</span>
<a name="l00234"></a>00234       <span class="stringliteral">&quot;instead of the mISDN_dsp/hfcmulti one.&quot;</span>
<a name="l00235"></a>00235       },
<a name="l00236"></a>00236    { <span class="stringliteral">&quot;hold_allowed&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaefe849152b8701cc28a9c11fcc4234a3">MISDN_CFG_HOLD_ALLOWED</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00237"></a>00237       <span class="stringliteral">&quot;Enable this to have support for hold and retrieve.&quot;</span> },
<a name="l00238"></a>00238    { <span class="stringliteral">&quot;early_bconnect&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab3dacbcbc41e2fff5e8acd8354ca4cec">MISDN_CFG_EARLY_BCONNECT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00239"></a>00239       <span class="stringliteral">&quot;Disable this if you don&apos;t mind correct handling of Progress Indicators.&quot;</span> },
<a name="l00240"></a>00240    { <span class="stringliteral">&quot;incoming_early_audio&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa78a5357e8af2a0d191436fdf12307467">MISDN_CFG_INCOMING_EARLY_AUDIO</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00241"></a>00241       <span class="stringliteral">&quot;Turn this on if you like to send Tone Indications to a Incoming\n&quot;</span>
<a name="l00242"></a>00242       <span class="stringliteral">&quot;\tisdn channel on a TE Port. Rarely used, only if the Telco allows\n&quot;</span>
<a name="l00243"></a>00243       <span class="stringliteral">&quot;\tyou to send indications by yourself, normally the Telco sends the\n&quot;</span>
<a name="l00244"></a>00244       <span class="stringliteral">&quot;\tindications to the remote party.&quot;</span> },
<a name="l00245"></a>00245    { <span class="stringliteral">&quot;echocancel&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabf6aabfa601c728547c7a6e25e33719d">MISDN_CFG_ECHOCANCEL</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>, <span class="stringliteral">&quot;0&quot;</span>, 128,
<a name="l00246"></a>00246       <span class="stringliteral">&quot;This enables echo cancellation with the given number of taps.\n&quot;</span>
<a name="l00247"></a>00247       <span class="stringliteral">&quot;\tBe aware: Move this setting only to outgoing portgroups!\n&quot;</span>
<a name="l00248"></a>00248       <span class="stringliteral">&quot;\tA value of zero turns echo cancellation off.\n&quot;</span>
<a name="l00249"></a>00249       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00250"></a>00250       <span class="stringliteral">&quot;\tPossible values are: 0,32,64,128,256,yes(=128),no(=0)&quot;</span> },
<a name="l00251"></a>00251 <span class="preprocessor">#ifdef MISDN_1_2</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>   { <span class="stringliteral">&quot;pipeline&quot;</span>, MISDN_CFG_PIPELINE, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00253"></a>00253       <span class="stringliteral">&quot;Set the configuration string for the mISDN dsp pipeline.\n&quot;</span>
<a name="l00254"></a>00254       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00255"></a>00255       <span class="stringliteral">&quot;\tExample for enabling the mg2 echo cancellation module with deftaps\n&quot;</span>
<a name="l00256"></a>00256       <span class="stringliteral">&quot;\tset to 128:\n&quot;</span>
<a name="l00257"></a>00257       <span class="stringliteral">&quot;\t\tmg2ec(deftaps=128)&quot;</span> },
<a name="l00258"></a>00258 <span class="preprocessor">#endif</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span><span class="preprocessor">#ifdef WITH_BEROEC</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span>   { <span class="stringliteral">&quot;bnechocancel&quot;</span>, MISDN_CFG_BNECHOCANCEL, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>, <span class="stringliteral">&quot;yes&quot;</span>, 64,
<a name="l00261"></a>00261       <span class="stringliteral">&quot;echotail in ms (1-200)\n&quot;</span>},
<a name="l00262"></a>00262    { <span class="stringliteral">&quot;bnec_antihowl&quot;</span>, MISDN_CFG_BNEC_ANTIHOWL, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00263"></a>00263       <span class="stringliteral">&quot;Use antihowl\n&quot;</span>},
<a name="l00264"></a>00264    { <span class="stringliteral">&quot;bnec_nlp&quot;</span>, MISDN_CFG_BNEC_NLP, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00265"></a>00265       <span class="stringliteral">&quot;Nonlinear Processing (much faster adaption)&quot;</span>},
<a name="l00266"></a>00266    { <span class="stringliteral">&quot;bnec_zerocoeff&quot;</span>, MISDN_CFG_BNEC_ZEROCOEFF, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00267"></a>00267       <span class="stringliteral">&quot;ZeroCoeffeciens\n&quot;</span>},
<a name="l00268"></a>00268    { <span class="stringliteral">&quot;bnec_tonedisabler&quot;</span>, MISDN_CFG_BNEC_TD, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00269"></a>00269       <span class="stringliteral">&quot;Disable Tone\n&quot;</span>},
<a name="l00270"></a>00270    { <span class="stringliteral">&quot;bnec_adaption&quot;</span>, MISDN_CFG_BNEC_ADAPT, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;1&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00271"></a>00271       <span class="stringliteral">&quot;Adaption mode (0=no,1=full,2=fast)\n&quot;</span>},
<a name="l00272"></a>00272 <span class="preprocessor">#endif</span>
<a name="l00273"></a>00273 <span class="preprocessor"></span>   { <span class="stringliteral">&quot;need_more_infos&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aacbfdbb8cf8eef2737b961cec237222c7">MISDN_CFG_NEED_MORE_INFOS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00274"></a>00274       <span class="stringliteral">&quot;Send Setup_Acknowledge on incoming calls anyway (instead of PROCEEDING),\n&quot;</span>
<a name="l00275"></a>00275       <span class="stringliteral">&quot;\tthis requests additional Infos, so we can waitfordigits without much\n&quot;</span>
<a name="l00276"></a>00276       <span class="stringliteral">&quot;\tissues. This works only for PTP Ports&quot;</span> },
<a name="l00277"></a>00277    { <span class="stringliteral">&quot;noautorespond_on_setup&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa1df5fb282a4dbb040ebb269c05986cd3">MISDN_CFG_NOAUTORESPOND_ON_SETUP</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00278"></a>00278       <span class="stringliteral">&quot;Do not send SETUP_ACKNOWLEDGE or PROCEEDING automatically to the calling Party.\n&quot;</span>
<a name="l00279"></a>00279       <span class="stringliteral">&quot;Instead we directly jump into the dialplan. This might be useful for fast call\n&quot;</span>
<a name="l00280"></a>00280       <span class="stringliteral">&quot;rejection, or for some broken switches, that need hangup causes like busy in the.\n&quot;</span>
<a name="l00281"></a>00281       <span class="stringliteral">&quot;RELEASE_COMPLETE Message, instead of the DISCONNECT Message.&quot;</span>},
<a name="l00282"></a>00282    { <span class="stringliteral">&quot;jitterbuffer&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa3c28851e02fb60880920790680261893">MISDN_CFG_JITTERBUFFER</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;4000&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00283"></a>00283       <span class="stringliteral">&quot;The jitterbuffer.&quot;</span> },
<a name="l00284"></a>00284    { <span class="stringliteral">&quot;jitterbuffer_upper_threshold&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa1b2e7b752d2e02a1624c1e6505ff1731">MISDN_CFG_JITTERBUFFER_UPPER_THRESHOLD</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00285"></a>00285       <span class="stringliteral">&quot;Change this threshold to enable dejitter functionality.&quot;</span> },
<a name="l00286"></a>00286    { <span class="stringliteral">&quot;callgroup&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaa92d27e8d3511f9715ba7c9b20a49e44">MISDN_CFG_CALLGROUP</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a40c3b08f125c2ddf122150790302f80b">MISDN_CTYPE_ASTGROUP</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00287"></a>00287       <span class="stringliteral">&quot;Callgroup.&quot;</span> },
<a name="l00288"></a>00288    { <span class="stringliteral">&quot;pickupgroup&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab62334d4fb963a1d96603915248fcfbf">MISDN_CFG_PICKUPGROUP</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a40c3b08f125c2ddf122150790302f80b">MISDN_CTYPE_ASTGROUP</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00289"></a>00289       <span class="stringliteral">&quot;Pickupgroup.&quot;</span> },
<a name="l00290"></a>00290    { <span class="stringliteral">&quot;max_incoming&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aac6d44d729f3a1d61f4fd2391f13a832a">MISDN_CFG_MAX_IN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;-1&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00291"></a>00291       <span class="stringliteral">&quot;Defines the maximum amount of incoming calls per port for this group.\n&quot;</span>
<a name="l00292"></a>00292       <span class="stringliteral">&quot;\tCalls which exceed the maximum will be marked with the channel variable\n&quot;</span>
<a name="l00293"></a>00293       <span class="stringliteral">&quot;\tMAX_OVERFLOW. It will contain the amount of overflowed calls&quot;</span> },
<a name="l00294"></a>00294    { <span class="stringliteral">&quot;max_outgoing&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa341446ad7a9fd2c59f000e5a4ae63634">MISDN_CFG_MAX_OUT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;-1&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00295"></a>00295       <span class="stringliteral">&quot;Defines the maximum amount of outgoing calls per port for this group\n&quot;</span>
<a name="l00296"></a>00296       <span class="stringliteral">&quot;\texceeding calls will be rejected&quot;</span> },
<a name="l00297"></a>00297 
<a name="l00298"></a>00298    { <span class="stringliteral">&quot;reject_cause&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaf07f31540a757ef544b9a4a25da618c5">MISDN_CFG_REJECT_CAUSE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;21&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00299"></a>00299       <span class="stringliteral">&quot;Defines the cause with which a 3. call is rejected on PTMP BRI.&quot;</span>},
<a name="l00300"></a>00300    { <span class="stringliteral">&quot;faxdetect&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa53619f42e92edd92884e70d99d8e1186">MISDN_CFG_FAXDETECT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00301"></a>00301       <span class="stringliteral">&quot;Setup fax detection:\n&quot;</span>
<a name="l00302"></a>00302       <span class="stringliteral">&quot;\t    no        - no fax detection\n&quot;</span>
<a name="l00303"></a>00303       <span class="stringliteral">&quot;\t    incoming  - fax detection for incoming calls\n&quot;</span>
<a name="l00304"></a>00304       <span class="stringliteral">&quot;\t    outgoing  - fax detection for outgoing calls\n&quot;</span>
<a name="l00305"></a>00305       <span class="stringliteral">&quot;\t    both      - fax detection for incoming and outgoing calls\n&quot;</span>
<a name="l00306"></a>00306       <span class="stringliteral">&quot;\tAdd +nojump to your value (i.e. faxdetect=both+nojump) if you don&apos;t want to jump into the\n&quot;</span>
<a name="l00307"></a>00307       <span class="stringliteral">&quot;\tfax-extension but still want to detect the fax and prepare the channel for fax transfer.&quot;</span> },
<a name="l00308"></a>00308    { <span class="stringliteral">&quot;faxdetect_timeout&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aac92e09a838eac6984d79fe4a762c7c63">MISDN_CFG_FAXDETECT_TIMEOUT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00309"></a>00309       <span class="stringliteral">&quot;Number of seconds the fax detection should do its job. After the given period of time,\n&quot;</span>
<a name="l00310"></a>00310       <span class="stringliteral">&quot;\twe assume that it&apos;s not a fax call and save some CPU time by turning off fax detection.\n&quot;</span>
<a name="l00311"></a>00311       <span class="stringliteral">&quot;\tSet this to 0 if you don&apos;t want a timeout (never stop detecting).&quot;</span> },
<a name="l00312"></a>00312    { <span class="stringliteral">&quot;faxdetect_context&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa4b42c135859f0229b12066348cfcc97e">MISDN_CFG_FAXDETECT_CONTEXT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00313"></a>00313       <span class="stringliteral">&quot;Context to jump into if we detect a fax. Don&apos;t set this if you want to stay in the current context.&quot;</span> },
<a name="l00314"></a>00314    { <span class="stringliteral">&quot;l1watcher_timeout&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa379acd10a5cf71976a3d84c97b869b8a">MISDN_CFG_L1_TIMEOUT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>, <span class="stringliteral">&quot;0&quot;</span>, 4,
<a name="l00315"></a>00315       <span class="stringliteral">&quot;Watches the layer 1. If the layer 1 is down, it tries to\n&quot;</span>
<a name="l00316"></a>00316       <span class="stringliteral">&quot;\tget it up. The timeout is given in seconds. with 0 as value it\n&quot;</span>
<a name="l00317"></a>00317       <span class="stringliteral">&quot;\tdoes not watch the l1 at all\n&quot;</span>
<a name="l00318"></a>00318       <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00319"></a>00319       <span class="stringliteral">&quot;\tThis option is only read at loading time of chan_misdn, which\n&quot;</span>
<a name="l00320"></a>00320       <span class="stringliteral">&quot;\tmeans you need to unload and load chan_misdn to change the value,\n&quot;</span>
<a name="l00321"></a>00321       <span class="stringliteral">&quot;\tan Asterisk restart should do the trick.&quot;</span> },
<a name="l00322"></a>00322    { <span class="stringliteral">&quot;overlapdial&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa7bd1c1cdde2e3cfe2a2dbf0707fdc2c2">MISDN_CFG_OVERLAP_DIAL</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>, <span class="stringliteral">&quot;0&quot;</span>, 4,
<a name="l00323"></a>00323       <span class="stringliteral">&quot;Enables overlap dial for the given amount of seconds.\n&quot;</span>
<a name="l00324"></a>00324       <span class="stringliteral">&quot;\tPossible values are positive integers or:\n&quot;</span>
<a name="l00325"></a>00325       <span class="stringliteral">&quot;\t   yes (= 4 seconds)\n&quot;</span>
<a name="l00326"></a>00326       <span class="stringliteral">&quot;\t   no  (= 0 seconds = disabled)&quot;</span> },
<a name="l00327"></a>00327    { <span class="stringliteral">&quot;nttimeout&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa7c0d9d71f6e4a3655befa6258ae2946f">MISDN_CFG_NTTIMEOUT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a> ,
<a name="l00328"></a>00328       <span class="stringliteral">&quot;Set this to yes if you want calls disconnected in overlap mode\n&quot;</span>
<a name="l00329"></a>00329       <span class="stringliteral">&quot;\twhen a timeout happens.&quot;</span> },
<a name="l00330"></a>00330    { <span class="stringliteral">&quot;bridging&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa2724a99c8a40d9b06762e10af9d3eaac">MISDN_CFG_BRIDGING</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00331"></a>00331       <span class="stringliteral">&quot;Set this to yes/no, default is yes.\n&quot;</span>
<a name="l00332"></a>00332       <span class="stringliteral">&quot;This can be used to have bridging enabled in general and to\n&quot;</span>
<a name="l00333"></a>00333       <span class="stringliteral">&quot;disable it for specific ports. It makes sense to disable\n&quot;</span>
<a name="l00334"></a>00334       <span class="stringliteral">&quot;bridging on NT Port where you plan to use the HOLD/RETRIEVE\n&quot;</span>
<a name="l00335"></a>00335       <span class="stringliteral">&quot;features with ISDN phones.&quot;</span> },
<a name="l00336"></a>00336    { <span class="stringliteral">&quot;msns&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aad27ef0e52b8b1967ba96cadc8994bb86">MISDN_CFG_MSNS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a1b4b4bec0d3721002c16eb2d28fab14c">MISDN_CTYPE_MSNLIST</a>, <span class="stringliteral">&quot;*&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00337"></a>00337       <span class="stringliteral">&quot;MSN&apos;s for TE ports, listen on those numbers on the above ports, and\n&quot;</span>
<a name="l00338"></a>00338       <span class="stringliteral">&quot;\tindicate the incoming calls to Asterisk.\n&quot;</span>
<a name="l00339"></a>00339       <span class="stringliteral">&quot;\tHere you can give a comma separated list, or simply an &apos;*&apos; for any msn.&quot;</span> },
<a name="l00340"></a>00340 };
<a name="l00341"></a>00341 
<a name="l00342"></a><a class="code" href="misdn__config_8c.html#ad07677134e8a6de0c88b0f168ad85a32">00342</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> <a class="code" href="misdn__config_8c.html#ad07677134e8a6de0c88b0f168ad85a32">gen_spec</a>[] = {
<a name="l00343"></a>00343    { <span class="stringliteral">&quot;debug&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aac641427d0a358649849911d5f0eb0566">MISDN_GEN_DEBUG</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00344"></a>00344       <span class="stringliteral">&quot;Sets the debugging flag:\n&quot;</span>
<a name="l00345"></a>00345       <span class="stringliteral">&quot;\t0 - No Debug\n&quot;</span>
<a name="l00346"></a>00346       <span class="stringliteral">&quot;\t1 - mISDN Messages and * - Messages, and * - State changes\n&quot;</span>
<a name="l00347"></a>00347       <span class="stringliteral">&quot;\t2 - Messages + Message specific Informations (e.g. bearer capability)\n&quot;</span>
<a name="l00348"></a>00348       <span class="stringliteral">&quot;\t3 - very Verbose, the above + lots of Driver specific infos\n&quot;</span>
<a name="l00349"></a>00349       <span class="stringliteral">&quot;\t4 - even more Verbose than 3&quot;</span> },
<a name="l00350"></a>00350 <span class="preprocessor">#ifndef MISDN_1_2</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span>   { <span class="stringliteral">&quot;misdn_init&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e4f8d28e6bf873400924bb0161807c9">MISDN_GEN_MISDN_INIT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;/etc/misdn-init.conf&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00352"></a>00352       <span class="stringliteral">&quot;Set the path to the misdn-init.conf (for nt_ptp mode checking).&quot;</span> },
<a name="l00353"></a>00353 <span class="preprocessor">#endif</span>
<a name="l00354"></a>00354 <span class="preprocessor"></span>   { <span class="stringliteral">&quot;tracefile&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aad989fee91500a3ca31db1f9c7ccda5f3">MISDN_GEN_TRACEFILE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;/var/log/asterisk/misdn.log&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00355"></a>00355       <span class="stringliteral">&quot;Set the path to the massively growing trace file, if you want that.&quot;</span> },
<a name="l00356"></a>00356    { <span class="stringliteral">&quot;bridging&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab4921d826e2c54d6c971d0d1efa62071">MISDN_GEN_BRIDGING</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00357"></a>00357       <span class="stringliteral">&quot;Set this to yes if you want mISDN_dsp to bridge the calls in HW.&quot;</span> },
<a name="l00358"></a>00358    { <span class="stringliteral">&quot;stop_tone_after_first_digit&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa044ac1c8c166648b1d67995ba1e8960f">MISDN_GEN_STOP_TONE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00359"></a>00359       <span class="stringliteral">&quot;Stops dialtone after getting first digit on NT Port.&quot;</span> },
<a name="l00360"></a>00360    { <span class="stringliteral">&quot;append_digits2exten&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa6ea789fec6299b5d967bd78df6c77994">MISDN_GEN_APPEND_DIGITS2EXTEN</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;yes&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00361"></a>00361       <span class="stringliteral">&quot;Whether to append overlapdialed Digits to Extension or not.&quot;</span> },
<a name="l00362"></a>00362    { <span class="stringliteral">&quot;dynamic_crypt&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa8a1da27a0b6fc72fa036f5d3e171a318">MISDN_GEN_DYNAMIC_CRYPT</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00363"></a>00363       <span class="stringliteral">&quot;Whether to look out for dynamic crypting attempts.&quot;</span> },
<a name="l00364"></a>00364    { <span class="stringliteral">&quot;crypt_prefix&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa735986d87a1252b93f22ed462a640a89">MISDN_GEN_CRYPT_PREFIX</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00365"></a>00365       <span class="stringliteral">&quot;What is used for crypting Protocol.&quot;</span> },
<a name="l00366"></a>00366    { <span class="stringliteral">&quot;crypt_keys&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aaacd5c6e18a3904a1b6934b9f57f89322">MISDN_GEN_CRYPT_KEYS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00367"></a>00367       <span class="stringliteral">&quot;Keys for cryption, you reference them in the dialplan\n&quot;</span>
<a name="l00368"></a>00368       <span class="stringliteral">&quot;\tLater also in dynamic encr.&quot;</span> },
<a name="l00369"></a>00369    { <span class="stringliteral">&quot;ntkeepcalls&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab0f790b350189bdcdced68408057d16d">MISDN_GEN_NTKEEPCALLS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>, 
<a name="l00370"></a>00370       <span class="stringliteral">&quot;avoid dropping calls if the L2 goes down. some Nortel pbx\n&quot;</span> 
<a name="l00371"></a>00371       <span class="stringliteral">&quot;do put down the L2/L1 for some milliseconds even if there\n&quot;</span>
<a name="l00372"></a>00372       <span class="stringliteral">&quot;are running calls. with this option you can avoid dropping them&quot;</span> },
<a name="l00373"></a>00373    { <span class="stringliteral">&quot;ntdebugflags&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa237371e790a3620cf1312b2c92ef8aab">MISDN_GEN_NTDEBUGFLAGS</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00374"></a>00374       <span class="stringliteral">&quot;No description yet.&quot;</span>},
<a name="l00375"></a>00375    { <span class="stringliteral">&quot;ntdebugfile&quot;</span>, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa5a45db543dae5ec58f3e4a9e95aae51a">MISDN_GEN_NTDEBUGFILE</a>, <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>, <span class="stringliteral">&quot;/var/log/misdn-nt.log&quot;</span>, <a class="code" href="misdn__config_8c.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>,
<a name="l00376"></a>00376       <span class="stringliteral">&quot;No description yet.&quot;</span> }
<a name="l00377"></a>00377 };
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">/* array of port configs, default is at position 0. */</span>
<a name="l00381"></a><a class="code" href="misdn__config_8c.html#a3b0333e64170b22ed99bddf9311f515d">00381</a> <span class="keyword">static</span> <span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> **<a class="code" href="misdn__config_8c.html#a3b0333e64170b22ed99bddf9311f515d">port_cfg</a>;
<a name="l00382"></a>00382 <span class="comment">/* max number of available ports, is set on init */</span>
<a name="l00383"></a><a class="code" href="misdn__config_8c.html#a24bb5f2898b28cecc69c86bb429f7517">00383</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#a24bb5f2898b28cecc69c86bb429f7517">max_ports</a>;
<a name="l00384"></a>00384 <span class="comment">/* general config */</span>
<a name="l00385"></a><a class="code" href="misdn__config_8c.html#a909c469ee436b5ef84fbcbef82968d90">00385</a> <span class="keyword">static</span> <span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *<a class="code" href="misdn__config_8c.html#a909c469ee436b5ef84fbcbef82968d90">general_cfg</a>;
<a name="l00386"></a>00386 <span class="comment">/* storing the ptp flag separated to save memory */</span>
<a name="l00387"></a><a class="code" href="misdn__config_8c.html#a8811c37f1bf155dadba8ae3dfb0fdfee">00387</a> <span class="keyword">static</span> <span class="keywordtype">int</span> *<a class="code" href="misdn__config_8c.html#a8811c37f1bf155dadba8ae3dfb0fdfee">ptp</a>;
<a name="l00388"></a>00388 <span class="comment">/* maps enum config elements to array positions */</span>
<a name="l00389"></a><a class="code" href="misdn__config_8c.html#a92a7399cbb76f6349df98d9432ad52c6">00389</a> <span class="keyword">static</span> <span class="keywordtype">int</span> *<a class="code" href="misdn__config_8c.html#a92a7399cbb76f6349df98d9432ad52c6">map</a>;
<a name="l00390"></a>00390 
<a name="l00391"></a><a class="code" href="misdn__config_8c.html#a9ef1b52be86dcb4cba28583d8f3feae9">00391</a> <span class="keyword">static</span> <a class="code" href="lock_8h.html#a2d9118a2a8939f115eea771bce3a52f2">ast_mutex_t</a> <a class="code" href="misdn__config_8c.html#a9ef1b52be86dcb4cba28583d8f3feae9">config_mutex</a>; 
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">00393</a> <span class="preprocessor">#define CLI_ERROR(name, value, section) ({ \</span>
<a name="l00394"></a>00394 <span class="preprocessor">   ast_log(LOG_WARNING, &quot;misdn.conf: \&quot;%s=%s\&quot; (section: %s) invalid or out of range. &quot; \</span>
<a name="l00395"></a>00395 <span class="preprocessor">      &quot;Please edit your misdn.conf and then do a \&quot;misdn reload\&quot;.\n&quot;, name, value, section); \</span>
<a name="l00396"></a>00396 <span class="preprocessor">})</span>
<a name="l00397"></a>00397 <span class="preprocessor"></span>
<a name="l00398"></a><a class="code" href="misdn__config_8c.html#a705f2aef7442b96728a1d130c1ea4398">00398</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#a705f2aef7442b96728a1d130c1ea4398">_enum_array_map</a> (<span class="keywordtype">void</span>)
<a name="l00399"></a>00399 {
<a name="l00400"></a>00400    <span class="keywordtype">int</span> i, j, ok;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402    <span class="keywordflow">for</span> (i = <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab150c41adf9cecd32d381a5c1ff16dab">MISDN_CFG_FIRST</a> + 1; i &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>; ++i) {
<a name="l00403"></a>00403       <span class="keywordflow">if</span> (i == <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9c975239458a1af36eb8db7d17dd850d">MISDN_CFG_PTP</a>)
<a name="l00404"></a>00404          <span class="keywordflow">continue</span>;
<a name="l00405"></a>00405       ok = 0;
<a name="l00406"></a>00406       <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a>; ++j) {
<a name="l00407"></a>00407          <span class="keywordflow">if</span> (port_spec[j].elem == i) {
<a name="l00408"></a>00408             map[i] = j;
<a name="l00409"></a>00409             ok = 1;
<a name="l00410"></a>00410             <span class="keywordflow">break</span>;
<a name="l00411"></a>00411          }
<a name="l00412"></a>00412       }
<a name="l00413"></a>00413       <span class="keywordflow">if</span> (!ok) {
<a name="l00414"></a>00414          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Enum element %d in misdn_cfg_elements (port section) has no corresponding element in the config struct!\n&quot;</span>, i);
<a name="l00415"></a>00415          <span class="keywordflow">return</span> -1;
<a name="l00416"></a>00416       }
<a name="l00417"></a>00417    }
<a name="l00418"></a>00418    <span class="keywordflow">for</span> (i = <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa50f2df70cb915612835a13a49c5fef81">MISDN_GEN_FIRST</a> + 1; i &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabeb4c50c2d53fffe39ee8c2fcc4cbc80">MISDN_GEN_LAST</a>; ++i) {
<a name="l00419"></a>00419       ok = 0;
<a name="l00420"></a>00420       <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">NUM_GEN_ELEMENTS</a>; ++j) {
<a name="l00421"></a>00421          <span class="keywordflow">if</span> (gen_spec[j].elem == i) {
<a name="l00422"></a>00422             map[i] = j;
<a name="l00423"></a>00423             ok = 1;
<a name="l00424"></a>00424             <span class="keywordflow">break</span>;
<a name="l00425"></a>00425          }
<a name="l00426"></a>00426       }
<a name="l00427"></a>00427       <span class="keywordflow">if</span> (!ok) {
<a name="l00428"></a>00428          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Enum element %d in misdn_cfg_elements (general section) has no corresponding element in the config struct!\n&quot;</span>, i);
<a name="l00429"></a>00429          <span class="keywordflow">return</span> -1;
<a name="l00430"></a>00430       }
<a name="l00431"></a>00431    }
<a name="l00432"></a>00432    <span class="keywordflow">return</span> 0;
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">00435</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">get_cfg_position</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <span class="keywordtype">int</span> <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>)
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437    <span class="keywordtype">int</span> i;
<a name="l00438"></a>00438 
<a name="l00439"></a>00439    <span class="keywordflow">switch</span> (type) {
<a name="l00440"></a>00440    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#af239c62f325c4a450832ba971ad30594">PORT_CFG</a>:
<a name="l00441"></a>00441       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a>; ++i) {
<a name="l00442"></a>00442          <span class="keywordflow">if</span> (!strcasecmp(name, port_spec[i].name))
<a name="l00443"></a>00443             <span class="keywordflow">return</span> i;
<a name="l00444"></a>00444       }
<a name="l00445"></a>00445       <span class="keywordflow">break</span>;
<a name="l00446"></a>00446    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#ac83a664de90770af20fa45e23a2f6a0b">GEN_CFG</a>:
<a name="l00447"></a>00447       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">NUM_GEN_ELEMENTS</a>; ++i) {
<a name="l00448"></a>00448          <span class="keywordflow">if</span> (!strcasecmp(name, gen_spec[i].name))
<a name="l00449"></a>00449             <span class="keywordflow">return</span> i;
<a name="l00450"></a>00450       }
<a name="l00451"></a>00451    }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453    <span class="keywordflow">return</span> -1;
<a name="l00454"></a>00454 }
<a name="l00455"></a>00455 
<a name="l00456"></a><a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">00456</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a> (<span class="keywordtype">void</span>)
<a name="l00457"></a>00457 {
<a name="l00458"></a>00458    <a class="code" href="lock_8h.html#ad941566de4050aa7358493af94d2ba4d">ast_mutex_lock</a>(&amp;config_mutex);
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a><a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">00461</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a> (<span class="keywordtype">void</span>)
<a name="l00462"></a>00462 {
<a name="l00463"></a>00463    <a class="code" href="lock_8h.html#aa9b39f0e22f44a7e7f587d4252e41a0b">ast_mutex_unlock</a>(&amp;config_mutex);
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="misdn__config_8c.html#ad242a41e8e1f5e9432d90ef70381032b">00466</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#ad242a41e8e1f5e9432d90ef70381032b">_free_msn_list</a> (<span class="keyword">struct</span> <a class="code" href="structmsn__list.html">msn_list</a>* iter)
<a name="l00467"></a>00467 {
<a name="l00468"></a>00468    <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">next</a>)
<a name="l00469"></a>00469       <a class="code" href="misdn__config_8c.html#ad242a41e8e1f5e9432d90ef70381032b">_free_msn_list</a>(iter-&gt;<a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">next</a>);
<a name="l00470"></a>00470    <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>)
<a name="l00471"></a>00471       <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(iter-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>);
<a name="l00472"></a>00472    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(iter);
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a><a class="code" href="misdn__config_8c.html#a023bb61b2e014d422690936565fcb69e">00475</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a023bb61b2e014d422690936565fcb69e">_free_port_cfg</a> (<span class="keywordtype">void</span>)
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477    <span class="keywordtype">int</span> i, j;
<a name="l00478"></a>00478    <span class="keywordtype">int</span> gn = map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>];
<a name="l00479"></a>00479    <span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a>* free_list[max_ports + 2];
<a name="l00480"></a>00480    
<a name="l00481"></a>00481    memset(free_list, 0, <span class="keyword">sizeof</span>(free_list));
<a name="l00482"></a>00482    free_list[0] = port_cfg[0];
<a name="l00483"></a>00483    <span class="keywordflow">for</span> (i = 1; i &lt;= max_ports; ++i) {
<a name="l00484"></a>00484       <span class="keywordflow">if</span> (port_cfg[i][gn].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00485"></a>00485          <span class="comment">/* we always have a groupname in the non-default case, so this is fine */</span>
<a name="l00486"></a>00486          <span class="keywordflow">for</span> (j = 1; j &lt;= max_ports; ++j) {
<a name="l00487"></a>00487             <span class="keywordflow">if</span> (free_list[j] &amp;&amp; free_list[j][gn].str == port_cfg[i][gn].str)
<a name="l00488"></a>00488                <span class="keywordflow">break</span>;
<a name="l00489"></a>00489             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!free_list[j]) {
<a name="l00490"></a>00490                free_list[j] = port_cfg[i];
<a name="l00491"></a>00491                <span class="keywordflow">break</span>;
<a name="l00492"></a>00492             }
<a name="l00493"></a>00493          }
<a name="l00494"></a>00494       }
<a name="l00495"></a>00495    }
<a name="l00496"></a>00496    <span class="keywordflow">for</span> (j = 0; free_list[j]; ++j) {
<a name="l00497"></a>00497       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a>; ++i) {
<a name="l00498"></a>00498          <span class="keywordflow">if</span> (free_list[j][i].<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a>) {
<a name="l00499"></a>00499             <span class="keywordflow">if</span> (port_spec[i].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a> == <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a1b4b4bec0d3721002c16eb2d28fab14c">MISDN_CTYPE_MSNLIST</a>)
<a name="l00500"></a>00500                <a class="code" href="misdn__config_8c.html#ad242a41e8e1f5e9432d90ef70381032b">_free_msn_list</a>(free_list[j][i].<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>);
<a name="l00501"></a>00501             <span class="keywordflow">else</span>
<a name="l00502"></a>00502                <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(free_list[j][i].any);
<a name="l00503"></a>00503          }
<a name="l00504"></a>00504       }
<a name="l00505"></a>00505    }
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 
<a name="l00508"></a><a class="code" href="misdn__config_8c.html#a259567e54b2d303629277af2e67c6bfa">00508</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a259567e54b2d303629277af2e67c6bfa">_free_general_cfg</a> (<span class="keywordtype">void</span>)
<a name="l00509"></a>00509 {
<a name="l00510"></a>00510    <span class="keywordtype">int</span> i;
<a name="l00511"></a>00511 
<a name="l00512"></a>00512    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">NUM_GEN_ELEMENTS</a>; i++) 
<a name="l00513"></a>00513       <span class="keywordflow">if</span> (general_cfg[i].<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a>)
<a name="l00514"></a>00514          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(general_cfg[i].any);
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00517"></a><a class="code" href="chan__misdn__config_8h.html#a0f6a5bee3a29bd963f565c6b474f2b23">00517</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a0f6a5bee3a29bd963f565c6b474f2b23">misdn_cfg_get</a>(<span class="keywordtype">int</span> port, <span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3a">misdn_cfg_elements</a> elem, <span class="keywordtype">void</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="keywordtype">int</span> bufsize)
<a name="l00518"></a>00518 {
<a name="l00519"></a>00519    <span class="keywordtype">int</span> place;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521    <span class="keywordflow">if</span> ((elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>) &amp;&amp; !<a class="code" href="misdn__config_8c.html#ab08e8e7e093f022d1a156fe2d6ebdf45">misdn_cfg_is_port_valid</a>(port)) {
<a name="l00522"></a>00522       memset(buf, 0, bufsize);
<a name="l00523"></a>00523       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid call to misdn_cfg_get! Port number %d is not valid.\n&quot;</span>, port);
<a name="l00524"></a>00524       <span class="keywordflow">return</span>;
<a name="l00525"></a>00525    }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l00528"></a>00528    <span class="keywordflow">if</span> (elem == <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9c975239458a1af36eb8db7d17dd850d">MISDN_CFG_PTP</a>) {
<a name="l00529"></a>00529       <span class="keywordflow">if</span> (!memcpy(buf, &amp;ptp[port], (bufsize &gt; ptp[port]) ? <span class="keyword">sizeof</span>(ptp[port]) : bufsize))
<a name="l00530"></a>00530          memset(buf, 0, bufsize);
<a name="l00531"></a>00531    } <span class="keywordflow">else</span> {
<a name="l00532"></a>00532       <span class="keywordflow">if</span> ((place = map[elem]) &lt; 0) {
<a name="l00533"></a>00533          memset(buf, 0, bufsize);
<a name="l00534"></a>00534          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid call to misdn_cfg_get! Invalid element (%d) requested.\n&quot;</span>, elem);
<a name="l00535"></a>00535       } <span class="keywordflow">else</span> {
<a name="l00536"></a>00536          <span class="keywordflow">if</span> (elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>) {
<a name="l00537"></a>00537             <span class="keywordflow">switch</span> (port_spec[place].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>) {
<a name="l00538"></a>00538             <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>:
<a name="l00539"></a>00539                <span class="keywordflow">if</span> (port_cfg[port][place].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00540"></a>00540                   <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf, port_cfg[port][place].str, bufsize);
<a name="l00541"></a>00541                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg[0][place].str) {
<a name="l00542"></a>00542                   <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf, port_cfg[0][place].str, bufsize);
<a name="l00543"></a>00543                } <span class="keywordflow">else</span>
<a name="l00544"></a>00544                   memset(buf, 0, bufsize);
<a name="l00545"></a>00545                <span class="keywordflow">break</span>;
<a name="l00546"></a>00546             <span class="keywordflow">default</span>:
<a name="l00547"></a>00547                <span class="keywordflow">if</span> (port_cfg[port][place].<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a>)
<a name="l00548"></a>00548                   memcpy(buf, port_cfg[port][place].any, bufsize);
<a name="l00549"></a>00549                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg[0][place].any)
<a name="l00550"></a>00550                   memcpy(buf, port_cfg[0][place].any, bufsize);
<a name="l00551"></a>00551                <span class="keywordflow">else</span>
<a name="l00552"></a>00552                   memset(buf, 0, bufsize);
<a name="l00553"></a>00553             }
<a name="l00554"></a>00554          } <span class="keywordflow">else</span> {
<a name="l00555"></a>00555             <span class="keywordflow">switch</span> (gen_spec[place].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>) {
<a name="l00556"></a>00556             <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>:
<a name="l00557"></a>00557                <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf, <a class="code" href="strings_8h.html#a2faaa16929951bfd2802b7829a100ba2" title="returns the equivalent of logic or for strings: first one if not empty, otherwise...">S_OR</a>(general_cfg[place].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="stringliteral">&quot;&quot;</span>), bufsize);
<a name="l00558"></a>00558                <span class="keywordflow">break</span>;
<a name="l00559"></a>00559             <span class="keywordflow">default</span>:
<a name="l00560"></a>00560                <span class="keywordflow">if</span> (general_cfg[place].<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a>)
<a name="l00561"></a>00561                   memcpy(buf, general_cfg[place].any, bufsize);
<a name="l00562"></a>00562                <span class="keywordflow">else</span>
<a name="l00563"></a>00563                   memset(buf, 0, bufsize);
<a name="l00564"></a>00564             }
<a name="l00565"></a>00565          }
<a name="l00566"></a>00566       }
<a name="l00567"></a>00567    }
<a name="l00568"></a>00568    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00571"></a><a class="code" href="chan__misdn__config_8h.html#a23de2d260a7f394b3d0d4bdead5343c6">00571</a> <span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3a">misdn_cfg_elements</a> <a class="code" href="misdn__config_8c.html#a23de2d260a7f394b3d0d4bdead5343c6">misdn_cfg_get_elem</a>(<span class="keywordtype">char</span> *<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)
<a name="l00572"></a>00572 {
<a name="l00573"></a>00573    <span class="keywordtype">int</span> pos;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575    <span class="comment">/* here comes a hack to replace the (not existing) &quot;name&quot; element with the &quot;ports&quot; element */</span>
<a name="l00576"></a>00576    <span class="keywordflow">if</span> (!strcmp(name, <span class="stringliteral">&quot;ports&quot;</span>))
<a name="l00577"></a>00577       <span class="keywordflow">return</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>;
<a name="l00578"></a>00578    <span class="keywordflow">if</span> (!strcmp(name, <span class="stringliteral">&quot;name&quot;</span>))
<a name="l00579"></a>00579       <span class="keywordflow">return</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab150c41adf9cecd32d381a5c1ff16dab">MISDN_CFG_FIRST</a>;
<a name="l00580"></a>00580 
<a name="l00581"></a>00581    pos = <a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">get_cfg_position</a>(name, <a class="code" href="misdn__config_8c.html#af239c62f325c4a450832ba971ad30594">PORT_CFG</a>);
<a name="l00582"></a>00582    <span class="keywordflow">if</span> (pos &gt;= 0)
<a name="l00583"></a>00583       <span class="keywordflow">return</span> port_spec[pos].<a class="code" href="structmisdn__cfg__spec.html#a1865504fb01a2e4ec328ccb0699f5a36">elem</a>;
<a name="l00584"></a>00584    
<a name="l00585"></a>00585    pos = <a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">get_cfg_position</a>(name, <a class="code" href="misdn__config_8c.html#ac83a664de90770af20fa45e23a2f6a0b">GEN_CFG</a>);
<a name="l00586"></a>00586    <span class="keywordflow">if</span> (pos &gt;= 0)
<a name="l00587"></a>00587       <span class="keywordflow">return</span> gen_spec[pos].<a class="code" href="structmisdn__cfg__spec.html#a1865504fb01a2e4ec328ccb0699f5a36">elem</a>;
<a name="l00588"></a>00588    
<a name="l00589"></a>00589    <span class="keywordflow">return</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab150c41adf9cecd32d381a5c1ff16dab">MISDN_CFG_FIRST</a>;
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="chan__misdn__config_8h.html#a5d5c67cc756ded480d5742ca65a3e36f">00592</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a5d5c67cc756ded480d5742ca65a3e36f">misdn_cfg_get_name</a>(<span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3a">misdn_cfg_elements</a> elem, <span class="keywordtype">void</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="keywordtype">int</span> bufsize)
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594    <span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> *spec = NULL;
<a name="l00595"></a>00595    <span class="keywordtype">int</span> place = map[elem];
<a name="l00596"></a>00596 
<a name="l00597"></a>00597    <span class="comment">/* the ptp hack */</span>
<a name="l00598"></a>00598    <span class="keywordflow">if</span> (elem == <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9c975239458a1af36eb8db7d17dd850d">MISDN_CFG_PTP</a>) {
<a name="l00599"></a>00599       memset(buf, 0, 1);
<a name="l00600"></a>00600       <span class="keywordflow">return</span>;
<a name="l00601"></a>00601    }
<a name="l00602"></a>00602    
<a name="l00603"></a>00603    <span class="comment">/* here comes a hack to replace the (not existing) &quot;name&quot; element with the &quot;ports&quot; element */</span>
<a name="l00604"></a>00604    <span class="keywordflow">if</span> (elem == <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>) {
<a name="l00605"></a>00605       <span class="keywordflow">if</span> (!snprintf(buf, bufsize, <span class="stringliteral">&quot;ports&quot;</span>))
<a name="l00606"></a>00606          memset(buf, 0, 1);
<a name="l00607"></a>00607       <span class="keywordflow">return</span>;
<a name="l00608"></a>00608    }
<a name="l00609"></a>00609 
<a name="l00610"></a>00610    <span class="keywordflow">if</span> ((elem &gt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab150c41adf9cecd32d381a5c1ff16dab">MISDN_CFG_FIRST</a>) &amp;&amp; (elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>))
<a name="l00611"></a>00611       spec = (<span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> *)port_spec;
<a name="l00612"></a>00612    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((elem &gt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa50f2df70cb915612835a13a49c5fef81">MISDN_GEN_FIRST</a>) &amp;&amp; (elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabeb4c50c2d53fffe39ee8c2fcc4cbc80">MISDN_GEN_LAST</a>))
<a name="l00613"></a>00613       spec = (<span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> *)gen_spec;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615    <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf, spec ? spec[place].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a> : <span class="stringliteral">&quot;&quot;</span>, bufsize);
<a name="l00616"></a>00616 }
<a name="l00617"></a>00617 
<a name="l00618"></a><a class="code" href="chan__misdn__config_8h.html#ab4fe73c162f2208a725cef8825a36de9">00618</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#ab4fe73c162f2208a725cef8825a36de9">misdn_cfg_get_desc</a> (<span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3a">misdn_cfg_elements</a> <a class="code" href="structmisdn__cfg__spec.html#a1865504fb01a2e4ec328ccb0699f5a36">elem</a>, <span class="keywordtype">void</span> *<a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="keywordtype">int</span> bufsize, <span class="keywordtype">void</span> *buf_default, <span class="keywordtype">int</span> bufsize_default)
<a name="l00619"></a>00619 {
<a name="l00620"></a>00620    <span class="keywordtype">int</span> place = map[elem];
<a name="l00621"></a>00621    <span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> *spec = NULL;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623    <span class="comment">/* here comes a hack to replace the (not existing) &quot;name&quot; element with the &quot;ports&quot; element */</span>
<a name="l00624"></a>00624    <span class="keywordflow">if</span> (elem == <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>) {
<a name="l00625"></a>00625       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf, ports_description, bufsize);
<a name="l00626"></a>00626       <span class="keywordflow">if</span> (buf_default &amp;&amp; bufsize_default)
<a name="l00627"></a>00627          memset(buf_default, 0, 1);
<a name="l00628"></a>00628       <span class="keywordflow">return</span>;
<a name="l00629"></a>00629    }
<a name="l00630"></a>00630 
<a name="l00631"></a>00631    <span class="keywordflow">if</span> ((elem &gt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab150c41adf9cecd32d381a5c1ff16dab">MISDN_CFG_FIRST</a>) &amp;&amp; (elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>))
<a name="l00632"></a>00632       spec = (<span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> *)port_spec;
<a name="l00633"></a>00633    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((elem &gt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa50f2df70cb915612835a13a49c5fef81">MISDN_GEN_FIRST</a>) &amp;&amp; (elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabeb4c50c2d53fffe39ee8c2fcc4cbc80">MISDN_GEN_LAST</a>))
<a name="l00634"></a>00634       spec = (<span class="keyword">struct </span><a class="code" href="structmisdn__cfg__spec.html">misdn_cfg_spec</a> *)gen_spec;
<a name="l00635"></a>00635       
<a name="l00636"></a>00636    <span class="keywordflow">if</span> (!spec || !spec[place].<a class="code" href="channel_8c.html#a710bce51374aba96ab04912897666c35">desc</a>)
<a name="l00637"></a>00637       memset(buf, 0, 1);
<a name="l00638"></a>00638    <span class="keywordflow">else</span> {
<a name="l00639"></a>00639       <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf, spec[place].desc, bufsize);
<a name="l00640"></a>00640       <span class="keywordflow">if</span> (buf_default &amp;&amp; bufsize) {
<a name="l00641"></a>00641          <span class="keywordflow">if</span> (!strcmp(spec[place].<a class="code" href="structmisdn__cfg__spec.html#a06df8b8b6c73d221965c28812a1c149e">def</a>, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>))
<a name="l00642"></a>00642             memset(buf_default, 0, 1);
<a name="l00643"></a>00643          <span class="keywordflow">else</span>
<a name="l00644"></a>00644             <a class="code" href="strings_8h.html#a17df4d252f3e2ecb230b526475ac4d93" title="Size-limited null-terminating string copy.">ast_copy_string</a>(buf_default, spec[place].def, bufsize_default);
<a name="l00645"></a>00645       }
<a name="l00646"></a>00646    }
<a name="l00647"></a>00647 }
<a name="l00648"></a>00648 
<a name="l00649"></a><a class="code" href="chan__misdn__config_8h.html#a1ff611ca63fed235f7cb668f96f94ed5">00649</a> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#a1ff611ca63fed235f7cb668f96f94ed5">misdn_cfg_is_msn_valid</a> (<span class="keywordtype">int</span> port, <span class="keywordtype">char</span>* msn)
<a name="l00650"></a>00650 {
<a name="l00651"></a>00651    <span class="keywordtype">int</span> re = 0;
<a name="l00652"></a>00652    <span class="keyword">struct </span><a class="code" href="structmsn__list.html">msn_list</a> *iter;
<a name="l00653"></a>00653 
<a name="l00654"></a>00654    <span class="keywordflow">if</span> (!<a class="code" href="misdn__config_8c.html#ab08e8e7e093f022d1a156fe2d6ebdf45">misdn_cfg_is_port_valid</a>(port)) {
<a name="l00655"></a>00655       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid call to misdn_cfg_is_msn_valid! Port number %d is not valid.\n&quot;</span>, port);
<a name="l00656"></a>00656       <span class="keywordflow">return</span> 0;
<a name="l00657"></a>00657    }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l00660"></a>00660    <span class="keywordflow">if</span> (port_cfg[port][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aad27ef0e52b8b1967ba96cadc8994bb86">MISDN_CFG_MSNS</a>]].ml)
<a name="l00661"></a>00661       iter = port_cfg[port][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aad27ef0e52b8b1967ba96cadc8994bb86">MISDN_CFG_MSNS</a>]].<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>;
<a name="l00662"></a>00662    <span class="keywordflow">else</span>
<a name="l00663"></a>00663       iter = port_cfg[0][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aad27ef0e52b8b1967ba96cadc8994bb86">MISDN_CFG_MSNS</a>]].<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>;
<a name="l00664"></a>00664    <span class="keywordflow">for</span> (; iter; iter = iter-&gt;<a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">next</a>) 
<a name="l00665"></a>00665       <span class="keywordflow">if</span> (*(iter-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>) == <span class="charliteral">&apos;*&apos;</span> || <a class="code" href="pbx_8h.html#a94cf2f099462a906620b5566871af797" title="Determine if a given extension matches a given pattern (in NXX format).">ast_extension_match</a>(iter-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>, msn)) {
<a name="l00666"></a>00666          re = 1;
<a name="l00667"></a>00667          <span class="keywordflow">break</span>;
<a name="l00668"></a>00668       }
<a name="l00669"></a>00669    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l00670"></a>00670 
<a name="l00671"></a>00671    <span class="keywordflow">return</span> re;
<a name="l00672"></a>00672 }
<a name="l00673"></a>00673 
<a name="l00674"></a><a class="code" href="chan__misdn__config_8h.html#ab08e8e7e093f022d1a156fe2d6ebdf45">00674</a> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#ab08e8e7e093f022d1a156fe2d6ebdf45">misdn_cfg_is_port_valid</a> (<span class="keywordtype">int</span> port)
<a name="l00675"></a>00675 {
<a name="l00676"></a>00676    <span class="keywordtype">int</span> gn = map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>];
<a name="l00677"></a>00677 
<a name="l00678"></a>00678    <span class="keywordflow">return</span> (port &gt;= 1 &amp;&amp; port &lt;= max_ports &amp;&amp; port_cfg[port][gn].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>);
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a><a class="code" href="chan__misdn__config_8h.html#abd7fda190c06742b1b32025dfa1776b5">00681</a> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#abd7fda190c06742b1b32025dfa1776b5">misdn_cfg_is_group_method</a> (<span class="keywordtype">char</span> *<a class="code" href="structgroup.html">group</a>, <span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#a9ce7b5b14a6c33d74b03a70feab95c92">misdn_cfg_method</a> meth)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683    <span class="keywordtype">int</span> i, re = 0;
<a name="l00684"></a>00684    <span class="keywordtype">char</span> *method ;
<a name="l00685"></a>00685 
<a name="l00686"></a>00686    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l00687"></a>00687 
<a name="l00688"></a>00688    method = port_cfg[0][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa987f6cab53c31e4d59eb76f485d7cf14">MISDN_CFG_METHOD</a>]].<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    <span class="keywordflow">for</span> (i = 1; i &lt;= max_ports; i++) {
<a name="l00691"></a>00691       <span class="keywordflow">if</span> (port_cfg[i] &amp;&amp; port_cfg[i][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>]].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00692"></a>00692          <span class="keywordflow">if</span> (!strcasecmp(port_cfg[i][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>]].str, group))
<a name="l00693"></a>00693             method = (port_cfg[i][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa987f6cab53c31e4d59eb76f485d7cf14">MISDN_CFG_METHOD</a>]].<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> ? 
<a name="l00694"></a>00694                     port_cfg[i][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa987f6cab53c31e4d59eb76f485d7cf14">MISDN_CFG_METHOD</a>]].<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> : port_cfg[0][map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa987f6cab53c31e4d59eb76f485d7cf14">MISDN_CFG_METHOD</a>]].<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);
<a name="l00695"></a>00695       }
<a name="l00696"></a>00696    }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698    <span class="keywordflow">if</span> (method) {
<a name="l00699"></a>00699       <span class="keywordflow">switch</span> (meth) {
<a name="l00700"></a>00700       <span class="keywordflow">case</span> <a class="code" href="chan__misdn__config_8h.html#a9ce7b5b14a6c33d74b03a70feab95c92a9b70807fba6cc7c0cc71315e8780494a">METHOD_STANDARD</a>:      re = !strcasecmp(method, <span class="stringliteral">&quot;standard&quot;</span>);
<a name="l00701"></a>00701                            <span class="keywordflow">break</span>;
<a name="l00702"></a>00702       <span class="keywordflow">case</span> <a class="code" href="chan__misdn__config_8h.html#a9ce7b5b14a6c33d74b03a70feab95c92aae039733b86f215ef5e8e0f7472e178b">METHOD_ROUND_ROBIN</a>:   re = !strcasecmp(method, <span class="stringliteral">&quot;round_robin&quot;</span>);
<a name="l00703"></a>00703                            <span class="keywordflow">break</span>;
<a name="l00704"></a>00704       <span class="keywordflow">case</span> <a class="code" href="chan__misdn__config_8h.html#a9ce7b5b14a6c33d74b03a70feab95c92abe93bc1ee9b0980c424e3442874ee818">METHOD_STANDARD_DEC</a>:  re = !strcasecmp(method, <span class="stringliteral">&quot;standard_dec&quot;</span>);
<a name="l00705"></a>00705                            <span class="keywordflow">break</span>;
<a name="l00706"></a>00706       }
<a name="l00707"></a>00707    }
<a name="l00708"></a>00708    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l00709"></a>00709 
<a name="l00710"></a>00710    <span class="keywordflow">return</span> re;
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 <span class="comment"></span>
<a name="l00713"></a>00713 <span class="comment">/*! </span>
<a name="l00714"></a>00714 <span class="comment"> * \brief Generate a comma separated list of all active ports</span>
<a name="l00715"></a>00715 <span class="comment"> */</span>
<a name="l00716"></a><a class="code" href="chan__misdn__config_8h.html#a5b0f1d6d9689fea5b7eba75176d06cc7">00716</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a5b0f1d6d9689fea5b7eba75176d06cc7" title="Generate a comma separated list of all active ports.">misdn_cfg_get_ports_string</a> (<span class="keywordtype">char</span> *ports)
<a name="l00717"></a>00717 {
<a name="l00718"></a>00718    <span class="keywordtype">char</span> tmp[16];
<a name="l00719"></a>00719    <span class="keywordtype">int</span> l, i;
<a name="l00720"></a>00720    <span class="keywordtype">int</span> gn = map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>];
<a name="l00721"></a>00721 
<a name="l00722"></a>00722    *ports = 0;
<a name="l00723"></a>00723 
<a name="l00724"></a>00724    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l00725"></a>00725    <span class="keywordflow">for</span> (i = 1; i &lt;= max_ports; i++) {
<a name="l00726"></a>00726       <span class="keywordflow">if</span> (port_cfg[i][gn].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00727"></a>00727          <span class="keywordflow">if</span> (ptp[i])
<a name="l00728"></a>00728             sprintf(tmp, <span class="stringliteral">&quot;%dptp,&quot;</span>, i);
<a name="l00729"></a>00729          <span class="keywordflow">else</span>
<a name="l00730"></a>00730             sprintf(tmp, <span class="stringliteral">&quot;%d,&quot;</span>, i);
<a name="l00731"></a>00731          strcat(ports, tmp);
<a name="l00732"></a>00732       }
<a name="l00733"></a>00733    }
<a name="l00734"></a>00734    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l00735"></a>00735 
<a name="l00736"></a>00736    <span class="keywordflow">if</span> ((l = strlen(ports))) {
<a name="l00737"></a>00737       <span class="comment">/* Strip trailing &apos;,&apos; */</span>
<a name="l00738"></a>00738       ports[l-1] = 0;
<a name="l00739"></a>00739    }
<a name="l00740"></a>00740 }
<a name="l00741"></a>00741 
<a name="l00742"></a><a class="code" href="chan__misdn__config_8h.html#ac61399fce05fb3fceea23627e48a7769">00742</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#ac61399fce05fb3fceea23627e48a7769">misdn_cfg_get_config_string</a> (<span class="keywordtype">int</span> port, <span class="keyword">enum</span> <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3a">misdn_cfg_elements</a> elem, <span class="keywordtype">char</span>* <a class="code" href="adsistub_8c.html#aa95cbf1d00929438101e64ee5a216d0c">buf</a>, <span class="keywordtype">int</span> bufsize)
<a name="l00743"></a>00743 {
<a name="l00744"></a>00744    <span class="keywordtype">int</span> place;
<a name="l00745"></a>00745    <span class="keywordtype">char</span> tempbuf[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00746"></a>00746    <span class="keyword">struct </span><a class="code" href="structmsn__list.html">msn_list</a> *iter;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748    <span class="keywordflow">if</span> ((elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>) &amp;&amp; !<a class="code" href="misdn__config_8c.html#ab08e8e7e093f022d1a156fe2d6ebdf45">misdn_cfg_is_port_valid</a>(port)) {
<a name="l00749"></a>00749       *buf = 0;
<a name="l00750"></a>00750       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid call to misdn_cfg_get_config_string! Port number %d is not valid.\n&quot;</span>, port);
<a name="l00751"></a>00751       <span class="keywordflow">return</span>;
<a name="l00752"></a>00752    }
<a name="l00753"></a>00753 
<a name="l00754"></a>00754    place = map[elem];
<a name="l00755"></a>00755 
<a name="l00756"></a>00756    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l00757"></a>00757    <span class="keywordflow">if</span> (elem == <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9c975239458a1af36eb8db7d17dd850d">MISDN_CFG_PTP</a>) {
<a name="l00758"></a>00758       snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; ptp: %s&quot;</span>, ptp[port] ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);
<a name="l00759"></a>00759    }
<a name="l00760"></a>00760    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem &gt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aab150c41adf9cecd32d381a5c1ff16dab">MISDN_CFG_FIRST</a> &amp;&amp; elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e8475d2359cfa83d9061f41c1f3ec1e">MISDN_CFG_LAST</a>) {
<a name="l00761"></a>00761       <span class="keywordflow">switch</span> (port_spec[place].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>) {
<a name="l00762"></a>00762       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>:
<a name="l00763"></a>00763       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>:
<a name="l00764"></a>00764          <span class="keywordflow">if</span> (port_cfg[port][place].<a class="code" href="adsistub_8c.html#af6fc584548091f45267cfaf7066119bd">num</a>)
<a name="l00765"></a>00765             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %d&quot;</span>, port_spec[place].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, *port_cfg[port][place].num);
<a name="l00766"></a>00766          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg[0][place].num)
<a name="l00767"></a>00767             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %d&quot;</span>, port_spec[place].name, *port_cfg[0][place].num);
<a name="l00768"></a>00768          <span class="keywordflow">else</span>
<a name="l00769"></a>00769             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, port_spec[place].name);
<a name="l00770"></a>00770          <span class="keywordflow">break</span>;
<a name="l00771"></a>00771       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>:
<a name="l00772"></a>00772          <span class="keywordflow">if</span> (port_cfg[port][place].num)
<a name="l00773"></a>00773             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, port_spec[place].name, *port_cfg[port][place].num ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);
<a name="l00774"></a>00774          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg[0][place].num)
<a name="l00775"></a>00775             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, port_spec[place].name, *port_cfg[0][place].num ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);
<a name="l00776"></a>00776          <span class="keywordflow">else</span>
<a name="l00777"></a>00777             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, port_spec[place].name);
<a name="l00778"></a>00778          <span class="keywordflow">break</span>;
<a name="l00779"></a>00779       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a40c3b08f125c2ddf122150790302f80b">MISDN_CTYPE_ASTGROUP</a>:
<a name="l00780"></a>00780          <span class="keywordflow">if</span> (port_cfg[port][place].grp)
<a name="l00781"></a>00781             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, port_spec[place].name, 
<a name="l00782"></a>00782                    <a class="code" href="channel_8h.html#a092d4e67b0bda0f99b02a1534ee75408" title="print call- and pickup groups into buffer">ast_print_group</a>(tempbuf, <span class="keyword">sizeof</span>(tempbuf), *port_cfg[port][place].grp));
<a name="l00783"></a>00783          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg[0][place].grp)
<a name="l00784"></a>00784             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, port_spec[place].name, 
<a name="l00785"></a>00785                    <a class="code" href="channel_8h.html#a092d4e67b0bda0f99b02a1534ee75408" title="print call- and pickup groups into buffer">ast_print_group</a>(tempbuf, <span class="keyword">sizeof</span>(tempbuf), *port_cfg[0][place].grp));
<a name="l00786"></a>00786          <span class="keywordflow">else</span>
<a name="l00787"></a>00787             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, port_spec[place].name);
<a name="l00788"></a>00788          <span class="keywordflow">break</span>;
<a name="l00789"></a>00789       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a1b4b4bec0d3721002c16eb2d28fab14c">MISDN_CTYPE_MSNLIST</a>:
<a name="l00790"></a>00790          <span class="keywordflow">if</span> (port_cfg[port][place].ml)
<a name="l00791"></a>00791             iter = port_cfg[port][place].<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>;
<a name="l00792"></a>00792          <span class="keywordflow">else</span>
<a name="l00793"></a>00793             iter = port_cfg[0][place].<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>;
<a name="l00794"></a>00794          <span class="keywordflow">if</span> (iter) {
<a name="l00795"></a>00795             <span class="keywordflow">for</span> (; iter; iter = iter-&gt;<a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">next</a>) {
<a name="l00796"></a>00796                strncat(tempbuf, iter-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>, <span class="keyword">sizeof</span>(tempbuf) - strlen(tempbuf) - 1);
<a name="l00797"></a>00797             }
<a name="l00798"></a>00798             <span class="keywordflow">if</span> (strlen(tempbuf) &gt; 1) {
<a name="l00799"></a>00799                tempbuf[strlen(tempbuf)-2] = 0;
<a name="l00800"></a>00800             }
<a name="l00801"></a>00801          }
<a name="l00802"></a>00802          snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; msns: %s&quot;</span>, *tempbuf ? tempbuf : <span class="stringliteral">&quot;none&quot;</span>);
<a name="l00803"></a>00803          <span class="keywordflow">break</span>;
<a name="l00804"></a>00804       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>:
<a name="l00805"></a>00805          <span class="keywordflow">if</span> ( port_cfg[port][place].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00806"></a>00806             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, port_spec[place].name, port_cfg[port][place].str);
<a name="l00807"></a>00807          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg[0][place].str) {
<a name="l00808"></a>00808             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, port_spec[place].name, port_cfg[0][place].str);
<a name="l00809"></a>00809          } <span class="keywordflow">else</span> {
<a name="l00810"></a>00810             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, port_spec[place].name);
<a name="l00811"></a>00811          }
<a name="l00812"></a>00812          <span class="keywordflow">break</span>;
<a name="l00813"></a>00813       }
<a name="l00814"></a>00814    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem &gt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa50f2df70cb915612835a13a49c5fef81">MISDN_GEN_FIRST</a> &amp;&amp; elem &lt; <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabeb4c50c2d53fffe39ee8c2fcc4cbc80">MISDN_GEN_LAST</a>) {
<a name="l00815"></a>00815       <span class="keywordflow">switch</span> (gen_spec[place].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>) {
<a name="l00816"></a>00816       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>:
<a name="l00817"></a>00817       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>:
<a name="l00818"></a>00818          <span class="keywordflow">if</span> (general_cfg[place].<a class="code" href="adsistub_8c.html#af6fc584548091f45267cfaf7066119bd">num</a>)
<a name="l00819"></a>00819             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %d&quot;</span>, gen_spec[place].<a class="code" href="cdr__adaptive__odbc_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, *general_cfg[place].num);
<a name="l00820"></a>00820          <span class="keywordflow">else</span>
<a name="l00821"></a>00821             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, gen_spec[place].name);
<a name="l00822"></a>00822          <span class="keywordflow">break</span>;
<a name="l00823"></a>00823       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>:
<a name="l00824"></a>00824          <span class="keywordflow">if</span> (general_cfg[place].num)
<a name="l00825"></a>00825             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, gen_spec[place].name, *general_cfg[place].num ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);
<a name="l00826"></a>00826          <span class="keywordflow">else</span>
<a name="l00827"></a>00827             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, gen_spec[place].name);
<a name="l00828"></a>00828          <span class="keywordflow">break</span>;
<a name="l00829"></a>00829       <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>:
<a name="l00830"></a>00830          <span class="keywordflow">if</span> ( general_cfg[place].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00831"></a>00831             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s: %s&quot;</span>, gen_spec[place].name, general_cfg[place].str);
<a name="l00832"></a>00832          } <span class="keywordflow">else</span> {
<a name="l00833"></a>00833             snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; %s:&quot;</span>, gen_spec[place].name);
<a name="l00834"></a>00834          }
<a name="l00835"></a>00835          <span class="keywordflow">break</span>;
<a name="l00836"></a>00836       <span class="keywordflow">default</span>:
<a name="l00837"></a>00837          snprintf(buf, bufsize, <span class="stringliteral">&quot; -&gt; type of %s not handled yet&quot;</span>, gen_spec[place].name);
<a name="l00838"></a>00838          <span class="keywordflow">break</span>;
<a name="l00839"></a>00839       }
<a name="l00840"></a>00840    } <span class="keywordflow">else</span> {
<a name="l00841"></a>00841       *buf = 0;
<a name="l00842"></a>00842       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid call to misdn_cfg_get_config_string! Invalid config element (%d) requested.\n&quot;</span>, elem);
<a name="l00843"></a>00843    }
<a name="l00844"></a>00844    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l00845"></a>00845 }
<a name="l00846"></a>00846 
<a name="l00847"></a><a class="code" href="chan__misdn__config_8h.html#af6e72d0cfa09c4ab2c5441db492397df">00847</a> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#af6e72d0cfa09c4ab2c5441db492397df">misdn_cfg_get_next_port</a> (<span class="keywordtype">int</span> port)
<a name="l00848"></a>00848 {
<a name="l00849"></a>00849    <span class="keywordtype">int</span> p = -1;
<a name="l00850"></a>00850    <span class="keywordtype">int</span> gn = map[<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa55472c893826f203a64663878f556d41">MISDN_CFG_GROUPNAME</a>];
<a name="l00851"></a>00851    
<a name="l00852"></a>00852    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l00853"></a>00853    <span class="keywordflow">for</span> (port++; port &lt;= max_ports; port++) {
<a name="l00854"></a>00854       <span class="keywordflow">if</span> (port_cfg[port][gn].<a class="code" href="app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>) {
<a name="l00855"></a>00855          p = port;
<a name="l00856"></a>00856          <span class="keywordflow">break</span>;
<a name="l00857"></a>00857       }
<a name="l00858"></a>00858    }
<a name="l00859"></a>00859    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l00860"></a>00860 
<a name="l00861"></a>00861    <span class="keywordflow">return</span> p;
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="chan__misdn__config_8h.html#af9a945b0921e0914c751795dc40af6ea">00864</a> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#af9a945b0921e0914c751795dc40af6ea">misdn_cfg_get_next_port_spin</a> (<span class="keywordtype">int</span> port)
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866    <span class="keywordtype">int</span> p = <a class="code" href="misdn__config_8c.html#af6e72d0cfa09c4ab2c5441db492397df">misdn_cfg_get_next_port</a>(port);
<a name="l00867"></a>00867    <span class="keywordflow">return</span> (p &gt; 0) ? p : <a class="code" href="misdn__config_8c.html#af6e72d0cfa09c4ab2c5441db492397df">misdn_cfg_get_next_port</a>(0);
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 
<a name="l00870"></a><a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">00870</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">_parse</a> (<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *dest, <span class="keyword">const</span> <span class="keywordtype">char</span> *value, <span class="keyword">enum</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1">misdn_cfg_type</a> <a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, <span class="keywordtype">int</span> boolint_def)
<a name="l00871"></a>00871 {
<a name="l00872"></a>00872    <span class="keywordtype">int</span> re = 0;
<a name="l00873"></a>00873    <span class="keywordtype">int</span> <a class="code" href="func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, tmp;
<a name="l00874"></a>00874    <span class="keywordtype">char</span> *valtmp;
<a name="l00875"></a>00875    <span class="keywordtype">char</span> *tmp2 = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(value);
<a name="l00876"></a>00876 
<a name="l00877"></a>00877    <span class="keywordflow">switch</span> (type) {
<a name="l00878"></a>00878    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a3fb9f6eb83f8251d1dca29e9d4db2e59">MISDN_CTYPE_STR</a>:
<a name="l00879"></a>00879       <span class="keywordflow">if</span> (dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>) {
<a name="l00880"></a>00880          <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);
<a name="l00881"></a>00881       }
<a name="l00882"></a>00882       <span class="keywordflow">if</span> ((len = strlen(value))) {
<a name="l00883"></a>00883          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>((len + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00884"></a>00884          strncpy(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, value, len);
<a name="l00885"></a>00885          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[len] = 0;
<a name="l00886"></a>00886       } <span class="keywordflow">else</span> {
<a name="l00887"></a>00887          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00888"></a>00888          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>[0] = 0;
<a name="l00889"></a>00889       }
<a name="l00890"></a>00890       <span class="keywordflow">break</span>;
<a name="l00891"></a>00891    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a38a39f43e1c5ab7d88da012b7d40af64">MISDN_CTYPE_INT</a>:
<a name="l00892"></a>00892    {
<a name="l00893"></a>00893       <span class="keywordtype">int</span> res;
<a name="l00894"></a>00894 
<a name="l00895"></a>00895       <span class="keywordflow">if</span> (strchr(value,<span class="charliteral">&apos;x&apos;</span>)) {
<a name="l00896"></a>00896          res = sscanf(value, <span class="stringliteral">&quot;%30x&quot;</span>, &amp;tmp);
<a name="l00897"></a>00897       } <span class="keywordflow">else</span> {
<a name="l00898"></a>00898          res = sscanf(value, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;tmp);
<a name="l00899"></a>00899       }
<a name="l00900"></a>00900       <span class="keywordflow">if</span> (res) {
<a name="l00901"></a>00901          <span class="keywordflow">if</span> (!dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>) {
<a name="l00902"></a>00902             dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00903"></a>00903          }
<a name="l00904"></a>00904          memcpy(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>, &amp;tmp, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00905"></a>00905       } <span class="keywordflow">else</span>
<a name="l00906"></a>00906          re = -1;
<a name="l00907"></a>00907    }
<a name="l00908"></a>00908       <span class="keywordflow">break</span>;
<a name="l00909"></a>00909    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a41691293175e3c004c27bd122e4c0ac6">MISDN_CTYPE_BOOL</a>:
<a name="l00910"></a>00910       <span class="keywordflow">if</span> (!dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>) {
<a name="l00911"></a>00911          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00912"></a>00912       }
<a name="l00913"></a>00913       *(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>) = (<a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(value) ? 1 : 0);
<a name="l00914"></a>00914       <span class="keywordflow">break</span>;
<a name="l00915"></a>00915    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1ab25b97e6087e720228ebca3b77ebd857">MISDN_CTYPE_BOOLINT</a>:
<a name="l00916"></a>00916       <span class="keywordflow">if</span> (!dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>) {
<a name="l00917"></a>00917          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00918"></a>00918       }
<a name="l00919"></a>00919       <span class="keywordflow">if</span> (sscanf(value, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;tmp)) {
<a name="l00920"></a>00920          memcpy(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>, &amp;tmp, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00921"></a>00921       } <span class="keywordflow">else</span> {
<a name="l00922"></a>00922          *(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#a39966e2d53f3e1554213ef0608ad5e9c">num</a>) = (<a class="code" href="strings_8h.html#a387a69b3871ca31061566a73f45d20f4" title="Make sure something is true. Determine if a string containing a boolean value is...">ast_true</a>(value) ? boolint_def : 0);
<a name="l00923"></a>00923       }
<a name="l00924"></a>00924       <span class="keywordflow">break</span>;
<a name="l00925"></a>00925    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a1b4b4bec0d3721002c16eb2d28fab14c">MISDN_CTYPE_MSNLIST</a>:
<a name="l00926"></a>00926       <span class="keywordflow">for</span> (valtmp = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;tmp2, <span class="stringliteral">&quot;,&quot;</span>); valtmp; valtmp = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;tmp2, <span class="stringliteral">&quot;,&quot;</span>)) {
<a name="l00927"></a>00927          <span class="keywordflow">if</span> ((len = strlen(valtmp))) {
<a name="l00928"></a>00928             <span class="keyword">struct </span><a class="code" href="structmsn__list.html">msn_list</a> *ml = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(*ml));
<a name="l00929"></a>00929             ml-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a> = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(len+1, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l00930"></a>00930             strncpy(ml-&gt;<a class="code" href="structmsn__list.html#a990f0b7206ba433fb3a7a8bfce56aea1">msn</a>, valtmp, len);
<a name="l00931"></a>00931             ml-&gt;<a class="code" href="structmsn__list.html#a59d10cdc7a1bafbb6761bd9e05ceb16e">next</a> = dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a>;
<a name="l00932"></a>00932             dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#abf455f77ca59efd9c05449072b886e4e">ml</a> = ml;
<a name="l00933"></a>00933          }
<a name="l00934"></a>00934       }
<a name="l00935"></a>00935       <span class="keywordflow">break</span>;
<a name="l00936"></a>00936    <span class="keywordflow">case</span> <a class="code" href="misdn__config_8c.html#a0d6c46c9eae8390716fac867baef16e1a40c3b08f125c2ddf122150790302f80b">MISDN_CTYPE_ASTGROUP</a>:
<a name="l00937"></a>00937       <span class="keywordflow">if</span> (!dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#af18db33a9880bbb832e539ff639b0411">grp</a>) {
<a name="l00938"></a>00938          dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#af18db33a9880bbb832e539ff639b0411">grp</a> = <a class="code" href="astmm_8h.html#a64a0e7a3ab511a3777ac56f5d43c628e">ast_malloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="channel_8h.html#a641d81d0c5c8df99d43eff69aede3bfd">ast_group_t</a>));
<a name="l00939"></a>00939       }
<a name="l00940"></a>00940       *(dest-&gt;<a class="code" href="unionmisdn__cfg__pt.html#af18db33a9880bbb832e539ff639b0411">grp</a>) = <a class="code" href="channel_8h.html#aee83e23058d0a4111fda1f506cbda107">ast_get_group</a>(value);
<a name="l00941"></a>00941       <span class="keywordflow">break</span>;
<a name="l00942"></a>00942    }
<a name="l00943"></a>00943 
<a name="l00944"></a>00944    <span class="keywordflow">return</span> re;
<a name="l00945"></a>00945 }
<a name="l00946"></a>00946 
<a name="l00947"></a><a class="code" href="misdn__config_8c.html#a807a1c4e4bed91c39a20e320dcb6947d">00947</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a807a1c4e4bed91c39a20e320dcb6947d">_build_general_config</a> (<span class="keyword">struct</span> <a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *v)
<a name="l00948"></a>00948 {
<a name="l00949"></a>00949    <span class="keywordtype">int</span> pos;
<a name="l00950"></a>00950 
<a name="l00951"></a>00951    <span class="keywordflow">for</span> (; v; v = v-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l00952"></a>00952       <span class="keywordflow">if</span> (!<a class="code" href="abstract__jb_8h.html#ae50ad081bd2ae6b58bcfc4687916c586" title="Sets jitterbuffer configuration property.">ast_jb_read_conf</a>(&amp;<a class="code" href="misdn__config_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>, v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>))
<a name="l00953"></a>00953          <span class="keywordflow">continue</span>;
<a name="l00954"></a>00954       <span class="keywordflow">if</span> (((pos = <a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">get_cfg_position</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <a class="code" href="misdn__config_8c.html#ac83a664de90770af20fa45e23a2f6a0b">GEN_CFG</a>)) &lt; 0) || 
<a name="l00955"></a>00955          (<a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">_parse</a>(&amp;general_cfg[pos], v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, gen_spec[pos].<a class="code" href="structmisdn__cfg__spec.html#a88b351b6cfc442e1679c9537bca61cab">type</a>, gen_spec[pos].<a class="code" href="structmisdn__cfg__spec.html#a8d928300435d8100e57a316008d390b7">boolint_def</a>) &lt; 0))
<a name="l00956"></a>00956          <a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">CLI_ERROR</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="stringliteral">&quot;general&quot;</span>);
<a name="l00957"></a>00957    }
<a name="l00958"></a>00958 }
<a name="l00959"></a>00959 
<a name="l00960"></a><a class="code" href="misdn__config_8c.html#ac54122236fbe57164ee22e04c8a546f3">00960</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#ac54122236fbe57164ee22e04c8a546f3">_build_port_config</a> (<span class="keyword">struct</span> <a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *v, <span class="keywordtype">char</span> *cat)
<a name="l00961"></a>00961 {
<a name="l00962"></a>00962    <span class="keywordtype">int</span> pos, i;
<a name="l00963"></a>00963    <span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> cfg_tmp[NUM_PORT_ELEMENTS];
<a name="l00964"></a>00964    <span class="keywordtype">int</span> cfg_for_ports[max_ports + 1];
<a name="l00965"></a>00965 
<a name="l00966"></a>00966    <span class="keywordflow">if</span> (!v || !cat)
<a name="l00967"></a>00967       <span class="keywordflow">return</span>;
<a name="l00968"></a>00968 
<a name="l00969"></a>00969    memset(cfg_tmp, 0, <span class="keyword">sizeof</span>(cfg_tmp));
<a name="l00970"></a>00970    memset(cfg_for_ports, 0, <span class="keyword">sizeof</span>(cfg_for_ports));
<a name="l00971"></a>00971 
<a name="l00972"></a>00972    <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;default&quot;</span>)) {
<a name="l00973"></a>00973       cfg_for_ports[0] = 1;
<a name="l00974"></a>00974    }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976    <span class="keywordflow">if</span> (((pos = <a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">get_cfg_position</a>(<span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="misdn__config_8c.html#af239c62f325c4a450832ba971ad30594">PORT_CFG</a>)) &lt; 0) || 
<a name="l00977"></a>00977       (<a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">_parse</a>(&amp;cfg_tmp[pos], cat, port_spec[pos].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, port_spec[pos].boolint_def) &lt; 0)) {
<a name="l00978"></a>00978       <a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">CLI_ERROR</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, cat);
<a name="l00979"></a>00979       <span class="keywordflow">return</span>;
<a name="l00980"></a>00980    }
<a name="l00981"></a>00981 
<a name="l00982"></a>00982    <span class="keywordflow">for</span> (; v; v = v-&gt;<a class="code" href="structast__variable.html#a46f18867e3894852bc489a4cd9cfa516">next</a>) {
<a name="l00983"></a>00983       <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ports&quot;</span>)) {
<a name="l00984"></a>00984          <span class="keywordtype">char</span> *token, *tmp = <a class="code" href="utils_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6" title="duplicate a string in memory from the stack">ast_strdupa</a>(v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);
<a name="l00985"></a>00985          <span class="keywordtype">char</span> ptpbuf[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>] = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00986"></a>00986          <span class="keywordtype">int</span> start, end;
<a name="l00987"></a>00987          <span class="keywordflow">for</span> (token = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;tmp, <span class="stringliteral">&quot;,&quot;</span>); token; token = <a class="code" href="agi_2strcompat_8c.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;tmp, <span class="stringliteral">&quot;,&quot;</span>), *ptpbuf = 0) { 
<a name="l00988"></a>00988             <span class="keywordflow">if</span> (!*token)
<a name="l00989"></a>00989                <span class="keywordflow">continue</span>;
<a name="l00990"></a>00990             <span class="keywordflow">if</span> (sscanf(token, <span class="stringliteral">&quot;%30d-%30d%511s&quot;</span>, &amp;start, &amp;end, ptpbuf) &gt;= 2) {
<a name="l00991"></a>00991                <span class="keywordflow">for</span> (; start &lt;= end; start++) {
<a name="l00992"></a>00992                   <span class="keywordflow">if</span> (start &lt;= max_ports &amp;&amp; start &gt; 0) {
<a name="l00993"></a>00993                      cfg_for_ports[start] = 1;
<a name="l00994"></a>00994                      ptp[start] = (strstr(ptpbuf, <span class="stringliteral">&quot;ptp&quot;</span>)) ? 1 : 0;
<a name="l00995"></a>00995                   } <span class="keywordflow">else</span>
<a name="l00996"></a>00996                      <a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">CLI_ERROR</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, cat);
<a name="l00997"></a>00997                }
<a name="l00998"></a>00998             } <span class="keywordflow">else</span> {
<a name="l00999"></a>00999                <span class="keywordflow">if</span> (sscanf(token, <span class="stringliteral">&quot;%30d%511s&quot;</span>, &amp;start, ptpbuf)) {
<a name="l01000"></a>01000                   <span class="keywordflow">if</span> (start &lt;= max_ports &amp;&amp; start &gt; 0) {
<a name="l01001"></a>01001                      cfg_for_ports[start] = 1;
<a name="l01002"></a>01002                      ptp[start] = (strstr(ptpbuf, <span class="stringliteral">&quot;ptp&quot;</span>)) ? 1 : 0;
<a name="l01003"></a>01003                   } <span class="keywordflow">else</span>
<a name="l01004"></a>01004                      <a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">CLI_ERROR</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, cat);
<a name="l01005"></a>01005                } <span class="keywordflow">else</span>
<a name="l01006"></a>01006                   <a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">CLI_ERROR</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, cat);
<a name="l01007"></a>01007             }
<a name="l01008"></a>01008          }
<a name="l01009"></a>01009       } <span class="keywordflow">else</span> {
<a name="l01010"></a>01010          <span class="keywordflow">if</span> (((pos = <a class="code" href="misdn__config_8c.html#aa8d3573401dc0c81640d196c819e9b9d">get_cfg_position</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <a class="code" href="misdn__config_8c.html#af239c62f325c4a450832ba971ad30594">PORT_CFG</a>)) &lt; 0) || 
<a name="l01011"></a>01011             (<a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">_parse</a>(&amp;cfg_tmp[pos], v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, port_spec[pos].<a class="code" href="structmisdn__cfg__spec.html#a88b351b6cfc442e1679c9537bca61cab">type</a>, port_spec[pos].<a class="code" href="structmisdn__cfg__spec.html#a8d928300435d8100e57a316008d390b7">boolint_def</a>) &lt; 0))
<a name="l01012"></a>01012             <a class="code" href="misdn__config_8c.html#a7ecf4ce12140fcf92774233f0d480f99">CLI_ERROR</a>(v-&gt;<a class="code" href="structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, cat);
<a name="l01013"></a>01013       }
<a name="l01014"></a>01014    }
<a name="l01015"></a>01015 
<a name="l01016"></a>01016    <span class="keywordflow">for</span> (i = 0; i &lt; (max_ports + 1); ++i) {
<a name="l01017"></a>01017       <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; cfg_for_ports[0]) {
<a name="l01018"></a>01018          <span class="comment">/* default category, will populate the port_cfg with additional port</span>
<a name="l01019"></a>01019 <span class="comment">         categories in subsequent calls to this function */</span>
<a name="l01020"></a>01020          memset(cfg_tmp, 0, <span class="keyword">sizeof</span>(cfg_tmp));
<a name="l01021"></a>01021       }
<a name="l01022"></a>01022       <span class="keywordflow">if</span> (cfg_for_ports[i]) {
<a name="l01023"></a>01023          memcpy(port_cfg[i], cfg_tmp, <span class="keyword">sizeof</span>(cfg_tmp));
<a name="l01024"></a>01024       }
<a name="l01025"></a>01025    }
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a><a class="code" href="chan__misdn__config_8h.html#ac2740a8103bd868c78d5f7f6c0985d6d">01028</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#ac2740a8103bd868c78d5f7f6c0985d6d">misdn_cfg_update_ptp</a> (<span class="keywordtype">void</span>)
<a name="l01029"></a>01029 {
<a name="l01030"></a>01030 <span class="preprocessor">#ifndef MISDN_1_2</span>
<a name="l01031"></a>01031 <span class="preprocessor"></span>   <span class="keywordtype">char</span> misdn_init[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>];
<a name="l01032"></a>01032    <span class="keywordtype">char</span> line[<a class="code" href="chan__misdn__config_8h.html#ac3146f1e9227301bb4aa518f4d336cee">BUFFERSIZE</a>];
<a name="l01033"></a>01033    FILE *fp;
<a name="l01034"></a>01034    <span class="keywordtype">char</span> *tok, *p, *end;
<a name="l01035"></a>01035    <span class="keywordtype">int</span> port;
<a name="l01036"></a>01036 
<a name="l01037"></a>01037    <a class="code" href="misdn__config_8c.html#a0f6a5bee3a29bd963f565c6b474f2b23">misdn_cfg_get</a>(0, <a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aa9e4f8d28e6bf873400924bb0161807c9">MISDN_GEN_MISDN_INIT</a>, &amp;misdn_init, <span class="keyword">sizeof</span>(misdn_init));
<a name="l01038"></a>01038 
<a name="l01039"></a>01039    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#a5c8aa5212ecb665fb072eac00c799da6">ast_strlen_zero</a>(misdn_init)) {
<a name="l01040"></a>01040       fp = fopen(misdn_init, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l01041"></a>01041       <span class="keywordflow">if</span> (fp) {
<a name="l01042"></a>01042          <span class="keywordflow">while</span>(fgets(line, <span class="keyword">sizeof</span>(line), fp)) {
<a name="l01043"></a>01043             <span class="keywordflow">if</span> (!strncmp(line, <span class="stringliteral">&quot;nt_ptp&quot;</span>, 6)) {
<a name="l01044"></a>01044                <span class="keywordflow">for</span> (tok = strtok_r(line,<span class="stringliteral">&quot;,=&quot;</span>, &amp;p);
<a name="l01045"></a>01045                    tok;
<a name="l01046"></a>01046                    tok = strtok_r(NULL,<span class="stringliteral">&quot;,=&quot;</span>, &amp;p)) {
<a name="l01047"></a>01047                   port = strtol(tok, &amp;end, 10);
<a name="l01048"></a>01048                   <span class="keywordflow">if</span> (end != tok &amp;&amp; <a class="code" href="misdn__config_8c.html#ab08e8e7e093f022d1a156fe2d6ebdf45">misdn_cfg_is_port_valid</a>(port)) {
<a name="l01049"></a>01049                      <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l01050"></a>01050                      ptp[port] = 1;
<a name="l01051"></a>01051                      <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l01052"></a>01052                   }
<a name="l01053"></a>01053                }
<a name="l01054"></a>01054             }
<a name="l01055"></a>01055          }
<a name="l01056"></a>01056          fclose(fp);
<a name="l01057"></a>01057       } <span class="keywordflow">else</span> {
<a name="l01058"></a>01058          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,<span class="stringliteral">&quot;Couldn&apos;t open %s: %s\n&quot;</span>, misdn_init, strerror(<a class="code" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));
<a name="l01059"></a>01059       }
<a name="l01060"></a>01060    }
<a name="l01061"></a>01061 <span class="preprocessor">#else</span>
<a name="l01062"></a>01062 <span class="preprocessor"></span>   <span class="keywordtype">int</span> i;
<a name="l01063"></a>01063    <span class="keywordtype">int</span> proto;
<a name="l01064"></a>01064    <span class="keywordtype">char</span> filename[128];
<a name="l01065"></a>01065    FILE *fp;
<a name="l01066"></a>01066 
<a name="l01067"></a>01067    <span class="keywordflow">for</span> (i = 1; i &lt;= max_ports; ++i) {
<a name="l01068"></a>01068       snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;/sys/class/mISDN-stacks/st-%08x/protocol&quot;</span>, i &lt;&lt; 8);
<a name="l01069"></a>01069       fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l01070"></a>01070       <span class="keywordflow">if</span> (!fp) {
<a name="l01071"></a>01071          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not open %s: %s\n&quot;</span>, filename, strerror(<a class="code" href="private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));
<a name="l01072"></a>01072          <span class="keywordflow">continue</span>;
<a name="l01073"></a>01073       }
<a name="l01074"></a>01074       <span class="keywordflow">if</span> (fscanf(fp, <span class="stringliteral">&quot;0x%08x&quot;</span>, &amp;proto) != 1)
<a name="l01075"></a>01075          <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not parse contents of %s!\n&quot;</span>, filename);
<a name="l01076"></a>01076       <span class="keywordflow">else</span>
<a name="l01077"></a>01077          ptp[i] = proto &amp; 1&lt;&lt;5 ? 1 : 0;
<a name="l01078"></a>01078       fclose(fp);
<a name="l01079"></a>01079    }
<a name="l01080"></a>01080 <span class="preprocessor">#endif</span>
<a name="l01081"></a>01081 <span class="preprocessor"></span>}
<a name="l01082"></a>01082 
<a name="l01083"></a><a class="code" href="misdn__config_8c.html#a92f772f3a8fca25a32f035720398cda2">01083</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a92f772f3a8fca25a32f035720398cda2">_fill_defaults</a> (<span class="keywordtype">void</span>)
<a name="l01084"></a>01084 {
<a name="l01085"></a>01085    <span class="keywordtype">int</span> i;
<a name="l01086"></a>01086 
<a name="l01087"></a>01087    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a>; ++i) {
<a name="l01088"></a>01088       <span class="keywordflow">if</span> (!port_cfg[0][i].<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a> &amp;&amp; strcasecmp(port_spec[i].def, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>))
<a name="l01089"></a>01089          <a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">_parse</a>(&amp;(port_cfg[0][i]), (<span class="keywordtype">char</span> *)port_spec[i].def, port_spec[i].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, port_spec[i].boolint_def);
<a name="l01090"></a>01090    }
<a name="l01091"></a>01091    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">NUM_GEN_ELEMENTS</a>; ++i) {
<a name="l01092"></a>01092       <span class="keywordflow">if</span> (!general_cfg[i].<a class="code" href="unionmisdn__cfg__pt.html#ac68c3e928adb45a5992d721df3db2505">any</a> &amp;&amp; strcasecmp(gen_spec[i].def, <a class="code" href="misdn__config_8c.html#a79ca2b7c3ff47cfcc56e767e92d3f000">NO_DEFAULT</a>))
<a name="l01093"></a>01093          <a class="code" href="misdn__config_8c.html#a67ad6725e9690d51f7e59ab628b661f0">_parse</a>(&amp;(general_cfg[i]), (<span class="keywordtype">char</span> *)gen_spec[i].def, gen_spec[i].<a class="code" href="evt_8c.html#a69e2889a94aeb9ac881abb82d3c22116">type</a>, gen_spec[i].boolint_def);
<a name="l01094"></a>01094    }
<a name="l01095"></a>01095 }
<a name="l01096"></a>01096 
<a name="l01097"></a><a class="code" href="chan__misdn__config_8h.html#af82466ea24146caeace6cdd5d7aba315">01097</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#af82466ea24146caeace6cdd5d7aba315">misdn_cfg_reload</a> (<span class="keywordtype">void</span>)
<a name="l01098"></a>01098 {
<a name="l01099"></a>01099    <a class="code" href="misdn__config_8c.html#aaa71f22ac88cd27d275bf6fbb7648f66">misdn_cfg_init</a>(0, 1);
<a name="l01100"></a>01100 }
<a name="l01101"></a>01101 
<a name="l01102"></a><a class="code" href="chan__misdn__config_8h.html#a59f113bee91d678988a1c3d8ddbdb2dc">01102</a> <span class="keywordtype">void</span> <a class="code" href="misdn__config_8c.html#a59f113bee91d678988a1c3d8ddbdb2dc">misdn_cfg_destroy</a> (<span class="keywordtype">void</span>)
<a name="l01103"></a>01103 {
<a name="l01104"></a>01104    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l01105"></a>01105 
<a name="l01106"></a>01106    <a class="code" href="misdn__config_8c.html#a023bb61b2e014d422690936565fcb69e">_free_port_cfg</a>();
<a name="l01107"></a>01107    <a class="code" href="misdn__config_8c.html#a259567e54b2d303629277af2e67c6bfa">_free_general_cfg</a>();
<a name="l01108"></a>01108 
<a name="l01109"></a>01109    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(port_cfg);
<a name="l01110"></a>01110    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(general_cfg);
<a name="l01111"></a>01111    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ptp);
<a name="l01112"></a>01112    <a class="code" href="astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(map);
<a name="l01113"></a>01113 
<a name="l01114"></a>01114    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l01115"></a>01115    <a class="code" href="lock_8h.html#ab237e70b569019bfb490ab0c3c09b8c5">ast_mutex_destroy</a>(&amp;config_mutex);
<a name="l01116"></a>01116 }
<a name="l01117"></a>01117 
<a name="l01118"></a><a class="code" href="chan__misdn__config_8h.html#a5cc183f54c105ba066b4f005e3886ba9">01118</a> <span class="keywordtype">int</span> <a class="code" href="misdn__config_8c.html#aaa71f22ac88cd27d275bf6fbb7648f66">misdn_cfg_init</a>(<span class="keywordtype">int</span> this_max_ports, <span class="keywordtype">int</span> <a class="code" href="app__amd_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>)
<a name="l01119"></a>01119 {
<a name="l01120"></a>01120    <span class="keywordtype">char</span> <a class="code" href="cdr__csv_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>[] = <span class="stringliteral">&quot;misdn.conf&quot;</span>;
<a name="l01121"></a>01121    <span class="keywordtype">char</span> *cat, *p;
<a name="l01122"></a>01122    <span class="keywordtype">int</span> i;
<a name="l01123"></a>01123    <span class="keyword">struct </span><a class="code" href="structast__config.html">ast_config</a> *cfg;
<a name="l01124"></a>01124    <span class="keyword">struct </span><a class="code" href="structast__variable.html" title="Structure for variables, used for configurations and for channel variables.">ast_variable</a> *v;
<a name="l01125"></a>01125    <span class="keyword">struct </span><a class="code" href="structast__flags.html" title="Structure used to handle boolean flags.">ast_flags</a> config_flags = { reload ? <a class="code" href="config_8h.html#a2d5492e116eebd5075f247d21fb9db26afa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };
<a name="l01126"></a>01126 
<a name="l01127"></a>01127    <span class="keywordflow">if</span> (!(cfg = <a class="code" href="config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9" title="Load a config file.">ast_config_load2</a>(config, <span class="stringliteral">&quot;chan_misdn&quot;</span>, config_flags)) || cfg == <a class="code" href="config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {
<a name="l01128"></a>01128       <a class="code" href="logger_8h.html#a93dd824dff97fe84941d6d71b7a3710e" title="Used for sending a log message This is the standard logger function. Probably the...">ast_log</a>(<a class="code" href="logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;missing or invalid file: misdn.conf\n&quot;</span>);
<a name="l01129"></a>01129       <span class="keywordflow">return</span> -1;
<a name="l01130"></a>01130    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>)
<a name="l01131"></a>01131       <span class="keywordflow">return</span> 0;
<a name="l01132"></a>01132 
<a name="l01133"></a>01133    <a class="code" href="lock_8h.html#a5dc895fe6e8c089175159fc22e33fc3b">ast_mutex_init</a>(&amp;config_mutex);
<a name="l01134"></a>01134 
<a name="l01135"></a>01135    <span class="comment">/* Copy the default jb config over global_jbconf */</span>
<a name="l01136"></a>01136    memcpy(&amp;<a class="code" href="misdn__config_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>, &amp;default_jbconf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__jb__conf.html" title="General jitterbuffer configuration.">ast_jb_conf</a>));
<a name="l01137"></a>01137 
<a name="l01138"></a>01138    <a class="code" href="misdn__config_8c.html#a0a5150edaaeab71511aa854c2004b040">misdn_cfg_lock</a>();
<a name="l01139"></a>01139 
<a name="l01140"></a>01140    <span class="keywordflow">if</span> (this_max_ports) {
<a name="l01141"></a>01141       <span class="comment">/* this is the first run */</span>
<a name="l01142"></a>01142       max_ports = this_max_ports;
<a name="l01143"></a>01143       map = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(<a class="code" href="chan__misdn__config_8h.html#ab42ce2e5d6c691e8574ff55f3b285e3aabeb4c50c2d53fffe39ee8c2fcc4cbc80">MISDN_GEN_LAST</a> + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01144"></a>01144       <span class="keywordflow">if</span> (<a class="code" href="misdn__config_8c.html#a705f2aef7442b96728a1d130c1ea4398">_enum_array_map</a>())
<a name="l01145"></a>01145          <span class="keywordflow">return</span> -1;
<a name="l01146"></a>01146       p = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, (max_ports + 1) * <span class="keyword">sizeof</span>(<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *)
<a name="l01147"></a>01147                      + (max_ports + 1) * <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a> * <span class="keyword">sizeof</span>(<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a>));
<a name="l01148"></a>01148       port_cfg = (<span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> **)p;
<a name="l01149"></a>01149       p += (max_ports + 1) * <span class="keyword">sizeof</span>(<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *);
<a name="l01150"></a>01150       <span class="keywordflow">for</span> (i = 0; i &lt;= max_ports; ++i) {
<a name="l01151"></a>01151          port_cfg[i] = (<span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *)p;
<a name="l01152"></a>01152          p += <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a> * <span class="keyword">sizeof</span>(<span class="keyword">union </span><a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a>);
<a name="l01153"></a>01153       }
<a name="l01154"></a>01154       general_cfg = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *) * <a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">NUM_GEN_ELEMENTS</a>);
<a name="l01155"></a>01155       ptp = <a class="code" href="astmm_8h.html#a1cb33b63d94fbbde94234b062249e015">ast_calloc</a>(max_ports + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01156"></a>01156    }
<a name="l01157"></a>01157    <span class="keywordflow">else</span> {
<a name="l01158"></a>01158       <span class="comment">/* misdn reload */</span>
<a name="l01159"></a>01159       <a class="code" href="misdn__config_8c.html#a023bb61b2e014d422690936565fcb69e">_free_port_cfg</a>();
<a name="l01160"></a>01160       <a class="code" href="misdn__config_8c.html#a259567e54b2d303629277af2e67c6bfa">_free_general_cfg</a>();
<a name="l01161"></a>01161       memset(port_cfg[0], 0, <a class="code" href="misdn__config_8c.html#a59d3b992910f474202453df33bd05ca5">NUM_PORT_ELEMENTS</a> * <span class="keyword">sizeof</span>(<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a>) * (max_ports + 1));
<a name="l01162"></a>01162       memset(general_cfg, 0, <span class="keyword">sizeof</span>(<span class="keyword">union</span> <a class="code" href="unionmisdn__cfg__pt.html">misdn_cfg_pt</a> *) * <a class="code" href="misdn__config_8c.html#a83493b27f098faa6746d734d0560a3e7">NUM_GEN_ELEMENTS</a>);
<a name="l01163"></a>01163       memset(ptp, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * (max_ports + 1));
<a name="l01164"></a>01164    }
<a name="l01165"></a>01165 
<a name="l01166"></a>01166    cat = <a class="code" href="config_8h.html#a611776300f941a63266cb220ac62b4db" title="Goes through categories.">ast_category_browse</a>(cfg, NULL);
<a name="l01167"></a>01167 
<a name="l01168"></a>01168    <span class="keywordflow">while</span>(cat) {
<a name="l01169"></a>01169       v = <a class="code" href="config_8h.html#a935ccfa153100ddd320c8918bd6e941b" title="Goes through variables Somewhat similar in intent as the ast_category_browse. List...">ast_variable_browse</a>(cfg, cat);
<a name="l01170"></a>01170       <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>)) {
<a name="l01171"></a>01171          <a class="code" href="misdn__config_8c.html#a807a1c4e4bed91c39a20e320dcb6947d">_build_general_config</a>(v);
<a name="l01172"></a>01172       } <span class="keywordflow">else</span> {
<a name="l01173"></a>01173          <a class="code" href="misdn__config_8c.html#ac54122236fbe57164ee22e04c8a546f3">_build_port_config</a>(v, cat);
<a name="l01174"></a>01174       }
<a name="l01175"></a>01175       cat = <a class="code" href="config_8h.html#a611776300f941a63266cb220ac62b4db" title="Goes through categories.">ast_category_browse</a>(cfg, cat);
<a name="l01176"></a>01176    }
<a name="l01177"></a>01177 
<a name="l01178"></a>01178    <a class="code" href="misdn__config_8c.html#a92f772f3a8fca25a32f035720398cda2">_fill_defaults</a>();
<a name="l01179"></a>01179 
<a name="l01180"></a>01180    <a class="code" href="misdn__config_8c.html#a788f0d601bd6a2f2089b3849b720bc62">misdn_cfg_unlock</a>();
<a name="l01181"></a>01181    <a class="code" href="config_8h.html#a710f0b2a897849572b77dd0854b8dc03" title="Destroys a config.">ast_config_destroy</a>(cfg);
<a name="l01182"></a>01182 
<a name="l01183"></a>01183    <span class="keywordflow">return</span> 0;
<a name="l01184"></a>01184 }
<a name="l01185"></a>01185 
<a name="l01186"></a><a class="code" href="chan__misdn__config_8h.html#a5a03113b2d6233d9deaf423b8aa59d64">01186</a> <span class="keyword">struct </span><a class="code" href="structast__jb__conf.html" title="General jitterbuffer configuration.">ast_jb_conf</a> *<a class="code" href="misdn__config_8c.html#a872080169b471c05fe0c59438346a2e8">misdn_get_global_jbconf</a>() {
<a name="l01187"></a>01187    <span class="keywordflow">return</span> &amp;<a class="code" href="misdn__config_8c.html#abaabcb7f4349cc632dde3af5c6a5e1bd">global_jbconf</a>;
<a name="l01188"></a>01188 }
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed May 5 15:18:43 2010 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
